/*! For license information please see module.js.LICENSE.txt */
define(["react","emotion","@grafana/data","@grafana/ui"],(function(e,t,n,i){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=108)}([function(e,t,n){"use strict";var i=function(e,t,n){return e.fields=t||[],e.fname=n,e};function r(e){return null==e?null:e.fname}function o(e){return null==e?null:e.fields}var s=function(e){return 1===e.length?a(e[0]):l(e)};const a=e=>function(t){return t[e]},l=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};var c=function(e){throw Error(e)},u=function(e){let t,n,i,r=[],o=null,s=0,a=e.length,l="";function u(){r.push(l+e.substring(t,n)),l="",t=n+1}for(e+="",t=n=0;n<a;++n)if(i=e[n],"\\"===i)l+=e.substring(t,n),l+=e.substring(++n,++n),t=n;else if(i===o)u(),o=null,s=-1;else{if(o)continue;t===s&&'"'===i||t===s&&"'"===i?(t=n+1,o=i):"."!==i||s?"["===i?(n>t&&u(),s=t=n+1):"]"===i&&(s||c("Access path missing open bracket: "+e),s>0&&u(),s=0,t=n+1):n>t?u():t=n+1}return s&&c("Access path missing closing bracket: "+e),o&&c("Access path missing closing quote: "+e),n>t&&(n++,u()),r},h=function(e,t,n){const r=u(e);return e=1===r.length?r[0]:e,i((n&&n.get||s)(r),[e],t||e)};const d=h("id"),f=i((function(e){return e}),[],"identity"),p=i((function(){return 0}),[],"zero"),g=i((function(){return 1}),[],"one"),m=i((function(){return!0}),[],"true"),v=i((function(){return!1}),[],"false");function b(e,t,n){const i=[t].concat([].slice.call(n));console[e].apply(console,i)}var y=function(e,t){let n=e||0;return{level(e){return arguments.length?(n=+e,this):n},error(){return n>=1&&b(t||"error","ERROR",arguments),this},warn(){return n>=2&&b(t||"warn","WARN",arguments),this},info(){return n>=3&&b(t||"log","INFO",arguments),this},debug(){return n>=4&&b(t||"log","DEBUG",arguments),this}}},w=Array.isArray,x=function(e){return e===Object(e)};const _=e=>"__proto__"!==e;function k(...e){return e.reduce((e,t)=>{for(const n in t)if("signals"===n)e.signals=O(e.signals,t.signals);else{const i="legend"===n?{layout:1}:"style"===n||null;S(e,n,t[n],i)}return e},{})}function S(e,t,n,i){if(!_(t))return;let r,o;if(x(n)&&!w(n))for(r in o=x(e[t])?e[t]:e[t]={},n)i&&(!0===i||i[r])?S(o,r,n[r]):_(r)&&(o[r]=n[r]);else e[t]=n}function O(e,t){if(null==e)return t;const n={},i=[];function r(e){n[e.name]||(n[e.name]=1,i.push(e))}return t.forEach(r),e.forEach(r),i}var C=function(e){return e[e.length-1]},A=function(e){return null==e||""===e?null:+e};const $=e=>t=>e*Math.exp(t),E=e=>t=>Math.log(e*t),M=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),j=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,R=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function D(e,t,n,i){const r=n(e[0]),o=n(C(e)),s=(o-r)*t;return[i(r-s),i(o-s)]}function T(e,t){return D(e,t,A,f)}function L(e,t){var n=Math.sign(e[0]);return D(e,t,E(n),$(n))}function F(e,t,n){return D(e,t,R(n),R(1/n))}function N(e,t,n){return D(e,t,M(n),j(n))}function P(e,t,n,i,r){const o=i(e[0]),s=i(C(e)),a=null!=t?i(t):(o+s)/2;return[r(a+(o-a)*n),r(a+(s-a)*n)]}function z(e,t,n){return P(e,t,n,A,f)}function I(e,t,n){const i=Math.sign(e[0]);return P(e,t,n,E(i),$(i))}function B(e,t,n,i){return P(e,t,n,R(i),R(1/i))}function W(e,t,n,i){return P(e,t,n,M(i),j(i))}function U(e){return 1+~~(new Date(e).getMonth()/3)}function H(e){return 1+~~(new Date(e).getUTCMonth()/3)}var q=function(e){return null!=e?w(e)?e:[e]:[]},V=function(e,t,n){let i,r=e[0],o=e[1];return o<r&&(i=o,o=r,r=i),i=o-r,i>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-i),r+i]},G=function(e){return"function"==typeof e};var K=function(e,t,n){n=n||{},t=q(t)||[];const r=[],s=[],a={},l=n.comparator||X;return q(e).forEach((e,i)=>{null!=e&&(r.push("descending"===t[i]?-1:1),s.push(e=G(e)?e:h(e,null,n)),(o(e)||[]).forEach(e=>a[e]=1))}),0===s.length?null:i(l(s,r),Object.keys(a))};const Y=(e,t)=>(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t==t?-1:t!=t&&e==e?1:0),X=(e,t)=>1===e.length?J(e[0],t[0]):Q(e,t,e.length),J=(e,t)=>function(n,i){return Y(e(n),e(i))*t},Q=(e,t,n)=>(t.push(0),function(i,r){let o,s=0,a=-1;for(;0===s&&++a<n;)o=e[a],s=Y(o(i),o(r));return s*t[a]});var Z=function(e){return G(e)?e:()=>e},ee=function(e,t){let n;return i=>{n&&clearTimeout(n),n=setTimeout(()=>(t(i),n=null),e)}},te=function(e){for(let t,n,i=1,r=arguments.length;i<r;++i)for(n in t=arguments[i],t)e[n]=t[n];return e},ne=function(e,t){let n,i,r,o,s=0;if(e&&(n=e.length))if(null==t){for(i=e[s];s<n&&(null==i||i!=i);i=e[++s]);for(r=o=i;s<n;++s)i=e[s],null!=i&&(i<r&&(r=i),i>o&&(o=i))}else{for(i=t(e[s]);s<n&&(null==i||i!=i);i=t(e[++s]));for(r=o=i;s<n;++s)i=t(e[s]),null!=i&&(i<r&&(r=i),i>o&&(o=i))}return[r,o]},ie=function(e,t){let n,i,r,o,s,a=-1,l=e.length;if(null==t){for(;++a<l;)if(i=e[a],null!=i&&i>=i){n=r=i;break}if(a===l)return[-1,-1];for(o=s=a;++a<l;)i=e[a],null!=i&&(n>i&&(n=i,o=a),r<i&&(r=i,s=a))}else{for(;++a<l;)if(i=t(e[a],a,e),null!=i&&i>=i){n=r=i;break}if(a===l)return[-1,-1];for(o=s=a;++a<l;)i=t(e[a],a,e),null!=i&&(n>i&&(n=i,o=a),r<i&&(r=i,s=a))}return[o,s]};const re=Object.prototype.hasOwnProperty;var oe=function(e,t){return re.call(e,t)};const se={};var ae=function(e){let t,n,i={};function r(e){return oe(i,e)&&i[e]!==se}return t={size:0,empty:0,object:i,has:r,get:e=>r(e)?i[e]:void 0,set(e,n){return r(e)||(++t.size,i[e]===se&&--t.empty),i[e]=n,this},delete(e){return r(e)&&(--t.size,++t.empty,i[e]=se),this},clear(){t.size=t.empty=0,t.object=i={}},test(e){return arguments.length?(n=e,t):n},clean(){let e,r,o={},s=0;for(e in i)r=i[e],r===se||n&&n(r)||(o[e]=r,++s);t.size=s,t.empty=0,t.object=i=o}},e&&Object.keys(e).forEach((function(n){t.set(n,e[n])})),t},le=function(e,t,n,i,r,o){if(!n&&0!==n)return o;let s,a,l=e[0],c=C(e),u=+n;return c<l&&(s=l,l=c,c=s),s=Math.abs(t-l),a=Math.abs(c-t),s<a&&s<=u?i:a<=u?r:o},ce=function(e,t,n){const i=e.prototype=Object.create(t.prototype);return i.constructor=e,te(i,n)},ue=function(e,t,n,i){let r,o=t[0],s=t[t.length-1];return o>s&&(r=o,o=s,s=r),i=void 0===i||i,((n=void 0===n||n)?o<=e:o<e)&&(i?e<=s:e<s)},he=function(e){return"boolean"==typeof e},de=function(e){return"[object Date]"===Object.prototype.toString.call(e)},fe=function(e){return"number"==typeof e},pe=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},ge=function(e){return"string"==typeof e},me=function(e,t,n){e&&(e=t?q(e).map(e=>e.replace(/\\(.)/g,"$1")):q(e));const r=e&&e.length,o=n&&n.get||s,a=e=>o(t?[e]:u(e));let l;if(r)if(1===r){const t=a(e[0]);l=function(e){return""+t(e)}}else{const t=e.map(a);l=function(e){let n=""+t[0](e),i=0;for(;++i<r;)n+="|"+t[i](e);return n}}else l=function(){return""};return i(l,e,"key")},ve=function(e,t){const n=e[0],i=C(e),r=+t;return r?1===r?i:n+r*(i-n):n};var be=function(e){let t,n,i;e=+e||1e4;const r=()=>{t={},n={},i=0},o=(r,o)=>(++i>e&&(n=t,t={},i=1),t[r]=o);return r(),{clear:r,has:e=>oe(t,e)||oe(n,e),get:e=>oe(t,e)?t[e]:oe(n,e)?o(e,n[e]):void 0,set:(e,n)=>oe(t,e)?t[e]=n:o(e,n)}},ye=function(e,t,n,i){const r=t.length,o=n.length;if(!o)return t;if(!r)return n;let s=i||new t.constructor(r+o),a=0,l=0,c=0;for(;a<r&&l<o;++c)s[c]=e(t[a],n[l])>0?n[l++]:t[a++];for(;a<r;++a,++c)s[c]=t[a];for(;l<o;++l,++c)s[c]=n[l];return s},we=function(e,t){let n="";for(;--t>=0;)n+=e;return n},xe=function(e,t,n,i){const r=n||" ",o=e+"",s=t-o.length;return s<=0?o:"left"===i?we(r,s)+o:"center"===i?we(r,~~(s/2))+o+we(r,Math.ceil(s/2)):o+we(r,s)},_e=function(e){return e&&C(e)-e[0]||0};function ke(e){return w(e)?"["+e.map(ke)+"]":x(e)||ge(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}var Se=function(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e)&&!!e};const Oe=e=>fe(e)||de(e)?e:Date.parse(e);var Ce=function(e,t){return t=t||Oe,null==e||""===e?null:t(e)},Ae=function(e){return null==e||""===e?null:e+""},$e=function(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t},Ee=function(e,t,n,i){const r=null!=i?i:"â€¦",o=e+"",s=o.length,a=Math.max(0,t-r.length);return s<=t?o:"left"===n?r+o.slice(s-a):"center"===n?o.slice(0,Math.ceil(a/2))+r+o.slice(s-~~(a/2)):o.slice(0,a)+r},Me=function(e,t,n){if(e)if(t){let i,r=0,o=e.length;for(;r<o;++r)(i=t(e[r]))&&n(i,r,e)}else e.forEach(n)};n.d(t,"f",(function(){return i})),n.d(t,"h",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"x",(function(){return d})),n.d(t,"y",(function(){return f})),n.d(t,"lb",(function(){return p})),n.d(t,"P",(function(){return g})),n.d(t,"hb",(function(){return m})),n.d(t,"s",(function(){return v})),n.d(t,"L",(function(){return y})),n.d(t,"d",(function(){return 0})),n.d(t,"b",(function(){return 1})),n.d(t,"e",(function(){return 2})),n.d(t,"c",(function(){return 3})),n.d(t,"a",(function(){return 4})),n.d(t,"O",(function(){return k})),n.d(t,"kb",(function(){return S})),n.d(t,"R",(function(){return T})),n.d(t,"S",(function(){return L})),n.d(t,"T",(function(){return F})),n.d(t,"U",(function(){return N})),n.d(t,"mb",(function(){return z})),n.d(t,"nb",(function(){return I})),n.d(t,"ob",(function(){return B})),n.d(t,"pb",(function(){return W})),n.d(t,"W",(function(){return U})),n.d(t,"ib",(function(){return H})),n.d(t,"i",(function(){return q})),n.d(t,"k",(function(){return V})),n.d(t,"l",(function(){return K})),n.d(t,"j",(function(){return Y})),n.d(t,"m",(function(){return Z})),n.d(t,"n",(function(){return ee})),n.d(t,"o",(function(){return c})),n.d(t,"p",(function(){return te})),n.d(t,"q",(function(){return ne})),n.d(t,"r",(function(){return ie})),n.d(t,"t",(function(){return ae})),n.d(t,"u",(function(){return h})),n.d(t,"v",(function(){return le})),n.d(t,"w",(function(){return oe})),n.d(t,"z",(function(){return ce})),n.d(t,"A",(function(){return ue})),n.d(t,"B",(function(){return w})),n.d(t,"C",(function(){return he})),n.d(t,"D",(function(){return de})),n.d(t,"E",(function(){return G})),n.d(t,"F",(function(){return fe})),n.d(t,"G",(function(){return x})),n.d(t,"H",(function(){return pe})),n.d(t,"I",(function(){return ge})),n.d(t,"J",(function(){return me})),n.d(t,"K",(function(){return ve})),n.d(t,"M",(function(){return be})),n.d(t,"N",(function(){return ye})),n.d(t,"Q",(function(){return xe})),n.d(t,"V",(function(){return C})),n.d(t,"X",(function(){return we})),n.d(t,"Y",(function(){return _e})),n.d(t,"Z",(function(){return u})),n.d(t,"ab",(function(){return ke})),n.d(t,"bb",(function(){return Se})),n.d(t,"cb",(function(){return Ce})),n.d(t,"db",(function(){return A})),n.d(t,"fb",(function(){return Ae})),n.d(t,"eb",(function(){return $e})),n.d(t,"gb",(function(){return Ee})),n.d(t,"jb",(function(){return Me}))},,function(t,n){t.exports=e},function(e,t,n){"use strict";function i(e){this.type=e}var r,o,s,a,l;i.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=function(e){switch(e.type){case"ArrayExpression":return e.elements;case"BinaryExpression":case"LogicalExpression":return[e.left,e.right];case"CallExpression":return[e.callee].concat(e.arguments);case"ConditionalExpression":return[e.test,e.consequent,e.alternate];case"MemberExpression":return[e.object,e.property];case"ObjectExpression":return e.properties;case"Property":return[e.key,e.value];case"UnaryExpression":return[e.argument];case"Identifier":case"Literal":case"RawCode":default:return[]}}(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1};(r={})[1]="Boolean",r[2]="<end>",r[3]="Identifier",r[4]="Keyword",r[5]="Null",r[6]="Numeric",r[7]="Punctuator",r[8]="String",r[9]="RegularExpression";var c="ILLEGAL",u=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),h=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function d(e,t){if(!e)throw new Error("ASSERT: "+t)}function f(e){return e>=48&&e<=57}function p(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function g(e){return"01234567".indexOf(e)>=0}function m(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function v(e){return 10===e||13===e||8232===e||8233===e}function b(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&u.test(String.fromCharCode(e))}function y(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&h.test(String.fromCharCode(e))}var w={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function x(){for(var e;s<a&&(m(e=o.charCodeAt(s))||v(e));)++s}function _(e){var t,n,i,r=0;for(n="u"===e?4:2,t=0;t<n;++t)s<a&&p(o[s])?(i=o[s++],r=16*r+"0123456789abcdef".indexOf(i.toLowerCase())):P({},"Unexpected token %0",c);return String.fromCharCode(r)}function k(){var e,t,n,i;for(t=0,"}"===(e=o[s])&&P({},"Unexpected token %0",c);s<a&&p(e=o[s++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&P({},"Unexpected token %0",c),t<=65535?String.fromCharCode(t):(n=55296+(t-65536>>10),i=56320+(t-65536&1023),String.fromCharCode(n,i))}function S(){var e,t;for(e=o.charCodeAt(s++),t=String.fromCharCode(e),92===e&&(117!==o.charCodeAt(s)&&P({},"Unexpected token %0",c),++s,(e=_("u"))&&"\\"!==e&&b(e.charCodeAt(0))||P({},"Unexpected token %0",c),t=e);s<a&&y(e=o.charCodeAt(s));)++s,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==o.charCodeAt(s)&&P({},"Unexpected token %0",c),++s,(e=_("u"))&&"\\"!==e&&y(e.charCodeAt(0))||P({},"Unexpected token %0",c),t+=e);return t}function O(){var e,t;return e=s,{type:1===(t=92===o.charCodeAt(s)?S():function(){var e,t;for(e=s++;s<a;){if(92===(t=o.charCodeAt(s)))return s=e,S();if(!y(t))break;++s}return o.slice(e,s)}()).length?3:w.hasOwnProperty(t)?4:"null"===t?5:"true"===t||"false"===t?1:3,value:t,start:e,end:s}}function C(){var e,t,n,i,r=s,a=o.charCodeAt(s),l=o[s];switch(a){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++s,{type:7,value:String.fromCharCode(a),start:r,end:s};default:if(61===(e=o.charCodeAt(s+1)))switch(a){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return s+=2,{type:7,value:String.fromCharCode(a)+String.fromCharCode(e),start:r,end:s};case 33:case 61:return s+=2,61===o.charCodeAt(s)&&++s,{type:7,value:o.slice(r,s),start:r,end:s}}}return">>>="===(i=o.substr(s,4))?{type:7,value:i,start:r,end:s+=4}:">>>"===(n=i.substr(0,3))||"<<="===n||">>="===n?{type:7,value:n,start:r,end:s+=3}:l===(t=n.substr(0,2))[1]&&"+-<>&|".indexOf(l)>=0||"=>"===t?{type:7,value:t,start:r,end:s+=2}:"<>=!+-*%&|^/".indexOf(l)>=0?{type:7,value:l,start:r,end:++s}:void P({},"Unexpected token %0",c)}function A(){var e,t,n;if(d(f((n=o[s]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=s,e="","."!==n){if(e=o[s++],n=o[s],"0"===e){if("x"===n||"X"===n)return++s,function(e){for(var t="";s<a&&p(o[s]);)t+=o[s++];return 0===t.length&&P({},"Unexpected token %0",c),b(o.charCodeAt(s))&&P({},"Unexpected token %0",c),{type:6,value:parseInt("0x"+t,16),start:e,end:s}}(t);if(g(n))return function(e){for(var t="0"+o[s++];s<a&&g(o[s]);)t+=o[s++];return(b(o.charCodeAt(s))||f(o.charCodeAt(s)))&&P({},"Unexpected token %0",c),{type:6,value:parseInt(t,8),octal:!0,start:e,end:s}}(t);n&&f(n.charCodeAt(0))&&P({},"Unexpected token %0",c)}for(;f(o.charCodeAt(s));)e+=o[s++];n=o[s]}if("."===n){for(e+=o[s++];f(o.charCodeAt(s));)e+=o[s++];n=o[s]}if("e"===n||"E"===n)if(e+=o[s++],"+"!==(n=o[s])&&"-"!==n||(e+=o[s++]),f(o.charCodeAt(s)))for(;f(o.charCodeAt(s));)e+=o[s++];else P({},"Unexpected token %0",c);return b(o.charCodeAt(s))&&P({},"Unexpected token %0",c),{type:6,value:parseFloat(e),start:t,end:s}}function $(){var e,t,n,i;return l=null,x(),e=s,t=function(){var e,t,n,i;for(d("/"===(e=o[s]),"Regular expression literal must start with a slash"),t=o[s++],n=!1,i=!1;s<a;)if(t+=e=o[s++],"\\"===e)v((e=o[s++]).charCodeAt(0))&&P({},"Invalid regular expression: missing /"),t+=e;else if(v(e.charCodeAt(0)))P({},"Invalid regular expression: missing /");else if(n)"]"===e&&(n=!1);else{if("/"===e){i=!0;break}"["===e&&(n=!0)}return i||P({},"Invalid regular expression: missing /"),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,n;for(t="",n="";s<a&&y((e=o[s]).charCodeAt(0));)++s,"\\"===e&&s<a?P({},"Unexpected token %0",c):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&P({},"Invalid regular expression",n),{value:n,literal:t}}(),i=function(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(e,t){if(parseInt(t,16)<=1114111)return"x";P({},"Invalid regular expression")})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(e){P({},"Invalid regular expression")}try{return new RegExp(e,t)}catch(e){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:s}}function E(){var e;return x(),s>=a?{type:2,start:s,end:s}:b(e=o.charCodeAt(s))?O():40===e||41===e||59===e?C():39===e||34===e?function(){var e,t,n,i,r="",l=!1;for(d("'"===(e=o[s])||'"'===e,"String literal must starts with a quote"),t=s,++s;s<a;){if((n=o[s++])===e){e="";break}if("\\"===n)if((n=o[s++])&&v(n.charCodeAt(0)))"\r"===n&&"\n"===o[s]&&++s;else switch(n){case"u":case"x":"{"===o[s]?(++s,r+=k()):r+=_(n);break;case"n":r+="\n";break;case"r":r+="\r";break;case"t":r+="\t";break;case"b":r+="\b";break;case"f":r+="\f";break;case"v":r+="\v";break;default:g(n)?(0!==(i="01234567".indexOf(n))&&(l=!0),s<a&&g(o[s])&&(l=!0,i=8*i+"01234567".indexOf(o[s++]),"0123".indexOf(n)>=0&&s<a&&g(o[s])&&(i=8*i+"01234567".indexOf(o[s++]))),r+=String.fromCharCode(i)):r+=n}else{if(v(n.charCodeAt(0)))break;r+=n}}return""!==e&&P({},"Unexpected token %0",c),{type:8,value:r,octal:l,start:t,end:s}}():46===e?f(o.charCodeAt(s+1))?A():C():f(e)?A():C()}function M(){var e;return s=(e=l).end,l=E(),s=e.end,e}function j(){var e;e=s,l=E(),s=e}function R(e,t,n){var r=new i("||"===e||"&&"===e?"LogicalExpression":"BinaryExpression");return r.operator=e,r.left=t,r.right=n,r}function D(e,t){var n=new i("CallExpression");return n.callee=e,n.arguments=t,n}function T(e){var t=new i("Identifier");return t.name=e,t}function L(e){var t=new i("Literal");return t.value=e.value,t.raw=o.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function F(e,t,n){var r=new i("MemberExpression");return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function N(e,t,n){var r=new i("Property");return r.key=t,r.value=n,r.kind=e,r}function P(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(function(e,t){return d(t<i.length,"Message reference must be in range"),i[t]}));throw(n=new Error(r)).index=s,n.description=r,n}function z(e){2===e.type&&P(e,"Unexpected end of input"),6===e.type&&P(e,"Unexpected number"),8===e.type&&P(e,"Unexpected string"),3===e.type&&P(e,"Unexpected identifier"),4===e.type&&P(e,"Unexpected reserved word"),P(e,"Unexpected token %0",e.value)}function I(e){var t=M();7===t.type&&t.value===e||z(t)}function B(e){return 7===l.type&&l.value===e}function W(e){return 4===l.type&&l.value===e}function U(){var e=[];for(s=l.start,I("[");!B("]");)B(",")?(M(),e.push(null)):(e.push(te()),B("]")||I(","));return M(),function(e){var t=new i("ArrayExpression");return t.elements=e,t}(e)}function H(){var e;return s=l.start,8===(e=M()).type||6===e.type?(e.octal&&P(e,"Octal literals are not allowed in strict mode."),L(e)):T(e.value)}function q(){var e,t,n;return s=l.start,3===(e=l).type?(n=H(),I(":"),N("init",n,te())):2!==e.type&&7!==e.type?(t=H(),I(":"),N("init",t,te())):void z(e)}function V(){var e,t,n=[],r={},o=String;for(s=l.start,I("{");!B("}");)t="$"+("Identifier"===(e=q()).key.type?e.key.name:o(e.key.value)),Object.prototype.hasOwnProperty.call(r,t)?P({},"Duplicate data property in object literal not allowed in strict mode"):r[t]=!0,n.push(e),B("}")||I(",");return I("}"),function(e){var t=new i("ObjectExpression");return t.properties=e,t}(n)}var G={if:1};function K(){var e,t,n;if(B("("))return function(){var e;return I("("),e=ne(),I(")"),e}();if(B("["))return U();if(B("{"))return V();if(e=l.type,s=l.start,3===e||G[l.value])n=T(M().value);else if(8===e||6===e)l.octal&&P(l,"Octal literals are not allowed in strict mode."),n=L(M());else{if(4===e)throw new Error("Disabled.");1===e?((t=M()).value="true"===t.value,n=L(t)):5===e?((t=M()).value=null,n=L(t)):B("/")||B("/=")?(n=L($()),j()):z(M())}return n}function Y(){var e=[];if(I("("),!B(")"))for(;s<a&&(e.push(te()),!B(")"));)I(",");return I(")"),e}function X(){return I("."),s=l.start,function(e){return 3===e.type||4===e.type||1===e.type||5===e.type}(e=M())||z(e),T(e.value);var e}function J(){var e;return I("["),e=ne(),I("]"),e}function Q(){var e=function(){var e;for(e=K();;)if(B("."))e=F(".",e,X());else if(B("("))e=D(e,Y());else{if(!B("["))break;e=F("[",e,J())}return e}();if(7===l.type&&(B("++")||B("--")))throw new Error("Disabled.");return e}function Z(){var e,t,n,r,o;if(7!==l.type&&4!==l.type)t=Q();else{if(B("++")||B("--"))throw new Error("Disabled.");if(B("+")||B("-")||B("~")||B("!"))e=M(),t=Z(),n=e.value,r=t,(o=new i("UnaryExpression")).operator=n,o.argument=r,o.prefix=!0,t=o;else{if(W("delete")||W("void")||W("typeof"))throw new Error("Disabled.");t=Q()}}return t}function ee(e){var t=0;if(7!==e.type&&4!==e.type)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function te(){var e,t;return e=function(){var e,t,n,i,r,o,s,a,c,u;if(e=l,c=Z(),0===(r=ee(i=l)))return c;for(i.prec=r,M(),t=[e,l],o=[c,i,s=Z()];(r=ee(l))>0;){for(;o.length>2&&r<=o[o.length-2].prec;)s=o.pop(),a=o.pop().value,c=o.pop(),t.pop(),n=R(a,c,s),o.push(n);(i=M()).prec=r,o.push(i),t.push(l),n=Z(),o.push(n)}for(n=o[u=o.length-1],t.pop();u>1;)t.pop(),n=R(o[u-1].value,o[u-2],n),u-=2;return n}(),B("?")&&(M(),t=te(),I(":"),e=function(e,t,n){var r=new i("ConditionalExpression");return r.test=e,r.consequent=t,r.alternate=n,r}(e,t,te())),e}function ne(){var e=te();if(B(","))throw new Error("Disabled.");return e}var ie=function(e){s=0,a=(o=e).length,l=null,j();var t=ne();if(2!==l.type)throw new Error("Unexpect token after expression.");return t},re={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"},oe=n(0),se=function(e){function t(t,n,i){return r=>function(t,n,i,r){let o=e(n[0]);return i&&(o=i+"("+o+")",0===i.lastIndexOf("new ",0)&&(o="("+o+")")),o+"."+t+(r<0?"":0===r?"()":"("+n.slice(1).map(e).join(",")+")")}(t,r,n,i)}const n="new Date";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){t.length<3&&Object(oe.o)("Missing arguments to clamp function."),t.length>3&&Object(oe.o)("Too many arguments to clamp function.");const n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:t("getDate",n,0),day:t("getDay",n,0),year:t("getFullYear",n,0),month:t("getMonth",n,0),hours:t("getHours",n,0),minutes:t("getMinutes",n,0),seconds:t("getSeconds",n,0),milliseconds:t("getMilliseconds",n,0),time:t("getTime",n,0),timezoneoffset:t("getTimezoneOffset",n,0),utcdate:t("getUTCDate",n,0),utcday:t("getUTCDay",n,0),utcyear:t("getUTCFullYear",n,0),utcmonth:t("getUTCMonth",n,0),utchours:t("getUTCHours",n,0),utcminutes:t("getUTCMinutes",n,0),utcseconds:t("getUTCSeconds",n,0),utcmilliseconds:t("getUTCMilliseconds",n,0),length:t("length",null,-1),join:t("join",null),indexof:t("indexOf",null),lastindexof:t("lastIndexOf",null),slice:t("slice",null),reverse:function(t){return"("+e(t[0])+").slice().reverse()"},parseFloat:"parseFloat",parseInt:"parseInt",upper:t("toUpperCase","String",0),lower:t("toLowerCase","String",0),substring:t("substring","String"),split:t("split","String"),replace:t("replace","String"),trim:t("trim","String",0),regexp:"RegExp",test:t("test","RegExp"),if:function(t){t.length<3&&Object(oe.o)("Missing arguments to if function."),t.length>3&&Object(oe.o)("Too many arguments to if function.");const n=t.map(e);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}};var ae=function(e){const t=(e=e||{}).whitelist?Object(oe.eb)(e.whitelist):{},n=e.blacklist?Object(oe.eb)(e.blacklist):{},i=e.constants||re,r=(e.functions||se)(h),o=e.globalvar,s=e.fieldvar,a=Object(oe.E)(o)?o:e=>`${o}["${e}"]`;let l={},c={},u=0;function h(e){if(Object(oe.I)(e))return e;const t=d[e.type];return null==t&&Object(oe.o)("Unsupported type: "+e.type),t(e)}const d={Literal:e=>e.raw,Identifier:e=>{const r=e.name;return u>0?r:Object(oe.w)(n,r)?Object(oe.o)("Illegal identifier: "+r):Object(oe.w)(i,r)?i[r]:Object(oe.w)(t,r)?r:(l[r]=1,a(r))},MemberExpression:e=>{const t=!e.computed,n=h(e.object);t&&(u+=1);const i=h(e.property);return n===s&&(c[function(e){const t=e&&e.length-1;return t&&('"'===e[0]&&'"'===e[t]||"'"===e[0]&&"'"===e[t])?e.slice(1,-1):e}(i)]=1),t&&(u-=1),n+(t?"."+i:"["+i+"]")},CallExpression:e=>{"Identifier"!==e.callee.type&&Object(oe.o)("Illegal callee type: "+e.callee.type);const t=e.callee.name,n=e.arguments,i=Object(oe.w)(r,t)&&r[t];return i||Object(oe.o)("Unrecognized function: "+t),Object(oe.E)(i)?i(n):i+"("+n.map(h).join(",")+")"},ArrayExpression:e=>"["+e.elements.map(h).join(",")+"]",BinaryExpression:e=>"("+h(e.left)+e.operator+h(e.right)+")",UnaryExpression:e=>"("+e.operator+h(e.argument)+")",ConditionalExpression:e=>"("+h(e.test)+"?"+h(e.consequent)+":"+h(e.alternate)+")",LogicalExpression:e=>"("+h(e.left)+e.operator+h(e.right)+")",ObjectExpression:e=>"{"+e.properties.map(h).join(",")+"}",Property:e=>{u+=1;const t=h(e.key);return u-=1,t+":"+h(e.value)}};function f(e){const t={code:h(e),globals:Object.keys(l),fields:Object.keys(c)};return l={},c={},t}return f.functions=r,f.constants=i,f};n.d(t,"b",(function(){return"Literal"})),n.d(t,"a",(function(){return"CallExpression"})),n.d(t,"f",(function(){return ie})),n.d(t,"c",(function(){return ae})),n.d(t,"e",(function(){return se})),n.d(t,"d",(function(){return re}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s}));var i=function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function r(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))}function o(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s}function s(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}},function(e,t,n){const i=n(19),{MAX_LENGTH:r,MAX_SAFE_INTEGER:o}=n(18),{re:s,t:a}=n(13),{compareIdentifiers:l}=n(35);class c{constructor(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof c){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>r)throw new TypeError(`version is longer than ${r} characters`);i("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?s[a.LOOSE]:s[a.FULL]);if(!n)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<o)return t}return e}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version}toString(){return this.version}compare(e){if(i("SemVer.compare",this.version,this.options,e),!(e instanceof c)){if("string"==typeof e&&e===this.version)return 0;e=new c(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof c||(e=new c(e,this.options)),l(this.major,e.major)||l(this.minor,e.minor)||l(this.patch,e.patch)}comparePre(e){if(e instanceof c||(e=new c(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],r=e.prerelease[t];if(i("prerelease compare",t,n,r),void 0===n&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===n)return-1;if(n!==r)return l(n,r)}while(++t)}compareBuild(e){e instanceof c||(e=new c(e,this.options));let t=0;do{const n=this.build[t],r=e.build[t];if(i("prerelease compare",t,n,r),void 0===n&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===n)return-1;if(n!==r)return l(n,r)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this}}e.exports=c},function(e,t,n){"use strict";var i=function(e,t,n){return r=t||s,o=n||l,u(e.trim()).map(h)};let r,o,s="view",a=/[[\]{}]/,l={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function c(e,t,n,i,r){let o,s=0,a=e.length;for(;t<a;++t){if(o=e[t],!s&&o===n)return t;r&&r.indexOf(o)>=0?--s:i&&i.indexOf(o)>=0&&++s}return t}function u(e){let t=[],n=0,i=e.length,r=0;for(;r<i;)r=c(e,r,",","[{","]}"),t.push(e.substring(n,r).trim()),n=++r;if(0===t.length)throw"Empty event selector: "+e;return t}function h(e){return"["===e[0]?function(e){let t,n,i=e.length,r=1;if(r=c(e,r,"]","[","]"),r===i)throw"Empty between selector: "+e;if(t=u(e.substring(1,r)),2!==t.length)throw"Between selector must have two elements: "+e;if(">"!==(e=e.slice(r+1).trim())[0])throw"Expected '>' after between selector: "+e;if(t=t.map(h),n=h(e.slice(1).trim()),n.between)return{between:t,stream:n};n.between=t;return n}(e):function(e){let t,n,i={source:r},s=[],l=[0,0],u=0,h=0,d=e.length,f=0;if("}"===e[d-1]){if(f=e.lastIndexOf("{"),!(f>=0))throw"Unmatched right brace: "+e;try{l=function(e){const t=e.split(",");if(!e.length||t.length>2)throw e;return t.map((function(t){const n=+t;if(n!=n)throw e;return n}))}(e.substring(f+1,d-1))}catch(t){throw"Invalid throttle specification: "+e}e=e.slice(0,f).trim(),d=e.length,f=0}if(!d)throw e;"@"===e[0]&&(u=++f);t=c(e,f,":"),t<d&&(s.push(e.substring(h,t).trim()),h=f=++t);if(f=c(e,f,"["),f===d)s.push(e.substring(h,d).trim());else if(s.push(e.substring(h,f).trim()),n=[],h=++f,h===d)throw"Unmatched left bracket: "+e;for(;f<d;){if(f=c(e,f,"]"),f===d)throw"Unmatched left bracket: "+e;if(n.push(e.substring(h,f).trim()),f<d-1&&"["!==e[++f])throw"Expected left bracket: "+e;h=++f}if(!(d=s.length)||a.test(s[d-1]))throw"Invalid event selector: "+e;d>1?(i.type=s[1],u?i.markname=s[0].slice(1):(p=s[0],o[p]?i.marktype=s[0]:i.source=s[0])):i.type=s[0];var p;"!"===i.type.slice(-1)&&(i.consume=!0,i.type=i.type.slice(0,-1));null!=n&&(i.filter=n);l[0]&&(i.throttle=l[0]);l[1]&&(i.debounce=l[1]);return i}(e)}n.d(t,"a",(function(){return i}))},function(e,t,n){const i=n(5);e.exports=(e,t,n)=>new i(e,n).compare(new i(t,n))},function(e,t,n){class i{constructor(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof i)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new i(e.raw,t);if(e instanceof r)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){const t=this.options.loose;e=e.trim();const n=t?a[l.HYPHENRANGELOOSE]:a[l.HYPHENRANGE];e=e.replace(n,k(this.options.includePrerelease)),o("hyphen replace",e),e=e.replace(a[l.COMPARATORTRIM],c),o("comparator trim",e,a[l.COMPARATORTRIM]),e=(e=(e=e.replace(a[l.TILDETRIM],u)).replace(a[l.CARETTRIM],h)).split(/\s+/).join(" ");const i=t?a[l.COMPARATORLOOSE]:a[l.COMPARATOR];return e.split(" ").map(e=>f(e,this.options)).join(" ").split(/\s+/).map(e=>_(e,this.options)).filter(this.options.loose?e=>!!e.match(i):()=>!0).map(e=>new r(e,this.options))}intersects(e,t){if(!(e instanceof i))throw new TypeError("a Range is required");return this.set.some(n=>d(n,t)&&e.set.some(e=>d(e,t)&&n.every(n=>e.every(e=>n.intersects(e,t)))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new s(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(S(this.set[t],e,this.options))return!0;return!1}}e.exports=i;const r=n(21),o=n(19),s=n(5),{re:a,t:l,comparatorTrimReplace:c,tildeTrimReplace:u,caretTrimReplace:h}=n(13),d=(e,t)=>{let n=!0;const i=e.slice();let r=i.pop();for(;n&&i.length;)n=i.every(e=>r.intersects(e,t)),r=i.pop();return n},f=(e,t)=>(o("comp",e,t),e=v(e,t),o("caret",e),e=g(e,t),o("tildes",e),e=y(e,t),o("xrange",e),e=x(e,t),o("stars",e),e),p=e=>!e||"x"===e.toLowerCase()||"*"===e,g=(e,t)=>e.trim().split(/\s+/).map(e=>m(e,t)).join(" "),m=(e,t)=>{const n=t.loose?a[l.TILDELOOSE]:a[l.TILDE];return e.replace(n,(t,n,i,r,s)=>{let a;return o("tilde",e,t,n,i,r,s),p(n)?a="":p(i)?a=`>=${n}.0.0 <${+n+1}.0.0-0`:p(r)?a=`>=${n}.${i}.0 <${n}.${+i+1}.0-0`:s?(o("replaceTilde pr",s),a=`>=${n}.${i}.${r}-${s} <${n}.${+i+1}.0-0`):a=`>=${n}.${i}.${r} <${n}.${+i+1}.0-0`,o("tilde return",a),a})},v=(e,t)=>e.trim().split(/\s+/).map(e=>b(e,t)).join(" "),b=(e,t)=>{o("caret",e,t);const n=t.loose?a[l.CARETLOOSE]:a[l.CARET],i=t.includePrerelease?"-0":"";return e.replace(n,(t,n,r,s,a)=>{let l;return o("caret",e,t,n,r,s,a),p(n)?l="":p(r)?l=`>=${n}.0.0${i} <${+n+1}.0.0-0`:p(s)?l="0"===n?`>=${n}.${r}.0${i} <${n}.${+r+1}.0-0`:`>=${n}.${r}.0${i} <${+n+1}.0.0-0`:a?(o("replaceCaret pr",a),l="0"===n?"0"===r?`>=${n}.${r}.${s}-${a} <${n}.${r}.${+s+1}-0`:`>=${n}.${r}.${s}-${a} <${n}.${+r+1}.0-0`:`>=${n}.${r}.${s}-${a} <${+n+1}.0.0-0`):(o("no pr"),l="0"===n?"0"===r?`>=${n}.${r}.${s}${i} <${n}.${r}.${+s+1}-0`:`>=${n}.${r}.${s}${i} <${n}.${+r+1}.0-0`:`>=${n}.${r}.${s} <${+n+1}.0.0-0`),o("caret return",l),l})},y=(e,t)=>(o("replaceXRanges",e,t),e.split(/\s+/).map(e=>w(e,t)).join(" ")),w=(e,t)=>{e=e.trim();const n=t.loose?a[l.XRANGELOOSE]:a[l.XRANGE];return e.replace(n,(n,i,r,s,a,l)=>{o("xRange",e,n,i,r,s,a,l);const c=p(r),u=c||p(s),h=u||p(a),d=h;return"="===i&&d&&(i=""),l=t.includePrerelease?"-0":"",c?n=">"===i||"<"===i?"<0.0.0-0":"*":i&&d?(u&&(s=0),a=0,">"===i?(i=">=",u?(r=+r+1,s=0,a=0):(s=+s+1,a=0)):"<="===i&&(i="<",u?r=+r+1:s=+s+1),"<"===i&&(l="-0"),n=`${i+r}.${s}.${a}${l}`):u?n=`>=${r}.0.0${l} <${+r+1}.0.0-0`:h&&(n=`>=${r}.${s}.0${l} <${r}.${+s+1}.0-0`),o("xRange return",n),n})},x=(e,t)=>(o("replaceStars",e,t),e.trim().replace(a[l.STAR],"")),_=(e,t)=>(o("replaceGTE0",e,t),e.trim().replace(a[t.includePrerelease?l.GTE0PRE:l.GTE0],"")),k=e=>(t,n,i,r,o,s,a,l,c,u,h,d,f)=>`${n=p(i)?"":p(r)?`>=${i}.0.0${e?"-0":""}`:p(o)?`>=${i}.${r}.0${e?"-0":""}`:s?">="+n:`>=${n}${e?"-0":""}`} ${l=p(c)?"":p(u)?`<${+c+1}.0.0-0`:p(h)?`<${c}.${+u+1}.0-0`:d?`<=${c}.${u}.${h}-${d}`:e?`<${c}.${u}.${+h+1}-0`:"<="+l}`.trim(),S=(e,t,n)=>{for(let n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let n=0;n<e.length;n++)if(o(e[n].semver),e[n].semver!==r.ANY&&e[n].semver.prerelease.length>0){const i=e[n].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}},,,function(e,t,n){e.exports=n(74)()},function(e,t,n){"use strict";e.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var n,i="boolean"==typeof t.cycles&&t.cycles,r=t.cmp&&(n=t.cmp,function(e){return function(t,i){var r={key:t,value:e[t]},o={key:i,value:e[i]};return n(r,o)}}),o=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var n,s;if(Array.isArray(t)){for(s="[",n=0;n<t.length;n++)n&&(s+=","),s+=e(t[n])||"null";return s+"]"}if(null===t)return"null";if(-1!==o.indexOf(t)){if(i)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var a=o.push(t)-1,l=Object.keys(t).sort(r&&r(t));for(s="",n=0;n<l.length;n++){var c=l[n],u=e(t[c]);u&&(s&&(s+=","),s+=JSON.stringify(c)+":"+u)}return o.splice(a,1),"{"+s+"}"}}(e)}},function(e,t,n){const{MAX_SAFE_COMPONENT_LENGTH:i}=n(18),r=n(19),o=(t=e.exports={}).re=[],s=t.src=[],a=t.t={};let l=0;const c=(e,t,n)=>{const i=l++;r(i,t),a[e]=i,s[i]=t,o[i]=new RegExp(t,n?"g":void 0)};c("NUMERICIDENTIFIER","0|[1-9]\\d*"),c("NUMERICIDENTIFIERLOOSE","[0-9]+"),c("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),c("MAINVERSION",`(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})`),c("MAINVERSIONLOOSE",`(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})`),c("PRERELEASEIDENTIFIER",`(?:${s[a.NUMERICIDENTIFIER]}|${s[a.NONNUMERICIDENTIFIER]})`),c("PRERELEASEIDENTIFIERLOOSE",`(?:${s[a.NUMERICIDENTIFIERLOOSE]}|${s[a.NONNUMERICIDENTIFIER]})`),c("PRERELEASE",`(?:-(${s[a.PRERELEASEIDENTIFIER]}(?:\\.${s[a.PRERELEASEIDENTIFIER]})*))`),c("PRERELEASELOOSE",`(?:-?(${s[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[a.PRERELEASEIDENTIFIERLOOSE]})*))`),c("BUILDIDENTIFIER","[0-9A-Za-z-]+"),c("BUILD",`(?:\\+(${s[a.BUILDIDENTIFIER]}(?:\\.${s[a.BUILDIDENTIFIER]})*))`),c("FULLPLAIN",`v?${s[a.MAINVERSION]}${s[a.PRERELEASE]}?${s[a.BUILD]}?`),c("FULL",`^${s[a.FULLPLAIN]}$`),c("LOOSEPLAIN",`[v=\\s]*${s[a.MAINVERSIONLOOSE]}${s[a.PRERELEASELOOSE]}?${s[a.BUILD]}?`),c("LOOSE",`^${s[a.LOOSEPLAIN]}$`),c("GTLT","((?:<|>)?=?)"),c("XRANGEIDENTIFIERLOOSE",s[a.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*"),c("XRANGEIDENTIFIER",s[a.NUMERICIDENTIFIER]+"|x|X|\\*"),c("XRANGEPLAIN",`[v=\\s]*(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:${s[a.PRERELEASE]})?${s[a.BUILD]}?)?)?`),c("XRANGEPLAINLOOSE",`[v=\\s]*(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:${s[a.PRERELEASELOOSE]})?${s[a.BUILD]}?)?)?`),c("XRANGE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAIN]}$`),c("XRANGELOOSE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAINLOOSE]}$`),c("COERCE",`(^|[^\\d])(\\d{1,${i}})(?:\\.(\\d{1,${i}}))?(?:\\.(\\d{1,${i}}))?(?:$|[^\\d])`),c("COERCERTL",s[a.COERCE],!0),c("LONETILDE","(?:~>?)"),c("TILDETRIM",`(\\s*)${s[a.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",c("TILDE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAIN]}$`),c("TILDELOOSE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAINLOOSE]}$`),c("LONECARET","(?:\\^)"),c("CARETTRIM",`(\\s*)${s[a.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",c("CARET",`^${s[a.LONECARET]}${s[a.XRANGEPLAIN]}$`),c("CARETLOOSE",`^${s[a.LONECARET]}${s[a.XRANGEPLAINLOOSE]}$`),c("COMPARATORLOOSE",`^${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]})$|^$`),c("COMPARATOR",`^${s[a.GTLT]}\\s*(${s[a.FULLPLAIN]})$|^$`),c("COMPARATORTRIM",`(\\s*)${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]}|${s[a.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",c("HYPHENRANGE",`^\\s*(${s[a.XRANGEPLAIN]})\\s+-\\s+(${s[a.XRANGEPLAIN]})\\s*$`),c("HYPHENRANGELOOSE",`^\\s*(${s[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[a.XRANGEPLAINLOOSE]})\\s*$`),c("STAR","(<|>)?=?\\s*\\*"),c("GTE0","^\\s*>=\\s*0.0.0\\s*$"),c("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},function(e,t,n){const{MAX_LENGTH:i}=n(18),{re:r,t:o}=n(13),s=n(5);e.exports=(e,t)=>{if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof s)return e;if("string"!=typeof e)return null;if(e.length>i)return null;if(!(t.loose?r[o.LOOSE]:r[o.FULL]).test(e))return null;try{return new s(e,t)}catch(e){return null}}},function(e,n){e.exports=t},,,function(e,t){const n=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:n,MAX_SAFE_COMPONENT_LENGTH:16}},function(e,t,n){(function(t){const n="object"==typeof t&&t.env&&t.env.NODE_DEBUG&&/\bsemver\b/i.test(t.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=n}).call(this,n(76))},function(e,t,n){const i=n(7);e.exports=(e,t,n)=>i(e,t,n)>0},function(e,t,n){const i=Symbol("SemVer ANY");class r{static get ANY(){return i}constructor(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof r){if(e.loose===!!t.loose)return e;e=e.value}l("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===i?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(e){const t=this.options.loose?o[s.COMPARATORLOOSE]:o[s.COMPARATOR],n=e.match(t);if(!n)throw new TypeError("Invalid comparator: "+e);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new c(n[2],this.options.loose):this.semver=i}toString(){return this.value}test(e){if(l("Comparator.test",e,this.options.loose),this.semver===i||e===i)return!0;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}return a(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Comparator is required");if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||new u(e.value,t).test(this.value);if(""===e.operator)return""===e.value||new u(this.value,t).test(e.semver);const n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),i=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),o=this.semver.version===e.semver.version,s=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),l=a(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=a(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||i||o&&s||l||c}}e.exports=r;const{re:o,t:s}=n(13),a=n(51),l=n(19),c=n(5),u=n(8)},function(e,t,n){const i=n(8);e.exports=(e,t,n)=>{try{t=new i(t,n)}catch(e){return!1}return t.test(e)}},function(e,t,n){"use strict";(function(e){var i=n(100),r=n(101),o=n(102);function s(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return c(this,e,t,n)}function c(e,t,n,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i);l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=d(e,t);return e}(e,t,n,i):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|p(t,n),r=(e=a(e,i)).write(t,n);r!==i&&(e=e.slice(0,r));return e}(e,t,n):function(e,t){if(l.isBuffer(t)){var n=0|f(t.length);return 0===(e=a(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?a(e,0):d(e,t);if("Buffer"===t.type&&o(t.data))return d(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(u(t),e=a(e,t<0?0:0|f(t)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function d(e,t){var n=t.length<0?0:0|f(t.length);e=a(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function f(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function p(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return I(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return B(e).length;default:if(i)return I(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return E(this,t,n);case"utf8":case"utf-8":return C(this,t,n);case"ascii":return A(this,t,n);case"latin1":case"binary":return $(this,t,n);case"base64":return O(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function m(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function v(e,t,n,i,r){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=l.from(t,i)),l.isBuffer(t))return 0===t.length?-1:b(e,t,n,i,r);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,i,r);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,i,r){var o,s=1,a=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;s=2,a/=2,l/=2,n/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(r){var u=-1;for(o=n;o<a;o++)if(c(e,o)===c(t,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===l)return u*s}else-1!==u&&(o-=o-u),u=-1}else for(n+l>a&&(n=a-l),o=n;o>=0;o--){for(var h=!0,d=0;d<l;d++)if(c(e,o+d)!==c(t,d)){h=!1;break}if(h)return o}return-1}function y(e,t,n,i){n=Number(n)||0;var r=e.length-n;i?(i=Number(i))>r&&(i=r):i=r;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");i>o/2&&(i=o/2);for(var s=0;s<i;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function w(e,t,n,i){return W(I(t,e.length-n),e,n,i)}function x(e,t,n,i){return W(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function _(e,t,n,i){return x(e,t,n,i)}function k(e,t,n,i){return W(B(t),e,n,i)}function S(e,t,n,i){return W(function(e,t){for(var n,i,r,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),i=n>>8,r=n%256,o.push(r),o.push(i);return o}(t,e.length-n),e,n,i)}function O(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function C(e,t,n){n=Math.min(e.length,n);for(var i=[],r=t;r<n;){var o,s,a,l,c=e[r],u=null,h=c>239?4:c>223?3:c>191?2:1;if(r+h<=n)switch(h){case 1:c<128&&(u=c);break;case 2:128==(192&(o=e[r+1]))&&(l=(31&c)<<6|63&o)>127&&(u=l);break;case 3:o=e[r+1],s=e[r+2],128==(192&o)&&128==(192&s)&&(l=(15&c)<<12|(63&o)<<6|63&s)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:o=e[r+1],s=e[r+2],a=e[r+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(l=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&l<1114112&&(u=l)}null===u?(u=65533,h=1):u>65535&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),r+=h}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=4096));return n}(i)}t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,n){return c(null,e,t,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,n){return function(e,t,n,i){return u(t),t<=0?a(e,t):void 0!==n?"string"==typeof i?a(e,t).fill(n,i):a(e,t).fill(n):a(e,t)}(null,e,t,n)},l.allocUnsafe=function(e){return h(null,e)},l.allocUnsafeSlow=function(e){return h(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,r=0,o=Math.min(n,i);r<o;++r)if(e[r]!==t[r]){n=e[r],i=t[r];break}return n<i?-1:i<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=l.allocUnsafe(t),r=0;for(n=0;n<e.length;++n){var s=e[n];if(!l.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(i,r),r+=s.length}return i},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?C(this,0,e):g.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,n,i,r){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),t<0||n>e.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&t>=n)return 0;if(i>=r)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(r>>>=0)-(i>>>=0),s=(n>>>=0)-(t>>>=0),a=Math.min(o,s),c=this.slice(i,r),u=e.slice(t,n),h=0;h<a;++h)if(c[h]!==u[h]){o=c[h],s=u[h];break}return o<s?-1:s<o?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},l.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var o=!1;;)switch(i){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":return x(this,e,t,n);case"latin1":case"binary":return _(this,e,t,n);case"base64":return k(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function A(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(127&e[r]);return i}function $(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(e[r]);return i}function E(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var r="",o=t;o<n;++o)r+=z(e[o]);return r}function M(e,t,n){for(var i=e.slice(t,n),r="",o=0;o<i.length;o+=2)r+=String.fromCharCode(i[o]+256*i[o+1]);return r}function j(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,n,i,r,o){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<o)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function D(e,t,n,i){t<0&&(t=65535+t+1);for(var r=0,o=Math.min(e.length-n,2);r<o;++r)e[n+r]=(t&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function T(e,t,n,i){t<0&&(t=4294967295+t+1);for(var r=0,o=Math.min(e.length-n,4);r<o;++r)e[n+r]=t>>>8*(i?r:3-r)&255}function L(e,t,n,i,r,o){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function F(e,t,n,i,o){return o||L(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function N(e,t,n,i,o){return o||L(e,0,n,8),r.write(e,t,n,i,52,8),n+8}l.prototype.slice=function(e,t){var n,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=l.prototype;else{var r=t-e;n=new l(r,void 0);for(var o=0;o<r;++o)n[o]=this[o+e]}return n},l.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||j(e,t,this.length);for(var i=this[e],r=1,o=0;++o<t&&(r*=256);)i+=this[e+o]*r;return i},l.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||j(e,t,this.length);for(var i=this[e+--t],r=1;t>0&&(r*=256);)i+=this[e+--t]*r;return i},l.prototype.readUInt8=function(e,t){return t||j(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||j(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||j(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||j(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||j(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||j(e,t,this.length);for(var i=this[e],r=1,o=0;++o<t&&(r*=256);)i+=this[e+o]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*t)),i},l.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||j(e,t,this.length);for(var i=t,r=1,o=this[e+--i];i>0&&(r*=256);)o+=this[e+--i]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*t)),o},l.prototype.readInt8=function(e,t){return t||j(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||j(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){t||j(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return t||j(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||j(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||j(e,4,this.length),r.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||j(e,4,this.length),r.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||j(e,8,this.length),r.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||j(e,8,this.length),r.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,i){(e=+e,t|=0,n|=0,i)||R(this,e,t,n,Math.pow(2,8*n)-1,0);var r=1,o=0;for(this[t]=255&e;++o<n&&(r*=256);)this[t+o]=e/r&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,i){(e=+e,t|=0,n|=0,i)||R(this,e,t,n,Math.pow(2,8*n)-1,0);var r=n-1,o=1;for(this[t+r]=255&e;--r>=0&&(o*=256);)this[t+r]=e/o&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):T(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):T(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);R(this,e,t,n,r-1,-r)}var o=0,s=1,a=0;for(this[t]=255&e;++o<n&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},l.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);R(this,e,t,n,r-1,-r)}var o=n-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):T(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):T(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,n){return F(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return F(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return N(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return N(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,i){if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var r,o=i-n;if(this===e&&n<t&&t<i)for(r=o-1;r>=0;--r)e[r+t]=this[r+n];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(r=0;r<o;++r)e[r+t]=this[r+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},l.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var r=e.charCodeAt(0);r<256&&(e=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var s=l.isBuffer(e)?e:I(new l(e,i).toString()),a=s.length;for(o=0;o<n-t;++o)this[o+t]=s[o%a]}return this};var P=/[^+\/0-9A-Za-z-_]/g;function z(e){return e<16?"0"+e.toString(16):e.toString(16)}function I(e,t){var n;t=t||1/0;for(var i=e.length,r=null,o=[],s=0;s<i;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===i){(t-=3)>-1&&o.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&o.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function B(e){return i.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(P,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function W(e,t,n,i){for(var r=0;r<i&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}}).call(this,n(24))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.d(t,"vega",(function(){return y})),n.d(t,"default",(function(){return $}));var i,r=n(4),o=n(71),s=n(30),a=n.n(s),l=n(44),c=n(29),u=n(68),h=n(45),d=n.n(h),f=n(69),p=n(70),g=n(0),m=n(65),v=n(31),b=n(46);n(54);const y=c;let w=u;const x="undefined"!=typeof window?window:void 0;void 0===w&&(null===(i=null==x?void 0:x.vl)||void 0===i?void 0:i.compile)&&(w=x.vl);const _={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},k={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},S={vega:"Vega","vega-lite":"Vega-Lite"},O={vega:y.version,"vega-lite":w?w.version:"not available"},C={vega:e=>e,"vega-lite":(e,t)=>w.compile(e,{config:t}).spec};function A(e,t,n,i){const r=`<html><head>${t}</head><body><pre><code class="json">`,o=`</code></pre>${n}</body></html>`,s=window.open("");s.document.write(r+e+o),s.document.title=S[i]+" JSON Source"}function $(e,t,n={}){var i,s,c;return Object(r.b)(this,void 0,void 0,(function*(){const u=(h=n.loader)&&"load"in h?n.loader:y.loader(n.loader);var h;const w=Object(g.I)(t)?JSON.parse(yield u.load(t)):t,x=yield E(null!==(i=w.usermeta&&w.usermeta.embedOptions)&&void 0!==i?i:{},u),$=yield E(n,u),M=Object.assign(Object.assign({},Object(b.a)($,x)),{config:Object(g.O)(null!==(s=$.config)&&void 0!==s?s:{},null!==(c=x.config)&&void 0!==c?c:{})});return yield function(e,t,n={},i){var s,c,u,h,w,x;return Object(r.b)(this,void 0,void 0,(function*(){const $=n.theme?Object(g.O)(f[n.theme],null!==(s=n.config)&&void 0!==s?s:{}):n.config,E=Object(g.C)(n.actions)?n.actions:Object(b.a)({},_,null!==(c=n.actions)&&void 0!==c?c:{}),M=Object.assign(Object.assign({},k),n.i18n),j=null!==(u=n.renderer)&&void 0!==u?u:"canvas",R=null!==(h=n.logLevel)&&void 0!==h?h:y.Warn,D=null!==(w=n.downloadFileName)&&void 0!==w?w:"visualization",T="string"==typeof e?document.querySelector(e):e;if(!T)throw new Error(e+" does not exist");if(!1!==n.defaultStyle){const e="vega-embed-style",{root:t,rootContainer:i}=function(e){var t;const n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:null!==(t=document.head)&&void 0!==t?t:document.body}}(T);if(!t.getElementById(e)){const t=document.createElement("style");t.id=e,t.innerText=void 0===n.defaultStyle||!0===n.defaultStyle?(null!==v.a&&void 0!==v.a?v.a:"").toString():n.defaultStyle,i.appendChild(t)}}const L=function(e,t){var n;if(e.$schema){const i=d()(e.$schema);t&&t!==i.library&&console.warn(`The given visualization spec is written in ${S[i.library]}, but mode argument sets ${null!==(n=S[t])&&void 0!==n?n:t}.`);const r=i.library;return Object(l.satisfies)(O[r],"^"+i.version.slice(1))||console.warn(`The input spec uses ${S[r]} ${i.version}, but the current version of ${S[r]} is v${O[r]}.`),r}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":null!=t?t:"vega"}(t,n.mode);let F=C[L](t,$);if("vega-lite"===L&&F.$schema){const e=d()(F.$schema);Object(l.satisfies)(O.vega,"^"+e.version.slice(1))||console.warn(`The compiled spec uses Vega ${e.version}, but current version is v${O.vega}.`)}T.classList.add("vega-embed"),E&&T.classList.add("has-actions"),T.innerHTML="";const N=n.patch;N&&(F=N instanceof Function?N(F):Object(o.a)(F,N,!0,!1).newDocument),n.formatLocale&&y.formatLocale(n.formatLocale),n.timeFormatLocale&&y.timeFormatLocale(n.timeFormatLocale);const{ast:P}=n,z=y.parse(F,"vega-lite"===L?{}:$,{ast:P}),I=new y.View(z,Object.assign({loader:i,logLevel:R,renderer:j},P?{expr:y.expressionInterpreter}:{}));if(!1!==n.tooltip){let e;e="function"==typeof n.tooltip?n.tooltip:new p.a(!0===n.tooltip?{}:n.tooltip).call,I.tooltip(e)}let B,{hover:W}=n;if(void 0===W&&(W="vega"===L),W){const{hoverSet:e,updateSet:t}="boolean"==typeof W?{}:W;I.hover(e,t)}if(n&&(null!=n.width&&I.width(n.width),null!=n.height&&I.height(n.height),null!=n.padding&&I.padding(n.padding)),yield I.initialize(e).runAsync(),!1!==E){let e=T;if(!1!==n.defaultStyle){const t=document.createElement("details");t.title=M.CLICK_TO_VIEW_ACTIONS,T.append(t),e=t;const n=document.createElement("summary");n.innerHTML='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>',t.append(n),B=e=>{t.contains(e.target)||t.removeAttribute("open")},document.addEventListener("click",B)}const i=document.createElement("div");if(e.append(i),i.classList.add("vega-actions"),!0===E||!1!==E.export)for(const e of["svg","png"])if(!0===E||!0===E.export||E.export[e]){const t=M[e.toUpperCase()+"_ACTION"],o=document.createElement("a");o.text=t,o.href="#",o.target="_blank",o.download=`${D}.${e}`,o.addEventListener("mousedown",(function(t){return Object(r.b)(this,void 0,void 0,(function*(){t.preventDefault();const i=yield I.toImageURL(e,n.scaleFactor);this.href=i}))})),i.append(o)}if(!0===E||!1!==E.source){const e=document.createElement("a");e.text=M.SOURCE_ACTION,e.href="#",e.addEventListener("click",(function(e){var i,r;A(a()(t),null!==(i=n.sourceHeader)&&void 0!==i?i:"",null!==(r=n.sourceFooter)&&void 0!==r?r:"",L),e.preventDefault()})),i.append(e)}if("vega-lite"===L&&(!0===E||!1!==E.compiled)){const e=document.createElement("a");e.text=M.COMPILED_ACTION,e.href="#",e.addEventListener("click",(function(e){var t,i;A(a()(F),null!==(t=n.sourceHeader)&&void 0!==t?t:"",null!==(i=n.sourceFooter)&&void 0!==i?i:"","vega"),e.preventDefault()})),i.append(e)}if(!0===E||!1!==E.editor){const e=null!==(x=n.editorUrl)&&void 0!==x?x:"https://vega.github.io/editor/",r=document.createElement("a");r.text=M.EDITOR_ACTION,r.href="#",r.addEventListener("click",(function(n){Object(m.a)(window,e,{config:$,mode:L,renderer:j,spec:a()(t)}),n.preventDefault()})),i.append(r)}}return{view:I,spec:t,vgSpec:F,finalize:function(){B&&document.removeEventListener("click",B),I.finalize()}}}))}(e,w,M,u)}))}function E(e,t){var n;return Object(r.b)(this,void 0,void 0,(function*(){const i=Object(g.I)(e.config)?JSON.parse(yield t.load(e.config)):null!==(n=e.config)&&void 0!==n?n:{},r=Object(g.I)(e.patch)?JSON.parse(yield t.load(e.patch)):e.patch;return Object.assign(Object.assign(Object.assign({},e),r?{patch:r}:{}),i?{config:i}:{})}))}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));var i=n(0);function r(t,n){const r=n&&n.property?Object(i.u)(n.property):i.y;return!Object(i.G)(t)||(o=t,"function"==typeof e&&Object(i.E)(e.isBuffer)&&e.isBuffer(o))?r(JSON.parse(t)):function(e,t){return t&&t.copy?JSON.parse(JSON.stringify(e)):e}(r(t));var o}r.responseType="json"}).call(this,n(23).Buffer)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));var i=n(0);function r(t,n){const r=n&&n.property?Object(i.u)(n.property):i.y;return!Object(i.G)(t)||(o=t,"function"==typeof e&&Object(i.E)(e.isBuffer)&&e.isBuffer(o))?r(JSON.parse(t)):function(e,t){return t&&t.copy?JSON.parse(JSON.stringify(e)):e}(r(t));var o}r.responseType="json"}).call(this,n(23).Buffer)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));var i=n(0);function r(t,n){const r=n&&n.property?Object(i.u)(n.property):i.y;return!Object(i.G)(t)||(o=t,"function"==typeof e&&Object(i.E)(e.isBuffer)&&e.isBuffer(o))?r(JSON.parse(t)):function(e,t){return t&&t.copy?JSON.parse(JSON.stringify(e)):e}(r(t));var o}r.responseType="json"}).call(this,n(23).Buffer)},function(e,t,n){"use strict";n.r(t);var i={};n.r(i),n.d(i,"aggregate",(function(){return is})),n.d(i,"bin",(function(){return rs})),n.d(i,"collect",(function(){return ss})),n.d(i,"compare",(function(){return as})),n.d(i,"countpattern",(function(){return cs})),n.d(i,"cross",(function(){return us})),n.d(i,"density",(function(){return ds})),n.d(i,"dotbin",(function(){return vs})),n.d(i,"expression",(function(){return bs})),n.d(i,"extent",(function(){return ws})),n.d(i,"facet",(function(){return _s})),n.d(i,"field",(function(){return ks})),n.d(i,"filter",(function(){return Os})),n.d(i,"flatten",(function(){return Cs})),n.d(i,"fold",(function(){return As})),n.d(i,"formula",(function(){return $s})),n.d(i,"generate",(function(){return Es})),n.d(i,"impute",(function(){return Rs})),n.d(i,"joinaggregate",(function(){return Ds})),n.d(i,"kde",(function(){return Ts})),n.d(i,"key",(function(){return Ls})),n.d(i,"load",(function(){return Ns})),n.d(i,"lookup",(function(){return zs})),n.d(i,"multiextent",(function(){return Is})),n.d(i,"multivalues",(function(){return Ws})),n.d(i,"params",(function(){return Hs})),n.d(i,"pivot",(function(){return qs})),n.d(i,"prefacet",(function(){return Vs})),n.d(i,"project",(function(){return Gs})),n.d(i,"proxy",(function(){return Ks})),n.d(i,"quantile",(function(){return Xs})),n.d(i,"relay",(function(){return Js})),n.d(i,"sample",(function(){return Qs})),n.d(i,"sequence",(function(){return Zs})),n.d(i,"sieve",(function(){return ea})),n.d(i,"subflow",(function(){return xs})),n.d(i,"timeunit",(function(){return ta})),n.d(i,"tupleindex",(function(){return ia})),n.d(i,"values",(function(){return ra})),n.d(i,"window",(function(){return ca}));var r={};n.r(r),n.d(r,"interpolate",(function(){return op})),n.d(r,"interpolateArray",(function(){return Jf})),n.d(r,"interpolateBasis",(function(){return Pf})),n.d(r,"interpolateBasisClosed",(function(){return zf})),n.d(r,"interpolateDate",(function(){return Zf})),n.d(r,"interpolateDiscrete",(function(){return rg})),n.d(r,"interpolateHue",(function(){return og})),n.d(r,"interpolateNumber",(function(){return ep})),n.d(r,"interpolateNumberArray",(function(){return Yf})),n.d(r,"interpolateObject",(function(){return tp})),n.d(r,"interpolateRound",(function(){return sp})),n.d(r,"interpolateString",(function(){return rp})),n.d(r,"interpolateTransformCss",(function(){return ug})),n.d(r,"interpolateTransformSvg",(function(){return hg})),n.d(r,"interpolateZoom",(function(){return pg})),n.d(r,"interpolateRgb",(function(){return qf})),n.d(r,"interpolateRgbBasis",(function(){return Gf})),n.d(r,"interpolateRgbBasisClosed",(function(){return Kf})),n.d(r,"interpolateHsl",(function(){return mg})),n.d(r,"interpolateHslLong",(function(){return vg})),n.d(r,"interpolateLab",(function(){return jg})),n.d(r,"interpolateHcl",(function(){return Dg})),n.d(r,"interpolateHclLong",(function(){return Tg})),n.d(r,"interpolateCubehelix",(function(){return Ug})),n.d(r,"interpolateCubehelixLong",(function(){return Hg})),n.d(r,"piecewise",(function(){return Ip})),n.d(r,"quantize",(function(){return qg}));var o={};n.r(o),n.d(o,"bound",(function(){return lv})),n.d(o,"identifier",(function(){return uv})),n.d(o,"mark",(function(){return hv})),n.d(o,"overlap",(function(){return dv})),n.d(o,"render",(function(){return yv})),n.d(o,"viewlayout",(function(){return Iv}));var s={};n.r(s),n.d(s,"axisticks",(function(){return Bv})),n.d(s,"datajoin",(function(){return Wv})),n.d(s,"encode",(function(){return Hv})),n.d(s,"legendentries",(function(){return qv})),n.d(s,"linkpath",(function(){return Xv})),n.d(s,"pie",(function(){return nb})),n.d(s,"scale",(function(){return ob})),n.d(s,"sortitems",(function(){return cb})),n.d(s,"stack",(function(){return hb}));var a={};n.r(a),n.d(a,"contour",(function(){return Rb})),n.d(a,"geojson",(function(){return Db})),n.d(a,"geopath",(function(){return Kx})),n.d(a,"geopoint",(function(){return Yx})),n.d(a,"geoshape",(function(){return Xx})),n.d(a,"graticule",(function(){return e_})),n.d(a,"heatmap",(function(){return t_})),n.d(a,"isocontour",(function(){return _b})),n.d(a,"kde2d",(function(){return Eb})),n.d(a,"projection",(function(){return i_}));var l={};n.r(l),n.d(l,"force",(function(){return X_}));var c={};n.r(c),n.d(c,"nest",(function(){return lk})),n.d(c,"pack",(function(){return Fk})),n.d(c,"partition",(function(){return Ik})),n.d(c,"stratify",(function(){return Vk})),n.d(c,"tree",(function(){return rS})),n.d(c,"treelinks",(function(){return oS})),n.d(c,"treemap",(function(){return fS}));var u={};n.r(u),n.d(u,"loess",(function(){return gS})),n.d(u,"regression",(function(){return vS}));var h={};n.r(h),n.d(h,"voronoi",(function(){return zS}));var d={};n.r(d),n.d(d,"wordcloud",(function(){return QS}));var f={};n.r(f),n.d(f,"crossfilter",(function(){return oO})),n.d(f,"resolvefilter",(function(){return sO}));var p=n(0);function g(e){const t=e||p.y,n=[],i={};return n.add=e=>{const r=t(e);return i[r]||(i[r]=1,n.push(e)),n},n.remove=e=>{const r=t(e);if(i[r]){i[r]=0;const t=n.indexOf(e);t>=0&&n.splice(t,1)}return n},n}var m=async function(e,t){try{await t(e)}catch(t){e.error(t)}};const v=Symbol("vega_id");let b=1;function y(e){return!(!e||!w(e))}function w(e){return e[v]}function x(e,t){return e[v]=t,e}function _(e){const t=e===Object(e)?e:{data:e};return w(t)?t:x(t,b++)}function k(e){return S(e,_({}))}function S(e,t){for(const n in e)t[n]=e[n];return t}function O(e,t){return x(t,w(e))}function C(e,t){return e?t?(n,i)=>e(n,i)||w(t(n))-w(t(i)):(t,n)=>e(t,n)||w(t)-w(n):null}function A(e){return e&&e.constructor===$}function $(){let e=[],t=[],n=[],i=[],r=[],o=null,s=!1;return{constructor:$,insert(t){let n=Object(p.i)(t),i=0,r=n.length;for(;i<r;++i)e.push(n[i]);return this},remove(e){let n=Object(p.E)(e)?i:t,r=Object(p.i)(e),o=0,s=r.length;for(;o<s;++o)n.push(r[o]);return this},modify(e,t,i){let o={field:t,value:Object(p.m)(i)};return Object(p.E)(e)?(o.filter=e,r.push(o)):(o.tuple=e,n.push(o)),this},encode(e,t){return Object(p.E)(e)?r.push({filter:e,field:t}):n.push({tuple:e,field:t}),this},clean(e){return o=e,this},reflow(){return s=!0,this},pulse(a,l){let c,u,h,d,f,p,g={},m={};for(c=0,u=l.length;c<u;++c)g[w(l[c])]=1;for(c=0,u=t.length;c<u;++c)f=t[c],g[w(f)]=-1;for(c=0,u=i.length;c<u;++c)d=i[c],l.forEach(e=>{d(e)&&(g[w(e)]=-1)});for(c=0,u=e.length;c<u;++c)f=e[c],p=w(f),g[p]?g[p]=1:a.add.push(_(e[c]));for(c=0,u=l.length;c<u;++c)f=l[c],g[w(f)]<0&&a.rem.push(f);function v(e,t,n){n?e[t]=n(e):a.encode=t,s||(m[w(e)]=e)}for(c=0,u=n.length;c<u;++c)h=n[c],f=h.tuple,d=h.field,p=g[w(f)],p>0&&(v(f,d,h.value),a.modifies(d));for(c=0,u=r.length;c<u;++c)h=r[c],d=h.filter,l.forEach(e=>{d(e)&&g[w(e)]>0&&v(e,h.field,h.value)}),a.modifies(h.field);if(s)a.mod=t.length||i.length?l.filter(e=>g[w(e)]>0):l.slice();else for(p in m)a.mod.push(m[p]);return(o||null==o&&(t.length||i.length))&&a.clean(!0),a}}}function E(){Object.defineProperty(this,"_:mod:_",{writable:!0,value:{}})}E.prototype={set(e,t,n,i){const r=this,o=r[e],s=r["_:mod:_"];return null!=t&&t>=0?(o[t]!==n||i)&&(o[t]=n,s[t+":"+e]=-1,s[e]=-1):(o!==n||i)&&(r[e]=n,s[e]=Object(p.B)(n)?1+n.length:-1),r},modified(e,t){let n,i=this["_:mod:_"];if(!arguments.length){for(n in i)if(i[n])return!0;return!1}if(Object(p.B)(e)){for(n=0;n<e.length;++n)if(i[e[n]])return!0;return!1}return null!=t&&t>=0?t+1<i[e]||!!i[t+":"+e]:!!i[e]},clear(){return this["_:mod:_"]={},this}};let M=0;const j=new E;function R(e,t,n,i){this.id=++M,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,i)}function D(e){return function(t){const n=this.flags;return 0===arguments.length?!!(n&e):(this.flags=t?n|e:n&~e,this)}}R.prototype={targets(){return this._targets||(this._targets=g(p.x))},set(e){return this.value!==e?(this.value=e,1):0},skip:D(1),modified:D(2),parameters(e,t,n){t=!1!==t;let i,r,o,s,a=this._argval=this._argval||new E,l=this._argops=this._argops||[],c=[];const u=(e,n,i)=>{i instanceof R?(i!==this&&(t&&i.targets().add(this),c.push(i)),l.push({op:i,name:e,index:n})):a.set(e,n,i)};for(i in e)if(r=e[i],"pulse"===i)Object(p.i)(r).forEach(e=>{e instanceof R?e!==this&&(e.targets().add(this),c.push(e)):Object(p.o)("Pulse parameters must be operator instances.")}),this.source=r;else if(Object(p.B)(r))for(a.set(i,-1,Array(o=r.length)),s=0;s<o;++s)u(i,s,r[s]);else u(i,-1,r);return this.marshall().clear(),n&&(l.initonly=!0),c},marshall(e){let t,n,i,r,o,s=this._argval||j,a=this._argops;if(a){for(n=0,i=a.length;n<i;++n)t=a[n],r=t.op,o=r.modified()&&r.stamp===e,s.set(t.name,t.index,r.value,o);if(a.initonly){for(n=0;n<i;++n)t=a[n],t.op.targets().remove(this);this._argops=null,this._update=null}}return s},detach(){let e,t,n,i,r=this._argops;if(r)for(e=0,t=r.length;e<t;++e)n=r[e],i=n.op,i._targets&&i._targets.remove(this)},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),i=t.call(this,n,e);if(n.clear(),i!==this.value)this.value=i;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};let T=0;function L(e,t,n){this.id=++T,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function F(e,t,n){return new L(e,t,n)}L.prototype={_filter:p.hb,_apply:p.y,targets(){return this._targets||(this._targets=g(p.x))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){let t=this.value=this._apply(e),n=this._targets,i=n?n.length:0,r=0;for(;r<i;++r)n[r].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=F(e);return this.targets().add(t),t},apply(e){const t=F(null,e);return this.targets().add(t),t},merge(){const e=F();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=F();return this.targets().add(F(null,null,Object(p.n)(e,e=>{const n=e.dataflow;t.receive(e),n&&n.run&&n.run()}))),t},between(e,t){let n=!1;return e.targets().add(F(null,null,()=>n=!0)),t.targets().add(F(null,null,()=>n=!1)),this.filter(()=>n)},detach(){}};const N=/^([A-Za-z]+:)?\/\//,P=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,z=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g;async function I(e,t){const n=await this.sanitize(e,t),i=n.href;return n.localFile?this.file(i):this.http(i,t)}async function B(e,t){t=Object(p.p)({},this.options,t);const n=this.fileAccess,i={href:null};let r,o,s;const a=P.test(e.replace(z,""));null!=e&&"string"==typeof e&&a||Object(p.o)("Sanitize failure, invalid URI: "+Object(p.ab)(e));const l=N.test(e);return(s=t.baseURL)&&!l&&(e.startsWith("/")||"/"===s[s.length-1]||(e="/"+e),e=s+e),o=(r=e.startsWith("file://"))||"file"===t.mode||"http"!==t.mode&&!l&&n,r?e=e.slice("file://".length):e.startsWith("//")&&("file"===t.defaultProtocol?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(i,"localFile",{value:!!o}),i.href=e,t.target&&(i.target=t.target+""),t.rel&&(i.rel=t.rel+""),"image"===t.context&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin+""),i}function W(e){return e?t=>new Promise((n,i)=>{e.readFile(t,(e,t)=>{e?i(e):n(t)})}):U}async function U(){Object(p.o)("No file system access.")}function H(e){return e?async function(t,n){const i=Object(p.p)({},this.options.http,n),r=n&&n.response,o=await e(t,i);return o.ok?Object(p.E)(o[r])?o[r]():o.text():Object(p.o)(o.status+""+o.statusText)}:q}async function q(){Object(p.o)("No HTTP fetch method available.")}const V=e=>!(Number.isNaN(+e)||e instanceof Date),G={boolean:p.bb,integer:p.db,number:p.db,date:p.cb,string:p.fb,unknown:p.y},K=[e=>"true"===e||"false"===e||!0===e||!1===e,e=>V(e)&&Number.isInteger(+e),V,e=>!Number.isNaN(Date.parse(e))],Y=["boolean","integer","number","date"];function X(e,t){return t.reduce((function(t,n){return t[n]=function(e,t){if(!e||!e.length)return"unknown";const n=e.length,i=K.length,r=K.map((e,t)=>t+1);for(let s,a,l=0,c=0;l<n;++l)for(a=t?e[l][t]:e[l],s=0;s<i;++s)if(r[s]&&(null!=(o=a)&&o==o)&&!K[s](a)&&(r[s]=0,++c,c===K.length))return"string";var o;return Y[r.reduce((e,t)=>0===e?t:e,0)-1]}(e,n),t}),{})}var J={},Q={};function Z(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function ee(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var i in e)i in t||n.push(t[i]=i)})),n}function te(e,t){var n=e+"",i=n.length;return i<t?new Array(t-i+1).join(0)+n:n}function ne(e){var t,n=e.getUTCHours(),i=e.getUTCMinutes(),r=e.getUTCSeconds(),o=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":((t=e.getUTCFullYear())<0?"-"+te(-t,6):t>9999?"+"+te(t,6):te(t,4))+"-"+te(e.getUTCMonth()+1,2)+"-"+te(e.getUTCDate(),2)+(o?"T"+te(n,2)+":"+te(i,2)+":"+te(r,2)+"."+te(o,3)+"Z":r?"T"+te(n,2)+":"+te(i,2)+":"+te(r,2)+"Z":i||n?"T"+te(n,2)+":"+te(i,2)+"Z":"")}var ie=function(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function i(e,t){var i,r=[],o=e.length,s=0,a=0,l=o<=0,c=!1;function u(){if(l)return Q;if(c)return c=!1,J;var t,i,r=s;if(34===e.charCodeAt(r)){for(;s++<o&&34!==e.charCodeAt(s)||34===e.charCodeAt(++s););return(t=s)>=o?l=!0:10===(i=e.charCodeAt(s++))?c=!0:13===i&&(c=!0,10===e.charCodeAt(s)&&++s),e.slice(r+1,t-1).replace(/""/g,'"')}for(;s<o;){if(10===(i=e.charCodeAt(t=s++)))c=!0;else if(13===i)c=!0,10===e.charCodeAt(s)&&++s;else if(i!==n)continue;return e.slice(r,t)}return l=!0,e.slice(r,o)}for(10===e.charCodeAt(o-1)&&--o,13===e.charCodeAt(o-1)&&--o;(i=u())!==Q;){for(var h=[];i!==J&&i!==Q;)h.push(i),i=u();t&&null==(h=t(h,a++))||r.push(h)}return r}function r(t,n){return t.map((function(t){return n.map((function(e){return s(t[e])})).join(e)}))}function o(t){return t.map(s).join(e)}function s(e){return null==e?"":e instanceof Date?ne(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,r,o=i(e,(function(e,i){if(n)return n(e,i-1);r=e,n=t?function(e,t){var n=Z(e);return function(i,r){return t(n(i),r,e)}}(e,t):Z(e)}));return o.columns=r||[],o},parseRows:i,format:function(t,n){return null==n&&(n=ee(t)),[n.map(s).join(e)].concat(r(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=ee(e)),r(e,t).join("\n")},formatRows:function(e){return e.map(o).join("\n")},formatRow:o,formatValue:s}};function re(e){const t=function(t,n){const i={delimiter:e};return oe(t,n?Object(p.p)(n,i):i)};return t.responseType="text",t}function oe(e,t){return t.header&&(e=t.header.map(p.ab).join(t.delimiter)+"\n"+e),ie(t.delimiter).parse(e+"")}oe.responseType="text";var se=n(26),ae=function(e){return e},le=function(e){if(null==e)return ae;var t,n,i=e.scale[0],r=e.scale[1],o=e.translate[0],s=e.translate[1];return function(e,a){a||(t=n=0);var l=2,c=e.length,u=new Array(c);for(u[0]=(t+=e[0])*i+o,u[1]=(n+=e[1])*r+s;l<c;)u[l]=e[l],++l;return u}},ce=function(e,t){return"string"==typeof t&&(t=e.objects[t]),"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map((function(t){return ue(e,t)}))}:ue(e,t)};function ue(e,t){var n=t.id,i=t.bbox,r=null==t.properties?{}:t.properties,o=he(e,t);return null==n&&null==i?{type:"Feature",properties:r,geometry:o}:null==i?{type:"Feature",id:n,properties:r,geometry:o}:{type:"Feature",id:n,bbox:i,properties:r,geometry:o}}function he(e,t){var n=le(e.transform),i=e.arcs;function r(e,t){t.length&&t.pop();for(var r=i[e<0?~e:e],o=0,s=r.length;o<s;++o)t.push(n(r[o],o));e<0&&function(e,t){for(var n,i=e.length,r=i-t;r<--i;)n=e[r],e[r++]=e[i],e[i]=n}(t,s)}function o(e){return n(e)}function s(e){for(var t=[],n=0,i=e.length;n<i;++n)r(e[n],t);return t.length<2&&t.push(t[0]),t}function a(e){for(var t=s(e);t.length<4;)t.push(t[0]);return t}function l(e){return e.map(a)}return function e(t){var n,i=t.type;switch(i){case"GeometryCollection":return{type:i,geometries:t.geometries.map(e)};case"Point":n=o(t.coordinates);break;case"MultiPoint":n=t.coordinates.map(o);break;case"LineString":n=s(t.arcs);break;case"MultiLineString":n=t.arcs.map(s);break;case"Polygon":n=l(t.arcs);break;case"MultiPolygon":n=t.arcs.map(l);break;default:return null}return{type:i,coordinates:n}}(t)}var de=function(e,t){var n={},i={},r={},o=[],s=-1;function a(e,t){for(var i in e){var r=e[i];delete t[r.start],delete r.start,delete r.end,r.forEach((function(e){n[e<0?~e:e]=1})),o.push(r)}}return t.forEach((function(n,i){var r,o=e.arcs[n<0?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(r=t[++s],t[s]=n,t[i]=r)})),t.forEach((function(t){var n,o,s=function(t){var n,i=e.arcs[t<0?~t:t],r=i[0];e.transform?(n=[0,0],i.forEach((function(e){n[0]+=e[0],n[1]+=e[1]}))):n=i[i.length-1];return t<0?[n,r]:[r,n]}(t),a=s[0],l=s[1];if(n=r[a])if(delete r[n.end],n.push(t),n.end=l,o=i[l]){delete i[o.start];var c=o===n?n:n.concat(o);i[c.start=n.start]=r[c.end=o.end]=c}else i[n.start]=r[n.end]=n;else if(n=i[l])if(delete i[n.start],n.unshift(t),n.start=a,o=r[a]){delete r[o.end];var u=o===n?n:o.concat(n);i[u.start=o.start]=r[u.end=n.end]=u}else i[n.start]=r[n.end]=n;else i[(n=[t]).start=a]=r[n.end=l]=n})),a(r,i),a(i,r),t.forEach((function(e){n[e<0?~e:e]||o.push([e])})),o},fe=function(e){return he(e,pe.apply(this,arguments))};function pe(e,t,n){var i,r,o;if(arguments.length>1)i=ge(e,t,n);else for(r=0,i=new Array(o=e.arcs.length);r<o;++r)i[r]=r;return{type:"MultiLineString",arcs:de(e,i)}}function ge(e,t,n){var i,r=[],o=[];function s(e){var t=e<0?~e:e;(o[t]||(o[t]=[])).push({i:e,g:i})}function a(e){e.forEach(s)}function l(e){e.forEach(a)}return function e(t){switch(i=t,t.type){case"GeometryCollection":t.geometries.forEach(e);break;case"LineString":a(t.arcs);break;case"MultiLineString":case"Polygon":l(t.arcs);break;case"MultiPolygon":!function(e){e.forEach(l)}(t.arcs)}}(t),o.forEach(null==n?function(e){r.push(e[0].i)}:function(e){n(e[0].g,e[e.length-1].g)&&r.push(e[0].i)}),r}const me={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function ve(e,t){let n,i,r,o;return e=Object(se.a)(e,t),t&&t.feature?(n=ce,r=t.feature):t&&t.mesh?(n=fe,r=t.mesh,o=me[t.filter]):Object(p.o)("Missing TopoJSON feature or mesh parameter."),i=(i=e.objects[r])?n(e,i,o):Object(p.o)("Invalid TopoJSON object: "+r),i&&i.features||[i]}ve.responseType="json";const be={dsv:oe,csv:re(","),tsv:re("\t"),json:se.a,topojson:ve};function ye(e,t){return arguments.length>1?(be[e]=t,this):Object(p.w)(be,e)?be[e]:null}function we(e){const t=ye(e);return t&&t.responseType||"text"}var xe=function(e){const t={};return n=>t[n]||(t[n]=e(n))},_e=Math.sqrt(50),ke=Math.sqrt(10),Se=Math.sqrt(2),Oe=function(e,t,n){var i,r,o,s,a=-1;if(n=+n,(e=+e)===(t=+t)&&n>0)return[e];if((i=t<e)&&(r=e,e=t,t=r),0===(s=Ce(e,t,n))||!isFinite(s))return[];if(s>0)for(e=Math.ceil(e/s),t=Math.floor(t/s),o=new Array(r=Math.ceil(t-e+1));++a<r;)o[a]=(e+a)*s;else for(s=-s,e=Math.ceil(e*s),t=Math.floor(t*s),o=new Array(r=Math.ceil(t-e+1));++a<r;)o[a]=(e+a)/s;return i&&o.reverse(),o};function Ce(e,t,n){var i=(t-e)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),o=i/Math.pow(10,r);return r>=0?(o>=_e?10:o>=ke?5:o>=Se?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(o>=_e?10:o>=ke?5:o>=Se?2:1)}function Ae(e,t,n){var i=Math.abs(t-e)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),o=i/r;return o>=_e?r*=10:o>=ke?r*=5:o>=Se&&(r*=2),t<e?-r:r}var $e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ee(e){if(!(t=$e.exec(e)))throw new Error("invalid format: "+e);var t;return new Me({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Me(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}Ee.prototype=Me.prototype,Me.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var je,Re,De,Te,Le=function(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]},Fe=function(e){return(e=Le(Math.abs(e)))?e[1]:NaN},Ne=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Fe(t)/3)))-Fe(Math.abs(e)))},Pe=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Fe(t)-Fe(e))+1},ze=function(e){return Math.max(0,-Fe(Math.abs(e)))},Ie=function(e,t){var n=Le(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")},Be={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return Ie(100*e,t)},r:Ie,s:function(e,t){var n=Le(e,t);if(!n)return e+"";var i=n[0],r=n[1],o=r-(je=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,s=i.length;return o===s?i:o>s?i+new Array(o-s+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+Le(e,Math.max(0,t+o-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}},We=function(e){return e},Ue=Array.prototype.map,He=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"],qe=function(e){var t,n,i=void 0===e.grouping||void 0===e.thousands?We:(t=Ue.call(e.grouping,Number),n=e.thousands+"",function(e,i){for(var r=e.length,o=[],s=0,a=t[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),o.push(e.substring(r-=a,r+a)),!((l+=a+1)>i));)a=t[s=(s+1)%t.length];return o.reverse().join(n)}),r=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",s=void 0===e.decimal?".":e.decimal+"",a=void 0===e.numerals?We:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(Ue.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"-":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=Ee(e)).fill,n=e.align,h=e.sign,d=e.symbol,f=e.zero,p=e.width,g=e.comma,m=e.precision,v=e.trim,b=e.type;"n"===b?(g=!0,b="g"):Be[b]||(void 0===m&&(m=12),v=!0,b="g"),(f||"0"===t&&"="===n)&&(f=!0,t="0",n="=");var y="$"===d?r:"#"===d&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",w="$"===d?o:/[%p]/.test(b)?l:"",x=Be[b],_=/[defgprs%]/.test(b);function k(e){var r,o,l,d=y,k=w;if("c"===b)k=x(e)+k,e="";else{var S=(e=+e)<0||1/e<0;if(e=isNaN(e)?u:x(Math.abs(e),m),v&&(e=function(e){e:for(var t,n=e.length,i=1,r=-1;i<n;++i)switch(e[i]){case".":r=t=i;break;case"0":0===r&&(r=i),t=i;break;default:if(!+e[i])break e;r>0&&(r=0)}return r>0?e.slice(0,r)+e.slice(t+1):e}(e)),S&&0==+e&&"+"!==h&&(S=!1),d=(S?"("===h?h:c:"-"===h||"("===h?"":h)+d,k=("s"===b?He[8+je/3]:"")+k+(S&&"("===h?")":""),_)for(r=-1,o=e.length;++r<o;)if(48>(l=e.charCodeAt(r))||l>57){k=(46===l?s+e.slice(r+1):e.slice(r))+k,e=e.slice(0,r);break}}g&&!f&&(e=i(e,1/0));var O=d.length+e.length+k.length,C=O<p?new Array(p-O+1).join(t):"";switch(g&&f&&(e=i(C+e,C.length?p-k.length:1/0),C=""),n){case"<":e=d+e+k+C;break;case"=":e=d+C+e+k;break;case"^":e=C.slice(0,O=C.length>>1)+d+e+k+C.slice(O);break;default:e=C+d+e+k}return a(e)}return m=void 0===m?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),k.toString=function(){return e+""},k}return{format:h,formatPrefix:function(e,t){var n=h(((e=Ee(e)).type="f",e)),i=3*Math.max(-8,Math.min(8,Math.floor(Fe(t)/3))),r=Math.pow(10,-i),o=He[8+i/3];return function(e){return n(r*e)+o}}}};function Ve(e){const t=xe(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(e){const n=Ee(e||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return i=t(n),r=t(".1f")(1)[1],e=>{let t,n,o=i(e),s=o.indexOf(r);if(s<0)return o;for(t=function(e,t){let n,i=e.lastIndexOf("e");if(i>0)return i;for(i=e.length;--i>t;)if(n=e.charCodeAt(i),n>=48&&n<=57)return i+1}(o,s),n=t<o.length?o.slice(t):"";--t>s;)if("0"!==o[t]){++t;break}return o.slice(0,t)+n}}return t(n);var i,r},formatSpan(e,i,r,o){o=Ee(null==o?",f":o);const s=Ae(e,i,r),a=Math.max(Math.abs(e),Math.abs(i));let l;if(null==o.precision)switch(o.type){case"s":return isNaN(l=Ne(s,a))||(o.precision=l),n(o,a);case"":case"e":case"g":case"p":case"r":isNaN(l=Pe(s,a))||(o.precision=l-("e"===o.type));break;case"f":case"%":isNaN(l=ze(s))||(o.precision=l-2*("%"===o.type))}return t(o)}}}let Ge;function Ke(){return Ge=Ve({format:De,formatPrefix:Te})}function Ye(e){return Ve(qe(e))}function Xe(e){return arguments.length?Ge=Ye(e):Ge}Re=qe({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),De=Re.format,Te=Re.formatPrefix,Ke();const Je="year",Qe="quarter",Ze="month",et="week",tt="date",nt="day",it="hours",rt="minutes",ot="seconds",st=[Je,Qe,Ze,et,tt,nt,"dayofyear",it,rt,ot,"milliseconds"],at=st.reduce((e,t,n)=>(e[t]=1+n,e),{});function lt(e){const t=Object(p.i)(e).slice(),n={};t.length||Object(p.o)("Missing time unit."),t.forEach(e=>{Object(p.w)(at,e)?n[e]=1:Object(p.o)(`Invalid time unit: ${e}.`)});return(n[et]||n.day?1:0)+(n[Qe]||n[Ze]||n[tt]?1:0)+(n.dayofyear?1:0)>1&&Object(p.o)("Incompatible time units: "+e),t.sort((e,t)=>at[e]-at[t]),t}const ct={[Je]:"%Y ",[Qe]:"Q%q ",[Ze]:"%b ",[tt]:"%d ",[et]:"W%U ",[nt]:"%a ",dayofyear:"%j ",[it]:"%H:00",[rt]:"00:%M",[ot]:":%S",milliseconds:".%L","year-month":"%Y-%m ","year-month-date":"%Y-%m-%d ",["hours-"+rt]:"%H:%M"};function ut(e,t){const n=Object(p.p)({},ct,t),i=lt(e),r=i.length;let o,s,a="",l=0;for(l=0;l<r;)for(o=i.length;o>l;--o)if(s=i.slice(l,o).join("-"),null!=n[s]){a+=n[s],l=o;break}return a.trim()}var ht=new Date,dt=new Date;function ft(e,t,n,i){function r(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return r.floor=function(t){return e(t=new Date(+t)),t},r.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},r.round=function(e){var t=r(e),n=r.ceil(e);return e-t<n-e?t:n},r.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},r.range=function(n,i,o){var s,a=[];if(n=r.ceil(n),o=null==o?1:Math.floor(o),!(n<i&&o>0))return a;do{a.push(s=new Date(+n)),t(n,o),e(n)}while(s<n&&n<i);return a},r.filter=function(n){return ft((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,i){if(e>=e)if(i<0)for(;++i<=0;)for(;t(e,-1),!n(e););else for(;--i>=0;)for(;t(e,1),!n(e););}))},n&&(r.count=function(t,i){return ht.setTime(+t),dt.setTime(+i),e(ht),e(dt),Math.floor(n(ht,dt))},r.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?r.filter(i?function(t){return i(t)%e==0}:function(t){return r.count(0,t)%e==0}):r:null}),r}var pt=ft((function(e){e.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5}),(function(e){return e.getDate()-1})),gt=pt;pt.range;function mt(e){return ft((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/6048e5}))}var vt=mt(0),bt=mt(1),yt=mt(2),wt=mt(3),xt=mt(4),_t=mt(5),kt=mt(6),St=(vt.range,bt.range,yt.range,wt.range,xt.range,_t.range,kt.range,ft((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/864e5}),(function(e){return e.getUTCDate()-1}))),Ot=St;St.range;function Ct(e){return ft((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/6048e5}))}var At=Ct(0),$t=Ct(1),Et=Ct(2),Mt=Ct(3),jt=Ct(4),Rt=Ct(5),Dt=Ct(6);At.range,$t.range,Et.range,Mt.range,jt.range,Rt.range,Dt.range;const Tt=new Date;function Lt(e){return Tt.setFullYear(e),Tt.setMonth(0),Tt.setDate(1),Tt.setHours(0,0,0,0),Tt}function Ft(e){return Pt(new Date(e))}function Nt(e){return zt(new Date(e))}function Pt(e){return gt.count(Lt(e.getFullYear())-1,e)}function zt(e){return vt.count(Lt(e.getFullYear())-1,e)}function It(e){return Lt(e).getDay()}function Bt(e,t,n,i,r,o,s){if(0<=e&&e<100){const a=new Date(-1,t,n,i,r,o,s);return a.setFullYear(e),a}return new Date(e,t,n,i,r,o,s)}function Wt(e){return Ht(new Date(e))}function Ut(e){return qt(new Date(e))}function Ht(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Ot.count(t-1,e)}function qt(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return At.count(t-1,e)}function Vt(e){return Tt.setTime(Date.UTC(e,0,1)),Tt.getUTCDay()}function Gt(e,t,n,i,r,o,s){if(0<=e&&e<100){const e=new Date(Date.UTC(-1,t,n,i,r,o,s));return e.setUTCFullYear(n.y),e}return new Date(Date.UTC(e,t,n,i,r,o,s))}function Kt(e,t,n,i,r){const o=t||1,s=Object(p.V)(e),a=(e,t,r)=>function(e,t,n,i){const r=n<=1?e:i?(t,r)=>i+n*Math.floor((e(t,r)-i)/n):(t,i)=>n*Math.floor(e(t,i)/n);return t?(e,n)=>t(r(e,n),n):r}(n[r=r||e],i[r],e===s&&o,t),l=new Date,c=Object(p.eb)(e),u=c[Je]?a(Je):Object(p.m)(2012),h=c[Ze]?a(Ze):c[Qe]?a(Qe):p.lb,d=c[et]&&c.day?a(nt,1,et+nt):c[et]?a(et,1):c.day?a(nt,1):c[tt]?a(tt,1):c.dayofyear?a("dayofyear",1):p.P,f=c[it]?a(it):p.lb,g=c[rt]?a(rt):p.lb,m=c[ot]?a(ot):p.lb,v=c.milliseconds?a("milliseconds"):p.lb;return function(e){l.setTime(+e);const t=u(l);return r(t,h(l),d(l,t),f(l),g(l),m(l),v(l))}}function Yt(e,t,n){return t+7*e-(n+6)%7}const Xt={[Je]:e=>e.getFullYear(),[Qe]:e=>Math.floor(e.getMonth()/3),[Ze]:e=>e.getMonth(),[tt]:e=>e.getDate(),[it]:e=>e.getHours(),[rt]:e=>e.getMinutes(),[ot]:e=>e.getSeconds(),milliseconds:e=>e.getMilliseconds(),dayofyear:e=>Pt(e),[et]:e=>zt(e),[et+nt]:(e,t)=>Yt(zt(e),e.getDay(),It(t)),[nt]:(e,t)=>Yt(1,e.getDay(),It(t))},Jt={[Qe]:e=>3*e,[et]:(e,t)=>Yt(e,0,It(t))};function Qt(e,t){return Kt(e,t||1,Xt,Jt,Bt)}const Zt={[Je]:e=>e.getUTCFullYear(),[Qe]:e=>Math.floor(e.getUTCMonth()/3),[Ze]:e=>e.getUTCMonth(),[tt]:e=>e.getUTCDate(),[it]:e=>e.getUTCHours(),[rt]:e=>e.getUTCMinutes(),[ot]:e=>e.getUTCSeconds(),milliseconds:e=>e.getUTCMilliseconds(),dayofyear:e=>Ht(e),[et]:e=>qt(e),[nt]:(e,t)=>Yt(1,e.getUTCDay(),Vt(t)),[et+nt]:(e,t)=>Yt(qt(e),e.getUTCDay(),Vt(t))},en={[Qe]:e=>3*e,[et]:(e,t)=>Yt(e,0,Vt(t))};function tn(e,t){return Kt(e,t||1,Zt,en,Gt)}var nn=ft((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()}));nn.every=function(e){return isFinite(e=Math.floor(e))&&e>0?ft((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};var rn=nn,on=(nn.range,ft((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()}))),sn=on,an=(on.range,ft((function(e){e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds()-6e4*e.getMinutes())}),(function(e,t){e.setTime(+e+36e5*t)}),(function(e,t){return(t-e)/36e5}),(function(e){return e.getHours()}))),ln=an,cn=(an.range,ft((function(e){e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds())}),(function(e,t){e.setTime(+e+6e4*t)}),(function(e,t){return(t-e)/6e4}),(function(e){return e.getMinutes()}))),un=cn,hn=(cn.range,ft((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+1e3*t)}),(function(e,t){return(t-e)/1e3}),(function(e){return e.getUTCSeconds()}))),dn=hn,fn=(hn.range,ft((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e})));fn.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?ft((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):fn:null};var pn=fn,gn=(fn.range,ft((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()})));gn.every=function(e){return isFinite(e=Math.floor(e))&&e>0?ft((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};var mn=gn,vn=(gn.range,ft((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()}))),bn=vn,yn=(vn.range,ft((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+36e5*t)}),(function(e,t){return(t-e)/36e5}),(function(e){return e.getUTCHours()}))),wn=yn,xn=(yn.range,ft((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+6e4*t)}),(function(e,t){return(t-e)/6e4}),(function(e){return e.getUTCMinutes()}))),_n=xn;xn.range;const kn={[Je]:rn,[Qe]:sn.every(3),[Ze]:sn,[et]:vt,[tt]:gt,[nt]:gt,dayofyear:gt,[it]:ln,[rt]:un,[ot]:dn,milliseconds:pn},Sn={[Je]:mn,[Qe]:bn.every(3),[Ze]:bn,[et]:At,[tt]:Ot,[nt]:Ot,dayofyear:Ot,[it]:wn,[rt]:_n,[ot]:dn,milliseconds:pn};function On(e){return kn[e]}function Cn(e){return Sn[e]}function An(e,t,n){return e?e.offset(t,n):void 0}function $n(e,t,n){return An(On(e),t,n)}function En(e,t,n){return An(Cn(e),t,n)}function Mn(e,t,n,i){return e?e.range(t,n,i):void 0}function jn(e,t,n,i){return Mn(On(e),t,n,i)}function Rn(e,t,n,i){return Mn(Cn(e),t,n,i)}var Dn=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},Tn=function(e){var t;return 1===e.length&&(t=e,e=function(e,n){return Dn(t(e),n)}),{left:function(t,n,i,r){for(null==i&&(i=0),null==r&&(r=t.length);i<r;){var o=i+r>>>1;e(t[o],n)<0?i=o+1:r=o}return i},right:function(t,n,i,r){for(null==i&&(i=0),null==r&&(r=t.length);i<r;){var o=i+r>>>1;e(t[o],n)>0?r=o:i=o+1}return i}}};const Ln=[Je,Ze,tt,it,rt,ot,"milliseconds"],Fn=Ln.slice(0,-1),Nn=Fn.slice(0,-1),Pn=Nn.slice(0,-1),zn=Pn.slice(0,-1),In=[Je,Ze],Bn=[Je],Wn=[[Fn,1,1e3],[Fn,5,5e3],[Fn,15,15e3],[Fn,30,3e4],[Nn,1,6e4],[Nn,5,3e5],[Nn,15,9e5],[Nn,30,18e5],[Pn,1,36e5],[Pn,3,108e5],[Pn,6,216e5],[Pn,12,432e5],[zn,1,864e5],[[Je,et],1,6048e5],[In,1,2592e6],[In,3,7776e6],[Bn,1,31536e6]];var Un=function(e){const t=e.extent,n=e.maxbins||40,i=Math.abs(Object(p.Y)(t))/n;let r,o,s=Tn(e=>e[2]).right(Wn,i);return s===Wn.length?(r=Bn,o=Ae(t[0]/31536e6,t[1]/31536e6,n)):s?(s=Wn[i/Wn[s-1][2]<Wn[s][2]/i?s-1:s],r=s[0],o=s[1]):(r=Ln,o=Math.max(Ae(t[0],t[1],n),1)),{units:r,step:o}};function Hn(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function qn(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Vn(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function Gn(e){var t=e.dateTime,n=e.date,i=e.time,r=e.periods,o=e.days,s=e.shortDays,a=e.months,l=e.shortMonths,c=oi(r),u=si(r),h=oi(o),d=si(o),f=oi(s),p=si(s),g=oi(a),m=si(a),v=oi(l),b=si(l),y={a:function(e){return s[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return a[e.getMonth()]},c:null,d:Ai,e:Ai,f:Ri,H:$i,I:Ei,j:Mi,L:ji,m:Di,M:Ti,p:function(e){return r[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:lr,s:cr,S:Li,u:Fi,U:Ni,V:Pi,w:zi,W:Ii,x:null,X:null,y:Bi,Y:Wi,Z:Ui,"%":ar},w={a:function(e){return s[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return a[e.getUTCMonth()]},c:null,d:Hi,e:Hi,f:Yi,H:qi,I:Vi,j:Gi,L:Ki,m:Xi,M:Ji,p:function(e){return r[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:lr,s:cr,S:Qi,u:Zi,U:er,V:tr,w:nr,W:ir,x:null,X:null,y:rr,Y:or,Z:sr,"%":ar},x={a:function(e,t,n){var i=f.exec(t.slice(n));return i?(e.w=p[i[0].toLowerCase()],n+i[0].length):-1},A:function(e,t,n){var i=h.exec(t.slice(n));return i?(e.w=d[i[0].toLowerCase()],n+i[0].length):-1},b:function(e,t,n){var i=v.exec(t.slice(n));return i?(e.m=b[i[0].toLowerCase()],n+i[0].length):-1},B:function(e,t,n){var i=g.exec(t.slice(n));return i?(e.m=m[i[0].toLowerCase()],n+i[0].length):-1},c:function(e,n,i){return S(e,t,n,i)},d:vi,e:vi,f:ki,H:yi,I:yi,j:bi,L:_i,m:mi,M:wi,p:function(e,t,n){var i=c.exec(t.slice(n));return i?(e.p=u[i[0].toLowerCase()],n+i[0].length):-1},q:gi,Q:Oi,s:Ci,S:xi,u:li,U:ci,V:ui,w:ai,W:hi,x:function(e,t,i){return S(e,n,t,i)},X:function(e,t,n){return S(e,i,t,n)},y:fi,Y:di,Z:pi,"%":Si};function _(e,t){return function(n){var i,r,o,s=[],a=-1,l=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++a<c;)37===e.charCodeAt(a)&&(s.push(e.slice(l,a)),null!=(r=Zn[i=e.charAt(++a)])?i=e.charAt(++a):r="e"===i?" ":"0",(o=t[i])&&(i=o(n,r)),s.push(i),l=a+1);return s.push(e.slice(l,a)),s.join("")}}function k(e,t){return function(n){var i,r,o=Vn(1900,void 0,1);if(S(o,e,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(t&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(r=(i=qn(Vn(o.y,0,1))).getUTCDay(),i=r>4||0===r?$t.ceil(i):$t(i),i=Ot.offset(i,7*(o.V-1)),o.y=i.getUTCFullYear(),o.m=i.getUTCMonth(),o.d=i.getUTCDate()+(o.w+6)%7):(r=(i=Hn(Vn(o.y,0,1))).getDay(),i=r>4||0===r?bt.ceil(i):bt(i),i=gt.offset(i,7*(o.V-1)),o.y=i.getFullYear(),o.m=i.getMonth(),o.d=i.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),r="Z"in o?qn(Vn(o.y,0,1)).getUTCDay():Hn(Vn(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(r+5)%7:o.w+7*o.U-(r+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,qn(o)):Hn(o)}}function S(e,t,n,i){for(var r,o,s=0,a=t.length,l=n.length;s<a;){if(i>=l)return-1;if(37===(r=t.charCodeAt(s++))){if(r=t.charAt(s++),!(o=x[r in Zn?t.charAt(s++):r])||(i=o(e,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}return y.x=_(n,y),y.X=_(i,y),y.c=_(t,y),w.x=_(n,w),w.X=_(i,w),w.c=_(t,w),{format:function(e){var t=_(e+="",y);return t.toString=function(){return e},t},parse:function(e){var t=k(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=_(e+="",w);return t.toString=function(){return e},t},utcParse:function(e){var t=k(e+="",!0);return t.toString=function(){return e},t}}}var Kn,Yn,Xn,Jn,Qn,Zn={"-":"",_:" ",0:"0"},ei=/^\s*\d+/,ti=/^%/,ni=/[\\^$*+?|[\]().{}]/g;function ii(e,t,n){var i=e<0?"-":"",r=(i?-e:e)+"",o=r.length;return i+(o<n?new Array(n-o+1).join(t)+r:r)}function ri(e){return e.replace(ni,"\\$&")}function oi(e){return new RegExp("^(?:"+e.map(ri).join("|")+")","i")}function si(e){for(var t={},n=-1,i=e.length;++n<i;)t[e[n].toLowerCase()]=n;return t}function ai(e,t,n){var i=ei.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function li(e,t,n){var i=ei.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function ci(e,t,n){var i=ei.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function ui(e,t,n){var i=ei.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function hi(e,t,n){var i=ei.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function di(e,t,n){var i=ei.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function fi(e,t,n){var i=ei.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function pi(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function gi(e,t,n){var i=ei.exec(t.slice(n,n+1));return i?(e.q=3*i[0]-3,n+i[0].length):-1}function mi(e,t,n){var i=ei.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function vi(e,t,n){var i=ei.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function bi(e,t,n){var i=ei.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function yi(e,t,n){var i=ei.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function wi(e,t,n){var i=ei.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function xi(e,t,n){var i=ei.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function _i(e,t,n){var i=ei.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function ki(e,t,n){var i=ei.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function Si(e,t,n){var i=ti.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function Oi(e,t,n){var i=ei.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function Ci(e,t,n){var i=ei.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function Ai(e,t){return ii(e.getDate(),t,2)}function $i(e,t){return ii(e.getHours(),t,2)}function Ei(e,t){return ii(e.getHours()%12||12,t,2)}function Mi(e,t){return ii(1+gt.count(rn(e),e),t,3)}function ji(e,t){return ii(e.getMilliseconds(),t,3)}function Ri(e,t){return ji(e,t)+"000"}function Di(e,t){return ii(e.getMonth()+1,t,2)}function Ti(e,t){return ii(e.getMinutes(),t,2)}function Li(e,t){return ii(e.getSeconds(),t,2)}function Fi(e){var t=e.getDay();return 0===t?7:t}function Ni(e,t){return ii(vt.count(rn(e)-1,e),t,2)}function Pi(e,t){var n=e.getDay();return e=n>=4||0===n?xt(e):xt.ceil(e),ii(xt.count(rn(e),e)+(4===rn(e).getDay()),t,2)}function zi(e){return e.getDay()}function Ii(e,t){return ii(bt.count(rn(e)-1,e),t,2)}function Bi(e,t){return ii(e.getFullYear()%100,t,2)}function Wi(e,t){return ii(e.getFullYear()%1e4,t,4)}function Ui(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+ii(t/60|0,"0",2)+ii(t%60,"0",2)}function Hi(e,t){return ii(e.getUTCDate(),t,2)}function qi(e,t){return ii(e.getUTCHours(),t,2)}function Vi(e,t){return ii(e.getUTCHours()%12||12,t,2)}function Gi(e,t){return ii(1+Ot.count(mn(e),e),t,3)}function Ki(e,t){return ii(e.getUTCMilliseconds(),t,3)}function Yi(e,t){return Ki(e,t)+"000"}function Xi(e,t){return ii(e.getUTCMonth()+1,t,2)}function Ji(e,t){return ii(e.getUTCMinutes(),t,2)}function Qi(e,t){return ii(e.getUTCSeconds(),t,2)}function Zi(e){var t=e.getUTCDay();return 0===t?7:t}function er(e,t){return ii(At.count(mn(e)-1,e),t,2)}function tr(e,t){var n=e.getUTCDay();return e=n>=4||0===n?jt(e):jt.ceil(e),ii(jt.count(mn(e),e)+(4===mn(e).getUTCDay()),t,2)}function nr(e){return e.getUTCDay()}function ir(e,t){return ii($t.count(mn(e)-1,e),t,2)}function rr(e,t){return ii(e.getUTCFullYear()%100,t,2)}function or(e,t){return ii(e.getUTCFullYear()%1e4,t,4)}function sr(){return"+0000"}function ar(){return"%"}function lr(e){return+e}function cr(e){return Math.floor(+e/1e3)}function ur(e,t,n){n=n||{},Object(p.G)(n)||Object(p.o)("Invalid time multi-format specifier: "+n);const i=t(ot),r=t(rt),o=t(it),s=t(tt),a=t(et),l=t(Ze),c=t(Qe),u=t(Je),h=e(n.milliseconds||".%L"),d=e(n[ot]||":%S"),f=e(n[rt]||"%I:%M"),g=e(n[it]||"%I %p"),m=e(n[tt]||n.day||"%a %d"),v=e(n[et]||"%b %d"),b=e(n[Ze]||"%B"),y=e(n[Qe]||"%B"),w=e(n[Je]||"%Y");return e=>(i(e)<e?h:r(e)<e?d:o(e)<e?f:s(e)<e?g:l(e)<e?a(e)<e?m:v:u(e)<e?c(e)<e?b:y:w)(e)}function hr(e){const t=xe(e.format),n=xe(e.utcFormat);return{timeFormat:e=>Object(p.I)(e)?t(e):ur(t,On,e),utcFormat:e=>Object(p.I)(e)?n(e):ur(n,Cn,e),timeParse:xe(e.parse),utcParse:xe(e.utcParse)}}let dr;function fr(){return dr=hr({format:Yn,parse:Xn,utcFormat:Jn,utcParse:Qn})}function pr(e){return hr(Gn(e))}function gr(e){return arguments.length?dr=pr(e):dr}!function(e){Kn=Gn(e),Yn=Kn.format,Xn=Kn.parse,Jn=Kn.utcFormat,Qn=Kn.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),fr();const mr=(e,t)=>Object(p.p)({},e,t);function vr(e,t){const n=e?Ye(e):Xe(),i=t?pr(t):gr();return mr(n,i)}function br(e,t){const n=arguments.length;return n&&2!==n&&Object(p.o)("defaultLocale expects either zero or two arguments."),n?mr(Xe(e),gr(t)):mr(Xe(),gr())}function yr(){return Ke(),fr(),br()}var wr=function(e,t,n,i){const r=ye((t=t||{}).type||"json");return r||Object(p.o)("Unknown data format type: "+t.type),e=r(e,t),t.parse&&function(e,t,n,i){if(!e.length)return;const r=gr();n=n||r.timeParse,i=i||r.utcParse;let o,s,a,l,c,u,h,d=e.columns||Object.keys(e[0]);"auto"===t&&(t=X(e,d));for(d=Object.keys(t),o=d.map(e=>{let r,o,s=t[e];if(s&&(s.startsWith("date:")||s.startsWith("utc:"))){r=s.split(/:(.+)?/,2),o=r[1],("'"===o[0]&&"'"===o[o.length-1]||'"'===o[0]&&'"'===o[o.length-1])&&(o=o.slice(1,-1));return("utc"===r[0]?i:n)(o)}if(!G[s])throw Error("Illegal format pattern: "+e+":"+s);return G[s]}),l=0,u=e.length,h=d.length;l<u;++l)for(s=e[l],c=0;c<h;++c)a=d[c],s[a]=o[c](s[a])}(e,t.parse,n,i),Object(p.w)(e,"columns")&&delete e.columns,e};var xr=function(e,t){return n=>({options:n||{},sanitize:B,load:I,fileAccess:!!t,file:W(t),http:H(e)})}("undefined"!=typeof fetch&&fetch,null);const _r={skip:!0};function kr(e,t,n,i,r,o){let s,a,l=Object(p.p)({},o,_r);Object(p.E)(n)||(n=Object(p.m)(n)),void 0===i?s=t=>e.touch(n(t)):Object(p.E)(i)?(a=new R(null,i,r,!1),s=t=>{a.evaluate(t);const i=n(t),r=a.value;A(r)?e.pulse(i,r,o):e.update(i,r,l)}):s=t=>e.update(n(t),i,l),t.apply(s)}function Sr(e,t,n,i,r,o){if(void 0===i)t.targets().add(n);else{const s=o||{},a=new R(null,function(e,t){return t=Object(p.E)(t)?t:Object(p.m)(t),e?function(n,i){const r=t(n,i);return e.skip()||(e.skip(r!==this.value).value=r),r}:t}(n,i),r,!1);a.modified(s.force),a.rank=t.rank,t.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),e.connect(n,[a]))}}const Or={};function Cr(e,t,n){this.dataflow=e,this.stamp=null==t?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function Ar(e,t){const n=[];return Object(p.jb)(e,t,e=>n.push(e)),n}function $r(e,t){const n={};return e.visit(t,(function(e){n[w(e)]=1})),e=>n[w(e)]?null:e}function Er(e,t){return e?(n,i)=>e(n,i)&&t(n,i):t}function Mr(e,t,n,i){let r,o,s,a,l,c=this,u=0;for(this.dataflow=e,this.stamp=t,this.fields=null,this.encode=i||null,this.pulses=n,s=0,a=n.length;s<a;++s)if(r=n[s],r.stamp===t){if(r.fields)for(l in o=c.fields||(c.fields={}),r.fields)o[l]=1;r.changed(c.ADD)&&(u|=c.ADD),r.changed(c.REM)&&(u|=c.REM),r.changed(c.MOD)&&(u|=c.MOD)}this.changes=u}function jr(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}Cr.prototype={StopPropagation:Or,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork(e){return new Cr(this.dataflow).init(this,e)},clone(){const e=this.fork(7);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(23)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new Cr(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,!e.fields||64&t||(n.fields=e.fields),1&t?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),2&t?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),4&t?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),32&t?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||7;return 1&t&&this.add.length||2&t&&this.rem.length||4&t&&this.mod.length},reflow(e){if(e)return this.fork(7).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(4,$r(this,1))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return Object(p.B)(e)?e.forEach(e=>t[e]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return!(!t&&!this.mod.length||!n)&&(arguments.length?Object(p.B)(e)?e.some(e=>n[e]):n[e]:!!n)},filter(e,t){const n=this;return 1&e&&(n.addF=Er(n.addF,t)),2&e&&(n.remF=Er(n.remF,t)),4&e&&(n.modF=Er(n.modF,t)),16&e&&(n.srcF=Er(n.srcF,t)),n},materialize(e){const t=this;return 1&(e=e||7)&&t.addF&&(t.add=Ar(t.add,t.addF),t.addF=null),2&e&&t.remF&&(t.rem=Ar(t.rem,t.remF),t.remF=null),4&e&&t.modF&&(t.mod=Ar(t.mod,t.modF),t.modF=null),16&e&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){let n,i,r=this,o=t;return 16&e?(Object(p.jb)(r.source,r.srcF,o),r):(1&e&&Object(p.jb)(r.add,r.addF,o),2&e&&Object(p.jb)(r.rem,r.remF,o),4&e&&Object(p.jb)(r.mod,r.modF,o),8&e&&(n=r.source)&&(i=r.add.length+r.mod.length,i===n.length||(i?Object(p.jb)(n,$r(r,5),o):Object(p.jb)(n,r.srcF,o))),r)}},Object(p.z)(Mr,Cr,{fork(e){const t=new Cr(this.dataflow).init(this,e&this.NO_FIELDS);return void 0!==e&&(e&t.ADD&&this.visit(t.ADD,e=>t.add.push(e)),e&t.REM&&this.visit(t.REM,e=>t.rem.push(e)),e&t.MOD&&this.visit(t.MOD,e=>t.mod.push(e))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?Object(p.B)(e)?e.some((function(e){return n[e]})):n[e]:0},filter(){Object(p.o)("MultiPulse does not support filtering.")},materialize(){Object(p.o)("MultiPulse does not support materialization.")},visit(e,t){let n=this,i=n.pulses,r=i.length,o=0;if(e&n.SOURCE)for(;o<r;++o)i[o].visit(e,t);else for(;o<r;++o)i[o].stamp===n.stamp&&i[o].visit(e,t);return n}});const Rr={skip:!1,force:!1};function Dr(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),Tr(t,0,t.length-1,e)),pop:()=>{let n,i=t.pop();return t.length?(n=t[0],t[0]=i,function(e,t,n){let i,r=t,o=e.length,s=e[t],a=1+(t<<1);for(;a<o;)i=a+1,i<o&&n(e[a],e[i])>=0&&(a=i),e[t]=e[a],a=1+((t=a)<<1);e[t]=s,Tr(e,r,t,n)}(t,0,e)):n=i,n}}}function Tr(e,t,n,i){let r,o,s;for(r=e[n];n>t&&(s=n-1>>1,o=e[s],i(r,o)<0);)e[n]=o,n=s;return e[n]=r}function Lr(){this.logger(Object(p.L)()),this.logLevel(p.b),this._clock=0,this._rank=0,this._locale=br();try{this._loader=xr()}catch(e){}this._touched=g(p.x),this._input={},this._pulse=null,this._heap=Dr((e,t)=>e.qrank-t.qrank),this._postrun=[]}function Fr(e){return function(){return this._log[e].apply(this,arguments)}}function Nr(e,t){R.call(this,e,null,t)}Lr.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:Fr("error"),warn:Fr("warn"),info:Fr("info"),debug:Fr("debug"),logLevel:Fr("level"),cleanThreshold:1e4,add:function(e,t,n,i){let r,o=1;return e instanceof R?r=e:e&&e.prototype instanceof R?r=new e:Object(p.E)(e)?r=new R(null,e):(o=0,r=new R(e,t)),this.rank(r),o&&(i=n,n=t),n&&this.connect(r,r.parameters(n,i)),this.touch(r),r},connect:function(e,t){let n,i,r=e.rank;for(n=0,i=t.length;n<i;++n)if(r<t[n].rank)return void this.rerank(e)},rank:function(e){e.rank=++this._rank},rerank:function(e){let t,n,i,r=[e];for(;r.length;)if(this.rank(t=r.pop()),n=t._targets)for(i=n.length;--i>=0;)r.push(t=n[i]),t===e&&Object(p.o)("Cycle detected in dataflow graph.")},pulse:function(e,t,n){this.touch(e,n||Rr);const i=new Cr(this,this._clock+(this._pulse?0:1)),r=e.pulse&&e.pulse.source||[];return i.target=e,this._input[e.id]=t.pulse(i,r),this},touch:function(e,t){const n=t||Rr;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this},update:function(e,t,n){const i=n||Rr;return(e.set(t)||i.force)&&this.touch(e,i),this},changeset:$,ingest:function(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))},parse:function(e,t){const n=this.locale();return wr(e,t,n.timeParse,n.utcParse)},preload:async function(e,t,n){const i=this,r=i._pending||function(e){let t,n=new Promise(e=>t=e);return n.requests=0,n.done=()=>{0==--n.requests&&(e._pending=null,t(e))},e._pending=n}(i);r.requests+=1;const o=await i.request(t,n);return i.pulse(e,i.changeset().remove(p.hb).insert(o.data||[])),r.done(),o},request:async function(e,t){const n=this;let i,r=0;try{i=await n.loader().load(e,{context:"dataflow",response:we(t&&t.type)});try{i=n.parse(i,t)}catch(t){r=-2,n.warn("Data ingestion failed",e,t)}}catch(t){r=-1,n.warn("Loading failed",e,t)}return{data:i,status:r}},events:function(e,t,n,i){let r,o=this,s=F(n,i),a=function(e){e.dataflow=o;try{s.receive(e)}catch(e){o.error(e)}finally{o.run()}};r="string"==typeof e&&"undefined"!=typeof document?document.querySelectorAll(e):Object(p.i)(e);for(let e=0,n=r.length;e<n;++e)r[e].addEventListener(t,a);return s},on:function(e,t,n,i,r){return(e instanceof R?Sr:kr)(this,e,t,n,i,r),this},evaluate:async function(e,t,n){const i=this,r=[];if(i._pulse)return jr(i);if(i._pending&&await i._pending,t&&await m(i,t),!i._touched.length)return i.debug("Dataflow invoked, but nothing to do."),i;const o=++i._clock;i._pulse=new Cr(i,o,e),i._touched.forEach(e=>i._enqueue(e,!0)),i._touched=g(p.x);let s,a,l,c=0;try{for(;i._heap.size()>0;)s=i._heap.pop(),s.rank===s.qrank?(a=s.run(i._getPulse(s,e)),a.then?a=await a:a.async&&(r.push(a.async),a=Or),a!==Or&&s._targets&&s._targets.forEach(e=>i._enqueue(e)),++c):i._enqueue(s,!0)}catch(e){i._heap.clear(),l=e}if(i._input={},i._pulse=null,i.debug(`Pulse ${o}: ${c} operators`),l&&(i._postrun=[],i.error(l)),i._postrun.length){const e=i._postrun.sort((e,t)=>t.priority-e.priority);i._postrun=[];for(let t=0;t<e.length;++t)await m(i,e[t].callback)}return n&&await m(i,n),r.length&&Promise.all(r).then(e=>i.runAsync(null,()=>{e.forEach(e=>{try{e(i)}catch(e){i.error(e)}})})),i},run:function(e,t,n){return this._pulse?jr(this):(this.evaluate(e,t,n),this)},runAsync:async function(e,t,n){for(;this._running;)await this._running;const i=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(i,i),this._running},runAfter:function(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(e){this.error(e)}},_enqueue:function(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))},_getPulse:function(e,t){const n=e.source,i=this._clock;return n&&Object(p.B)(n)?new Mr(this,i,n.map(e=>e.pulse),t):this._input[e.id]||function(e,t){if(t&&t.stamp===e.stamp)return t;e=e.fork(),t&&t!==Or&&(e.source=t.source);return e}(this._pulse,n&&n.pulse)}},Object(p.z)(Nr,R,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(e=>this.pulse=e):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const Pr={};function zr(e){const t=Ir(e);return t&&t.Definition||null}function Ir(e){return e=e&&e.toLowerCase(),Object(p.w)(Pr,e)?Pr[e]:null}function Br(e){return e&&e.length?1===e.length?e[0]:(t=e,e=>{let n=t.length,i=1,r=String(t[0](e));for(;i<n;++i)r+="|"+t[i](e);return r}):function(){return""};var t}function Wr(e,t,n){return n||e+(t?"_"+t:"")}const Ur=()=>{},Hr={init:Ur,add:Ur,rem:Ur,idx:0},qr={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||void 0===e.min)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||void 0===e.max)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},Vr=Object.keys(qr);function Gr(e,t){return qr[e](t)}function Kr(e,t){return e.idx-t.idx}function Yr(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function Xr(e,t){null!=e&&""!==e?e==e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t))):++this.missing}function Jr(e,t){null!=e&&""!==e?e==e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t))):--this.missing}function Qr(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function Zr(e,t){const n=t||p.y,i=function(e){const t={};e.forEach(e=>t[e.name]=e);const n=e=>{e.req&&e.req.forEach(e=>{t[e]||n(t[e]=qr[e]())})};return e.forEach(n),Object.values(t).sort(Kr)}(e),r=e.slice().sort(Kr);function o(e){this._ops=i,this._out=r,this.cell=e,this.init()}return o.prototype.init=Yr,o.prototype.add=Xr,o.prototype.rem=Jr,o.prototype.set=Qr,o.prototype.get=n,o.fields=e.map(e=>e.out),o}Vr.forEach(e=>{qr[e]=function(e,t){return n=>Object(p.p)({name:e,out:n||e},Hr,t)}(e,qr[e])});var eo=function*(e,t){if(null==t)for(let t of e)null!=t&&""!==t&&(t=+t)>=t&&(yield t);else{let n=-1;for(let i of e)i=t(i,++n,e),null!=i&&""!==i&&(i=+i)>=i&&(yield i)}};function to(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let i=-1;for(let r of e)null!=(r=t(r,++i,e))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n}function no(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let i=-1;for(let r of e)null!=(r=t(r,++i,e))&&(n>r||void 0===n&&r>=r)&&(n=r)}return n}function io(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}var ro=function(e){return null===e?NaN:+e};function oo(e,t,n){if(i=(e=Float64Array.from(function*(e,t){if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(yield t);else{let n=-1;for(let i of e)null!=(i=t(i,++n,e))&&(i=+i)>=i&&(yield i)}}(e,n))).length){if((t=+t)<=0||i<2)return no(e);if(t>=1)return to(e);var i,r=(i-1)*t,o=Math.floor(r),s=to(function e(t,n,i=0,r=t.length-1,o=Dn){for(;r>i;){if(r-i>600){const s=r-i+1,a=n-i+1,l=Math.log(s),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(s-c)/s)*(a-s/2<0?-1:1);e(t,n,Math.max(i,Math.floor(n-a*c/s+u)),Math.min(r,Math.floor(n+(s-a)*c/s+u)),o)}const s=t[n];let a=i,l=r;for(io(t,i,n),o(t[r],s)>0&&io(t,i,r);a<l;){for(io(t,a,l),++a,--l;o(t[a],s)<0;)++a;for(;o(t[l],s)>0;)--l}0===o(t[i],s)?io(t,i,l):(++l,io(t,l,r)),l<=n&&(i=l+1),n<=l&&(r=l-1)}return t}(e,o).subarray(0,o+1));return s+(no(e.subarray(o+1))-s)*(r-o)}}var so=function(e,t,n){const i=Float64Array.from(eo(e,n));return i.sort(Dn),t.map(e=>function(e,t,n=ro){if(i=e.length){if((t=+t)<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,o=Math.floor(r),s=+n(e[o],o,e);return s+(+n(e[o+1],o+1,e)-s)*(r-o)}}(i,e))},ao=function(e,t){return so(e,[.25,.5,.75],t)};var lo=function(e,t){let n=e.length,i=function(e,t){const n=function(e,t){let n,i=0,r=0,o=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(n=t-r,r+=n/++i,o+=n*(t-r));else{let s=-1;for(let a of e)null!=(a=t(a,++s,e))&&(a=+a)>=a&&(n=a-r,r+=n/++i,o+=n*(a-r))}if(i>1)return o/(i-1)}(e,t);return n?Math.sqrt(n):n}(e,t),r=ao(e,t),o=(r[2]-r[0])/1.34;return i=Math.min(i,o)||i||Math.abs(r[0])||1,1.06*i*Math.pow(n,-.2)},co=function(e){let t,n,i,r,o,s,a,l,c=e.maxbins||20,u=e.base||10,h=Math.log(u),d=e.divide||[5,2],f=e.extent[0],p=e.extent[1],g=e.span||p-f||Math.abs(f)||1;if(e.step)t=e.step;else if(e.steps){for(o=g/c,s=0,a=e.steps.length;s<a&&e.steps[s]<o;++s);t=e.steps[Math.max(0,s-1)]}else{for(n=Math.ceil(Math.log(c)/h),i=e.minstep||0,t=Math.max(i,Math.pow(u,Math.round(Math.log(g)/h)-n));Math.ceil(g/t)>c;)t*=u;for(s=0,a=d.length;s<a;++s)o=t/d[s],o>=i&&g/o<=c&&(t=o)}return o=Math.log(t),r=o>=0?0:1+~~(-o/h),l=Math.pow(u,-r-1),(e.nice||void 0===e.nice)&&(o=Math.floor(f/t+l)*t,f=f<o?o-t:o,p=Math.ceil(p/t)*t),{start:f,stop:p===f?f+t:p,step:t}},uo=Math.random;function ho(e){uo=e}var fo=function(e,t,n,i){if(!e.length)return[void 0,void 0];let r,o,s,a,l=Float64Array.from(eo(e,i)),c=l.length,u=t;for(s=0,a=Array(u);s<u;++s){for(r=0,o=0;o<c;++o)r+=l[~~(uo()*c)];a[s]=r/c}return a.sort(Dn),[oo(a,n/2),oo(a,1-n/2)]},po=function(e,t,n,i){i=i||(e=>e);let r,o=0,s=1,a=e.length,l=new Float64Array(a),c=i(e[0]),u=c,h=c+t;for(;s<a;++s){if(r=i(e[s]),r>=h){for(u=(c+u)/2;o<s;++o)l[o]=u;h=r+t,c=r}u=r}for(u=(c+u)/2;o<s;++o)l[o]=u;return n?function(e,t){let n,i,r=e.length,o=0,s=1;for(;e[o]===e[s];)++s;for(;s<r;){for(n=s+1;e[s]===e[n];)++n;if(e[s]-e[s-1]<t){for(i=s+(o+n-s-s>>1);i<s;)e[i++]=e[s];for(;i>s;)e[i--]=e[o]}o=s,s=n}return e}(l,t+t/4):l};var go=function(e){return function(){return(e=(1103515245*e+12345)%2147483647)/2147483647}},mo=function(e,t){let n,i,r;null==t&&(t=e,e=0);const o={min(e){return arguments.length?(n=e||0,r=i-n,o):n},max(e){return arguments.length?(i=e||0,r=i-n,o):i},sample:()=>n+Math.floor(r*uo()),pdf:e=>e===Math.floor(e)&&e>=n&&e<i?1/r:0,cdf(e){const t=Math.floor(e);return t<n?0:t>=i?1:(t-n+1)/r},icdf:e=>e>=0&&e<=1?n-1+Math.floor(e*r):NaN};return o.min(e).max(t)};const vo=Math.sqrt(2*Math.PI),bo=Math.SQRT2;let yo=NaN;function wo(e,t){e=e||0,t=null==t?1:t;let n,i,r=0,o=0;if(yo==yo)r=yo,yo=NaN;else{do{r=2*uo()-1,o=2*uo()-1,n=r*r+o*o}while(0===n||n>1);i=Math.sqrt(-2*Math.log(n)/n),r*=i,yo=o*i}return e+r*t}function xo(e,t,n){const i=(e-(t||0))/(n=null==n?1:n);return Math.exp(-.5*i*i)/(n*vo)}function _o(e,t,n){let i,r=(e-(t=t||0))/(n=null==n?1:n),o=Math.abs(r);if(o>37)i=0;else{let e,t=Math.exp(-o*o/2);o<7.07106781186547?(e=.0352624965998911*o+.700383064443688,e=e*o+6.37396220353165,e=e*o+33.912866078383,e=e*o+112.079291497871,e=e*o+221.213596169931,e=e*o+220.206867912376,i=t*e,e=.0883883476483184*o+1.75566716318264,e=e*o+16.064177579207,e=e*o+86.7807322029461,e=e*o+296.564248779674,e=e*o+637.333633378831,e=e*o+793.826512519948,e=e*o+440.413735824752,i/=e):(e=o+.65,e=o+4/e,e=o+3/e,e=o+2/e,e=o+1/e,i=t/e/2.506628274631)}return r>0?1-i:i}function ko(e,t,n){return e<0||e>1?NaN:(t||0)+(null==n?1:n)*bo*function(e){let t,n=-Math.log((1-e)*(1+e));n<6.25?(n-=3.125,t=-364441206401782e-35,t=t*n-16850591381820166e-35,t=128584807152564e-32+t*n,t=11157877678025181e-33+t*n,t=t*n-1333171662854621e-31,t=20972767875968562e-33+t*n,t=6637638134358324e-30+t*n,t=t*n-4054566272975207e-29,t=t*n-8151934197605472e-29,t=26335093153082323e-28+t*n,t=t*n-12975133253453532e-27,t=t*n-5415412054294628e-26,t=1.0512122733215323e-9+t*n,t=t*n-4.112633980346984e-9,t=t*n-2.9070369957882005e-8,t=4.2347877827932404e-7+t*n,t=t*n-13654692000834679e-22,t=t*n-13882523362786469e-21,t=.00018673420803405714+t*n,t=t*n-.000740702534166267,t=t*n-.006033670871430149,t=.24015818242558962+t*n,t=1.6536545626831027+t*n):n<16?(n=Math.sqrt(n)-3.25,t=2.2137376921775787e-9,t=9.075656193888539e-8+t*n,t=t*n-2.7517406297064545e-7,t=1.8239629214389228e-8+t*n,t=15027403968909828e-22+t*n,t=t*n-4013867526981546e-21,t=29234449089955446e-22+t*n,t=12475304481671779e-21+t*n,t=t*n-47318229009055734e-21,t=6828485145957318e-20+t*n,t=24031110387097894e-21+t*n,t=t*n-.0003550375203628475,t=.0009532893797373805+t*n,t=t*n-.0016882755560235047,t=.002491442096107851+t*n,t=t*n-.003751208507569241,t=.005370914553590064+t*n,t=1.0052589676941592+t*n,t=3.0838856104922208+t*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,t=-27109920616438573e-27,t=t*n-2.555641816996525e-10,t=1.5076572693500548e-9+t*n,t=t*n-3.789465440126737e-9,t=7.61570120807834e-9+t*n,t=t*n-1.496002662714924e-8,t=2.914795345090108e-8+t*n,t=t*n-6.771199775845234e-8,t=2.2900482228026655e-7+t*n,t=t*n-9.9298272942317e-7,t=4526062597223154e-21+t*n,t=t*n-1968177810553167e-20,t=7599527703001776e-20+t*n,t=t*n-.00021503011930044477,t=t*n-.00013871931833623122,t=1.0103004648645344+t*n,t=4.849906401408584+t*n):t=1/0;return t*e}(2*e-1)}var So=function(e,t){let n,i;const r={mean(e){return arguments.length?(n=e||0,r):n},stdev(e){return arguments.length?(i=null==e?1:e,r):i},sample:()=>wo(n,i),pdf:e=>xo(e,n,i),cdf:e=>_o(e,n,i),icdf:e=>ko(e,n,i)};return r.mean(e).stdev(t)},Oo=function(e,t){const n=So();let i=0;const r={data(n){return arguments.length?(e=n,i=n?n.length:0,r.bandwidth(t)):e},bandwidth(n){return arguments.length?(!(t=n)&&e&&(t=lo(e)),r):t},sample:()=>e[~~(uo()*i)]+t*n.sample(),pdf(r){let o=0,s=0;for(;s<i;++s)o+=n.pdf((r-e[s])/t);return o/t/i},cdf(r){let o=0,s=0;for(;s<i;++s)o+=n.cdf((r-e[s])/t);return o/i},icdf(){throw Error("KDE icdf not supported.")}};return r.data(e)};function Co(e,t){return e=e||0,t=null==t?1:t,Math.exp(e+wo()*t)}function Ao(e,t,n){if(e<=0)return 0;t=t||0,n=null==n?1:n;const i=(Math.log(e)-t)/n;return Math.exp(-.5*i*i)/(n*vo*e)}function $o(e,t,n){return _o(Math.log(e),t,n)}function Eo(e,t,n){return Math.exp(ko(e,t,n))}var Mo=function(e,t){let n,i;const r={mean(e){return arguments.length?(n=e||0,r):n},stdev(e){return arguments.length?(i=null==e?1:e,r):i},sample:()=>Co(n,i),pdf:e=>Ao(e,n,i),cdf:e=>$o(e,n,i),icdf:e=>Eo(e,n,i)};return r.mean(e).stdev(t)},jo=function(e,t){let n,i=0;const r={weights(e){return arguments.length?(n=function(e){let t,n=[],r=0;for(t=0;t<i;++t)r+=n[t]=null==e[t]?1:+e[t];for(t=0;t<i;++t)n[t]/=r;return n}(t=e||[]),r):t},distributions(n){return arguments.length?(n?(i=n.length,e=n):(i=0,e=[]),r.weights(t)):e},sample(){let t=uo(),r=e[i-1],o=n[0],s=0;for(;s<i-1;o+=n[++s])if(t<o){r=e[s];break}return r.sample()},pdf(t){let r=0,o=0;for(;o<i;++o)r+=n[o]*e[o].pdf(t);return r},cdf(t){let r=0,o=0;for(;o<i;++o)r+=n[o]*e[o].cdf(t);return r},icdf(){throw Error("Mixture icdf not supported.")}};return r.distributions(e).weights(t)};function Ro(e,t){return null==t&&(t=null==e?1:e,e=0),e+(t-e)*uo()}function Do(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function To(e,t,n){return null==n&&(n=null==t?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function Lo(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}var Fo=function(e,t){let n,i;const r={min(e){return arguments.length?(n=e||0,r):n},max(e){return arguments.length?(i=null==e?1:e,r):i},sample:()=>Ro(n,i),pdf:e=>Do(e,n,i),cdf:e=>To(e,n,i),icdf:e=>Lo(e,n,i)};return null==t&&(t=null==e?1:e,e=0),r.min(e).max(t)},No=function(e,t,n,i){const r=i-e*e,o=Math.abs(r)<1e-24?0:(n-e*t)/r;return[t-o*e,o]};function Po(e,t,n,i){e=e.filter(e=>{let i=t(e),r=n(e);return null!=i&&(i=+i)>=i&&null!=r&&(r=+r)>=r}),i&&e.sort((e,n)=>t(e)-t(n));const r=e.length,o=new Float64Array(r),s=new Float64Array(r);let a,l,c,u=0,h=0,d=0;for(c of e)o[u]=a=+t(c),s[u]=l=+n(c),++u,h+=(a-h)/u,d+=(l-d)/u;for(u=0;u<r;++u)o[u]-=h,s[u]-=d;return[o,s,h,d]}function zo(e,t,n,i){let r,o,s=-1;for(let a of e)r=t(a),o=n(a),null!=r&&(r=+r)>=r&&null!=o&&(o=+o)>=o&&i(r,o,++s)}var Io=function(e,t,n,i,r){let o=0,s=0;return zo(e,t,n,(e,t)=>{const n=t-r(e),a=t-i;o+=n*n,s+=a*a}),1-o/s},Bo=function(e,t,n){let i=0,r=0,o=0,s=0,a=0;zo(e,t,n,(e,t)=>{++a,i+=(e-i)/a,r+=(t-r)/a,o+=(e*t-o)/a,s+=(e*e-s)/a});const l=No(i,r,o,s),c=e=>l[0]+l[1]*e;return{coef:l,predict:c,rSquared:Io(e,t,n,r,c)}},Wo=function(e,t,n){let i=0,r=0,o=0,s=0,a=0;zo(e,t,n,(e,t)=>{++a,e=Math.log(e),i+=(e-i)/a,r+=(t-r)/a,o+=(e*t-o)/a,s+=(e*e-s)/a});const l=No(i,r,o,s),c=e=>l[0]+l[1]*Math.log(e);return{coef:l,predict:c,rSquared:Io(e,t,n,r,c)}},Uo=function(e,t,n){const[i,r,o,s]=Po(e,t,n);let a,l,c,u=0,h=0,d=0,f=0,p=0;zo(e,t,n,(e,t)=>{a=i[p++],l=Math.log(t),c=a*t,u+=(t*l-u)/p,h+=(c-h)/p,d+=(c*l-d)/p,f+=(a*c-f)/p});const[g,m]=No(h/s,u/s,d/s,f/s),v=e=>Math.exp(g+m*(e-o));return{coef:[Math.exp(g-m*o),m],predict:v,rSquared:Io(e,t,n,s,v)}},Ho=function(e,t,n){let i=0,r=0,o=0,s=0,a=0,l=0;zo(e,t,n,(e,t)=>{const n=Math.log(e),c=Math.log(t);++l,i+=(n-i)/l,r+=(c-r)/l,o+=(n*c-o)/l,s+=(n*n-s)/l,a+=(t-a)/l});const c=No(i,r,o,s),u=e=>c[0]*Math.pow(e,c[1]);return c[0]=Math.exp(c[0]),{coef:c,predict:u,rSquared:Io(e,t,n,a,u)}},qo=function(e,t,n){const[i,r,o,s]=Po(e,t,n),a=i.length;let l,c,u,h,d=0,f=0,p=0,g=0,m=0;for(l=0;l<a;)c=i[l],u=r[l++],h=c*c,d+=(h-d)/l,f+=(h*c-f)/l,p+=(h*h-p)/l,g+=(c*u-g)/l,m+=(h*u-m)/l;const v=p-d*d,b=d*v-f*f,y=(m*d-g*f)/b,w=(g*v-m*f)/b,x=-y*d,_=e=>y*(e-=o)*e+w*e+x+s;return{coef:[x-w*o+y*o*o+s,w-2*y*o,y],predict:_,rSquared:Io(e,t,n,s,_)}},Vo=function(e,t,n,i){if(1===i)return Bo(e,t,n);if(2===i)return qo(e,t,n);const[r,o,s,a]=Po(e,t,n),l=r.length,c=[],u=[],h=i+1;let d,f,p,g,m;for(d=0;d<h;++d){for(p=0,g=0;p<l;++p)g+=Math.pow(r[p],d)*o[p];for(c.push(g),m=new Float64Array(h),f=0;f<h;++f){for(p=0,g=0;p<l;++p)g+=Math.pow(r[p],d+f);m[f]=g}u.push(m)}u.push(c);const v=function(e){const t=e.length-1,n=[];let i,r,o,s,a;for(i=0;i<t;++i){for(s=i,r=i+1;r<t;++r)Math.abs(e[i][r])>Math.abs(e[i][s])&&(s=r);for(o=i;o<t+1;++o)a=e[o][i],e[o][i]=e[o][s],e[o][s]=a;for(r=i+1;r<t;++r)for(o=t;o>=i;o--)e[o][r]-=e[o][i]*e[i][r]/e[i][i]}for(r=t-1;r>=0;--r){for(a=0,o=r+1;o<t;++o)a+=e[o][r]*n[o];n[r]=(e[t][r]-a)/e[r][r]}return n}(u),b=e=>{e-=s;let t=a+v[0]+v[1]*e+v[2]*e*e;for(d=3;d<h;++d)t+=v[d]*Math.pow(e,d);return t};return{coef:Go(h,v,-s,a),predict:b,rSquared:Io(e,t,n,a,b)}};function Go(e,t,n,i){const r=Array(e);let o,s,a,l;for(o=0;o<e;++o)r[o]=0;for(o=e-1;o>=0;--o)for(a=t[o],l=1,r[o]+=a,s=1;s<=o;++s)l*=(o+1-s)/s,r[o-s]+=a*Math.pow(n,s)*l;return r[0]+=i,r}var Ko=function(e,t){return oo(e,.5,t)};var Yo=function(e,t,n,i){const[r,o,s,a]=Po(e,t,n,!0),l=r.length,c=Math.max(2,~~(i*l)),u=new Float64Array(l),h=new Float64Array(l),d=new Float64Array(l).fill(1);for(let e=-1;++e<=2;){const t=[0,c-1];for(let e=0;e<l;++e){const n=r[e],i=t[0],s=t[1],a=n-r[i]>r[s]-n?i:s;let l=0,c=0,f=0,p=0,g=0,m=1/Math.abs(r[a]-n||1);for(let e=i;e<=s;++e){const t=r[e],i=o[e],s=Xo(Math.abs(n-t)*m)*d[e],a=t*s;l+=s,c+=a,f+=i*s,p+=i*a,g+=t*a}const[v,b]=No(c/l,f/l,p/l,g/l);u[e]=v+b*n,h[e]=Math.abs(o[e]-u[e]),Jo(r,e+1,t)}if(2===e)break;const n=Ko(h);if(Math.abs(n)<1e-12)break;for(let e,t,i=0;i<l;++i)e=h[i]/(6*n),d[i]=e>=1?1e-12:(t=1-e*e)*t}return function(e,t,n,i){const r=e.length,o=[];let s,a=0,l=0,c=[];for(;a<r;++a)s=e[a]+n,c[0]===s?c[1]+=(t[a]-c[1])/++l:(l=0,c[1]+=i,c=[s,t[a]],o.push(c));return c[1]+=i,o}(r,u,s,a)};function Xo(e){return(e=1-e*e*e)*e*e}function Jo(e,t,n){let i=e[t],r=n[0],o=n[1]+1;if(!(o>=e.length))for(;t>r&&e[o]-i<=i-e[r];)n[0]=++r,n[1]=o,++o}const Qo=.1*Math.PI/180;var Zo=function(e,t,n,i){n=n||25,i=Math.max(n,i||200);const r=t=>[t,e(t)],o=t[0],s=t[1],a=s-o,l=a/i,c=[r(o)],u=[];if(n===i){for(let e=1;e<i;++e)c.push(r(o+e/n*a));return c.push(r(s)),c}u.push(r(s));for(let e=n;--e>0;)u.push(r(o+e/n*a));let h=c[0],d=u[u.length-1];for(;d;){const e=r((h[0]+d[0])/2);e[0]-h[0]>=l&&es(h,e,d)>Qo?u.push(e):(h=d,c.push(d),u.pop()),d=u[u.length-1]}return c};function es(e,t,n){const i=Math.atan2(n[1]-e[1],n[0]-e[0]),r=Math.atan2(t[1]-e[1],t[0]-e[0]);return Math.abs(i-r)}function ts(e){this._key=e?Object(p.u)(e):w,this.reset()}const ns=ts.prototype;function is(e){Nr.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}ns.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},ns.add=function(e){this._add.push(e)},ns.rem=function(e){this._rem.push(e)},ns.values=function(){if(this._get=null,0===this._rem.length)return this._add;let e,t,n,i=this._add,r=this._rem,o=this._key,s=i.length,a=r.length,l=Array(s-a),c={};for(e=0;e<a;++e)c[o(r[e])]=1;for(e=0,t=0;e<s;++e)c[o(n=i[e])]?c[o(n)]=0:l[t++]=n;return this._rem=[],this._add=l},ns.distinct=function(e){let t,n=this.values(),i=n.length,r={},o=0;for(;--i>=0;)t=e(n[i])+"",Object(p.w)(r,t)||(r[t]=1,++o);return o},ns.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=Object(p.r)(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext},ns.argmin=function(e){return this.extent(e)[0]||{}},ns.argmax=function(e){return this.extent(e)[1]||{}},ns.min=function(e){const t=this.extent(e)[0];return null!=t?e(t):void 0},ns.max=function(e){const t=this.extent(e)[1];return null!=t?e(t):void 0},ns.quartile=function(e){return this._get===e&&this._q||(this._q=ao(this.values(),e),this._get=e),this._q},ns.q1=function(e){return this.quartile(e)[0]},ns.q2=function(e){return this.quartile(e)[1]},ns.q3=function(e){return this.quartile(e)[2]},ns.ci=function(e){return this._get===e&&this._ci||(this._ci=fo(this.values(),1e3,.05,e),this._get=e),this._ci},ns.ci0=function(e){return this.ci(e)[0]},ns.ci1=function(e){return this.ci(e)[1]},is.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Vr},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},Object(p.z)(is,Nr,{transform(e,t){const n=this,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.modified();return n.stamp=i.stamp,n.value&&(r||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=r?n.init(e):{},t.visit(t.SOURCE,e=>n.add(e))):(n.value=n.value||n.init(e),t.visit(t.REM,e=>n.rem(e)),t.visit(t.ADD,e=>n.add(e))),i.modifies(n._outputs),n._drop=!1!==e.drop,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&i.clean(!0).runAfter(()=>this.clean()),n.changes(i)},cross(){const e=this,t=e.value,n=e._dnames,i=n.map(()=>({})),r=n.length;function o(e){let t,o,s,a;for(t in e)for(s=e[t].tuple,o=0;o<r;++o)i[o][a=s[n[o]]]=a}o(e._prev),o(t),function o(s,a,l){const c=n[l],u=i[l++];for(const n in u){const i=s?s+"|"+n:n;a[c]=u[n],l<r?o(i,a,l):t[i]||e.cell(i,a)}}("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],i={};function r(e){let n,r=Object(p.i)(Object(p.g)(e)),o=0,s=r.length;for(;o<s;++o)i[n=r[o]]||(i[n]=1,t.push(n))}this._dims=Object(p.i)(e.groupby),this._dnames=this._dims.map((function(e){var t=Object(p.h)(e);return r(e),n.push(t),t})),this.cellkey=e.key?e.key:Br(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];let o,s,a,l,c,u,h=e.fields||[null],d=e.ops||["count"],f=e.as||[],g=h.length,m={};for(g!==d.length&&Object(p.o)("Unmatched number of fields and aggregate ops."),u=0;u<g;++u)o=h[u],s=d[u],null==o&&"count"!==s&&Object(p.o)("Null aggregate field specified."),l=Object(p.h)(o),c=Wr(s,l,f[u]),n.push(c),"count"!==s?(a=m[l],a||(r(o),a=m[l]=[],a.field=o,this._measures.push(a)),"count"!==s&&(this._countOnly=!1),a.push(Gr(s,c))):this._counts.push(c);return this._measures=this._measures.map((function(e){return Zr(e,e.field)})),{}},cellkey:Br(),cell(e,t){let n=this.value[e];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const e=this._measures,t=e.length;n.agg=Array(t);for(let i=0;i<t;++i)n.agg[i]=new e[i](n)}return n.store&&(n.data=new ts),n},newtuple(e,t){const n=this._dnames,i=this._dims,r=i.length,o={};for(let t=0;t<r;++t)o[n[t]]=i[t](e);return t?O(t.tuple,o):_(o)},clean(){const e=this.value;for(const t in e)0===e[t].num&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const i=n.agg;for(let t=0,n=i.length;t<n;++t)i[t].add(i[t].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const i=n.agg;for(let t=0,n=i.length;t<n;++t)i[t].rem(i[t].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let i=0,r=n.length;i<r;++i)t[n[i]]=e.num;if(!this._countOnly){const n=e.agg;for(let e=0,i=n.length;e<i;++e)n[e].set(t)}return t},changes(e){const t=this._adds,n=this._mods,i=this._prev,r=this._drop,o=e.add,s=e.rem,a=e.mod;let l,c,u,h;if(i)for(c in i)l=i[c],r&&!l.num||s.push(l.tuple);for(u=0,h=this._alen;u<h;++u)o.push(this.celltuple(t[u])),t[u]=null;for(u=0,h=this._mlen;u<h;++u)l=n[u],(0===l.num&&r?s:a).push(this.celltuple(l)),n[u]=null;return this._alen=this._mlen=0,this._prev=null,e}});function rs(e){Nr.call(this,null,e)}rs.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},Object(p.z)(rs,Nr,{transform(e,t){const n=!1!==e.interval,i=this._bins(e),r=i.start,o=i.step,s=e.as||["bin0","bin1"],a=s[0],l=s[1];let c;return c=e.modified()?(t=t.reflow(!0)).SOURCE:t.modified(Object(p.g)(e.field))?t.ADD_MOD:t.ADD,t.visit(c,n?e=>{const t=i(e);e[a]=t,e[l]=null==t?null:r+o*(1+(t-r)/o)}:e=>e[a]=i(e)),t.modifies(n?s:a)},_bins(e){if(this.value&&!e.modified())return this.value;let t,n,i=e.field,r=co(e),o=r.step,s=r.start,a=s+Math.ceil((r.stop-s)/o)*o;null!=(t=e.anchor)&&(n=t-(s+o*Math.floor((t-s)/o)),s+=n,a+=n);const l=function(e){let t=Object(p.db)(i(e));return null==t?null:t<s?-1/0:t>a?1/0:(t=Math.max(s,Math.min(t,a-o)),s+o*Math.floor(1e-14+(t-s)/o))};return l.start=s,l.stop=r.stop,l.step=o,this.value=Object(p.f)(l,Object(p.g)(i),e.name||"bin_"+Object(p.h)(i))}});var os=function(e,t,n){let i=e,r=t||[],o=n||[],s={},a=0;return{add:e=>o.push(e),remove:e=>s[i(e)]=++a,size:()=>r.length,data:(e,t)=>(a&&(r=r.filter(e=>!s[i(e)]),s={},a=0),t&&e&&r.sort(e),o.length&&(r=e?Object(p.N)(e,r,o.sort(e)):r.concat(o),o=[]),r)}};function ss(e){Nr.call(this,[],e)}function as(e){R.call(this,null,ls,e)}function ls(e){return this.value&&!e.modified()?this.value:Object(p.l)(e.fields,e.orders)}function cs(e){Nr.call(this,null,e)}function us(e){Nr.call(this,null,e)}ss.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},Object(p.z)(ss,Nr,{transform(e,t){const n=t.fork(t.ALL),i=os(w,this.value,n.materialize(n.ADD).add),r=e.sort,o=t.changed()||r&&(e.modified("sort")||t.modified(r.fields));return n.visit(n.REM,i.remove),this.modified(o),this.value=n.source=i.data(C(r),o),t.source&&t.source.root&&(this.value.root=t.source.root),n}}),Object(p.z)(as,R),cs.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},Object(p.z)(cs,Nr,{transform(e,t){const n=t=>n=>{for(var i,r=function(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase()}return e.match(n)}(a(n),e.case,o)||[],l=0,c=r.length;l<c;++l)s.test(i=r[l])||t(i)},i=this._parameterCheck(e,t),r=this._counts,o=this._match,s=this._stop,a=e.field,l=e.as||["text","count"],c=n(e=>r[e]=1+(r[e]||0)),u=n(e=>r[e]-=1);return i?t.visit(t.SOURCE,c):(t.visit(t.ADD,c),t.visit(t.REM,u)),this._finish(t,l)},_parameterCheck(e,t){let n=!1;return!e.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),!e.modified("pattern")&&this._match||(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){let n,i,r,o=this._counts,s=this._tuples||(this._tuples={}),a=t[0],l=t[1],c=e.fork(e.NO_SOURCE|e.NO_FIELDS);for(n in o)i=s[n],r=o[n]||0,!i&&r?(s[n]=i=_({}),i[a]=n,i[l]=r,c.add.push(i)):0===r?(i&&c.rem.push(i),o[n]=null,s[n]=null):i[l]!==r&&(i[l]=r,c.mod.push(i));return c.modifies(t)}}),us.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},Object(p.z)(us,Nr,{transform(e,t){let n=t.fork(t.NO_SOURCE),i=this.value,r=e.as||["a","b"],o=r[0],s=r[1];return!i||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter")?(i&&(n.rem=i),i=t.materialize(t.SOURCE).source,n.add=this.value=function(e,t,n,i){for(var r,o,s=[],a={},l=e.length,c=0;c<l;++c)for(a[t]=o=e[c],r=0;r<l;++r)a[n]=e[r],i(a)&&(s.push(_(a)),(a={})[t]=o);return s}(i,o,s,e.filter||p.hb)):n.mod=i,n.source=this.value,n.modifies(r)}});const hs={kde:Oo,mixture:jo,normal:So,lognormal:Mo,uniform:Fo};function ds(e){Nr.call(this,null,e)}var fs=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],ps={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:fs},{name:"weights",type:"number",array:!0}]};function gs(e,t){return e?e.map((e,n)=>t[n]||Object(p.h)(e)):null}function ms(e,t,n){let i,r,o,s,a,l,c=[],u=e=>e(s);if(null==t)c.push(e.map(n));else for(i={},r=0,o=e.length;r<o;++r)s=e[r],a=t.map(u),l=i[a],l||(i[a]=l=[],l.dims=a,c.push(l)),l.push(n(s));return c}ds.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:fs.concat(ps)},{name:"as",type:"string",array:!0,default:["value","density"]}]},Object(p.z)(ds,Nr,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){let i=function e(t,n){const i=t.function;Object(p.w)(hs,i)||Object(p.o)("Unknown distribution function: "+i);const r=hs[i]();for(const i in t)"field"===i?r.data((t.from||n()).map(t[i])):"distributions"===i?r[i](t[i].map(t=>e(t,n))):"function"==typeof r[i]&&r[i](t[i]);return r}(e.distribution,function(e){return()=>e.materialize(e.SOURCE).source}(t)),r=e.steps||e.minsteps||25,o=e.steps||e.maxsteps||200,s=e.method||"pdf";"pdf"!==s&&"cdf"!==s&&Object(p.o)("Invalid density method: "+s),e.extent||i.data||Object(p.o)("Missing density extent parameter."),s=i[s];const a=e.as||["value","density"],l=e.extent||Object(p.q)(i.data()),c=Zo(s,l,r,o).map(e=>{const t={};return t[a[0]]=e[0],t[a[1]]=e[1],_(t)});this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}});function vs(e){Nr.call(this,null,e)}vs.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]};function bs(e){R.call(this,null,ys,e),this.modified(!0)}function ys(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:Object(p.f)(n=>t(n,e),Object(p.g)(t),Object(p.h)(t))}function ws(e){Nr.call(this,[void 0,void 0],e)}function xs(e,t){R.call(this,e),this.parent=t,this.count=0}function _s(e){Nr.call(this,{},e),this._keys=Object(p.t)();const t=this._targets=[];t.active=0,t.forEach=e=>{for(let n=0,i=t.active;n<i;++n)e(t[n],n,t)}}function ks(e){R.call(this,null,Ss,e)}function Ss(e){return this.value&&!e.modified()?this.value:Object(p.B)(e.name)?Object(p.i)(e.name).map(e=>Object(p.u)(e)):Object(p.u)(e.name,e.as)}function Os(e){Nr.call(this,Object(p.t)(),e)}function Cs(e){Nr.call(this,[],e)}function As(e){Nr.call(this,[],e)}function $s(e){Nr.call(this,null,e)}function Es(e){Nr.call(this,[],e)}Object(p.z)(vs,Nr,{transform(e,t){if(this.value&&!e.modified()&&!t.changed())return t;const n=t.materialize(t.SOURCE).source,i=ms(t.source,e.groupby,p.y),r=e.smooth||!1,o=e.field,s=e.step||((e,t)=>Object(p.Y)(Object(p.q)(e,t))/30)(n,o),a=C((e,t)=>o(e)-o(t)),l=e.as||"bin",c=i.length;let u,h=1/0,d=-1/0,f=0;for(;f<c;++f){const e=i[f].sort(a);u=-1;for(const t of po(e,s,r,o))t<h&&(h=t),t>d&&(d=t),e[++u][l]=t}return this.value={start:h,stop:d,step:s},t.reflow(!0).modifies(l)}}),Object(p.z)(bs,R),ws.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},Object(p.z)(ws,Nr,{transform(e,t){let n,i=this.value,r=e.field,o=i[0],s=i[1];if(n=t.changed()||t.modified(r.fields)||e.modified("field"),(n||null==o)&&(o=1/0,s=-1/0),t.visit(n?t.SOURCE:t.ADD,e=>{let t=Object(p.db)(r(e));null!=t&&(t<o&&(o=t),t>s&&(s=t))}),!Number.isFinite(o)||!Number.isFinite(s)){let e=Object(p.h)(r);e&&(e=` for field "${e}"`),t.dataflow.warn(`Infinite extent${e}: [${o}, ${s}]`),o=s=void 0}this.value=[o,s]}}),Object(p.z)(xs,R,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}}),Object(p.z)(_s,Nr,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,i){let r,o,s=this.value,a=Object(p.w)(s,e)&&s[e];return a?a.value.stamp<n.stamp&&(a.init(n),this.activate(a)):(o=i||(o=this._group[e])&&o.tuple,r=n.dataflow,a=new xs(n.fork(n.NO_SOURCE),this),r.add(a).connect(t(r,e,o)),s[e]=a,this.activate(a)),a},clean(){const e=this.value;for(const t in e)if(0===e[t].count){const n=e[t].detachSubflow;n&&n(),delete e[t]}},initTargets(){const e=this._targets,t=e.length;for(let n=0;n<t&&null!=e[n];++n)e[n]=null;e.active=0},transform(e,t){const n=t.dataflow,i=e.key,r=e.subflow,o=this._keys,s=e.modified("key"),a=e=>this.subflow(e,r,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,e=>{const t=w(e),n=o.get(t);void 0!==n&&(o.delete(t),a(n).rem(e))}),t.visit(t.ADD,e=>{const t=i(e);o.set(w(e),t),a(t).add(e)}),s||t.modified(i.fields)?t.visit(t.MOD,e=>{const t=w(e),n=o.get(t),r=i(e);n===r?a(r).mod(e):(o.set(t,r),a(n).rem(e),a(r).add(e))}):t.changed(t.MOD)&&t.visit(t.MOD,e=>{a(o.get(w(e))).mod(e)}),s&&t.visit(t.REFLOW,e=>{const t=w(e),n=o.get(t),r=i(e);n!==r&&(o.set(t,r),a(n).rem(e),a(r).add(e))}),t.clean()?n.runAfter(()=>{this.clean(),o.clean()}):o.empty>n.cleanThreshold&&n.runAfter(o.clean),t}}),Object(p.z)(ks,R),Os.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},Object(p.z)(Os,Nr,{transform(e,t){let n=t.dataflow,i=this.value,r=t.fork(),o=r.add,s=r.rem,a=r.mod,l=e.expr,c=!0;function u(t){const n=w(t),r=l(t,e),u=i.get(n);r&&u?(i.delete(n),o.push(t)):r||u?c&&r&&!u&&a.push(t):(i.set(n,1),s.push(t))}return t.visit(t.REM,e=>{var t=w(e);i.has(t)?i.delete(t):s.push(e)}),t.visit(t.ADD,t=>{l(t,e)?o.push(t):i.set(w(t),1)}),t.visit(t.MOD,u),e.modified()&&(c=!1,t.visit(t.REFLOW,u)),i.empty>n.cleanThreshold&&n.runAfter(i.clean),r}}),Cs.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},Object(p.z)(Cs,Nr,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=gs(i,e.as||[]),o=e.index||null,s=r.length;return n.rem=this.value,t.visit(t.SOURCE,e=>{let t,a,l,c=i.map(t=>t(e)),u=c.reduce((e,t)=>Math.max(e,t.length),0),h=0;for(;h<u;++h){for(a=k(e),t=0;t<s;++t)a[r[t]]=null==(l=c[t][h])?null:l;o&&(a[o]=h),n.add.push(a)}}),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(r)}}),As.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},Object(p.z)(As,Nr,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=i.map(p.h),o=e.as||["key","value"],s=o[0],a=o[1],l=i.length;return n.rem=this.value,t.visit(t.SOURCE,e=>{for(let t,o=0;o<l;++o)t=k(e),t[s]=r[o],t[a]=i[o](e),n.add.push(t)}),this.value=n.source=n.add,n.modifies(o)}}),$s.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},Object(p.z)($s,Nr,{transform(e,t){const n=e.expr,i=e.as,r=e.modified(),o=e.initonly?t.ADD:r?t.SOURCE:t.modified(n.fields)||t.modified(i)?t.ADD_MOD:t.ADD;return r&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(i),t.visit(o,t=>t[i]=n(t,e))}}),Object(p.z)(Es,Nr,{transform(e,t){let n,i,r,o=this.value,s=t.fork(t.ALL),a=e.size-o.length,l=e.generator;if(a>0){for(n=[];--a>=0;)n.push(r=_(l(e))),o.push(r);s.add=s.add.length?s.materialize(s.ADD).add.concat(n):n}else i=o.slice(0,-a),s.rem=s.rem.length?s.materialize(s.REM).rem.concat(i):i,o=o.slice(-a);return s.source=this.value=o,s}});const Ms={value:"value",median:Ko,mean:function(e,t){let n=0,i=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(++n,i+=t);else{let r=-1;for(let o of e)null!=(o=t(o,++r,e))&&(o=+o)>=o&&(++n,i+=o)}if(n)return i/n},min:no,max:to},js=[];function Rs(e){Nr.call(this,[],e)}function Ds(e){is.call(this,e)}function Ts(e){Nr.call(this,null,e)}function Ls(e){R.call(this,null,Fs,e)}function Fs(e){return this.value&&!e.modified()?this.value:Object(p.J)(e.fields,e.flat)}function Ns(e){Nr.call(this,[],e),this._pending=null}function Ps(e,t,n){n.forEach(_);const i=t.fork(t.NO_FIELDS&t.NO_SOURCE);return i.rem=e.value,e.value=i.source=i.add=n,e._pending=null,i.rem.length&&i.clean(!0),i}function zs(e){Nr.call(this,{},e)}function Is(e){R.call(this,null,Bs,e)}function Bs(e){if(this.value&&!e.modified())return this.value;let t,n,i,r=1/0,o=-1/0,s=e.extents;for(t=0,n=s.length;t<n;++t)i=s[t],i[0]<r&&(r=i[0]),i[1]>o&&(o=i[1]);return[r,o]}function Ws(e){R.call(this,null,Us,e)}function Us(e){return this.value&&!e.modified()?this.value:e.values.reduce((e,t)=>e.concat(t),[])}function Hs(e){Nr.call(this,null,e)}function qs(e){is.call(this,e)}function Vs(e){_s.call(this,e)}function Gs(e){Nr.call(this,null,e)}function Ks(e){Nr.call(this,null,e)}Rs.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},Object(p.z)(Rs,Nr,{transform(e,t){var n,i,r,o,s,a,l,c,u,h,d=t.fork(t.ALL),f=function(e){var t,n=e.method||Ms.value;if(null!=Ms[n])return n===Ms.value?(t=void 0!==e.value?e.value:0,()=>t):Ms[n];Object(p.o)("Unrecognized imputation method: "+n)}(e),g=function(e){var t=e.field;return e=>e?t(e):NaN}(e),m=Object(p.h)(e.field),v=Object(p.h)(e.key),b=(e.groupby||[]).map(p.h),y=function(e,t,n,i){var r,o,s,a,l,c,u,h,d=e=>e(h),f=[],p=i?i.slice():[],g={},m={};for(p.forEach((e,t)=>g[e]=t+1),a=0,u=e.length;a<u;++a)h=e[a],c=n(h),l=g[c]||(g[c]=p.push(c)),o=(r=t?t.map(d):js)+"",(s=m[o])||(s=m[o]=[],f.push(s),s.values=r),s[l-1]=h;return f.domain=p,f}(t.source,e.groupby,e.key,e.keyvals),w=[],x=this.value,k=y.domain.length;for(s=0,c=y.length;s<c;++s)for(r=(n=y[s]).values,i=NaN,l=0;l<k;++l)if(null==n[l]){for(o=y.domain[l],h={_impute:!0},a=0,u=r.length;a<u;++a)h[b[a]]=r[a];h[v]=o,h[m]=Number.isNaN(i)?i=f(n,g):i,w.push(_(h))}return w.length&&(d.add=d.materialize(d.ADD).add.concat(w)),x.length&&(d.rem=d.materialize(d.REM).rem.concat(x)),this.value=w,d}}),Ds.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Vr},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},Object(p.z)(Ds,is,{transform(e,t){let n,i=this,r=e.modified();return i.value&&(r||t.modified(i._inputs,!0))?(n=i.value=r?i.init(e):{},t.visit(t.SOURCE,e=>i.add(e))):(n=i.value=i.value||this.init(e),t.visit(t.REM,e=>i.rem(e)),t.visit(t.ADD,e=>i.add(e))),i.changes(),t.visit(t.SOURCE,e=>{Object(p.p)(e,n[i.cellkey(e)].tuple)}),t.reflow(r).modifies(this._outputs)},changes(){let e,t,n=this._adds,i=this._mods;for(e=0,t=this._alen;e<t;++e)this.celltuple(n[e]),n[e]=null;for(e=0,t=this._mlen;e<t;++e)this.celltuple(i[e]),i[e]=null;this._alen=this._mlen=0}}),Ts.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},Object(p.z)(Ts,Nr,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=ms(i,e.groupby,e.field),o=(e.groupby||[]).map(p.h),s=e.bandwidth,a=e.cumulative?"cdf":"pdf",l=e.as||["value","density"],c=[];let u=e.extent,h=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;"pdf"!==a&&"cdf"!==a&&Object(p.o)("Invalid density method: "+a),"shared"===e.resolve&&(u||(u=Object(p.q)(i,e.field)),h=d=e.steps||d),r.forEach(t=>{const n=Oo(t,s)[a],i=e.counts?t.length:1,r=u||Object(p.q)(t);Zo(n,r,h,d).forEach(e=>{const n={};for(let e=0;e<o.length;++e)n[o[e]]=t.dims[e];n[l[0]]=e[0],n[l[1]]=e[1]*i,c.push(_(n))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}}),Object(p.z)(Ls,R),Object(p.z)(Ns,Nr,{transform(e,t){const n=t.dataflow;if(this._pending)return Ps(this,t,this._pending);if(function(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}(e))return t.StopPropagation;if(e.values)return Ps(this,t,n.parse(e.values,e.format));if(e.async){return{async:n.request(e.url,e.format).then(e=>(this._pending=Object(p.i)(e.data),e=>e.touch(this)))}}return n.request(e.url,e.format).then(e=>Ps(this,t,Object(p.i)(e.data)))}}),zs.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},Object(p.z)(zs,Nr,{transform(e,t){let n,i,r,o=t,s=e.as,a=e.fields,l=e.index,c=e.values,u=null==e.default?null:e.default,h=e.modified(),d=h?t.SOURCE:t.ADD,f=a.length;return c?(i=c.length,f>1&&!s&&Object(p.o)('Multi-field lookup requires explicit "as" parameter.'),s&&s.length!==f*i&&Object(p.o)('The "as" parameter has too few output field names.'),s=s||c.map(p.h),n=function(e){for(var t,n,r=0,o=0;r<f;++r)if(null==(n=l.get(a[r](e))))for(t=0;t<i;++t,++o)e[s[o]]=u;else for(t=0;t<i;++t,++o)e[s[o]]=c[t](n)}):(s||Object(p.o)("Missing output field names."),n=function(e){for(var t,n=0;n<f;++n)t=l.get(a[n](e)),e[s[n]]=null==t?u:t}),h?o=t.reflow(!0):(r=a.some(e=>t.modified(e.fields)),d|=r?t.MOD:0),t.visit(d,n),o.modifies(s)}}),Object(p.z)(Is,R),Object(p.z)(Ws,R),Object(p.z)(Hs,Nr,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),qs.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:Vr,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},Object(p.z)(qs,is,{_transform:is.prototype.transform,transform(e,t){return this._transform(function(e,t){const n=e.field,i=e.value,r=("count"===e.op?"__count__":e.op)||"sum",o=Object(p.g)(n).concat(Object(p.g)(i)),s=function(e,t,n){const i={},r=[];return n.visit(n.SOURCE,t=>{const n=e(t);i[n]||(i[n]=1,r.push(n))}),r.sort(p.j),t?r.slice(0,t):r}(n,e.limit||0,t);t.changed()&&e.set("__pivot__",null,null,!0);return{key:e.key,groupby:e.groupby,ops:s.map((function(){return r})),fields:s.map((function(e){return function(e,t,n,i){return Object(p.f)(i=>t(i)===e?n(i):NaN,i,e+"")}(e,n,i,o)})),as:s.map((function(e){return e+""})),modified:e.modified.bind(e)}}(e,t),t)}}),Object(p.z)(Vs,_s,{transform(e,t){const n=e.subflow,i=e.field,r=e=>this.subflow(w(e),n,t,e);return(e.modified("field")||i&&t.modified(Object(p.g)(i)))&&Object(p.o)("PreFacet does not support field modification."),this.initTargets(),i?(t.visit(t.MOD,e=>{const t=r(e);i(e).forEach(e=>t.mod(e))}),t.visit(t.ADD,e=>{const t=r(e);i(e).forEach(e=>t.add(_(e)))}),t.visit(t.REM,e=>{const t=r(e);i(e).forEach(e=>t.rem(e))})):(t.visit(t.MOD,e=>r(e).mod(e)),t.visit(t.ADD,e=>r(e).add(e)),t.visit(t.REM,e=>r(e).rem(e))),t.clean()&&t.runAfter(()=>this.clean()),t}}),Gs.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},Object(p.z)(Gs,Nr,{transform(e,t){let n,i,r=e.fields,o=gs(e.fields,e.as||[]),s=r?(e,t)=>function(e,t,n,i){for(let r=0,o=n.length;r<o;++r)t[i[r]]=n[r](e);return t}(e,t,r,o):S;return this.value?i=this.value:(t=t.addAll(),i=this.value={}),n=t.fork(t.NO_SOURCE),t.visit(t.REM,e=>{const t=w(e);n.rem.push(i[t]),i[t]=null}),t.visit(t.ADD,e=>{const t=s(e,_({}));i[w(e)]=t,n.add.push(t)}),t.visit(t.MOD,e=>{n.mod.push(s(e,i[w(e)]))}),n}}),Object(p.z)(Ks,Nr,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});var Ys=function(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(r);++i<r;)o[i]=e+i*n;return o};function Xs(e){Nr.call(this,null,e)}Xs.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};function Js(e){Nr.call(this,null,e)}function Qs(e){Nr.call(this,[],e),this.count=0}function Zs(e){Nr.call(this,null,e)}function ea(e){Nr.call(this,null,e),this.modified(!0)}function ta(e){Nr.call(this,null,e)}Object(p.z)(Xs,Nr,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const r=ms(t.materialize(t.SOURCE).source,e.groupby,e.field),o=(e.groupby||[]).map(p.h),s=[],a=e.step||.01,l=e.probs||Ys(a/2,1-1e-14,a),c=l.length;return r.forEach(e=>{const t=so(e,l);for(let n=0;n<c;++n){const r={};for(let t=0;t<o.length;++t)r[o[t]]=e.dims[t];r[i[0]]=l[n],r[i[1]]=t[n],s.push(_(r))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=s,n}}),Object(p.z)(Js,Nr,{transform(e,t){let n,i;return this.value?i=this.value:(n=t=t.addAll(),i=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,e=>{const t=w(e);n.rem.push(i[t]),i[t]=null}),t.visit(t.ADD,e=>{const t=k(e);i[w(e)]=t,n.add.push(t)}),t.visit(t.MOD,e=>{const t=i[w(e)];for(const i in e)t[i]=e[i],n.modifies(i);n.mod.push(t)})),n}}),Qs.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},Object(p.z)(Qs,Nr,{transform(e,t){let n=t.fork(t.NO_SOURCE),i=e.modified("size"),r=e.size,o=this.value,s=this.count,a=0,l=o.reduce((e,t)=>(e[w(t)]=1,e),{});function c(e){let t,i;o.length<r?o.push(e):(i=~~((s+1)*uo()),i<o.length&&i>=a&&(t=o[i],l[w(t)]&&n.rem.push(t),o[i]=e)),++s}if(t.rem.length&&(t.visit(t.REM,e=>{const t=w(e);l[t]&&(l[t]=-1,n.rem.push(e)),--s}),o=o.filter(e=>-1!==l[w(e)])),(t.rem.length||i)&&o.length<r&&t.source&&(a=s=o.length,t.visit(t.SOURCE,e=>{l[w(e)]||c(e)}),a=-1),i&&o.length>r){const e=o.length-r;for(let t=0;t<e;++t)l[w(o[t])]=-1,n.rem.push(o[t]);o=o.slice(e)}return t.mod.length&&t.visit(t.MOD,e=>{l[w(e)]&&n.mod.push(e)}),t.add.length&&t.visit(t.ADD,c),(t.add.length||a<0)&&(n.add=o.filter(e=>!l[w(e)])),this.count=s,this.value=n.source=o,n}}),Zs.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},Object(p.z)(Zs,Nr,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),i=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Ys(e.start,e.stop,e.step||1).map(e=>{const t={};return t[i]=e,_(t)}),n.add=t.add.concat(this.value),n}}),Object(p.z)(ea,Nr,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});const na=["unit0","unit1"];function ia(e){Nr.call(this,Object(p.t)(),e)}function ra(e){Nr.call(this,null,e)}ta.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:st,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:na}]},Object(p.z)(ta,Nr,{transform(e,t){let n=e.field,i=!1!==e.interval,r="utc"===e.timezone,o=this._floor(e,t),s=(r?Cn:On)(o.unit).offset,a=e.as||na,l=a[0],c=a[1],u=o.start||1/0,h=o.stop||-1/0,d=o.step,f=t.ADD;return(e.modified()||t.modified(Object(p.g)(n)))&&(f=(t=t.reflow(!0)).SOURCE,u=1/0,h=-1/0),t.visit(f,e=>{let t,r,a=n(e);null==a?(e[l]=null,i&&(e[c]=null)):(e[l]=t=r=o(a),i&&(e[c]=r=s(t,d)),t<u&&(u=t),r>h&&(h=r))}),o.start=u,o.stop=h,t.modifies(i?a:l)},_floor(e,t){const n="utc"===e.timezone;let{units:i,step:r}=e.units?{units:e.units,step:e.step||1}:Un({extent:e.extent||Object(p.q)(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins});i=lt(i);const o=this.value||{},s=(n?tn:Qt)(i,r);return s.unit=Object(p.V)(i),s.units=i,s.step=r,s.start=o.start,s.stop=o.stop,this.value=s}}),Object(p.z)(ia,Nr,{transform(e,t){const n=t.dataflow,i=e.field,r=this.value,o=e=>r.set(i(e),e);let s=!0;return e.modified("field")||t.modified(i.fields)?(r.clear(),t.visit(t.SOURCE,o)):t.changed()?(t.visit(t.REM,e=>r.delete(i(e))),t.visit(t.ADD,o)):s=!1,this.modified(s),r.empty>n.cleanThreshold&&n.runAfter(r.clean),t.fork()}}),Object(p.z)(ra,Nr,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(C(e.sort)):t.source).map(e.field))}});const oa={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{let n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{let n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?++e:e}}},percent_rank:function(){let e=oa.rank(),t=e.next;return{init:e.init,next:e=>(t(e)-1)/(e.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{let n=t.index,i=t.data,r=t.compare;if(e<n){for(;n+1<i.length&&!r(i[n],i[n+1]);)++n;e=n}return(1+e)/i.length}}},ntile:function(e,t){(t=+t)>0||Object(p.o)("ntile num must be greater than zero.");let n=oa.cume_dist(),i=n.next;return{init:n.init,next:e=>Math.ceil(t*i(e))}},lag:function(e,t){return t=+t||1,{next:n=>{let i=n.index-t;return i>=0?e(n.data[i]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{let i=n.index+t,r=n.data;return i<r.length?e(r[i]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return(t=+t)>0||Object(p.o)("nth_value nth must be greater than zero."),{next:n=>{let i=n.i0+(t-1);return i<n.i1?e(n.data[i]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{let i=e(n.data[n.index]);return null!=i?t=i:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:i=>{let r=i.data;return i.index<=n?t:(n=function(e,t,n){for(let i=t.length;n<i;++n){if(null!=e(t[n]))return n}return-1}(e,r,i.index))<0?(n=r.length,t=null):t=e(r[n])}}}};const sa=Object.keys(oa);function aa(e){let t=this,n=Object(p.i)(e.ops),i=Object(p.i)(e.fields),r=Object(p.i)(e.params),o=Object(p.i)(e.as),s=t.outputs=[],a=t.windows=[],l={},c={},u=!0,h=[],d=[];function f(e){Object(p.i)(Object(p.g)(e)).forEach(e=>l[e]=1)}f(e.sort),n.forEach((function(e,t){let n=i[t],l=Object(p.h)(n),g=Wr(e,l,o[t]);if(f(n),s.push(g),Object(p.w)(oa,e))a.push(function(e,t,n,i){let r=oa[e](t,n);return{init:r.init||p.lb,update:function(e,t){t[i]=r.next(e)}}}(e,i[t],r[t],g));else{if(null==n&&"count"!==e&&Object(p.o)("Null aggregate field specified."),"count"===e)return void h.push(g);u=!1;let t=c[l];t||(t=c[l]=[],t.field=n,d.push(t)),t.push(Gr(e,g))}})),(h.length||d.length)&&(t.cell=function(e,t,n){e=e.map(e=>Zr(e,e.field));let i={num:0,agg:null,store:!1,count:t};if(!n)for(var r=e.length,o=i.agg=Array(r),s=0;s<r;++s)o[s]=new e[s](i);if(i.store)var a=i.data=new ts;return i.add=function(e){if(i.num+=1,!n){a&&a.add(e);for(let t=0;t<r;++t)o[t].add(o[t].get(e),e)}},i.rem=function(e){if(i.num-=1,!n){a&&a.rem(e);for(let t=0;t<r;++t)o[t].rem(o[t].get(e),e)}},i.set=function(e){let r,s;for(a&&a.values(),r=0,s=t.length;r<s;++r)e[t[r]]=i.num;if(!n)for(r=0,s=o.length;r<s;++r)o[r].set(e)},i.init=function(){i.num=0,a&&a.reset();for(let e=0;e<r;++e)o[e].init()},i}(d,h,u)),t.inputs=Object.keys(l)}const la=aa.prototype;function ca(e){Nr.call(this,{},e),this._mlen=0,this._mods=[]}function ua(e,t,n,i){const r=i.sort,o=r&&!i.ignorePeers,s=i.frame||[null,0],a=e.data(n),l=a.length,c=o?Tn(r):null,u={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:r||Object(p.m)(-1)};t.init();for(let e=0;e<l;++e)ha(u,s,e,l),o&&da(u,c),t.update(u,a[e])}function ha(e,t,n,i){e.p0=e.i0,e.p1=e.i1,e.i0=null==t[0]?0:Math.max(0,n-Math.abs(t[0])),e.i1=null==t[1]?i:Math.min(i,n+Math.abs(t[1])+1),e.index=n}function da(e,t){const n=e.i0,i=e.i1-1,r=e.compare,o=e.data,s=o.length-1;n>0&&!r(o[n],o[n-1])&&(e.i0=t.left(o,o[n])),i<s&&!r(o[i],o[i+1])&&(e.i1=t.right(o,o[i]))}la.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()},la.update=function(e,t){let n,i=this.cell,r=this.windows,o=e.data,s=r&&r.length;if(i){for(n=e.p0;n<e.i0;++n)i.rem(o[n]);for(n=e.p1;n<e.i1;++n)i.add(o[n]);i.set(t)}for(n=0;n<s;++n)r[n].update(e,t)},ca.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:sa.concat(Vr)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},Object(p.z)(ca,Nr,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),i=C(e.sort),r=Br(e.groupby),o=e=>this.group(r(e));let s=this.state;s&&!n||(s=this.state=new aa(e)),n||t.modified(s.inputs)?(this.value={},t.visit(t.SOURCE,e=>o(e).add(e))):(t.visit(t.REM,e=>o(e).remove(e)),t.visit(t.ADD,e=>o(e).add(e)));for(let t=0,n=this._mlen;t<n;++t)ua(this._mods[t],s,i,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(s.outputs)},group(e){let t=this,n=t.value[e];return n||(n=t.value[e]=os(w),n.stamp=-1),n.stamp<t.stamp&&(n.stamp=t.stamp,t._mods[t._mlen++]=n),n}});const fa="top",pa="left",ga="right",ma="end",va="row";var ba=0;function ya(e){return e&&e.gradient}function wa(e,t,n){let i=e.id,r=e.gradient,o="radial"===r?"p_":"";return i||(i=e.id="gradient_"+ba++,"radial"===r?(e.x1=xa(e.x1,.5),e.y1=xa(e.y1,.5),e.r1=xa(e.r1,0),e.x2=xa(e.x2,.5),e.y2=xa(e.y2,.5),e.r2=xa(e.r2,.5),o="p_"):(e.x1=xa(e.x1,0),e.y1=xa(e.y1,0),e.x2=xa(e.x2,1),e.y2=xa(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+o+i+")"}function xa(e,t){return null!=e?e:t}var _a=function(e,t){var n,i=[];return n={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:i,stop:function(e,t){return i.push({offset:e,color:t}),n}}};function ka(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Sa(e){this._context=e}Sa.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ka(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ka(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};var Oa=function(e){return new Sa(e)},Ca=function(){};function Aa(e){this._context=e}Aa.prototype={areaStart:Ca,areaEnd:Ca,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:ka(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};var $a=function(e){return new Aa(e)};function Ea(e){this._context=e}Ea.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:ka(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};var Ma=function(e){return new Ea(e)};function ja(e,t){this._basis=new Sa(e),this._beta=t}ja.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var i,r=e[0],o=t[0],s=e[n]-r,a=t[n]-o,l=-1;++l<=n;)i=l/n,this._basis.point(this._beta*e[l]+(1-this._beta)*(r+i*s),this._beta*t[l]+(1-this._beta)*(o+i*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var Ra=function e(t){function n(e){return 1===t?new Sa(e):new ja(e,t)}return n.beta=function(t){return e(+t)},n}(.85);function Da(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Ta(e,t){this._context=e,this._k=(1-t)/6}Ta.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Da(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Da(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var La=function e(t){function n(e){return new Ta(e,t)}return n.tension=function(t){return e(+t)},n}(0);function Fa(e,t){this._context=e,this._k=(1-t)/6}Fa.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Da(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Na=function e(t){function n(e){return new Fa(e,t)}return n.tension=function(t){return e(+t)},n}(0);function Pa(e,t){this._context=e,this._k=(1-t)/6}Pa.prototype={areaStart:Ca,areaEnd:Ca,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Da(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var za=function e(t){function n(e){return new Pa(e,t)}return n.tension=function(t){return e(+t)},n}(0),Ia=Math.abs,Ba=Math.atan2,Wa=Math.cos,Ua=Math.max,Ha=Math.min,qa=Math.sin,Va=Math.sqrt,Ga=Math.PI,Ka=Ga/2,Ya=2*Ga;function Xa(e){return e>1?0:e<-1?Ga:Math.acos(e)}function Ja(e){return e>=1?Ka:e<=-1?-Ka:Math.asin(e)}function Qa(e,t,n){var i=e._x1,r=e._y1,o=e._x2,s=e._y2;if(e._l01_a>1e-12){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);i=(i*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,r=(r*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>1e-12){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*c+e._x1*e._l23_2a-t*e._l12_2a)/u,s=(s*c+e._y1*e._l23_2a-n*e._l12_2a)/u}e._context.bezierCurveTo(i,r,o,s,e._x2,e._y2)}function Za(e,t){this._context=e,this._alpha=t}Za.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Qa(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var el=function e(t){function n(e){return t?new Za(e,t):new Ta(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function tl(e,t){this._context=e,this._alpha=t}tl.prototype={areaStart:Ca,areaEnd:Ca,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Qa(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var nl=function e(t){function n(e){return t?new tl(e,t):new Pa(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function il(e,t){this._context=e,this._alpha=t}il.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Qa(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var rl=function e(t){function n(e){return t?new il(e,t):new Fa(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function ol(e){this._context=e}ol.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var sl=function(e){return new ol(e)};function al(e){this._context=e}al.prototype={areaStart:Ca,areaEnd:Ca,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};var ll=function(e){return new al(e)};function cl(e){return e<0?-1:1}function ul(e,t,n){var i=e._x1-e._x0,r=t-e._x1,o=(e._y1-e._y0)/(i||r<0&&-0),s=(n-e._y1)/(r||i<0&&-0),a=(o*r+s*i)/(i+r);return(cl(o)+cl(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function hl(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function dl(e,t,n){var i=e._x0,r=e._y0,o=e._x1,s=e._y1,a=(o-i)/3;e._context.bezierCurveTo(i+a,r+a*t,o-a,s-a*n,o,s)}function fl(e){this._context=e}function pl(e){this._context=new gl(e)}function gl(e){this._context=e}function ml(e){return new fl(e)}function vl(e){return new pl(e)}function bl(e){this._context=e}function yl(e){var t,n,i=e.length-1,r=new Array(i),o=new Array(i),s=new Array(i);for(r[0]=0,o[0]=2,s[0]=e[0]+2*e[1],t=1;t<i-1;++t)r[t]=1,o[t]=4,s[t]=4*e[t]+2*e[t+1];for(r[i-1]=2,o[i-1]=7,s[i-1]=8*e[i-1]+e[i],t=1;t<i;++t)n=r[t]/o[t-1],o[t]-=n,s[t]-=n*s[t-1];for(r[i-1]=s[i-1]/o[i-1],t=i-2;t>=0;--t)r[t]=(s[t]-r[t+1])/o[t];for(o[i-1]=(e[i]+r[i-1])/2,t=0;t<i-1;++t)o[t]=2*e[t+1]-r[t+1];return[r,o]}fl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:dl(this,this._t0,hl(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,dl(this,hl(this,n=ul(this,e,t)),n);break;default:dl(this,this._t0,n=ul(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(pl.prototype=Object.create(fl.prototype)).point=function(e,t){fl.prototype.point.call(this,t,e)},gl.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,r,o){this._context.bezierCurveTo(t,e,i,n,o,r)}},bl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var i=yl(e),r=yl(t),o=0,s=1;s<n;++o,++s)this._context.bezierCurveTo(i[0][o],r[0][o],i[1][o],r[1][o],e[s],t[s]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var wl=function(e){return new bl(e)};function xl(e,t){this._context=e,this._t=t}xl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};var _l=function(e){return new xl(e,.5)};function kl(e){return new xl(e,0)}function Sl(e){return new xl(e,1)}const Ol={basis:{curve:Oa},"basis-closed":{curve:$a},"basis-open":{curve:Ma},bundle:{curve:Ra,tension:"beta",value:.85},cardinal:{curve:La,tension:"tension",value:0},"cardinal-open":{curve:Na,tension:"tension",value:0},"cardinal-closed":{curve:za,tension:"tension",value:0},"catmull-rom":{curve:el,tension:"alpha",value:.5},"catmull-rom-closed":{curve:nl,tension:"alpha",value:.5},"catmull-rom-open":{curve:rl,tension:"alpha",value:.5},linear:{curve:sl},"linear-closed":{curve:ll},monotone:{horizontal:vl,vertical:ml},natural:{curve:wl},step:{curve:_l},"step-after":{curve:Sl},"step-before":{curve:kl}};function Cl(e,t,n){var i=Object(p.w)(Ol,e)&&Ol[e],r=null;return i&&(r=i.curve||i[t||"vertical"],i.tension&&null!=n&&(r=r[i.tension](n))),r}const Al={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},$l=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];var El=function(e){let t,n,i,r,o,s,a,l,c,u,h,d=[];for(t=e.slice().replace($l[0],"###$1").split($l[1]).slice(1),l=0,u=t.length;l<u;++l){for(n=t[l],i=n.slice(1).trim().replace($l[2],"$1###$2").replace($l[3],"$1###$2").split($l[4]),s=n.charAt(0),r=[s],c=0,h=i.length;c<h;++c)(o=+i[c])===o&&r.push(o);if(a=Al[s.toLowerCase()],r.length-1>a){let e=1,t=r.length;for(d.push([s].concat(r.slice(e,e+=a))),s="M"===s?"L":"m"===s?"l":s;e<t;e+=a)d.push([s].concat(r.slice(e,e+a)))}else d.push(r)}return d};const Ml=Math.PI/180,jl=Math.PI/2,Rl=2*Math.PI,Dl=Math.sqrt(3)/2;var Tl={},Ll={},Fl=[].join;function Nl(e){var t=Fl.call(e);if(Ll[t])return Ll[t];var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=c*s,h=-l*a,d=l*s,f=c*a,p=Math.cos(r),g=Math.sin(r),m=Math.cos(o),v=Math.sin(o),b=.5*(o-r),y=Math.sin(.5*b),w=8/3*y*y/Math.sin(b),x=n+p-w*g,_=i+g+w*p,k=n+m,S=i+v,O=k+w*v,C=S-w*m;return Ll[t]=[u*x+h*_,d*x+f*_,u*O+h*C,d*O+f*C,u*k+h*S,d*k+f*S]}var Pl=["l",0,0,0,0,0,0,0];function zl(e,t,n){var i=Pl[0]=e[0];if("a"===i||"A"===i)Pl[1]=t*e[1],Pl[2]=n*e[2],Pl[3]=e[3],Pl[4]=e[4],Pl[5]=e[5],Pl[6]=t*e[6],Pl[7]=n*e[7];else if("h"===i||"H"===i)Pl[1]=t*e[1];else if("v"===i||"V"===i)Pl[1]=n*e[1];else for(var r=1,o=e.length;r<o;++r)Pl[r]=(r%2==1?t:n)*e[r];return Pl}var Il=function(e,t,n,i,r,o){var s,a,l,c,u,h=null,d=0,f=0,p=0,g=0;null==n&&(n=0),null==i&&(i=0),null==r&&(r=1),null==o&&(o=r),e.beginPath&&e.beginPath();for(var m=0,v=t.length;m<v;++m){switch(s=t[m],1===r&&1===o||(s=zl(s,r,o)),s[0]){case"l":d+=s[1],f+=s[2],e.lineTo(d+n,f+i);break;case"L":d=s[1],f=s[2],e.lineTo(d+n,f+i);break;case"h":d+=s[1],e.lineTo(d+n,f+i);break;case"H":d=s[1],e.lineTo(d+n,f+i);break;case"v":f+=s[1],e.lineTo(d+n,f+i);break;case"V":f=s[1],e.lineTo(d+n,f+i);break;case"m":d+=s[1],f+=s[2],e.moveTo(d+n,f+i);break;case"M":d=s[1],f=s[2],e.moveTo(d+n,f+i);break;case"c":a=d+s[5],l=f+s[6],p=d+s[3],g=f+s[4],e.bezierCurveTo(d+s[1]+n,f+s[2]+i,p+n,g+i,a+n,l+i),d=a,f=l;break;case"C":d=s[5],f=s[6],p=s[3],g=s[4],e.bezierCurveTo(s[1]+n,s[2]+i,p+n,g+i,d+n,f+i);break;case"s":a=d+s[3],l=f+s[4],p=2*d-p,g=2*f-g,e.bezierCurveTo(p+n,g+i,d+s[1]+n,f+s[2]+i,a+n,l+i),p=d+s[1],g=f+s[2],d=a,f=l;break;case"S":a=s[3],l=s[4],p=2*d-p,g=2*f-g,e.bezierCurveTo(p+n,g+i,s[1]+n,s[2]+i,a+n,l+i),d=a,f=l,p=s[1],g=s[2];break;case"q":a=d+s[3],l=f+s[4],p=d+s[1],g=f+s[2],e.quadraticCurveTo(p+n,g+i,a+n,l+i),d=a,f=l;break;case"Q":a=s[3],l=s[4],e.quadraticCurveTo(s[1]+n,s[2]+i,a+n,l+i),d=a,f=l,p=s[1],g=s[2];break;case"t":a=d+s[1],l=f+s[2],null===h[0].match(/[QqTt]/)?(p=d,g=f):"t"===h[0]?(p=2*d-c,g=2*f-u):"q"===h[0]&&(p=2*d-p,g=2*f-g),c=p,u=g,e.quadraticCurveTo(p+n,g+i,a+n,l+i),f=l,p=(d=a)+s[1],g=f+s[2];break;case"T":a=s[1],l=s[2],p=2*d-p,g=2*f-g,e.quadraticCurveTo(p+n,g+i,a+n,l+i),d=a,f=l;break;case"a":Bl(e,d+n,f+i,[s[1],s[2],s[3],s[4],s[5],s[6]+d+n,s[7]+f+i]),d+=s[6],f+=s[7];break;case"A":Bl(e,d+n,f+i,[s[1],s[2],s[3],s[4],s[5],s[6]+n,s[7]+i]),d=s[6],f=s[7];break;case"z":case"Z":e.closePath()}h=s}};function Bl(e,t,n,i){for(var r=function(e,t,n,i,r,o,s,a,l){var c=Fl.call(arguments);if(Tl[c])return Tl[c];var u=s*Ml,h=Math.sin(u),d=Math.cos(u),f=d*(a-e)*.5+h*(l-t)*.5,p=d*(l-t)*.5-h*(a-e)*.5,g=f*f/((n=Math.abs(n))*n)+p*p/((i=Math.abs(i))*i);g>1&&(n*=g=Math.sqrt(g),i*=g);var m=d/n,v=h/n,b=-h/i,y=d/i,w=m*a+v*l,x=b*a+y*l,_=m*e+v*t,k=b*e+y*t,S=(_-w)*(_-w)+(k-x)*(k-x),O=1/S-.25;O<0&&(O=0);var C=Math.sqrt(O);o==r&&(C=-C);var A=.5*(w+_)-C*(k-x),$=.5*(x+k)+C*(_-w),E=Math.atan2(x-$,w-A),M=Math.atan2(k-$,_-A),j=M-E;j<0&&1===o?j+=Rl:j>0&&0===o&&(j-=Rl);for(var R=Math.ceil(Math.abs(j/(jl+.001))),D=[],T=0;T<R;++T){var L=E+T*j/R,F=E+(T+1)*j/R;D[T]=[A,$,L,F,n,i,h,d]}return Tl[c]=D}(i[5],i[6],i[0],i[1],i[3],i[4],i[2],t,n),o=0;o<r.length;++o){var s=Nl(r[o]);e.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5])}}var Wl=.5773502691896257,Ul={circle:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Rl)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/2.5;e.moveTo(-n,-i),e.lineTo(-n,i),e.lineTo(-i,i),e.lineTo(-i,n),e.lineTo(i,n),e.lineTo(i,i),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(i,-i),e.lineTo(i,-n),e.lineTo(-i,-n),e.lineTo(-i,-i),e.closePath()}},diamond:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),i=-n/2;e.rect(i,i,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/7,r=n/2.5,o=n/8;e.moveTo(-i,n),e.lineTo(i,n),e.lineTo(i,-o),e.lineTo(r,-o),e.lineTo(0,-n),e.lineTo(-r,-o),e.lineTo(-i,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,i=Dl*n,r=i-n*Wl,o=n/4;e.moveTo(0,-i-r),e.lineTo(-o,i-r),e.lineTo(o,i-r),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,i=Dl*n,r=i-n*Wl;e.moveTo(0,-i-r),e.lineTo(-n,i-r),e.lineTo(n,i-r),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Dl*n;e.moveTo(0,-i),e.lineTo(-n,i),e.lineTo(n,i),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Dl*n;e.moveTo(0,i),e.lineTo(-n,-i),e.lineTo(n,-i),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Dl*n;e.moveTo(i,0),e.lineTo(-i,-n),e.lineTo(-i,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Dl*n;e.moveTo(-i,0),e.lineTo(i,-n),e.lineTo(i,n),e.closePath()}},stroke:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function Hl(e){return Object(p.w)(Ul,e)?Ul[e]:function(e){if(!Object(p.w)(ql,e)){var t=El(e);ql[e]={draw:function(e,n){Il(e,t,0,0,Math.sqrt(n)/2)}}}return ql[e]}(e)}var ql={};var Vl=Math.PI,Gl=2*Vl,Kl=Gl-1e-6;function Yl(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Xl(){return new Yl}Yl.prototype=Xl.prototype={constructor:Yl,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,i){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(e,t,n,i,r,o){this._+="C"+ +e+","+ +t+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(e,t,n,i,r){e=+e,t=+t,n=+n,i=+i,r=+r;var o=this._x1,s=this._y1,a=n-e,l=i-t,c=o-e,u=s-t,h=c*c+u*u;if(r<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(h>1e-6)if(Math.abs(u*a-l*c)>1e-6&&r){var d=n-o,f=i-s,p=a*a+l*l,g=d*d+f*f,m=Math.sqrt(p),v=Math.sqrt(h),b=r*Math.tan((Vl-Math.acos((p+h-g)/(2*m*v)))/2),y=b/v,w=b/m;Math.abs(y-1)>1e-6&&(this._+="L"+(e+y*c)+","+(t+y*u)),this._+="A"+r+","+r+",0,0,"+ +(u*d>c*f)+","+(this._x1=e+w*a)+","+(this._y1=t+w*l)}else this._+="L"+(this._x1=e)+","+(this._y1=t);else;},arc:function(e,t,n,i,r,o){e=+e,t=+t,o=!!o;var s=(n=+n)*Math.cos(i),a=n*Math.sin(i),l=e+s,c=t+a,u=1^o,h=o?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-c)>1e-6)&&(this._+="L"+l+","+c),n&&(h<0&&(h=h%Gl+Gl),h>Kl?this._+="A"+n+","+n+",0,1,"+u+","+(e-s)+","+(t-a)+"A"+n+","+n+",0,1,"+u+","+(this._x1=l)+","+(this._y1=c):h>1e-6&&(this._+="A"+n+","+n+",0,"+ +(h>=Vl)+","+u+","+(this._x1=e+n*Math.cos(r))+","+(this._y1=t+n*Math.sin(r))))},rect:function(e,t,n,i){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};var Jl=Xl;const Ql=.448084975506;function Zl(e){return e.x}function ec(e){return e.y}function tc(e){return e.width}function nc(e){return e.height}function ic(e){return"function"==typeof e?e:()=>+e}function rc(e,t,n){return Math.max(t,Math.min(e,n))}var oc=function(){var e=Zl,t=ec,n=tc,i=nc,r=ic(0),o=r,s=r,a=r,l=null;function c(c,u,h){var d,f=null!=u?u:+e.call(this,c),p=null!=h?h:+t.call(this,c),g=+n.call(this,c),m=+i.call(this,c),v=Math.min(g,m)/2,b=rc(+r.call(this,c),0,v),y=rc(+o.call(this,c),0,v),w=rc(+s.call(this,c),0,v),x=rc(+a.call(this,c),0,v);if(l||(l=d=Jl()),b<=0&&y<=0&&w<=0&&x<=0)l.rect(f,p,g,m);else{var _=f+g,k=p+m;l.moveTo(f+b,p),l.lineTo(_-y,p),l.bezierCurveTo(_-Ql*y,p,_,p+Ql*y,_,p+y),l.lineTo(_,k-x),l.bezierCurveTo(_,k-Ql*x,_-Ql*x,k,_-x,k),l.lineTo(f+w,k),l.bezierCurveTo(f+Ql*w,k,f,k-Ql*w,f,k-w),l.lineTo(f,p+b),l.bezierCurveTo(f,p+Ql*b,f+Ql*b,p,f+b,p),l.closePath()}if(d)return l=null,d+""||null}return c.x=function(t){return arguments.length?(e=ic(t),c):e},c.y=function(e){return arguments.length?(t=ic(e),c):t},c.width=function(e){return arguments.length?(n=ic(e),c):n},c.height=function(e){return arguments.length?(i=ic(e),c):i},c.cornerRadius=function(e,t,n,i){return arguments.length?(r=ic(e),o=null!=t?ic(t):r,a=null!=n?ic(n):r,s=null!=i?ic(i):o,c):r},c.context=function(e){return arguments.length?(l=null==e?null:e,c):l},c},sc=function(){var e,t,n,i,r,o,s,a,l=null;function c(e,t,n){var i=n/2;if(r){var c=s-t,u=e-o;if(c||u){var h=Math.sqrt(c*c+u*u),d=(c/=h)*a,f=(u/=h)*a,p=Math.atan2(u,c);l.moveTo(o-d,s-f),l.lineTo(e-c*i,t-u*i),l.arc(e,t,i,p-Math.PI,p),l.lineTo(o+d,s+f),l.arc(o,s,a,p,p+Math.PI)}else l.arc(e,t,i,0,Rl);l.closePath()}else r=1;o=e,s=t,a=i}function u(o){var s,a,u,h=o.length,d=!1;for(null==l&&(l=u=Jl()),s=0;s<=h;++s)!(s<h&&i(a=o[s],s,o))===d&&(d=!d)&&(r=0),d&&c(+e(a,s,o),+t(a,s,o),+n(a,s,o));if(u)return l=null,u+""||null}return u.x=function(t){return arguments.length?(e=t,u):e},u.y=function(e){return arguments.length?(t=e,u):t},u.size=function(e){return arguments.length?(n=e,u):n},u.defined=function(e){return arguments.length?(i=e,u):i},u.context=function(e){return arguments.length?(l=null==e?null:e,u):l},u},ac=function(e){return function(){return e}};function lc(e){return e.innerRadius}function cc(e){return e.outerRadius}function uc(e){return e.startAngle}function hc(e){return e.endAngle}function dc(e){return e&&e.padAngle}function fc(e,t,n,i,r,o,s,a){var l=n-e,c=i-t,u=s-r,h=a-o,d=h*l-u*c;if(!(d*d<1e-12))return[e+(d=(u*(t-o)-h*(e-r))/d)*l,t+d*c]}function pc(e,t,n,i,r,o,s){var a=e-n,l=t-i,c=(s?o:-o)/Va(a*a+l*l),u=c*l,h=-c*a,d=e+u,f=t+h,p=n+u,g=i+h,m=(d+p)/2,v=(f+g)/2,b=p-d,y=g-f,w=b*b+y*y,x=r-o,_=d*g-p*f,k=(y<0?-1:1)*Va(Ua(0,x*x*w-_*_)),S=(_*y-b*k)/w,O=(-_*b-y*k)/w,C=(_*y+b*k)/w,A=(-_*b+y*k)/w,$=S-m,E=O-v,M=C-m,j=A-v;return $*$+E*E>M*M+j*j&&(S=C,O=A),{cx:S,cy:O,x01:-u,y01:-h,x11:S*(r/x-1),y11:O*(r/x-1)}}var gc=function(){var e=lc,t=cc,n=ac(0),i=null,r=uc,o=hc,s=dc,a=null;function l(){var l,c,u=+e.apply(this,arguments),h=+t.apply(this,arguments),d=r.apply(this,arguments)-Ka,f=o.apply(this,arguments)-Ka,p=Ia(f-d),g=f>d;if(a||(a=l=Jl()),h<u&&(c=h,h=u,u=c),h>1e-12)if(p>Ya-1e-12)a.moveTo(h*Wa(d),h*qa(d)),a.arc(0,0,h,d,f,!g),u>1e-12&&(a.moveTo(u*Wa(f),u*qa(f)),a.arc(0,0,u,f,d,g));else{var m,v,b=d,y=f,w=d,x=f,_=p,k=p,S=s.apply(this,arguments)/2,O=S>1e-12&&(i?+i.apply(this,arguments):Va(u*u+h*h)),C=Ha(Ia(h-u)/2,+n.apply(this,arguments)),A=C,$=C;if(O>1e-12){var E=Ja(O/u*qa(S)),M=Ja(O/h*qa(S));(_-=2*E)>1e-12?(w+=E*=g?1:-1,x-=E):(_=0,w=x=(d+f)/2),(k-=2*M)>1e-12?(b+=M*=g?1:-1,y-=M):(k=0,b=y=(d+f)/2)}var j=h*Wa(b),R=h*qa(b),D=u*Wa(x),T=u*qa(x);if(C>1e-12){var L,F=h*Wa(y),N=h*qa(y),P=u*Wa(w),z=u*qa(w);if(p<Ga&&(L=fc(j,R,P,z,F,N,D,T))){var I=j-L[0],B=R-L[1],W=F-L[0],U=N-L[1],H=1/qa(Xa((I*W+B*U)/(Va(I*I+B*B)*Va(W*W+U*U)))/2),q=Va(L[0]*L[0]+L[1]*L[1]);A=Ha(C,(u-q)/(H-1)),$=Ha(C,(h-q)/(H+1))}}k>1e-12?$>1e-12?(m=pc(P,z,j,R,h,$,g),v=pc(F,N,D,T,h,$,g),a.moveTo(m.cx+m.x01,m.cy+m.y01),$<C?a.arc(m.cx,m.cy,$,Ba(m.y01,m.x01),Ba(v.y01,v.x01),!g):(a.arc(m.cx,m.cy,$,Ba(m.y01,m.x01),Ba(m.y11,m.x11),!g),a.arc(0,0,h,Ba(m.cy+m.y11,m.cx+m.x11),Ba(v.cy+v.y11,v.cx+v.x11),!g),a.arc(v.cx,v.cy,$,Ba(v.y11,v.x11),Ba(v.y01,v.x01),!g))):(a.moveTo(j,R),a.arc(0,0,h,b,y,!g)):a.moveTo(j,R),u>1e-12&&_>1e-12?A>1e-12?(m=pc(D,T,F,N,u,-A,g),v=pc(j,R,P,z,u,-A,g),a.lineTo(m.cx+m.x01,m.cy+m.y01),A<C?a.arc(m.cx,m.cy,A,Ba(m.y01,m.x01),Ba(v.y01,v.x01),!g):(a.arc(m.cx,m.cy,A,Ba(m.y01,m.x01),Ba(m.y11,m.x11),!g),a.arc(0,0,u,Ba(m.cy+m.y11,m.cx+m.x11),Ba(v.cy+v.y11,v.cx+v.x11),g),a.arc(v.cx,v.cy,A,Ba(v.y11,v.x11),Ba(v.y01,v.x01),!g))):a.arc(0,0,u,x,w,g):a.lineTo(D,T)}else a.moveTo(0,0);if(a.closePath(),l)return a=null,l+""||null}return l.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,i=(+r.apply(this,arguments)+ +o.apply(this,arguments))/2-Ga/2;return[Wa(i)*n,qa(i)*n]},l.innerRadius=function(t){return arguments.length?(e="function"==typeof t?t:ac(+t),l):e},l.outerRadius=function(e){return arguments.length?(t="function"==typeof e?e:ac(+e),l):t},l.cornerRadius=function(e){return arguments.length?(n="function"==typeof e?e:ac(+e),l):n},l.padRadius=function(e){return arguments.length?(i=null==e?null:"function"==typeof e?e:ac(+e),l):i},l.startAngle=function(e){return arguments.length?(r="function"==typeof e?e:ac(+e),l):r},l.endAngle=function(e){return arguments.length?(o="function"==typeof e?e:ac(+e),l):o},l.padAngle=function(e){return arguments.length?(s="function"==typeof e?e:ac(+e),l):s},l.context=function(e){return arguments.length?(a=null==e?null:e,l):a},l};function mc(e){return e[0]}function vc(e){return e[1]}var bc=function(){var e=mc,t=vc,n=ac(!0),i=null,r=sl,o=null;function s(s){var a,l,c,u=s.length,h=!1;for(null==i&&(o=r(c=Jl())),a=0;a<=u;++a)!(a<u&&n(l=s[a],a,s))===h&&((h=!h)?o.lineStart():o.lineEnd()),h&&o.point(+e(l,a,s),+t(l,a,s));if(c)return o=null,c+""||null}return s.x=function(t){return arguments.length?(e="function"==typeof t?t:ac(+t),s):e},s.y=function(e){return arguments.length?(t="function"==typeof e?e:ac(+e),s):t},s.defined=function(e){return arguments.length?(n="function"==typeof e?e:ac(!!e),s):n},s.curve=function(e){return arguments.length?(r=e,null!=i&&(o=r(i)),s):r},s.context=function(e){return arguments.length?(null==e?i=o=null:o=r(i=e),s):i},s},yc=function(){var e=mc,t=null,n=ac(0),i=vc,r=ac(!0),o=null,s=sl,a=null;function l(l){var c,u,h,d,f,p=l.length,g=!1,m=new Array(p),v=new Array(p);for(null==o&&(a=s(f=Jl())),c=0;c<=p;++c){if(!(c<p&&r(d=l[c],c,l))===g)if(g=!g)u=c,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),h=c-1;h>=u;--h)a.point(m[h],v[h]);a.lineEnd(),a.areaEnd()}g&&(m[c]=+e(d,c,l),v[c]=+n(d,c,l),a.point(t?+t(d,c,l):m[c],i?+i(d,c,l):v[c]))}if(f)return a=null,f+""||null}function c(){return bc().defined(r).curve(s).context(o)}return l.x=function(n){return arguments.length?(e="function"==typeof n?n:ac(+n),t=null,l):e},l.x0=function(t){return arguments.length?(e="function"==typeof t?t:ac(+t),l):e},l.x1=function(e){return arguments.length?(t=null==e?null:"function"==typeof e?e:ac(+e),l):t},l.y=function(e){return arguments.length?(n="function"==typeof e?e:ac(+e),i=null,l):n},l.y0=function(e){return arguments.length?(n="function"==typeof e?e:ac(+e),l):n},l.y1=function(e){return arguments.length?(i=null==e?null:"function"==typeof e?e:ac(+e),l):i},l.lineX0=l.lineY0=function(){return c().x(e).y(n)},l.lineY1=function(){return c().x(e).y(i)},l.lineX1=function(){return c().x(t).y(n)},l.defined=function(e){return arguments.length?(r="function"==typeof e?e:ac(!!e),l):r},l.curve=function(e){return arguments.length?(s=e,null!=o&&(a=s(o)),l):s},l.context=function(e){return arguments.length?(null==e?o=a=null:a=s(o=e),l):o},l},wc={draw:function(e,t){var n=Math.sqrt(t/Ga);e.moveTo(n,0),e.arc(0,0,n,0,Ya)}},xc=(Math.sqrt(1/3),Math.sin(Ga/10)/Math.sin(7*Ga/10)),_c=(Math.sin(Ya/10),Math.cos(Ya/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12),function(){var e=ac(wc),t=ac(64),n=null;function i(){var i;if(n||(n=i=Jl()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return i.type=function(t){return arguments.length?(e="function"==typeof t?t:ac(t),i):e},i.size=function(e){return arguments.length?(t="function"==typeof e?e:ac(+e),i):t},i.context=function(e){return arguments.length?(n=null==e?null:e,i):n},i});function kc(e,t){return null!=e?e:t}const Sc=e=>e.x||0,Oc=e=>e.y||0,Cc=e=>!(!1===e.defined),Ac=gc().startAngle(e=>e.startAngle||0).endAngle(e=>e.endAngle||0).padAngle(e=>e.padAngle||0).innerRadius(e=>e.innerRadius||0).outerRadius(e=>e.outerRadius||0).cornerRadius(e=>e.cornerRadius||0),$c=yc().x(Sc).y1(Oc).y0(e=>(e.y||0)+(e.height||0)).defined(Cc),Ec=yc().y(Oc).x1(Sc).x0(e=>(e.x||0)+(e.width||0)).defined(Cc),Mc=bc().x(Sc).y(Oc).defined(Cc),jc=oc().x(Sc).y(Oc).width(e=>e.width||0).height(e=>e.height||0).cornerRadius(e=>kc(e.cornerRadiusTopLeft,e.cornerRadius)||0,e=>kc(e.cornerRadiusTopRight,e.cornerRadius)||0,e=>kc(e.cornerRadiusBottomRight,e.cornerRadius)||0,e=>kc(e.cornerRadiusBottomLeft,e.cornerRadius)||0),Rc=_c().type(e=>Hl(e.shape||"circle")).size(e=>kc(e.size,64)),Dc=sc().x(Sc).y(Oc).defined(Cc).size(e=>e.size||1);function Tc(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function Lc(e,t,n,i){return jc.context(e)(t,n,i)}var Fc=1;function Nc(){Fc=1}var Pc=function(e,t,n){var i=t.clip,r=e._defs,o=t.clip_id||(t.clip_id="clip"+Fc++),s=r.clipping[o]||(r.clipping[o]={id:o});return Object(p.E)(i)?s.path=i(null):Tc(n)?s.path=Lc(null,n,0,0):(s.width=n.width||0,s.height=n.height||0),"url(#"+o+")"};function zc(e){this.clear(),e&&this.union(e)}function Ic(e){this.mark=e,this.bounds=this.bounds||new zc}function Bc(e){Ic.call(this,e),this.items=this.items||[]}function Wc(e,t){if("undefined"!=typeof document&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}zc.prototype={clone(){return new zc(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const i=this.rotatedPoints(e,t,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(e,t,n){var{x1:i,y1:r,x2:o,y2:s}=this,a=Math.cos(e),l=Math.sin(e),c=t-t*a+n*l,u=n-t*l-n*a;return[a*i-l*r+c,l*i+a*r+u,a*i-l*s+c,l*i+a*s+u,a*o-l*r+c,l*o+a*r+u,a*o-l*s+c,l*o+a*s+u]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},Object(p.z)(Bc,Ic);const Uc=()=>"undefined"!=typeof Image?Image:null,Hc=/^([A-Za-z]+:)?\/\//,qc=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Vc=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g;async function Gc(e,t){const n=await this.sanitize(e,t),i=n.href;return n.localFile?this.file(i):this.http(i,t)}async function Kc(e,t){t=Object(p.p)({},this.options,t);const n=this.fileAccess,i={href:null};let r,o,s;const a=qc.test(e.replace(Vc,""));null!=e&&"string"==typeof e&&a||Object(p.o)("Sanitize failure, invalid URI: "+Object(p.ab)(e));const l=Hc.test(e);return(s=t.baseURL)&&!l&&(e.startsWith("/")||"/"===s[s.length-1]||(e="/"+e),e=s+e),o=(r=e.startsWith("file://"))||"file"===t.mode||"http"!==t.mode&&!l&&n,r?e=e.slice("file://".length):e.startsWith("//")&&("file"===t.defaultProtocol?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(i,"localFile",{value:!!o}),i.href=e,t.target&&(i.target=t.target+""),t.rel&&(i.rel=t.rel+""),"image"===t.context&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin+""),i}function Yc(e){return e?t=>new Promise((n,i)=>{e.readFile(t,(e,t)=>{e?i(e):n(t)})}):Xc}async function Xc(){Object(p.o)("No file system access.")}function Jc(e){return e?async function(t,n){const i=Object(p.p)({},this.options.http,n),r=n&&n.response,o=await e(t,i);return o.ok?Object(p.E)(o[r])?o[r]():o.text():Object(p.o)(o.status+""+o.statusText)}:Qc}async function Qc(){Object(p.o)("No HTTP fetch method available.")}const Zc=e=>!(Number.isNaN(+e)||e instanceof Date),eu={boolean:p.bb,integer:p.db,number:p.db,date:p.cb,string:p.fb,unknown:p.y},tu=[e=>"true"===e||"false"===e||!0===e||!1===e,e=>Zc(e)&&Number.isInteger(+e),Zc,e=>!Number.isNaN(Date.parse(e))],nu=["boolean","integer","number","date"];function iu(e,t){if(!e||!e.length)return"unknown";const n=e.length,i=tu.length,r=tu.map((e,t)=>t+1);for(let s,a,l=0,c=0;l<n;++l)for(a=t?e[l][t]:e[l],s=0;s<i;++s)if(r[s]&&(null!=(o=a)&&o==o)&&!tu[s](a)&&(r[s]=0,++c,c===tu.length))return"string";var o;return nu[r.reduce((e,t)=>0===e?t:e,0)-1]}function ru(e,t){return t.reduce((function(t,n){return t[n]=iu(e,n),t}),{})}function ou(e){const t=function(t,n){const i={delimiter:e};return su(t,n?Object(p.p)(n,i):i)};return t.responseType="text",t}function su(e,t){return t.header&&(e=t.header.map(p.ab).join(t.delimiter)+"\n"+e),ie(t.delimiter).parse(e+"")}su.responseType="text";var au=n(27);const lu={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function cu(e,t){let n,i,r,o;return e=Object(au.a)(e,t),t&&t.feature?(n=ce,r=t.feature):t&&t.mesh?(n=fe,r=t.mesh,o=lu[t.filter]):Object(p.o)("Missing TopoJSON feature or mesh parameter."),i=(i=e.objects[r])?n(e,i,o):Object(p.o)("Invalid TopoJSON object: "+r),i&&i.features||[i]}cu.responseType="json";const uu={dsv:su,csv:ou(","),tsv:ou("\t"),json:au.a,topojson:cu};function hu(e,t){return arguments.length>1?(uu[e]=t,this):Object(p.w)(uu,e)?uu[e]:null}function du(e){const t=hu(e);return t&&t.responseType||"text"}var fu=function(e,t,n,i){const r=hu((t=t||{}).type||"json");return r||Object(p.o)("Unknown data format type: "+t.type),e=r(e,t),t.parse&&function(e,t,n,i){if(!e.length)return;const r=gr();n=n||r.timeParse,i=i||r.utcParse;let o,s,a,l,c,u,h,d=e.columns||Object.keys(e[0]);"auto"===t&&(t=ru(e,d));for(d=Object.keys(t),o=d.map(e=>{let r,o,s=t[e];if(s&&(s.startsWith("date:")||s.startsWith("utc:"))){r=s.split(/:(.+)?/,2),o=r[1],("'"===o[0]&&"'"===o[o.length-1]||'"'===o[0]&&'"'===o[o.length-1])&&(o=o.slice(1,-1));return("utc"===r[0]?i:n)(o)}if(!eu[s])throw Error("Illegal format pattern: "+e+":"+s);return eu[s]}),l=0,u=e.length,h=d.length;l<u;++l)for(s=e[l],c=0;c<h;++c)a=d[c],s[a]=o[c](s[a])}(e,t.parse,n,i),Object(p.w)(e,"columns")&&delete e.columns,e};var pu=function(e,t){return n=>({options:n||{},sanitize:Kc,load:Gc,fileAccess:!!t,file:Yc(t),http:Jc(e)})}("undefined"!=typeof fetch&&fetch,null);function gu(e){this._pending=0,this._loader=e||pu()}function mu(e){e._pending+=1}function vu(e){e._pending-=1}gu.prototype={pending(){return this._pending},sanitizeURL(e){var t=this;return mu(t),t._loader.sanitize(e,{context:"href"}).then((function(e){return vu(t),e})).catch((function(){return vu(t),null}))},loadImage(e){const t=this,n=Uc();return mu(t),t._loader.sanitize(e,{context:"image"}).then((function(e){const i=e.href;if(!i||!n)throw{url:i};const r=new n,o=Object(p.w)(e,"crossOrigin")?e.crossOrigin:"anonymous";return null!=o&&(r.crossOrigin=o),r.onload=()=>vu(t),r.onerror=()=>vu(t),r.src=i,r})).catch((function(e){return vu(t),{complete:!1,width:0,height:0,src:e&&e.url||""}}))},ready(){var e=this;return new Promise((function(t){!function n(i){e.pending()?setTimeout((function(){n(!0)}),10):t(i)}(!1)}))}};var bu=function(e,t,n){if(t.stroke&&0!==t.opacity&&0!==t.strokeOpacity){const i=null!=t.strokeWidth?+t.strokeWidth:1;e.expand(i+(n?function(e,t){return e.strokeJoin&&"miter"!==e.strokeJoin?0:t}(t,i):0))}return e};const yu=Rl-1e-8;let wu,xu,_u,ku,Su,Ou,Cu,Au;const $u=(e,t)=>wu.add(e,t),Eu=(e,t)=>$u(xu=e,_u=t),Mu=e=>$u(e,wu.y1),ju=e=>$u(wu.x1,e),Ru=(e,t)=>Su*e+Cu*t,Du=(e,t)=>Ou*e+Au*t,Tu=(e,t)=>$u(Ru(e,t),Du(e,t)),Lu=(e,t)=>Eu(Ru(e,t),Du(e,t));var Fu=function(e,t){return wu=e,t?(ku=t*Ml,Su=Au=Math.cos(ku),Ou=Math.sin(ku),Cu=-Ou):(Su=Au=1,ku=Ou=Cu=0),Nu};const Nu={beginPath(){},closePath(){},moveTo:Lu,lineTo:Lu,rect(e,t,n,i){ku?(Tu(e+n,t),Tu(e+n,t+i),Tu(e,t+i),Lu(e,t)):($u(e+n,t+i),Eu(e,t))},quadraticCurveTo(e,t,n,i){const r=Ru(e,t),o=Du(e,t),s=Ru(n,i),a=Du(n,i);Pu(xu,r,s,Mu),Pu(_u,o,a,ju),Eu(s,a)},bezierCurveTo(e,t,n,i,r,o){const s=Ru(e,t),a=Du(e,t),l=Ru(n,i),c=Du(n,i),u=Ru(r,o),h=Du(r,o);zu(xu,s,l,u,Mu),zu(_u,a,c,h,ju),Eu(u,h)},arc(e,t,n,i,r,o){if(i+=ku,r+=ku,xu=n*Math.cos(r)+e,_u=n*Math.sin(r)+t,Math.abs(r-i)>yu)$u(e-n,t-n),$u(e+n,t+n);else{const s=i=>$u(n*Math.cos(i)+e,n*Math.sin(i)+t);let a,l;if(s(i),s(r),r!==i)if((i%=Rl)<0&&(i+=Rl),(r%=Rl)<0&&(r+=Rl),r<i&&(o=!o,a=i,i=r,r=a),o)for(r-=Rl,a=i-i%jl,l=0;l<4&&a>r;++l,a-=jl)s(a);else for(a=i-i%jl+jl,l=0;l<4&&a<r;++l,a+=jl)s(a)}}};function Pu(e,t,n,i){const r=(e-t)/(e+n-2*t);0<r&&r<1&&i(e+(t-e)*r)}function zu(e,t,n,i,r){const o=i-e+3*t-3*n,s=e+n-2*t,a=e-t;let l,c=0,u=0;Math.abs(o)>1e-14?(l=s*s+a*o,l>=0&&(l=Math.sqrt(l),c=(-s+l)/o,u=(-s-l)/o)):c=.5*a/s,0<c&&c<1&&r(Iu(c,e,t,n,i)),0<u&&u<1&&r(Iu(u,e,t,n,i))}function Iu(e,t,n,i,r){const o=1-e,s=o*o,a=e*e;return s*o*t+3*s*e*n+3*o*a*i+a*e*r}var Bu=(Bu=Wc(1,1))?Bu.getContext("2d"):null;const Wu=new zc;function Uu(e){return function(t,n){if(!Bu)return!0;e(Bu,t),Wu.clear().union(t.bounds).intersect(n).round();const{x1:i,y1:r,x2:o,y2:s}=Wu;for(let e=r;e<=s;++e)for(let t=i;t<=o;++t)if(Bu.isPointInPath(t,e))return!0;return!1}}function Hu(e,t){return t.contains(e.x||0,e.y||0)}function qu(e,t){const n=e.x||0,i=e.y||0,r=e.width||0,o=e.height||0;return t.intersects(Wu.set(n,i,n+r,i+o))}function Vu(e,t){const n=e.x||0,i=e.y||0;return Gu(t,n,i,null!=e.x2?e.x2:n,null!=e.y2?e.y2:i)}function Gu(e,t,n,i,r){const{x1:o,y1:s,x2:a,y2:l}=e,c=i-t,u=r-n;let h,d,f,p,g=0,m=1;for(p=0;p<4;++p){if(0===p&&(h=-c,d=-(o-t)),1===p&&(h=c,d=a-t),2===p&&(h=-u,d=-(s-n)),3===p&&(h=u,d=l-n),Math.abs(h)<1e-10&&d<0)return!1;if(f=d/h,h<0){if(f>m)return!1;f>g&&(g=f)}else if(h>0){if(f<g)return!1;f<m&&(m=f)}}return!0}var Ku=function(e,t){e.globalCompositeOperation=t.blend||"source-over"},Yu=function(e,t){return null==e?t:e};function Xu(e,t){const n=t.length;for(let i=0;i<n;++i)e.addColorStop(t[i].offset,t[i].color);return e}var Ju=function(e,t,n){return ya(n)?function(e,t,n){const i=n.width(),r=n.height();let o;if("radial"===t.gradient)o=e.createRadialGradient(n.x1+Yu(t.x1,.5)*i,n.y1+Yu(t.y1,.5)*r,Math.max(i,r)*Yu(t.r1,0),n.x1+Yu(t.x2,.5)*i,n.y1+Yu(t.y2,.5)*r,Math.max(i,r)*Yu(t.r2,.5));else{const s=Yu(t.x1,0),a=Yu(t.y1,0),l=Yu(t.x2,1),c=Yu(t.y2,0);if(s!==l&&a!==c&&i!==r){const n=Wc(Math.ceil(i),Math.ceil(r)),o=n.getContext("2d");return o.scale(i,r),o.fillStyle=Xu(o.createLinearGradient(s,a,l,c),t.stops),o.fillRect(0,0,i,r),e.createPattern(n,"no-repeat")}o=e.createLinearGradient(n.x1+s*i,n.y1+a*r,n.x1+l*i,n.y1+c*r)}return Xu(o,t.stops)}(e,n,t.bounds):n},Qu=function(e,t,n){return(n*=null==t.fillOpacity?1:t.fillOpacity)>0&&(e.globalAlpha=n,e.fillStyle=Ju(e,t,t.fill),!0)},Zu=[],eh=function(e,t,n){var i=null!=(i=t.strokeWidth)?i:1;return!(i<=0)&&((n*=null==t.strokeOpacity?1:t.strokeOpacity)>0&&(e.globalAlpha=n,e.strokeStyle=Ju(e,t,t.stroke),e.lineWidth=i,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||Zu),e.lineDashOffset=t.strokeDashOffset||0),!0))};function th(e,t){return e.zindex-t.zindex||e.index-t.index}function nh(e){if(!e.zdirty)return e.zitems;var t,n,i,r=e.items,o=[];for(n=0,i=r.length;n<i;++n)(t=r[n]).index=n,t.zindex&&o.push(t);return e.zdirty=!1,e.zitems=o.sort(th)}function ih(e,t){var n,i,r=e.items;if(r&&r.length){var o=nh(e);if(o&&o.length){for(n=0,i=r.length;n<i;++n)r[n].zindex||t(r[n]);r=o}for(n=0,i=r.length;n<i;++n)t(r[n])}}function rh(e,t){var n,i,r=e.items;if(!r||!r.length)return null;var o=nh(e);for(o&&o.length&&(r=o),i=r.length;--i>=0;)if(n=t(r[i]))return n;if(r===o)for(i=(r=e.items).length;--i>=0;)if(!r[i].zindex&&(n=t(r[i])))return n;return null}function oh(e){return function(t,n,i){ih(n,(function(n){i&&!i.intersects(n.bounds)||sh(e,t,n,n)}))}}function sh(e,t,n,i){var r=null==n.opacity?1:n.opacity;0!==r&&(e(t,i)||(Ku(t,n),n.fill&&Qu(t,n,r)&&t.fill(),n.stroke&&eh(t,n,r)&&t.stroke()))}function ah(e){return e=e||p.hb,function(t,n,i,r,o,s){return i*=t.pixelRatio,r*=t.pixelRatio,rh(n,(function(n){var a=n.bounds;if((!a||a.contains(o,s))&&a)return e(t,n,i,r,o,s)?n:void 0}))}}function lh(e,t){return function(n,i,r,o){var s,a,l=Array.isArray(i)?i[0]:i,c=null==t?l.fill:t,u=l.stroke&&n.isPointInStroke;return u&&(s=l.strokeWidth,a=l.strokeCap,n.lineWidth=null!=s?s:1,n.lineCap=null!=a?a:"butt"),!e(n,i)&&(c&&n.isPointInPath(r,o)||u&&n.isPointInStroke(r,o))}}function ch(e){return ah(lh(e))}function uh(e,t){return"translate("+e+","+t+")"}function hh(e){return"rotate("+e+")"}function dh(e){return uh(e.x||0,e.y||0)}var fh=function(e,t,n){function i(e,n){var i=n.x||0,r=n.y||0,o=n.angle||0;e.translate(i,r),o&&e.rotate(o*=Ml),e.beginPath(),t(e,n),o&&e.rotate(-o),e.translate(-i,-r)}return{type:e,tag:"path",nested:!1,attr:function(e,n){e("transform",function(e){return uh(e.x||0,e.y||0)+(e.angle?" "+hh(e.angle):"")}(n)),e("d",t(null,n))},bound:function(e,n){return t(Fu(e,n.angle),n),bu(e,n).translate(n.x||0,n.y||0)},draw:oh(i),pick:ch(i),isect:n||Uu(i)}},ph=fh("arc",(function(e,t){return Ac.context(e)(t)}));var gh=function(e,t,n){function i(e,n){e.beginPath(),t(e,n)}var r,o=lh(i);return{type:e,tag:"path",nested:!0,attr:function(e,n){var i=n.mark.items;i.length&&e("d",t(null,i))},bound:function(e,n){var i=n.items;return 0===i.length?e:(t(Fu(e),i),bu(e,i[0]))},draw:(r=i,function(e,t,n){!t.items.length||n&&!n.intersects(t.bounds)||sh(r,e,t.items[0],t.items)}),pick:function(e,t,n,i,r,s){var a=t.items,l=t.bounds;return!a||!a.length||l&&!l.contains(r,s)?null:(n*=e.pixelRatio,i*=e.pixelRatio,o(e,a,n,i)?a[0]:null)},isect:Hu,tip:n}},mh=gh("area",(function(e,t){const n=t[0],i=n.interpolate||"linear";return("horizontal"===n.orient?Ec:$c).curve(Cl(i,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,i,r="horizontal"===e[0].orient?t[1]:t[0],o="horizontal"===e[0].orient?"y":"x",s=e.length,a=1/0;--s>=0;)!1!==e[s].defined&&(i=Math.abs(e[s][o]-r))<a&&(a=i,n=e[s]);return n}));function vh(e,t){e.beginPath(),Tc(t)?Lc(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function bh(e){const t=Yu(e.strokeWidth,1);return null!=e.strokeOffset?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function yh(e,t){const n=bh(t);e("d",Lc(null,t,n,n))}function wh(e,t,n,i){const r=bh(t);e.beginPath(),Lc(e,t,(n||0)+r,(i||0)+r)}const xh=lh(wh),_h=lh(wh,!1),kh=lh(wh,!0);var Sh={type:"group",tag:"g",nested:!1,attr:function(e,t){e("transform",dh(t))},bound:function(e,t){if(!t.clip&&t.items){const n=t.items,i=n.length;for(let t=0;t<i;++t)e.union(n[t].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),bu(e,t),e.translate(t.x||0,t.y||0)},draw:function(e,t,n){ih(t,t=>{const i=t.x||0,r=t.y||0,o=t.strokeForeground,s=null==t.opacity?1:t.opacity;(t.stroke||t.fill)&&s&&(wh(e,t,i,r),Ku(e,t),t.fill&&Qu(e,t,s)&&e.fill(),t.stroke&&!o&&eh(e,t,s)&&e.stroke()),e.save(),e.translate(i,r),t.clip&&vh(e,t),n&&n.translate(-i,-r),ih(t,t=>{this.draw(e,t,n)}),n&&n.translate(i,r),e.restore(),o&&t.stroke&&s&&(wh(e,t,i,r),Ku(e,t),eh(e,t,s)&&e.stroke())})},pick:function(e,t,n,i,r,o){if(t.bounds&&!t.bounds.contains(r,o)||!t.items)return null;const s=n*e.pixelRatio,a=i*e.pixelRatio;return rh(t,l=>{let c,u,h,d,f,p,g,m,v;if(m=l.bounds,(!m||m.contains(r,o))&&(d=l.x||0,f=l.y||0,p=d+(l.width||0),g=f+(l.height||0),v=l.clip,!v||!(r<d||r>p||o<f||o>g)))return e.save(),e.translate(d,f),d=r-d,f=o-f,v&&Tc(l)&&!kh(e,l,s,a)?(e.restore(),null):(u=l.strokeForeground,h=!1!==t.interactive,h&&u&&l.stroke&&_h(e,l,s,a)?(e.restore(),l):(c=rh(l,e=>function(e,t,n){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}(e,d,f)?this.pick(e,n,i,d,f):null),!c&&h&&(l.fill||!u&&l.stroke)&&xh(e,l,s,a)&&(c=l),e.restore(),c||null))})},isect:qu,content:function(e,t,n){e("clip-path",t.clip?Pc(n,t,t):null)},background:function(e,t){e("class","background"),e("aria-hidden",!0),yh(e,t)},foreground:function(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?yh(e,t):e("d","")}},Oh={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function Ch(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(t=>{e.image=t,e.image.url=e.url})),n}function Ah(e,t){return null!=e.width?e.width:t&&t.width?!1!==e.aspect&&e.height?e.height*t.width/t.height:t.width:0}function $h(e,t){return null!=e.height?e.height:t&&t.height?!1!==e.aspect&&e.width?e.width*t.height/t.width:t.height:0}function Eh(e,t){return"center"===e?t/2:"right"===e?t:0}function Mh(e,t){return"middle"===e?t/2:"bottom"===e?t:0}var jh={type:"image",tag:"image",nested:!1,attr:function(e,t,n){const i=Ch(t,n),r=Ah(t,i),o=$h(t,i),s=(t.x||0)-Eh(t.align,r),a=(t.y||0)-Mh(t.baseline,o);e("href",!i.src&&i.toDataURL?i.toDataURL():i.src||"",Oh["xmlns:xlink"],"xlink:href"),e("transform",uh(s,a)),e("width",r),e("height",o),e("preserveAspectRatio",!1===t.aspect?"none":"xMidYMid")},bound:function(e,t){const n=t.image,i=Ah(t,n),r=$h(t,n),o=(t.x||0)-Eh(t.align,i),s=(t.y||0)-Mh(t.baseline,r);return e.set(o,s,o+i,s+r)},draw:function(e,t,n){ih(t,t=>{if(n&&!n.intersects(t.bounds))return;let i,r,o,s,a=Ch(t,this),l=Ah(t,a),c=$h(t,a),u=(t.x||0)-Eh(t.align,l),h=(t.y||0)-Mh(t.baseline,c);!1!==t.aspect&&(r=a.width/a.height,o=t.width/t.height,r==r&&o==o&&r!==o&&(o<r?(s=l/r,h+=(c-s)/2,c=s):(s=c*r,u+=(l-s)/2,l=s))),(a.complete||a.toDataURL)&&(Ku(e,t),e.globalAlpha=null!=(i=t.opacity)?i:1,e.imageSmoothingEnabled=!1!==t.smooth,e.drawImage(a,u,h,l,c))})},pick:ah(),isect:p.hb,get:Ch,xOffset:Eh,yOffset:Mh},Rh=gh("line",(function(e,t){const n=t[0],i=n.interpolate||"linear";return Mc.curve(Cl(i,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,i,r=Math.pow(e[0].strokeWidth||1,2),o=e.length;--o>=0;)if(!1!==e[o].defined&&(n=e[o].x-t[0])*n+(i=e[o].y-t[1])*i<r)return e[o];return null}));function Dh(e,t){var n=t.path;if(null==n)return!0;var i=t.x||0,r=t.y||0,o=t.scaleX||1,s=t.scaleY||1,a=(t.angle||0)*Ml,l=t.pathCache;l&&l.path===n||((t.pathCache=l=El(n)).path=n),a&&e.rotate&&e.translate?(e.translate(i,r),e.rotate(a),Il(e,l,0,0,o,s),e.rotate(-a),e.translate(-i,-r)):Il(e,l,i,r,o,s)}var Th={type:"path",tag:"path",nested:!1,attr:function(e,t){var n=t.scaleX||1,i=t.scaleY||1;1===n&&1===i||e("vector-effect","non-scaling-stroke"),e("transform",function(e){return uh(e.x||0,e.y||0)+(e.angle?" "+hh(e.angle):"")+(e.scaleX||e.scaleY?" "+(t=e.scaleX||1,n=e.scaleY||1,"scale("+t+","+n+")"):"");var t,n}(t)),e("d",t.path)},bound:function(e,t){return Dh(Fu(e,t.angle),t)?e.set(0,0,0,0):bu(e,t,!0)},draw:oh(Dh),pick:ch(Dh),isect:Uu(Dh)};function Lh(e,t){e.beginPath(),Lc(e,t)}var Fh={type:"rect",tag:"path",nested:!1,attr:function(e,t){e("d",Lc(null,t))},bound:function(e,t){var n,i;return bu(e.set(n=t.x||0,i=t.y||0,n+t.width||0,i+t.height||0),t)},draw:oh(Lh),pick:ch(Lh),isect:qu};function Nh(e,t,n){var i,r,o,s;return!(!t.stroke||!eh(e,t,n))&&(i=t.x||0,r=t.y||0,o=null!=t.x2?t.x2:i,s=null!=t.y2?t.y2:r,e.beginPath(),e.moveTo(i,r),e.lineTo(o,s),!0)}var Ph={type:"rule",tag:"line",nested:!1,attr:function(e,t){e("transform",dh(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)},bound:function(e,t){var n,i;return bu(e.set(n=t.x||0,i=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:i),t)},draw:function(e,t,n){ih(t,(function(t){if(!n||n.intersects(t.bounds)){var i=null==t.opacity?1:t.opacity;i&&Nh(e,t,i)&&(Ku(e,t),e.stroke())}}))},pick:ah((function(e,t,n,i){return!!e.isPointInStroke&&(Nh(e,t,1)&&e.isPointInStroke(n,i))})),isect:Vu},zh=fh("shape",(function(e,t){return(t.mark.shape||t.shape).context(e)(t)})),Ih=fh("symbol",(function(e,t){return Rc.context(e)(t)}),Hu);const Bh=Object(p.M)();var Wh={height:Kh,measureWidth:Vh,estimateWidth:Hh,width:Hh,canvas:Uh};function Uh(e){Wh.width=e&&Bu?Vh:Hh}function Hh(e,t){return qh(Qh(e,t),Kh(e))}function qh(e,t){return~~(.8*e.length*t)}function Vh(e,t){return Kh(e)<=0||!(t=Qh(e,t))?0:Gh(t,ed(e))}function Gh(e,t){const n=`(${t}) ${e}`;let i=Bh.get(n);return void 0===i&&(Bu.font=t,i=Bu.measureText(e).width,Bh.set(n,i)),i}function Kh(e){return null!=e.fontSize?+e.fontSize||0:11}function Yh(e){return null!=e.lineHeight?e.lineHeight:Kh(e)+2}function Xh(e){return t=e.lineBreak&&e.text&&!Object(p.B)(e.text)?e.text.split(e.lineBreak):e.text,Object(p.B)(t)?t.length>1?t:t[0]:t;var t}function Jh(e){const t=Xh(e);return(Object(p.B)(t)?t.length-1:0)*Yh(e)}function Qh(e,t){const n=null==t?"":(t+"").trim();return e.limit>0&&n.length?function(e,t){var n=+e.limit,i=function(e){if(Wh.width===Vh){const t=ed(e);return e=>Gh(e,t)}{const t=Kh(e);return e=>qh(e,t)}}(e);if(i(t)<n)return t;var r,o=e.ellipsis||"â€¦",s="rtl"===e.dir,a=0,l=t.length;if(n-=i(o),s){for(;a<l;)r=a+l>>>1,i(t.slice(r))>n?a=r+1:l=r;return o+t.slice(a)}for(;a<l;)r=1+(a+l>>>1),i(t.slice(0,r))<n?a=r:l=r-1;return t.slice(0,a)+o}(e,n):n}function Zh(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function ed(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+Kh(e)+"px "+Zh(e,t)}function td(e){var t=e.baseline,n=Kh(e);return Math.round("top"===t?.79*n:"middle"===t?.3*n:"bottom"===t?-.21*n:"line-top"===t?.29*n+.5*Yh(e):"line-bottom"===t?.29*n-.5*Yh(e):0)}Uh(!0);var nd={left:"start",center:"middle",right:"end"},id=new zc;function rd(e){var t,n=e.x||0,i=e.y||0,r=e.radius||0;return r&&(t=(e.theta||0)-jl,n+=r*Math.cos(t),i+=r*Math.sin(t)),id.x1=n,id.y1=i,id}function od(e,t,n){var i,r=Wh.height(t),o=t.align,s=rd(t),a=s.x1,l=s.y1,c=t.dx||0,u=(t.dy||0)+td(t)-Math.round(.8*r),h=Xh(t);if(Object(p.B)(h)?(r+=Yh(t)*(h.length-1),i=h.reduce((e,n)=>Math.max(e,Wh.width(t,n)),0)):i=Wh.width(t,h),"center"===o?c-=i/2:"right"===o&&(c-=i),e.set(c+=a,u+=l,c+i,u+r),t.angle&&!n)e.rotate(t.angle*Ml,a,l);else if(2===n)return e.rotatedPoints(t.angle*Ml,a,l);return e}var sd={arc:ph,area:mh,group:Sh,image:jh,line:Rh,path:Th,rect:Fh,rule:Ph,shape:zh,symbol:Ih,text:{type:"text",tag:"text",nested:!1,attr:function(e,t){var n,i=t.dx||0,r=(t.dy||0)+td(t),o=rd(t),s=o.x1,a=o.y1,l=t.angle||0;e("text-anchor",nd[t.align]||"start"),l?(n=uh(s,a)+" "+hh(l),(i||r)&&(n+=" "+uh(i,r))):n=uh(s+i,a+r),e("transform",n)},bound:od,draw:function(e,t,n){ih(t,(function(t){var i,r,o,s,a,l,c,u=null==t.opacity?1:t.opacity;if(!(n&&!n.intersects(t.bounds)||0===u||t.fontSize<=0||null==t.text||0===t.text.length)){if(e.font=ed(t),e.textAlign=t.align||"left",r=(i=rd(t)).x1,o=i.y1,t.angle&&(e.save(),e.translate(r,o),e.rotate(t.angle*Ml),r=o=0),r+=t.dx||0,o+=(t.dy||0)+td(t),l=Xh(t),Ku(e,t),Object(p.B)(l))for(a=Yh(t),s=0;s<l.length;++s)c=Qh(t,l[s]),t.fill&&Qu(e,t,u)&&e.fillText(c,r,o),t.stroke&&eh(e,t,u)&&e.strokeText(c,r,o),o+=a;else c=Qh(t,l),t.fill&&Qu(e,t,u)&&e.fillText(c,r,o),t.stroke&&eh(e,t,u)&&e.strokeText(c,r,o);t.angle&&e.restore()}}))},pick:ah((function(e,t,n,i,r,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var s=rd(t),a=s.x1,l=s.y1,c=od(id,t,1),u=-t.angle*Ml,h=Math.cos(u),d=Math.sin(u),f=h*r-d*o+(a-h*a+d*l),p=d*r+h*o+(l-d*a-h*l);return c.contains(f,p)})),isect:function(e,t){var n=od(id,e,2);return Gu(t,n[0],n[1],n[2],n[3])||Gu(t,n[0],n[1],n[4],n[5])||Gu(t,n[4],n[5],n[6],n[7])||Gu(t,n[2],n[3],n[6],n[7])}},trail:gh("trail",(function(e,t){return Dc.context(e)(t)}),(function(e,t){for(var n,i,r=e.length;--r>=0;)if(!1!==e[r].defined&&(n=e[r].x-t[0])*n+(i=e[r].y-t[1])*i<(n=e[r].size||1)*n)return e[r];return null}))},ad=function(e,t,n){var i=sd[e.mark.marktype],r=t||i.bound;return i.nested&&(e=e.mark),r(e.bounds||(e.bounds=new zc),e,n)},ld={mark:null},cd=function(e,t,n){var i,r,o,s,a=sd[e.marktype],l=a.bound,c=e.items,u=c&&c.length;if(a.nested)return u?o=c[0]:(ld.mark=e,o=ld),s=ad(o,l,n),t=t&&t.union(s)||s;if(t=t||e.bounds&&e.bounds.clear()||new zc,u)for(i=0,r=c.length;i<r;++i)t.union(ad(c[i],l,n));return e.bounds=t},ud=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function hd(e,t){return JSON.stringify(e,ud,t)}function dd(e){return function e(t){var n,i,r,o=t.marktype,s=t.items;if(s)for(i=0,r=s.length;i<r;++i)n=o?"mark":"group",s[i][n]=t,s[i].zindex&&(s[i][n].zdirty=!0),"group"===(o||n)&&e(s[i]);o&&cd(t);return t}("string"==typeof e?JSON.parse(e):e)}function fd(e){arguments.length?this.root=dd(e):(this.root=pd({marktype:"group",name:"root",role:"frame"}),this.root.items=[new Bc(this.root)])}function pd(e,t){const n={bounds:new zc,clip:!!e.clip,group:t,interactive:!1!==e.interactive,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return null!=e.aria&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function gd(e,t,n){return!e&&"undefined"!=typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function md(e,t){t=t.toLowerCase();for(var n=e.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===t)return n[i]}function vd(e,t,n,i){var r,o=e.childNodes[t];return o&&o.tagName.toLowerCase()===n.toLowerCase()||(r=o||null,o=gd(e.ownerDocument,n,i),e.insertBefore(o,r)),o}function bd(e,t){for(var n=e.childNodes,i=n.length;i>t;)e.removeChild(n[--i]);return e}function yd(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}fd.prototype={toJSON(e){return hd(this.root,e||0)},mark(e,t,n){var i=pd(e,t=t||this.root.items[0]);return t.items[n]=i,i.zindex&&(i.group.zdirty=!0),i}};var wd=function(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]};function xd(e,t){this._active=null,this._handlers={},this._loader=e||pu(),this._tooltip=t||_d}function _d(e,t,n,i){e.element().setAttribute("title",i||"")}function kd(e){this._el=null,this._bgcolor=null,this._loader=new gu(e)}xd.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let i=e?e.length:0;--i>=0;)if(e[i].type===t&&(!n||e[i].handler===n))return i;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push.apply(n,t[this.eventName(e)]);else for(const e in t)n.push.apply(n,t[e]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(t=>{const n=new MouseEvent(e.type,e),i=gd(null,"a");for(const e in t)i.setAttribute(e,t[e]);i.dispatchEvent(n)}).catch((function(){}))},handleTooltip(e,t,n){if(t&&null!=t.tooltip){t=function(e,t,n,i){var r,o,s=e&&e.mark;if(s&&(r=sd[s.marktype]).tip){for((o=wd(t,n))[0]-=i[0],o[1]-=i[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=r.tip(s.items,o)}return e}(t,e,this.canvas(),this._origin);const i=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,i)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),i=this._origin,r=e.bounds,o=r.width(),s=r.height();let a=r.x1+i[0]+n.left,l=r.y1+i[1]+n.top;for(;e.mark&&(e=e.mark.group);)a+=e.x||0,l+=e.y||0;return{x:a,y:l,width:o,height:s,left:a,top:l,right:a+o,bottom:l+s}}},kd.prototype={initialize(e,t,n,i,r){return this._el=e,this.resize(t,n,i,r)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,i){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=i||1,this},dirty(){},render(e){var t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){var t=this.render(e);return this._ready?this._ready.then((function(){return t})):Promise.resolve(t)},_load(e,t){var n=this,i=n._loader[e](t);if(!n._ready){var r=n._call;n._ready=n._loader.ready().then((function(e){e&&r(),n._ready=null}))}return i},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const Sd="dragleave",Od="mousedown",Cd="mousemove",Ad="mouseout",$d="click",Ed=["keydown","keypress","keyup","dragenter",Sd,"dragover",Od,"mouseup",Cd,Ad,"mouseover",$d,"dblclick","wheel","mousewheel","touchstart","touchmove","touchend"],Md=Cd,jd=Ad,Rd=$d;function Dd(e,t){xd.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}function Td(e,t){(e=>"touchstart"===e||"touchmove"===e||"touchend"===e?["touchstart","touchmove","touchend"]:[e])(t).forEach(t=>function(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?n=>e[t](n):n=>e.fire(t,n)))}(e,t))}function Ld(e,t,n){return function(i){const r=this._active,o=this.pickEvent(i);o===r||(r&&r.exit||this.fire(n,i),this._active=o,this.fire(t,i)),this.fire(e,i)}}function Fd(e){return function(t){this.fire(e,t),this._active=null}}Object(p.z)(Dd,xd,{initialize(e,t,n){return this._canvas=e&&md(e,"canvas"),[$d,Od,Cd,Ad,Sd].forEach(e=>Td(this,e)),xd.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:Ed,DOMMouseScroll(e){this.fire("mousewheel",e)},mousemove:Ld(Cd,"mouseover",Ad),dragover:Ld("dragover","dragenter",Sd),mouseout:Fd(Ad),dragleave:Fd(Sd),mousedown(e){this._down=this._active,this.fire(Od,e)},click(e){this._down===this._active&&(this.fire($d,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire("touchstart",e,!0)},touchmove(e){this.fire("touchmove",e,!0)},touchend(e){this.fire("touchend",e,!0),this._touch=null},fire(e,t,n){const i=n?this._touch:this._active,r=this._handlers[e];if(t.vegaType=e,e===Rd&&i&&i.href?this.handleHref(t,i,i.href):e!==Md&&e!==jd||this.handleTooltip(t,i,e!==jd),r)for(let e=0,n=r.length;e<n;++e)r[e].handler.call(this._obj,t,i)},on(e,t){const n=this.eventName(e),i=this._handlers;return this._handlerIndex(i[n],e,t)<0&&(Td(this,e),(i[n]||(i[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&i.splice(r,1),this},pickEvent(e){const t=wd(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,i,r){const o=this.context();return sd[e.marktype].pick.call(this,o,e,t,n,i,r)}});var Nd="undefined"!=typeof window&&window.devicePixelRatio||1;function Pd(e){kd.call(this,e),this._options={},this._redraw=!1,this._dirty=new zc,this._tempb=new zc}const zd=kd.prototype;function Id(e,t){xd.call(this,e,t);const n=this;n._hrefHandler=Bd(n,(e,t)=>{t&&t.href&&n.handleHref(e,t,t.href)}),n._tooltipHandler=Bd(n,(e,t)=>{n.handleTooltip(e,t,e.type!==jd)})}Object(p.z)(Pd,kd,{initialize(e,t,n,i,r,o){return this._options=o||{},this._canvas=this._options.externalContext?null:Wc(1,1,this._options.type),e&&this._canvas&&(bd(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),zd.initialize.call(this,e,t,n,i,r)},resize(e,t,n,i){if(zd.resize.call(this,e,t,n,i),this._canvas)!function(e,t,n,i,r,o){const s="undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,a=e.getContext("2d"),l=s?Nd:r;e.width=t*l,e.height=n*l;for(const e in o)a[e]=o[e];s&&1!==l&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=l,a.setTransform(l,0,0,l,l*i[0],l*i[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const e=this._options.externalContext;e||Object(p.o)("CanvasRenderer is missing a valid canvas or context"),e.scale(this._scale,this._scale),e.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){let t=this._tempb.clear().union(e.bounds),n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,i=this._width,r=this._height,o=this._dirty,s=(a=n,l=i,c=r,(new zc).set(0,0,l,c).translate(-a[0],-a[1]));var a,l,c;t.save();const u=this._redraw||o.empty()?(this._redraw=!1,s.expand(1)):function(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-n[0]%1,-n[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}(t,s.intersect(o),n);return this.clear(-n[0],-n[1],i,r),this.draw(t,e,u),t.restore(),o.clear(),this},draw(e,t,n){const i=sd[t.marktype];t.clip&&function(e,t){var n=t.clip;e.save(),Object(p.E)(n)?(e.beginPath(),n(e),e.clip()):vh(e,t.group)}(e,t),i.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,i){const r=this._options,o=this.context();"pdf"===r.type||r.externalContext||o.clearRect(e,t,n,i),null!=this._bgcolor&&(o.fillStyle=this._bgcolor,o.fillRect(e,t,n,i))}});const Bd=(e,t)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,t.call(e._obj,n,i)};Object(p.z)(Id,xd,{initialize(e,t,n){let i=this._svg;return i&&(i.removeEventListener(Rd,this._hrefHandler),i.removeEventListener(Md,this._tooltipHandler),i.removeEventListener(jd,this._tooltipHandler)),this._svg=i=e&&md(e,"svg"),i&&(i.addEventListener(Rd,this._hrefHandler),i.addEventListener(Md,this._tooltipHandler),i.addEventListener(jd,this._tooltipHandler)),xd.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),i=this._handlers;if(this._handlerIndex(i[n],e,t)<0){const r={type:e,handler:t,listener:Bd(this,t)};(i[n]||(i[n]=[])).push(r),this._svg&&this._svg.addEventListener(n,r.listener)}return this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&(this._svg&&this._svg.removeEventListener(n,i[r].listener),i.splice(r,1)),this}});var Wd=function(e,t,n){const i=e-t+2*n;return e?i>0?i:1:0};const Ud="log",Hd="time",qd="utc",Vd="continuous";var Gd=Tn(Dn),Kd=Gd.right,Yd=Gd.left,Xd=Kd;function Jd(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function Qd(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}const Zd=Symbol("implicit");function ef(){var e=new Map,t=[],n=[],i=Zd;function r(r){var o=r+"",s=e.get(o);if(!s){if(i!==Zd)return i;e.set(o,s=t.push(r))}return n[(s-1)%n.length]}return r.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Map;for(const i of n){const n=i+"";e.has(n)||e.set(n,t.push(i))}return r},r.range=function(e){return arguments.length?(n=Array.from(e),r):n.slice()},r.unknown=function(e){return arguments.length?(i=e,r):i},r.copy=function(){return ef(t,n).unknown(i)},Jd.apply(r,arguments),r}function tf(){let e,t,n=ef().unknown(void 0),i=n.domain,r=n.range,o=[0,1],s=!1,a=0,l=0,c=.5;function u(){let n=i().length,u=o[1]<o[0],h=o[u-0],d=o[1-u],f=Wd(n,a,l);e=(d-h)/(f||1),s&&(e=Math.floor(e)),h+=(d-h-e*(n-a))*c,t=e*(1-a),s&&(h=Math.round(h),t=Math.round(t));const p=Ys(n).map((function(t){return h+e*t}));return r(u?p.reverse():p)}return delete n.unknown,n.domain=function(e){return arguments.length?(i(e),u()):i()},n.range=function(e){return arguments.length?(o=[+e[0],+e[1]],u()):o.slice()},n.rangeRound=function(e){return o=[+e[0],+e[1]],s=!0,u()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(s=!!e,u()):s},n.padding=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),a=l,u()):a},n.paddingInner=function(e){return arguments.length?(a=Math.max(0,Math.min(1,e)),u()):a},n.paddingOuter=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),u()):l},n.align=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),u()):c},n.invertRange=function(e){if(null==e[0]||null==e[1])return;let n,s,a,l=+e[0],c=+e[1],u=o[1]<o[0],h=u?r().reverse():r(),d=h.length-1;return l!=l||c!=c||(c<l&&(a=l,l=c,c=a),c<h[0]||l>o[1-u])?void 0:(n=Math.max(0,Kd(h,l)-1),s=l===c?n:Kd(h,c)-1,l-h[n]>t+1e-10&&++n,u&&(a=n,n=d-s,s=d-a),n>s?void 0:i().slice(n,s+1))},n.invert=function(e){const t=n.invertRange([e,e]);return t?t[0]:t},n.copy=function(){return tf().domain(i()).range(o).round(s).paddingInner(a).paddingOuter(l).align(c)},u()}var nf=function(e,t,n,i){var r,o=Ae(e,t,n);switch((i=Ee(null==i?",f":i)).type){case"s":var s=Math.max(Math.abs(e),Math.abs(t));return null!=i.precision||isNaN(r=Ne(o,s))||(i.precision=r),Te(i,s);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(r=Pe(o,Math.max(Math.abs(e),Math.abs(t))))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=ze(o))||(i.precision=r-2*("%"===i.type))}return De(i)},rf=Array.prototype.map;function of(e){return rf.call(e,p.db)}const sf=Array.prototype.slice;var af=function(e,t,n){e.prototype=t.prototype=n,n.constructor=e};function lf(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function cf(){}var uf="\\s*([+-]?\\d+)\\s*",hf="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",df="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ff=/^#([0-9a-f]{3,8})$/,pf=new RegExp("^rgb\\("+[uf,uf,uf]+"\\)$"),gf=new RegExp("^rgb\\("+[df,df,df]+"\\)$"),mf=new RegExp("^rgba\\("+[uf,uf,uf,hf]+"\\)$"),vf=new RegExp("^rgba\\("+[df,df,df,hf]+"\\)$"),bf=new RegExp("^hsl\\("+[hf,df,df]+"\\)$"),yf=new RegExp("^hsla\\("+[hf,df,df,hf]+"\\)$"),wf={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function xf(){return this.rgb().formatHex()}function _f(){return this.rgb().formatRgb()}function kf(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=ff.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Sf(t):3===n?new $f(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Of(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Of(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=pf.exec(e))?new $f(t[1],t[2],t[3],1):(t=gf.exec(e))?new $f(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=mf.exec(e))?Of(t[1],t[2],t[3],t[4]):(t=vf.exec(e))?Of(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=bf.exec(e))?Rf(t[1],t[2]/100,t[3]/100,1):(t=yf.exec(e))?Rf(t[1],t[2]/100,t[3]/100,t[4]):wf.hasOwnProperty(e)?Sf(wf[e]):"transparent"===e?new $f(NaN,NaN,NaN,0):null}function Sf(e){return new $f(e>>16&255,e>>8&255,255&e,1)}function Of(e,t,n,i){return i<=0&&(e=t=n=NaN),new $f(e,t,n,i)}function Cf(e){return e instanceof cf||(e=kf(e)),e?new $f((e=e.rgb()).r,e.g,e.b,e.opacity):new $f}function Af(e,t,n,i){return 1===arguments.length?Cf(e):new $f(e,t,n,null==i?1:i)}function $f(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}function Ef(){return"#"+jf(this.r)+jf(this.g)+jf(this.b)}function Mf(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function jf(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function Rf(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Lf(e,t,n,i)}function Df(e){if(e instanceof Lf)return new Lf(e.h,e.s,e.l,e.opacity);if(e instanceof cf||(e=kf(e)),!e)return new Lf;if(e instanceof Lf)return e;var t=(e=e.rgb()).r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),o=Math.max(t,n,i),s=NaN,a=o-r,l=(o+r)/2;return a?(s=t===o?(n-i)/a+6*(n<i):n===o?(i-t)/a+2:(t-n)/a+4,a/=l<.5?o+r:2-o-r,s*=60):a=l>0&&l<1?0:s,new Lf(s,a,l,e.opacity)}function Tf(e,t,n,i){return 1===arguments.length?Df(e):new Lf(e,t,n,null==i?1:i)}function Lf(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function Ff(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function Nf(e,t,n,i,r){var o=e*e,s=o*e;return((1-3*e+3*o-s)*t+(4-6*o+3*s)*n+(1+3*e+3*o-3*s)*i+s*r)/6}af(cf,kf,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:xf,formatHex:xf,formatHsl:function(){return Df(this).formatHsl()},formatRgb:_f,toString:_f}),af($f,Af,lf(cf,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new $f(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new $f(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ef,formatHex:Ef,formatRgb:Mf,toString:Mf})),af(Lf,Tf,lf(cf,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new Lf(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new Lf(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new $f(Ff(e>=240?e-240:e+120,r,i),Ff(e,r,i),Ff(e<120?e+240:e-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var Pf=function(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],o=e[i+1],s=i>0?e[i-1]:2*r-o,a=i<t-1?e[i+2]:2*o-r;return Nf((n-i/t)*t,s,r,o,a)}},zf=function(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t),r=e[(i+t-1)%t],o=e[i%t],s=e[(i+1)%t],a=e[(i+2)%t];return Nf((n-i/t)*t,r,o,s,a)}},If=function(e){return function(){return e}};function Bf(e,t){return function(n){return e+n*t}}function Wf(e,t){var n=t-e;return n?Bf(e,n>180||n<-180?n-360*Math.round(n/360):n):If(isNaN(e)?t:e)}function Uf(e){return 1==(e=+e)?Hf:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}(t,n,e):If(isNaN(t)?n:t)}}function Hf(e,t){var n=t-e;return n?Bf(e,n):If(isNaN(e)?t:e)}var qf=function e(t){var n=Uf(t);function i(e,t){var i=n((e=Af(e)).r,(t=Af(t)).r),r=n(e.g,t.g),o=n(e.b,t.b),s=Hf(e.opacity,t.opacity);return function(t){return e.r=i(t),e.g=r(t),e.b=o(t),e.opacity=s(t),e+""}}return i.gamma=e,i}(1);function Vf(e){return function(t){var n,i,r=t.length,o=new Array(r),s=new Array(r),a=new Array(r);for(n=0;n<r;++n)i=Af(t[n]),o[n]=i.r||0,s[n]=i.g||0,a[n]=i.b||0;return o=e(o),s=e(s),a=e(a),i.opacity=1,function(e){return i.r=o(e),i.g=s(e),i.b=a(e),i+""}}}var Gf=Vf(Pf),Kf=Vf(zf),Yf=function(e,t){t||(t=[]);var n,i=e?Math.min(t.length,e.length):0,r=t.slice();return function(o){for(n=0;n<i;++n)r[n]=e[n]*(1-o)+t[n]*o;return r}};function Xf(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}var Jf=function(e,t){return(Xf(t)?Yf:Qf)(e,t)};function Qf(e,t){var n,i=t?t.length:0,r=e?Math.min(i,e.length):0,o=new Array(r),s=new Array(i);for(n=0;n<r;++n)o[n]=op(e[n],t[n]);for(;n<i;++n)s[n]=t[n];return function(e){for(n=0;n<r;++n)s[n]=o[n](e);return s}}var Zf=function(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}},ep=function(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}},tp=function(e,t){var n,i={},r={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?i[n]=op(e[n],t[n]):r[n]=t[n];return function(e){for(n in i)r[n]=i[n](e);return r}},np=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ip=new RegExp(np.source,"g");var rp=function(e,t){var n,i,r,o=np.lastIndex=ip.lastIndex=0,s=-1,a=[],l=[];for(e+="",t+="";(n=np.exec(e))&&(i=ip.exec(t));)(r=i.index)>o&&(r=t.slice(o,r),a[s]?a[s]+=r:a[++s]=r),(n=n[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,l.push({i:s,x:ep(n,i)})),o=ip.lastIndex;return o<t.length&&(r=t.slice(o),a[s]?a[s]+=r:a[++s]=r),a.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,i=0;i<t;++i)a[(n=l[i]).i]=n.x(e);return a.join("")})},op=function(e,t){var n,i=typeof t;return null==t||"boolean"===i?If(t):("number"===i?ep:"string"===i?(n=kf(t))?(t=n,qf):rp:t instanceof kf?qf:t instanceof Date?Zf:Xf(t)?Yf:Array.isArray(t)?Qf:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?tp:ep)(e,t)},sp=function(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}},ap=function(e){return+e},lp=[0,1];function cp(e){return e}function up(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function hp(e,t,n){var i=e[0],r=e[1],o=t[0],s=t[1];return r<i?(i=up(r,i),o=n(s,o)):(i=up(i,r),o=n(o,s)),function(e){return o(i(e))}}function dp(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),o=new Array(i),s=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<i;)r[s]=up(e[s],e[s+1]),o[s]=n(t[s],t[s+1]);return function(t){var n=Xd(e,t,1,i)-1;return o[n](r[n](t))}}function fp(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function pp(){var e,t,n,i,r,o,s=lp,a=lp,l=op,c=cp;function u(){var e,t,n,l=Math.min(s.length,a.length);return c!==cp&&(e=s[0],t=s[l-1],e>t&&(n=e,e=t,t=n),c=function(n){return Math.max(e,Math.min(t,n))}),i=l>2?dp:hp,r=o=null,h}function h(t){return isNaN(t=+t)?n:(r||(r=i(s.map(e),a,l)))(e(c(t)))}return h.invert=function(n){return c(t((o||(o=i(a,s.map(e),ep)))(n)))},h.domain=function(e){return arguments.length?(s=Array.from(e,ap),u()):s.slice()},h.range=function(e){return arguments.length?(a=Array.from(e),u()):a.slice()},h.rangeRound=function(e){return a=Array.from(e),l=sp,u()},h.clamp=function(e){return arguments.length?(c=!!e||cp,u()):c!==cp},h.interpolate=function(e){return arguments.length?(l=e,u()):l},h.unknown=function(e){return arguments.length?(n=e,h):n},function(n,i){return e=n,t=i,u()}}function gp(){return pp()(cp,cp)}function mp(e){var t=e.domain;return e.ticks=function(e){var n=t();return Oe(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var i=t();return nf(i[0],i[i.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var i,r=t(),o=0,s=r.length-1,a=r[o],l=r[s];return l<a&&(i=a,a=l,l=i,i=o,o=s,s=i),(i=Ce(a,l,n))>0?i=Ce(a=Math.floor(a/i)*i,l=Math.ceil(l/i)*i,n):i<0&&(i=Ce(a=Math.ceil(a*i)/i,l=Math.floor(l*i)/i,n)),i>0?(r[o]=Math.floor(a/i)*i,r[s]=Math.ceil(l/i)*i,t(r)):i<0&&(r[o]=Math.ceil(a*i)/i,r[s]=Math.floor(l*i)/i,t(r)),e},e}var vp=function(e,t){var n,i=0,r=(e=e.slice()).length-1,o=e[i],s=e[r];return s<o&&(n=i,i=r,r=n,n=o,o=s,s=n),e[i]=t.floor(o),e[r]=t.ceil(s),e};function bp(e){return Math.log(e)}function yp(e){return Math.exp(e)}function wp(e){return-Math.log(-e)}function xp(e){return-Math.exp(-e)}function _p(e){return isFinite(e)?+("1e"+e):e<0?0:e}function kp(e){return function(t){return-e(-t)}}function Sp(e){var t,n,i=e(bp,yp),r=i.domain,o=10;function s(){return t=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(o),n=function(e){return 10===e?_p:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(o),r()[0]<0?(t=kp(t),n=kp(n),e(wp,xp)):e(bp,yp),i}return i.base=function(e){return arguments.length?(o=+e,s()):o},i.domain=function(e){return arguments.length?(r(e),s()):r()},i.ticks=function(e){var i,s=r(),a=s[0],l=s[s.length-1];(i=l<a)&&(d=a,a=l,l=d);var c,u,h,d=t(a),f=t(l),p=null==e?10:+e,g=[];if(!(o%1)&&f-d<p){if(d=Math.floor(d),f=Math.ceil(f),a>0){for(;d<=f;++d)for(u=1,c=n(d);u<o;++u)if(!((h=c*u)<a)){if(h>l)break;g.push(h)}}else for(;d<=f;++d)for(u=o-1,c=n(d);u>=1;--u)if(!((h=c*u)<a)){if(h>l)break;g.push(h)}2*g.length<p&&(g=Oe(a,l,p))}else g=Oe(d,f,Math.min(f-d,p)).map(n);return i?g.reverse():g},i.tickFormat=function(e,r){if(null==r&&(r=10===o?".0e":","),"function"!=typeof r&&(r=De(r)),e===1/0)return r;null==e&&(e=10);var s=Math.max(1,o*e/i.ticks().length);return function(e){var i=e/n(Math.round(t(e)));return i*o<o-.5&&(i*=o),i<=s?r(e):""}},i.nice=function(){return r(vp(r(),{floor:function(e){return n(Math.floor(t(e)))},ceil:function(e){return n(Math.ceil(t(e)))}}))},i}function Op(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Cp(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Ap(e){return e<0?-e*e:e*e}function $p(e){var t=e(cp,cp),n=1;function i(){return 1===n?e(cp,cp):.5===n?e(Cp,Ap):e(Op(n),Op(1/n))}return t.exponent=function(e){return arguments.length?(n=+e,i()):n},mp(t)}function Ep(){var e=$p(pp());return e.copy=function(){return fp(e,Ep()).exponent(e.exponent())},Jd.apply(e,arguments),e}function Mp(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function jp(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Rp(e){var t=1,n=e(Mp(t),jp(t));return n.constant=function(n){return arguments.length?e(Mp(t=+n),jp(t)):t},mp(n)}function Dp(e){return new Date(e)}function Tp(e){return e instanceof Date?+e:+new Date(+e)}function Lp(e,t,n,i,r,o,s,a,l){var c=gp(),u=c.invert,h=c.domain,d=l(".%L"),f=l(":%S"),p=l("%I:%M"),g=l("%I %p"),m=l("%a %d"),v=l("%b %d"),b=l("%B"),y=l("%Y"),w=[[s,1,1e3],[s,5,5e3],[s,15,15e3],[s,30,3e4],[o,1,6e4],[o,5,3e5],[o,15,9e5],[o,30,18e5],[r,1,36e5],[r,3,108e5],[r,6,216e5],[r,12,432e5],[i,1,864e5],[i,2,1728e5],[n,1,6048e5],[t,1,2592e6],[t,3,7776e6],[e,1,31536e6]];function x(a){return(s(a)<a?d:o(a)<a?f:r(a)<a?p:i(a)<a?g:t(a)<a?n(a)<a?m:v:e(a)<a?b:y)(a)}function _(t,n,i){if(null==t&&(t=10),"number"==typeof t){var r,o=Math.abs(i-n)/t,s=Tn((function(e){return e[2]})).right(w,o);return s===w.length?(r=Ae(n/31536e6,i/31536e6,t),t=e):s?(r=(s=w[o/w[s-1][2]<w[s][2]/o?s-1:s])[1],t=s[0]):(r=Math.max(Ae(n,i,t),1),t=a),t.every(r)}return t}return c.invert=function(e){return new Date(u(e))},c.domain=function(e){return arguments.length?h(Array.from(e,Tp)):h().map(Dp)},c.ticks=function(e){var t,n=h(),i=n[0],r=n[n.length-1],o=r<i;return o&&(t=i,i=r,r=t),t=(t=_(e,i,r))?t.range(i,r+1):[],o?t.reverse():t},c.tickFormat=function(e,t){return null==t?x:l(t)},c.nice=function(e){var t=h();return(e=_(e,t[0],t[t.length-1]))?h(vp(t,e)):c},c.copy=function(){return fp(c,Lp(e,t,n,i,r,o,s,a,l))},c}function Fp(){var e,t,n,i,r,o=0,s=1,a=cp,l=!1;function c(t){return isNaN(t=+t)?r:a(0===n?.5:(t=(i(t)-e)*n,l?Math.max(0,Math.min(1,t)):t))}function u(e){return function(t){var n,i;return arguments.length?([n,i]=t,a=e(n,i),c):[a(0),a(1)]}}return c.domain=function(r){return arguments.length?([o,s]=r,e=i(o=+o),t=i(s=+s),n=e===t?0:1/(t-e),c):[o,s]},c.clamp=function(e){return arguments.length?(l=!!e,c):l},c.interpolator=function(e){return arguments.length?(a=e,c):a},c.range=u(op),c.rangeRound=u(sp),c.unknown=function(e){return arguments.length?(r=e,c):r},function(r){return i=r,e=r(o),t=r(s),n=e===t?0:1/(t-e),c}}function Np(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Pp(){var e=mp(Fp()(cp));return e.copy=function(){return Np(e,Pp())},Qd.apply(e,arguments)}function zp(){var e=$p(Fp());return e.copy=function(){return Np(e,zp()).exponent(e.exponent())},Qd.apply(e,arguments)}function Ip(e,t){for(var n=0,i=t.length-1,r=t[0],o=new Array(i<0?0:i);n<i;)o[n]=e(r,r=t[++n]);return function(e){var t=Math.max(0,Math.min(i-1,Math.floor(e*=i)));return o[t](e-t)}}function Bp(){var e,t,n,i,r,o,s,a=0,l=.5,c=1,u=1,h=cp,d=!1;function f(e){return isNaN(e=+e)?s:(e=.5+((e=+o(e))-t)*(u*e<u*t?i:r),h(d?Math.max(0,Math.min(1,e)):e))}function p(e){return function(t){var n,i,r;return arguments.length?([n,i,r]=t,h=Ip(e,[n,i,r]),f):[h(0),h(.5),h(1)]}}return f.domain=function(s){return arguments.length?([a,l,c]=s,e=o(a=+a),t=o(l=+l),n=o(c=+c),i=e===t?0:.5/(t-e),r=t===n?0:.5/(n-t),u=t<e?-1:1,f):[a,l,c]},f.clamp=function(e){return arguments.length?(d=!!e,f):d},f.interpolator=function(e){return arguments.length?(h=e,f):h},f.range=p(op),f.rangeRound=p(sp),f.unknown=function(e){return arguments.length?(s=e,f):s},function(s){return o=s,e=s(a),t=s(l),n=s(c),i=e===t?0:.5/(t-e),r=t===n?0:.5/(n-t),u=t<e?-1:1,f}}function Wp(){var e=$p(Bp());return e.copy=function(){return Np(e,Wp()).exponent(e.exponent())},Qd.apply(e,arguments)}const Up={};function Hp(e,t,n){const i=function(){const n=t();return n.invertRange||(n.invertRange=n.invert?function(e){return function(t){let n,i=t[0],r=t[1];return r<i&&(n=i,i=r,r=n),[e.invert(i),e.invert(r)]}}(n):n.invertExtent?function(e){return function(t){let n,i,r,o,s=e.range(),a=t[0],l=t[1],c=-1;for(l<a&&(i=a,a=l,l=i),r=0,o=s.length;r<o;++r)s[r]>=a&&s[r]<=l&&(c<0&&(c=r),n=r);if(!(c<0))return a=e.invertExtent(s[c]),l=e.invertExtent(s[n]),[void 0===a[0]?a[1]:a[0],void 0===l[1]?l[0]:l[1]]}}(n):void 0),n.type=e,n};return i.metadata=Object(p.eb)(Object(p.i)(n)),i}function qp(e,t,n){return arguments.length>1?(Up[e]=Hp(e,t,n),this):Vp(e)?Up[e]:void 0}function Vp(e){return Object(p.w)(Up,e)}function Gp(e,t){const n=Up[e];return n&&n.metadata[t]}function Kp(e){return Gp(e,Vd)}function Yp(e){return Gp(e,"discrete")}function Xp(e){return Gp(e,"discretizing")}function Jp(e){return Gp(e,Ud)}function Qp(e){return Gp(e,"interpolating")}function Zp(e){return Gp(e,"quantile")}qp("identity",(function e(t){var n;function i(e){return isNaN(e=+e)?n:e}return i.invert=i,i.domain=i.range=function(e){return arguments.length?(t=Array.from(e,ap),i):t.slice()},i.unknown=function(e){return arguments.length?(n=e,i):n},i.copy=function(){return e(t).unknown(n)},t=arguments.length?Array.from(t,ap):[0,1],mp(i)})),qp("linear",(function e(){var t=gp();return t.copy=function(){return fp(t,e())},Jd.apply(t,arguments),mp(t)}),Vd),qp(Ud,(function e(){var t=Sp(pp()).domain([1,10]);return t.copy=function(){return fp(t,e()).base(t.base())},Jd.apply(t,arguments),t}),[Vd,Ud]),qp("pow",Ep,Vd),qp("sqrt",(function(){return Ep.apply(null,arguments).exponent(.5)}),Vd),qp("symlog",(function e(){var t=Rp(pp());return t.copy=function(){return fp(t,e()).constant(t.constant())},Jd.apply(t,arguments)}),Vd),qp(Hd,(function(){return Jd.apply(Lp(rn,sn,vt,gt,ln,un,dn,pn,Yn).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}),[Vd,"temporal"]),qp(qd,(function(){return Jd.apply(Lp(mn,bn,At,Ot,wn,_n,dn,pn,Jn).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}),[Vd,"temporal"]),qp("sequential",Pp,[Vd,"interpolating"]),qp("sequential-linear",Pp,[Vd,"interpolating"]),qp("sequential-log",(function e(){var t=Sp(Fp()).domain([1,10]);return t.copy=function(){return Np(t,e()).base(t.base())},Qd.apply(t,arguments)}),[Vd,"interpolating",Ud]),qp("sequential-pow",zp,[Vd,"interpolating"]),qp("sequential-sqrt",(function(){return zp.apply(null,arguments).exponent(.5)}),[Vd,"interpolating"]),qp("sequential-symlog",(function e(){var t=Rp(Fp());return t.copy=function(){return Np(t,e()).constant(t.constant())},Qd.apply(t,arguments)}),[Vd,"interpolating"]),qp("diverging-linear",(function e(){var t=mp(Bp()(cp));return t.copy=function(){return Np(t,e())},Qd.apply(t,arguments)}),[Vd,"interpolating"]),qp("diverging-log",(function e(){var t=Sp(Bp()).domain([.1,1,10]);return t.copy=function(){return Np(t,e()).base(t.base())},Qd.apply(t,arguments)}),[Vd,"interpolating",Ud]),qp("diverging-pow",Wp,[Vd,"interpolating"]),qp("diverging-sqrt",(function(){return Wp.apply(null,arguments).exponent(.5)}),[Vd,"interpolating"]),qp("diverging-symlog",(function e(){var t=Rp(Bp());return t.copy=function(){return Np(t,e()).constant(t.constant())},Qd.apply(t,arguments)}),[Vd,"interpolating"]),qp("quantile",(function e(){var t,n=[],i=[],r=[];function o(){var e=0,t=Math.max(1,i.length);for(r=new Array(t-1);++e<t;)r[e-1]=oo(n,e/t);return s}function s(e){return isNaN(e=+e)?t:i[Xd(r,e)]}return s.invertExtent=function(e){var t=i.indexOf(e);return t<0?[NaN,NaN]:[t>0?r[t-1]:n[0],t<r.length?r[t]:n[n.length-1]]},s.domain=function(e){if(!arguments.length)return n.slice();n=[];for(let t of e)null==t||isNaN(t=+t)||n.push(t);return n.sort(Dn),o()},s.range=function(e){return arguments.length?(i=Array.from(e),o()):i.slice()},s.unknown=function(e){return arguments.length?(t=e,s):t},s.quantiles=function(){return r.slice()},s.copy=function(){return e().domain(n).range(i).unknown(t)},Jd.apply(s,arguments)}),["discretizing","quantile"]),qp("quantize",(function e(){var t,n=0,i=1,r=1,o=[.5],s=[0,1];function a(e){return e<=e?s[Xd(o,e,0,r)]:t}function l(){var e=-1;for(o=new Array(r);++e<r;)o[e]=((e+1)*i-(e-r)*n)/(r+1);return a}return a.domain=function(e){return arguments.length?([n,i]=e,n=+n,i=+i,l()):[n,i]},a.range=function(e){return arguments.length?(r=(s=Array.from(e)).length-1,l()):s.slice()},a.invertExtent=function(e){var t=s.indexOf(e);return t<0?[NaN,NaN]:t<1?[n,o[0]]:t>=r?[o[r-1],i]:[o[t-1],o[t]]},a.unknown=function(e){return arguments.length?(t=e,a):a},a.thresholds=function(){return o.slice()},a.copy=function(){return e().domain([n,i]).range(s).unknown(t)},Jd.apply(mp(a),arguments)}),"discretizing"),qp("threshold",(function e(){var t,n=[.5],i=[0,1],r=1;function o(e){return e<=e?i[Xd(n,e,0,r)]:t}return o.domain=function(e){return arguments.length?(n=Array.from(e),r=Math.min(n.length,i.length-1),o):n.slice()},o.range=function(e){return arguments.length?(i=Array.from(e),r=Math.min(n.length,i.length-1),o):i.slice()},o.invertExtent=function(e){var t=i.indexOf(e);return[n[t-1],n[t]]},o.unknown=function(e){return arguments.length?(t=e,o):t},o.copy=function(){return e().domain(n).range(i).unknown(t)},Jd.apply(o,arguments)}),"discretizing"),qp("bin-ordinal",(function e(){let t=[],n=[];function i(e){return null==e||e!=e?void 0:n[(Xd(t,e)-1)%n.length]}return i.domain=function(e){return arguments.length?(t=of(e),i):t.slice()},i.range=function(e){return arguments.length?(n=sf.call(e),i):n.slice()},i.tickFormat=function(e,n){return nf(t[0],Object(p.V)(t),null==e?10:e,n)},i.copy=function(){return e().domain(i.domain()).range(i.range())},i}),["discrete","discretizing"]),qp("ordinal",ef,"discrete"),qp("band",tf,"discrete"),qp("point",(function(){return function e(t){const n=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return e(n())},t}(tf().paddingInner(1))}),"discrete");var eg,tg,ng,ig,rg=function(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}},og=function(e,t){var n=Wf(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}},sg=180/Math.PI,ag={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},lg=function(e,t,n,i,r,o){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*i)&&(n-=e*l,i-=t*l),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,l/=a),e*i<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:r,translateY:o,rotate:Math.atan2(t,e)*sg,skewX:Math.atan(l)*sg,scaleX:s,scaleY:a}};function cg(e,t,n,i){function r(e){return e.length?e.pop()+" ":""}return function(o,s){var a=[],l=[];return o=e(o),s=e(s),function(e,i,r,o,s,a){if(e!==r||i!==o){var l=s.push("translate(",null,t,null,n);a.push({i:l-4,x:ep(e,r)},{i:l-2,x:ep(i,o)})}else(r||o)&&s.push("translate("+r+t+o+n)}(o.translateX,o.translateY,s.translateX,s.translateY,a,l),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(r(n)+"rotate(",null,i)-2,x:ep(e,t)})):t&&n.push(r(n)+"rotate("+t+i)}(o.rotate,s.rotate,a,l),function(e,t,n,o){e!==t?o.push({i:n.push(r(n)+"skewX(",null,i)-2,x:ep(e,t)}):t&&n.push(r(n)+"skewX("+t+i)}(o.skewX,s.skewX,a,l),function(e,t,n,i,o,s){if(e!==n||t!==i){var a=o.push(r(o)+"scale(",null,",",null,")");s.push({i:a-4,x:ep(e,n)},{i:a-2,x:ep(t,i)})}else 1===n&&1===i||o.push(r(o)+"scale("+n+","+i+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,l),o=s=null,function(e){for(var t,n=-1,i=l.length;++n<i;)a[(t=l[n]).i]=t.x(e);return a.join("")}}}var ug=cg((function(e){return"none"===e?ag:(eg||(eg=document.createElement("DIV"),tg=document.documentElement,ng=document.defaultView),eg.style.transform=e,e=ng.getComputedStyle(tg.appendChild(eg),null).getPropertyValue("transform"),tg.removeChild(eg),e=e.slice(7,-1).split(","),lg(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5]))}),"px, ","px)","deg)"),hg=cg((function(e){return null==e?ag:(ig||(ig=document.createElementNS("http://www.w3.org/2000/svg","g")),ig.setAttribute("transform",e),(e=ig.transform.baseVal.consolidate())?(e=e.matrix,lg(e.a,e.b,e.c,e.d,e.e,e.f)):ag)}),", ",")",")"),dg=Math.SQRT2;function fg(e){return((e=Math.exp(e))+1/e)/2}var pg=function(e,t){var n,i,r=e[0],o=e[1],s=e[2],a=t[0],l=t[1],c=t[2],u=a-r,h=l-o,d=u*u+h*h;if(d<1e-12)i=Math.log(c/s)/dg,n=function(e){return[r+e*u,o+e*h,s*Math.exp(dg*e*i)]};else{var f=Math.sqrt(d),p=(c*c-s*s+4*d)/(2*s*2*f),g=(c*c-s*s-4*d)/(2*c*2*f),m=Math.log(Math.sqrt(p*p+1)-p),v=Math.log(Math.sqrt(g*g+1)-g);i=(v-m)/dg,n=function(e){var t,n=e*i,a=fg(m),l=s/(2*f)*(a*(t=dg*n+m,((t=Math.exp(2*t))-1)/(t+1))-function(e){return((e=Math.exp(e))-1/e)/2}(m));return[r+l*u,o+l*h,s*a/fg(dg*n+m)]}}return n.duration=1e3*i,n};function gg(e){return function(t,n){var i=e((t=Tf(t)).h,(n=Tf(n)).h),r=Hf(t.s,n.s),o=Hf(t.l,n.l),s=Hf(t.opacity,n.opacity);return function(e){return t.h=i(e),t.s=r(e),t.l=o(e),t.opacity=s(e),t+""}}}var mg=gg(Wf),vg=gg(Hf),bg=Math.PI/180,yg=180/Math.PI;function wg(e){if(e instanceof _g)return new _g(e.l,e.a,e.b,e.opacity);if(e instanceof Eg)return Mg(e);e instanceof $f||(e=Cf(e));var t,n,i=Cg(e.r),r=Cg(e.g),o=Cg(e.b),s=kg((.2225045*i+.7168786*r+.0606169*o)/1);return i===r&&r===o?t=n=s:(t=kg((.4360747*i+.3850649*r+.1430804*o)/.96422),n=kg((.0139322*i+.0971045*r+.7141733*o)/.82521)),new _g(116*s-16,500*(t-s),200*(s-n),e.opacity)}function xg(e,t,n,i){return 1===arguments.length?wg(e):new _g(e,t,n,null==i?1:i)}function _g(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}function kg(e){return e>6/29*(6/29)*(6/29)?Math.pow(e,1/3):e/(6/29*3*(6/29))+4/29}function Sg(e){return e>6/29?e*e*e:6/29*3*(6/29)*(e-4/29)}function Og(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Cg(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Ag(e){if(e instanceof Eg)return new Eg(e.h,e.c,e.l,e.opacity);if(e instanceof _g||(e=wg(e)),0===e.a&&0===e.b)return new Eg(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*yg;return new Eg(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function $g(e,t,n,i){return 1===arguments.length?Ag(e):new Eg(e,t,n,null==i?1:i)}function Eg(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function Mg(e){if(isNaN(e.h))return new _g(e.l,0,0,e.opacity);var t=e.h*bg;return new _g(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}function jg(e,t){var n=Hf((e=xg(e)).l,(t=xg(t)).l),i=Hf(e.a,t.a),r=Hf(e.b,t.b),o=Hf(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=i(t),e.b=r(t),e.opacity=o(t),e+""}}function Rg(e){return function(t,n){var i=e((t=$g(t)).h,(n=$g(n)).h),r=Hf(t.c,n.c),o=Hf(t.l,n.l),s=Hf(t.opacity,n.opacity);return function(e){return t.h=i(e),t.c=r(e),t.l=o(e),t.opacity=s(e),t+""}}}af(_g,xg,lf(cf,{brighter:function(e){return new _g(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new _g(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new $f(Og(3.1338561*(t=.96422*Sg(t))-1.6168667*(e=1*Sg(e))-.4906146*(n=.82521*Sg(n))),Og(-.9787684*t+1.9161415*e+.033454*n),Og(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),af(Eg,$g,lf(cf,{brighter:function(e){return new Eg(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new Eg(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return Mg(this).rgb()}}));var Dg=Rg(Wf),Tg=Rg(Hf),Lg=1.97294,Fg=-.90649*Lg,Ng=1.78277*Lg,Pg=-.6557636667999999;function zg(e){if(e instanceof Bg)return new Bg(e.h,e.s,e.l,e.opacity);e instanceof $f||(e=Cf(e));var t=e.r/255,n=e.g/255,i=e.b/255,r=(Pg*i+Fg*t-Ng*n)/(Pg+Fg-Ng),o=i-r,s=(Lg*(n-r)- -.29227*o)/-.90649,a=Math.sqrt(s*s+o*o)/(Lg*r*(1-r)),l=a?Math.atan2(s,o)*yg-120:NaN;return new Bg(l<0?l+360:l,a,r,e.opacity)}function Ig(e,t,n,i){return 1===arguments.length?zg(e):new Bg(e,t,n,null==i?1:i)}function Bg(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function Wg(e){return function t(n){function i(t,i){var r=e((t=Ig(t)).h,(i=Ig(i)).h),o=Hf(t.s,i.s),s=Hf(t.l,i.l),a=Hf(t.opacity,i.opacity);return function(e){return t.h=r(e),t.s=o(e),t.l=s(Math.pow(e,n)),t.opacity=a(e),t+""}}return n=+n,i.gamma=t,i}(1)}af(Bg,Ig,lf(cf,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new Bg(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new Bg(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*bg,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new $f(255*(t+n*(-.14861*i+1.78277*r)),255*(t+n*(-.29227*i+-.90649*r)),255*(t+n*(Lg*i)),this.opacity)}}));var Ug=Wg(Wf),Hg=Wg(Hf),qg=function(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e(i/(t-1));return n};const Vg=["clamp","base","constant","exponent"];function Gg(e,t){const n=t[0],i=Object(p.V)(t)-n;return function(t){return e(n+t*i)}}function Kg(e,t,n){return Ip(Jg(t||"rgb",n),e)}function Yg(e,t){const n=new Array(t),i=t+1;for(let r=0;r<t;)n[r]=e(++r/i);return n}function Xg(e,t,n){let i,r,o,s=n-t;return s&&Number.isFinite(s)?(i=(r=e.type).indexOf("-"),r=i<0?r:r.slice(i+1),o=qp(r)().domain([t,n]).range([0,1]),Vg.forEach(t=>e[t]?o[t](e[t]()):0),o):Object(p.m)(.5)}function Jg(e,t){const n=r[function(e){return"interpolate"+e.toLowerCase().split("-").map((function(e){return e[0].toUpperCase()+e.slice(1)})).join("")}(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}function Qg(e){const t=e.length/6|0,n=new Array(t);for(let i=0;i<t;)n[i]="#"+e.slice(6*i,6*++i);return n}function Zg(e,t){for(const n in e)tm(n,t(e[n]))}const em={};function tm(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(em[e]=t,this):em[e]}Zg({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},Qg),Zg({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},e=>Kg(Qg(e)));const nm=e=>Object(p.B)(e)?e.map(e=>String(e)):String(e),im=(e,t)=>e[1]-t[1],rm=(e,t)=>t[1]-e[1];function om(e,t,n){let i;return Object(p.F)(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),null!=n&&(t=Math.min(t,Math.floor(Object(p.Y)(e.domain())/n||1)))),Object(p.G)(t)&&(i=t.step,t=t.interval),Object(p.I)(t)&&(t=e.type===Hd?On(t):e.type==qd?Cn(t):Object(p.o)("Only time and utc scales accept interval strings."),i&&(t=t.every(i))),t}function sm(e,t,n){let i=e.range(),r=i[0],o=Object(p.V)(i),s=im;if(r>o&&(i=o,o=r,r=i,s=rm),r=Math.floor(r),o=Math.ceil(o),t=t.map(t=>[t,e(t)]).filter(e=>r<=e[1]&&e[1]<=o).sort(s).map(e=>e[0]),n>0&&t.length>1){const e=[t[0],Object(p.V)(t)];for(;t.length>n&&t.length>=3;)t=t.filter((e,t)=>!(t%2));t.length<3&&(t=e)}return t}function am(e,t){return e.bins?sm(e,e.bins):e.ticks?e.ticks(t):e.domain()}function lm(e,t,n,i,r,o){const s=t.type;let a=nm;if(s===Hd||r===Hd)a=e.timeFormat(i);else if(s===qd||r===qd)a=e.utcFormat(i);else if(Jp(s)){const r=e.formatFloat(i);if(o||t.bins)a=r;else{const e=cm(t,n,!1);a=t=>e(t)?r(t):""}}else if(t.tickFormat){const r=t.domain();a=e.formatSpan(r[0],r[r.length-1],n,i)}else i&&(a=e.format(i));return a}function cm(e,t,n){const i=am(e,t),r=e.base(),o=Math.log(r),s=Math.max(1,r*t/i.length),a=e=>{let t=e/Math.pow(r,Math.round(Math.log(e)/o));return t*r<r-.5&&(t*=r),t<=s};return n?i.filter(a):a}const um={quantile:"quantiles",quantize:"thresholds",threshold:"domain"},hm={quantile:"quantiles",quantize:"domain"};function dm(e,t){return e.bins?function(e){const t=e.slice(0,-1);return t.max=Object(p.V)(e),t}(e.bins):e.type===Ud?cm(e,t,!0):um[e.type]?function(e){const t=[-1/0].concat(e);return t.max=1/0,t}(e[um[e.type]]()):am(e,t)}function fm(e,t,n,i,r,o,s){const a=hm[t.type]&&o!==Hd&&o!==qd?function(e,t,n){let i,r=t[hm[t.type]](),o=r.length,s=o>1?r[1]-r[0]:r[0];for(i=1;i<o;++i)s=Math.min(s,r[i]-r[i-1]);return e.formatSpan(0,s,30,n)}(e,t,r):lm(e,t,n,r,o,s);return"symbol"===i&&(e=>um[e.type]||e.bins)(t)?pm(a):"discrete"===i?mm(a):vm(a)}const pm=e=>(t,n,i)=>{const r=gm(i[n+1],gm(i.max,1/0)),o=bm(t,e),s=bm(r,e);return o&&s?o+" â€“ "+s:s?"< "+s:"â‰¥ "+o},gm=(e,t)=>null!=e?e:t,mm=e=>(t,n)=>n?e(t):null,vm=e=>t=>e(t),bm=(e,t)=>Number.isFinite(e)?t(e):null;function ym(e,t,n,i){const r=i||t.type;return Object(p.I)(n)&&Gp(r,"temporal")&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||r!==Hd?n||r!==qd?fm(e,t,5,null,n,i,!0):e.utcFormat("%A, %d %B %Y, %X UTC"):e.timeFormat("%A, %d %B %Y, %X")}function wm(e,t,n){n=n||{};const i=Math.max(3,n.maxlen||7),r=ym(e,t,n.format,n.formatType);if(Xp(t.type)){const e=dm(t).slice(1).map(r),n=e.length;return`${n} boundar${1===n?"y":"ies"}: ${e.join(", ")}`}if(Yp(t.type)){const e=t.domain(),n=e.length;return`${n} value${1===n?"":"s"}: ${n>i?e.slice(0,i-2).map(r).join(", ")+", ending with "+e.slice(-1).map(r):e.map(r).join(", ")}`}{const e=t.domain();return`values from ${r(e[0])} to ${r(Object(p.V)(e))}`}}const xm=(e,t,n)=>({role:e,"aria-roledescription":t,"aria-label":n||void 0}),_m=Object(p.eb)(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),km={axis:{desc:"axis",caption:function(e){const t=e.datum,n=e.orient,i=t.title?$m(e):null,r=e.context,o=r.scales[t.scale].value,s=r.dataflow.locale(),a=o.type;return("left"===n||"right"===n?"Y":"X")+"-axis"+(i?` titled '${i}'`:"")+` for a ${Yp(a)?"discrete":a} scale with `+wm(s,o,e)}},legend:{desc:"legend",caption:function(e){const t=e.datum,n=t.title?$m(e):null,i=((t.type||"")+" legend").trim(),r=t.scales,o=Object.keys(r),s=e.context,a=s.scales[r[o[0]]].value,l=s.dataflow.locale();return c=i,(c.length?c[0].toUpperCase()+c.slice(1):c)+(n?` titled '${n}'`:"")+" for "+function(e){return(e=e.map(e=>e+("fill"===e||"stroke"===e?" color":""))).length<2?e[0]:e.slice(0,-1).join(", ")+" and "+Object(p.V)(e)}(o)+" with "+wm(l,a,e);var c}},"title-text":{desc:"title",caption:e=>`Title text '${Am(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${Am(e)}'`}},Sm={ariaRole:"role",ariaRoleDescription:"aria-roledescription",description:"aria-label"};function Om(e,t){const n=!1===t.aria;if(e("aria-hidden",n||void 0),n||null==t.description)for(const t in Sm)e(Sm[t],void 0);else{const n=t.mark.marktype;e("aria-label",t.description),e("role",t.ariaRole||("group"===n?"graphics-object":"graphics-symbol")),e("aria-roledescription",t.ariaRoleDescription||n+" mark")}}function Cm(e){return!1===e.aria?{"aria-hidden":!0}:_m[e.role]?null:km[e.role]?function(e,t){try{const n=e.items[0],i=t.caption||(()=>"");return xm(t.role||"graphics-symbol",t.desc,n.description||i(n))}catch(e){return null}}(e,km[e.role]):function(e){const t=e.marktype,n="group"===t||"text"===t||e.items.some(e=>null!=e.description&&!1!==e.aria);return xm(n?"graphics-object":"graphics-symbol",t+" mark container",e.description)}(e)}function Am(e){return Object(p.i)(e.text).join(" ")}function $m(e){try{return Object(p.i)(Object(p.V)(e.items).items[0].text).join(" ")}catch(e){return null}}const Em=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function Mm(){let e="",t="",n="";const i=[],r=()=>t=n="",o=(e,n)=>{var i;return null!=n&&(t+=` ${e}="${i=n,Em(i).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")}"`),s},s={open(a,...l){(o=>{t&&(e+=`${t}>${n}`,r()),i.push(o)})(a),t="<"+a;for(const e of l)for(const t in e)o(t,e[t]);return s},close(){const o=i.pop();return e+=t?t+(n?`>${n}</${o}>`:"/>"):`</${o}>`,r(),s},attr:o,text:e=>(n+=Em(e),s),toString:()=>e};return s}const jm=e=>function e(t,n){if(t.open(n.tagName),n.hasAttributes()){const e=n.attributes,i=e.length;for(let n=0;n<i;++n)t.attr(e[n].name,e[n].value)}if(n.hasChildNodes()){const i=n.childNodes,r=i.length;for(let n=0;n<r;n++){const r=i[n];3===r.nodeType?t.text(r.nodeValue):e(t,r)}}return t.close()}(Mm(),e)+"";const Rm={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},Dm={fill:"none","stroke-miterlimit":10},Tm=Oh.xmlns;function Lm(e){kd.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const Fm=kd.prototype;function Nm(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function Pm(e,t,n){let i,r,o;if("radial"===t.gradient){let i=vd(e,n++,"pattern",Tm);Vm(i,{id:"p_"+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),i=vd(i,0,"rect",Tm),Vm(i,{width:1,height:1,fill:`url(${Km()}#${t.id})`}),Vm(e=vd(e,n++,"radialGradient",Tm),{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else Vm(e=vd(e,n++,"linearGradient",Tm),{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(i=0,r=t.stops.length;i<r;++i)o=vd(e,i,"stop",Tm),o.setAttribute("offset",t.stops[i].offset),o.setAttribute("stop-color",t.stops[i].color);return bd(e,i),n}function zm(e,t,n){let i;return(e=vd(e,n,"clipPath",Tm)).setAttribute("id",t.id),t.path?(i=vd(e,0,"path",Tm),i.setAttribute("d",t.path)):(i=vd(e,0,"rect",Tm),Vm(i,{x:0,y:0,width:t.width,height:t.height})),bd(e,1),n+1}function Im(e,t,n,i,r){let o,s=e._svg;if(!s&&(o=t.ownerDocument,s=gd(o,i,Tm),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},"g"===i))){const t=gd(o,"path",Tm);s.appendChild(t),t.__data__=e;const n=gd(o,"g",Tm);s.appendChild(n),n.__data__=e;const i=gd(o,"path",Tm);s.appendChild(i),i.__data__=e,i.__values__={fill:"default"}}return(s.ownerSVGElement!==r||function(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}(s,n))&&t.insertBefore(s,n?n.nextSibling:t.firstChild),s}Object(p.z)(Lm,kd,{initialize(e,t,n,i,r){return this._defs={},this._clearDefs(),e&&(this._svg=vd(e,0,"svg",Tm),Vm(this._svg,Oh),this._svg.setAttribute("class","marks"),bd(e,1),this._root=vd(this._svg,0,"g",Tm),Vm(this._root,Dm),bd(this._svg,1)),this.background(this._bgcolor),Fm.initialize.call(this,e,t,n,i,r)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),Fm.background.apply(this,arguments)},resize(e,t,n,i){return Fm.resize.call(this,e,t,n,i),this._svg&&(Vm(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=vd(e,0,"rect",Tm),Vm(n,{width:this._width,height:this._height,fill:t}));const i=jm(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),i},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),bd(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;let t,n,i,r,o,s,a,l=++this._dirtyID;for(o=0,s=e.length;o<s;++o)t=e[o],n=t.mark,n.marktype!==i&&(i=n.marktype,r=sd[i]),n.zdirty&&n.dirty!==l&&(this._dirtyAll=!1,Nm(t,l),n.items.forEach((function(e){e.dirty=l}))),n.zdirty||(t.exit?(r.nested&&n.items.length?(a=n.items[0],a._svg&&this._update(r,a._svg,a)):t._svg&&(a=t._svg.parentNode,a&&a.removeChild(t._svg)),t._svg=null):(t=r.nested?n.items[0]:t,t._update!==l&&(t._svg&&t._svg.ownerSVGElement?this._update(r,t._svg,t):(this._dirtyAll=!1,Nm(t,l)),t._update=l)));return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;let i,r=this._svg,o=sd[t.marktype],s=!1===t.interactive?"none":null,a="g"===o.tag,l=null,c=0;i=Im(t,e,n,"g",r),i.setAttribute("class",yd(t));const u=Cm(t);for(const e in u)Gm(i,e,u[e]);a||Gm(i,"pointer-events",s),Gm(i,"clip-path",t.clip?Pc(this,t,t.group):null);const h=e=>{const t=this.isDirty(e),n=Im(e,i,l,o.tag,r);t&&(this._update(o,n,e),a&&function(e,t,n){t=t.lastChild.previousSibling;let i,r=0;ih(n,n=>{i=e.mark(t,n,i),++r}),bd(t,1+r)}(this,n,e)),l=n,++c};return o.nested?t.items.length&&h(t.items[0]):ih(t,h),bd(i,c),i},_update(e,t,n){Bm=t,Wm=t.__values__,Om(Hm,n),e.attr(Hm,n,this);const i=Um[e.type];i&&i.call(this,e,t,n),Bm&&this.style(Bm,n)},style(e,t){if(null!=t)for(const n in Rm){let i="font"===n?Zh(t):t[n];if(i===Wm[n])continue;const r=Rm[n];null==i?e.removeAttribute(r):(ya(i)&&(i=wa(i,this._defs.gradient,Km())),e.setAttribute(r,i+"")),Wm[n]=i}},defs(){const e=this._svg,t=this._defs;let n=t.el,i=0;for(const r in t.gradient)n||(t.el=n=vd(e,1,"defs",Tm)),i=Pm(n,t.gradient[r],i);for(const r in t.clipping)n||(t.el=n=vd(e,1,"defs",Tm)),i=zm(n,t.clipping[r],i);n&&(0===i?(e.removeChild(n),t.el=null):bd(n,i))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});let Bm=null,Wm=null;const Um={group(e,t,n){const i=Bm=t.childNodes[2];Wm=i.__values__,e.foreground(Hm,n,this),Wm=t.__values__,Bm=t.childNodes[1],e.content(Hm,n,this);const r=Bm=t.childNodes[0];e.background(Hm,n,this);const o=!1===n.mark.interactive?"none":null;if(o!==Wm.events&&(Gm(i,"pointer-events",o),Gm(r,"pointer-events",o),Wm.events=o),n.strokeForeground&&n.stroke){const e=n.fill;Gm(i,"display",null),this.style(r,n),Gm(r,"stroke",null),e&&(n.fill=null),Wm=i.__values__,this.style(i,n),e&&(n.fill=e),Bm=null}else Gm(i,"display","none")},image(e,t,n){!1===n.smooth?(qm(t,"image-rendering","optimizeSpeed"),qm(t,"image-rendering","pixelated")):qm(t,"image-rendering",null)},text(e,t,n){let i,r,o,s,a=Xh(n);Object(p.B)(a)?(r=a.map(e=>Qh(n,e)),i=r.join("\n"),i!==Wm.text&&(bd(t,0),o=t.ownerDocument,s=Yh(n),r.forEach((e,i)=>{const r=gd(o,"tspan",Tm);r.__data__=n,r.textContent=e,i&&(r.setAttribute("x",0),r.setAttribute("dy",s)),t.appendChild(r)}),Wm.text=i)):(r=Qh(n,a),r!==Wm.text&&(t.textContent=r,Wm.text=r)),Gm(t,"font-family",Zh(n)),Gm(t,"font-size",Kh(n)+"px"),Gm(t,"font-style",n.fontStyle),Gm(t,"font-variant",n.fontVariant),Gm(t,"font-weight",n.fontWeight)}};function Hm(e,t,n){t!==Wm[e]&&(n?function(e,t,n,i){null!=n?e.setAttributeNS(i,t,n):e.removeAttributeNS(i,t)}(Bm,e,t,n):Gm(Bm,e,t),Wm[e]=t)}function qm(e,t,n){n!==Wm[t]&&(null==n?e.style.removeProperty(t):e.style.setProperty(t,n+""),Wm[t]=n)}function Vm(e,t){for(const n in t)Gm(e,n,t[n])}function Gm(e,t,n){null!=n?e.setAttribute(t,n):e.removeAttribute(t)}function Km(){let e;return"undefined"==typeof window?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function Ym(e){kd.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}Object(p.z)(Ym,kd,{svg(){return this._text},_render(e){const t=Mm();t.open("svg",Object(p.p)({},Oh,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",Dm,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=sd[t.marktype],i=n.tag,r=[Om,n.attr];e.open("g",{class:yd(t),"clip-path":t.clip?Pc(this,t,t.group):null},Cm(t),{"pointer-events":"g"!==i&&!1===t.interactive?"none":null});const o=o=>{const s=this.href(o);if(s&&e.open("a",s),e.open(i,this.attr(t,o,r,"g"!==i?i:null)),"text"===i){const t=Xh(o);if(Object(p.B)(t)){const n={x:0,dy:Yh(o)};for(let i=0;i<t.length;++i)e.open("tspan",i?n:null).text(Qh(o,t[i])).close()}else e.text(Qh(o,t))}else if("g"===i){const i=o.strokeForeground,r=o.fill,s=o.stroke;i&&s&&(o.stroke=null),e.open("path",this.attr(t,o,n.background,"bgrect")).close(),e.open("g",this.attr(t,o,n.content)),ih(o,t=>this.mark(e,t)),e.close(),i&&s?(r&&(o.fill=null),o.stroke=s,e.open("path",this.attr(t,o,n.foreground,"bgrect")).close(),r&&(o.fill=r)):e.open("path",this.attr(t,o,n.foreground,"bgfore")).close()}e.close(),s&&e.close()};return n.nested?t.items&&t.items.length&&o(t.items[0]):ih(t,o),e.close()},href(e){let t,n=e.href;if(n){if(t=this._hrefs&&this._hrefs[n])return t;this.sanitizeURL(n).then(e=>{e["xlink:href"]=e.href,e.href=null,(this._hrefs||(this._hrefs={}))[n]=e})}return null},attr(e,t,n,i){const r={},o=(e,t,n,i)=>{r[i||e]=t};return Array.isArray(n)?n.forEach(e=>e(o,t,this)):n(o,t,this),i&&function(e,t,n,i,r){if(null==t)return e;"bgrect"===i&&!1===n.interactive&&(e["pointer-events"]="none");if("bgfore"===i&&(!1===n.interactive&&(e["pointer-events"]="none"),e.display="none",null!==t.fill))return e;"image"===i&&!1===t.smooth&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;");"text"===i&&(e["font-family"]=Zh(t),e["font-size"]=Kh(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const n in Rm){let i=t[n];const o=Rm[n];("transparent"!==i||"fill"!==o&&"stroke"!==o)&&null!=i&&(ya(i)&&(i=wa(i,r.gradient,"")),e[o]=i)}}(r,t,e,i,this._defs),r},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(t).length+Object.keys(n).length){e.open("defs");for(const n in t){const i=t[n],r=i.stops;"radial"===i.gradient?(e.open("pattern",{id:"p_"+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),e.close(),e.open("radialGradient",{id:n,fx:i.x1,fy:i.y1,fr:i.r1,cx:i.x2,cy:i.y2,r:i.r2})):e.open("linearGradient",{id:n,x1:i.x1,x2:i.x2,y1:i.y1,y2:i.y2});for(let t=0;t<r.length;++t)e.open("stop",{offset:r[t].offset,"stop-color":r[t].color}).close();e.close()}for(const t in n){const i=n[t];e.open("clipPath",{id:t}),i.path?e.open("path",{d:i.path}).close():e.open("rect",{x:0,y:0,width:i.width,height:i.height}).close(),e.close()}e.close()}}});var Xm={Canvas:"canvas",PNG:"png",SVG:"svg",None:"none"},Jm={};function Qm(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(Jm[e]=t,this):Jm[e]}function Zm(e,t,n){const i=[],r=(new zc).union(t),o=e.marktype;return o?ev(e,r,n,i):"group"===o?tv(e,r,n,i):Object(p.o)("Intersect scene must be mark node or group item.")}function ev(e,t,n,i){if(function(e,t,n){return e.bounds&&t.intersects(e.bounds)&&("group"===e.marktype||!1!==e.interactive&&(!n||n(e)))}(e,t,n)){const r=e.items,o=e.marktype,s=r.length;let a=0;if("group"===o)for(;a<s;++a)tv(r[a],t,n,i);else for(const e=sd[o].isect;a<s;++a){let n=r[a];nv(n,t,e)&&i.push(n)}}return i}function tv(e,t,n,i){n&&n(e.mark)&&nv(e,t,sd.group.isect)&&i.push(e);const r=e.items,o=r&&r.length;if(o){const s=e.x||0,a=e.y||0;t.translate(-s,-a);for(let e=0;e<o;++e)ev(r[e],t,n,i);t.translate(s,a)}return i}function nv(e,t,n){const i=e.bounds;return t.encloses(i)||t.intersects(i)&&n(e,t)}Jm.canvas=Jm.png={renderer:Pd,headless:Pd,handler:Dd},Jm.svg={renderer:Lm,headless:Ym,handler:Id},Jm.none={};const iv=new zc;var rv=function(e){const t=e.clip;if(Object(p.E)(t))t(Fu(iv.clear()));else{if(!t)return;iv.set(0,0,e.group.width,e.group.height)}e.bounds.intersect(iv)};function ov(e,t,n){return e===t||("path"===n?sv(e,t):e instanceof Date&&t instanceof Date?+e==+t:Object(p.F)(e)&&Object(p.F)(t)?Math.abs(e-t)<=1e-9:e&&t&&(Object(p.G)(e)||Object(p.G)(t))?null!=e&&null!=t&&function(e,t){var n,i,r=Object.keys(e),o=Object.keys(t);if(r.length!==o.length)return!1;for(r.sort(),o.sort(),i=r.length-1;i>=0;i--)if(r[i]!=o[i])return!1;for(i=r.length-1;i>=0;i--)if(n=r[i],!ov(e[n],t[n],n))return!1;return typeof e==typeof t}(e,t):e==t)}function sv(e,t){return ov(El(e),El(t))}function av(){Nc(),ba=0}function lv(e){Nr.call(this,null,e)}function cv(e,t,n){return t(e.bounds.clear(),e,n)}Object(p.z)(lv,Nr,{transform(e,t){const n=t.dataflow,i=e.mark,r=i.marktype,o=sd[r],s=o.bound;let a,l=i.bounds;if(o.nested)i.items.length&&n.dirty(i.items[0]),l=cv(i,s),i.items.forEach((function(e){e.bounds.clear().union(l)}));else if("group"===r||e.modified())switch(t.visit(t.MOD,e=>n.dirty(e)),l.clear(),i.items.forEach(e=>l.union(cv(e,s))),i.role){case"axis":case"legend":case"title":t.reflow()}else a=t.changed(t.REM),t.visit(t.ADD,e=>{l.union(cv(e,s))}),t.visit(t.MOD,e=>{a=a||l.alignsWith(e.bounds),n.dirty(e),l.union(cv(e,s))}),a&&(l.clear(),i.items.forEach(e=>l.union(e.bounds)));return rv(i),t.modifies("bounds")}});function uv(e){Nr.call(this,0,e)}function hv(e){Nr.call(this,null,e)}function dv(e){Nr.call(this,null,e)}uv.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},Object(p.z)(uv,Nr,{transform(e,t){const n=(r=t.dataflow)._signals[":vega_identifier:"]||(r._signals[":vega_identifier:"]=r.add(0)),i=e.as;var r;let o=n.value;return t.visit(t.ADD,e=>e[i]=e[i]||++o),n.set(this.value=o),t}}),Object(p.z)(hv,Nr,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,function(e){const t=e.groups,n=e.parent;return t&&1===t.size?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const i="group"===n.marktype?Bc:Ic;return t.visit(t.ADD,e=>i.call(e,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});const fv={parity:e=>e.filter((e,t)=>t%2?e.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((e,i)=>i&&pv(n.bounds,e.bounds,t)?e.opacity=0:(n=e,1))}},pv=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),gv=(e,t)=>{for(var n,i=1,r=e.length,o=e[0].bounds;i<r;o=n,++i)if(pv(o,n=e[i].bounds,t))return!0},mv=e=>{var t=e.bounds;return t.width()>1&&t.height()>1},vv=e=>(e.forEach(e=>e.opacity=1),e),bv=(e,t)=>e.reflow(t.modified()).modifies("opacity");function yv(e){Nr.call(this,null,e)}Object(p.z)(dv,Nr,{transform(e,t){let n,i,r,o=fv[e.method]||fv.parity,s=t.materialize(t.SOURCE).source,a=e.separation||0;if(s&&s.length){if(!e.method)return e.modified("method")&&(vv(s),t=bv(t,e)),t;if(s=s.filter(mv),s.length){if(e.sort&&(s=s.slice().sort(e.sort)),n=vv(s),t=bv(t,e),n.length>=3&&gv(n,a)){do{n=o(n,a)}while(n.length>=3&&gv(n,a));n.length<3&&!Object(p.V)(s).opacity&&(n.length>1&&(Object(p.V)(n).opacity=0),Object(p.V)(s).opacity=1)}var l,c,u,h,d;return e.boundScale&&e.boundTolerance>=0&&(l=e.boundScale,c=e.boundOrient,u=+e.boundTolerance,h=l.range(),d=new zc,c===fa||"bottom"===c?d.set(h[0],-1/0,h[1],1/0):d.set(-1/0,h[0],1/0,h[1]),d.expand(u||1),i=e=>d.encloses(e.bounds),s.forEach(e=>{i(e)||(e.opacity=0)})),r=n[0].mark.bounds.clear(),s.forEach(e=>{e.opacity&&r.union(e.bounds)}),t}}}}),Object(p.z)(yv,Nr,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,e=>n.dirty(e)),t.fields&&t.fields.zindex){var i=t.source&&t.source[0];i&&(i.mark.zdirty=!0)}}});const wv=new zc;function xv(e,t,n){return e[t]===n?0:(e[t]=n,1)}function _v(e){var t=e.items[0].orient;return t===pa||t===ga}function kv(e,t,n,i){var r,o,s=t.items[0],a=s.datum,l=null!=s.translate?s.translate:.5,c=s.orient,u=function(e){var t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}(a),h=s.range,d=s.offset,f=s.position,p=s.minExtent,g=s.maxExtent,m=a.title&&s.items[u[2]].items[0],v=s.titlePadding,b=s.bounds,y=m&&Jh(m),w=0,x=0;switch(wv.clear().union(b),b.clear(),(r=u[0])>-1&&b.union(s.items[r].bounds),(r=u[1])>-1&&b.union(s.items[r].bounds),c){case fa:w=f||0,x=-d,o=Math.max(p,Math.min(g,-b.y1)),b.add(0,-o).add(h,0),m&&Sv(e,m,o,v,y,0,-1,b);break;case pa:w=-d,x=f||0,o=Math.max(p,Math.min(g,-b.x1)),b.add(-o,0).add(0,h),m&&Sv(e,m,o,v,y,1,-1,b);break;case ga:w=n+d,x=f||0,o=Math.max(p,Math.min(g,b.x2)),b.add(0,0).add(o,h),m&&Sv(e,m,o,v,y,1,1,b);break;case"bottom":w=f||0,x=i+d,o=Math.max(p,Math.min(g,b.y2)),b.add(0,0).add(h,o),m&&Sv(e,m,o,v,0,0,1,b);break;default:w=s.x,x=s.y}return bu(b.translate(w,x),s),xv(s,"x",w+l)|xv(s,"y",x+l)&&(s.bounds=wv,e.dirty(s),s.bounds=b,e.dirty(s)),s.mark.bounds.clear().union(b)}function Sv(e,t,n,i,r,o,s,a){const l=t.bounds;if(t.auto){const a=s*(n+r+i);let c=0,u=0;e.dirty(t),o?c=(t.x||0)-(t.x=a):u=(t.y||0)-(t.y=a),t.mark.bounds.clear().union(l.translate(-c,-u)),e.dirty(t)}a.union(l)}const Ov=(e,t)=>Math.floor(Math.min(e,t)),Cv=(e,t)=>Math.ceil(Math.max(e,t));function Av(e){return(new zc).set(0,0,e.width||0,e.height||0)}function $v(e){var t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function Ev(e,t,n){var i=Object(p.G)(e)?e[t]:e;return null!=i?i:void 0!==n?n:0}function Mv(e){return e<0?Math.ceil(-e):0}function jv(e,t,n){var i,r,o,s,a,l,c,u,h,d,f,p=!n.nodirty,g="flush"===n.bounds?Av:$v,m=wv.set(0,0,0,0),v=Ev(n.align,"column"),b=Ev(n.align,va),y=Ev(n.padding,"column"),w=Ev(n.padding,va),x=n.columns||t.length,_=x<=0?1:Math.ceil(t.length/x),k=t.length,S=Array(k),O=Array(x),C=0,A=Array(k),$=Array(_),E=0,M=Array(k),j=Array(k),R=Array(k);for(r=0;r<x;++r)O[r]=0;for(r=0;r<_;++r)$[r]=0;for(r=0;r<k;++r)l=t[r],a=R[r]=g(l),l.x=l.x||0,M[r]=0,l.y=l.y||0,j[r]=0,o=r%x,s=~~(r/x),C=Math.max(C,c=Math.ceil(a.x2)),E=Math.max(E,u=Math.ceil(a.y2)),O[o]=Math.max(O[o],c),$[s]=Math.max($[s],u),S[r]=y+Mv(a.x1),A[r]=w+Mv(a.y1),p&&e.dirty(t[r]);for(r=0;r<k;++r)r%x==0&&(S[r]=0),r<x&&(A[r]=0);if("each"===v)for(o=1;o<x;++o){for(f=0,r=o;r<k;r+=x)f<S[r]&&(f=S[r]);for(r=o;r<k;r+=x)S[r]=f+O[o-1]}else if("all"===v){for(f=0,r=0;r<k;++r)r%x&&f<S[r]&&(f=S[r]);for(r=0;r<k;++r)r%x&&(S[r]=f+C)}else for(v=!1,o=1;o<x;++o)for(r=o;r<k;r+=x)S[r]+=O[o-1];if("each"===b)for(s=1;s<_;++s){for(f=0,i=(r=s*x)+x;r<i;++r)f<A[r]&&(f=A[r]);for(r=s*x;r<i;++r)A[r]=f+$[s-1]}else if("all"===b){for(f=0,r=x;r<k;++r)f<A[r]&&(f=A[r]);for(r=x;r<k;++r)A[r]=f+E}else for(b=!1,s=1;s<_;++s)for(i=(r=s*x)+x;r<i;++r)A[r]+=$[s-1];for(h=0,r=0;r<k;++r)h=S[r]+(r%x?h:0),M[r]+=h-t[r].x;for(o=0;o<x;++o)for(d=0,r=o;r<k;r+=x)d+=A[r],j[r]+=d-t[r].y;if(v&&Ev(n.center,"column")&&_>1)for(r=0;r<k;++r)(h=(a="all"===v?C:O[r%x])-R[r].x2-t[r].x-M[r])>0&&(M[r]+=h/2);if(b&&Ev(n.center,va)&&1!==x)for(r=0;r<k;++r)(d=(a="all"===b?E:$[~~(r/x)])-R[r].y2-t[r].y-j[r])>0&&(j[r]+=d/2);for(r=0;r<k;++r)m.union(R[r].translate(M[r],j[r]));switch(h=Ev(n.anchor,"x"),d=Ev(n.anchor,"y"),Ev(n.anchor,"column")){case ma:h-=m.width();break;case"middle":h-=m.width()/2}switch(Ev(n.anchor,va)){case ma:d-=m.height();break;case"middle":d-=m.height()/2}for(h=Math.round(h),d=Math.round(d),m.clear(),r=0;r<k;++r)t[r].mark.bounds.clear();for(r=0;r<k;++r)(l=t[r]).x+=M[r]+=h,l.y+=j[r]+=d,m.union(l.mark.bounds.union(l.bounds.translate(M[r],j[r]))),p&&e.dirty(l);return m}function Rv(e,t){return"x1"===t?e.x||0:"y1"===t?e.y||0:"x2"===t?(e.x||0)+(e.width||0):"y2"===t?(e.y||0)+(e.height||0):void 0}function Dv(e,t){return e.bounds[t]}function Tv(e,t,n,i,r,o,s,a,l,c,u,h,d,f){var p,g,m,v,b,y,w,x,_,k=n.length,S=0,O=0;if(!k)return S;for(p=u;p<k;p+=h)n[p]&&(S=s(S,l(n[p],c)));if(!t.length)return S;for(t.length>r&&(e.warn("Grid headers exceed limit: "+r),t=t.slice(0,r)),S+=o,g=0,v=t.length;g<v;++g)e.dirty(t[g]),t[g].mark.bounds.clear();for(p=u,g=0,v=t.length;g<v;++g,p+=h){for(b=(y=t[g]).mark.bounds,m=p;m>=0&&null==(w=n[m]);m-=d);a?(x=null==f?w.x:Math.round(w.bounds.x1+f*w.bounds.width()),_=S):(x=S,_=null==f?w.y:Math.round(w.bounds.y1+f*w.bounds.height())),b.union(y.bounds.translate(x-(y.x||0),_-(y.y||0))),y.x=x,y.y=_,e.dirty(y),O=s(O,b[c])}return O}function Lv(e,t,n,i,r,o){if(t){e.dirty(t);var s=n,a=n;i?s=Math.round(r.x1+o*r.width()):a=Math.round(r.y1+o*r.height()),t.bounds.translate(s-(t.x||0),a-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=s,t.y=a,e.dirty(t)}}function Fv(e,t,n,i,r,o,s){const a=function(e,t){const n=e[t]||{};return(t,i)=>null!=n[t]?n[t]:null!=e[t]?e[t]:i}(n,t),l=(h=e,d=a("offset",0),f=-1/0,h.forEach(e=>{null!=e.offset&&(f=Math.max(f,e.offset))}),f>-1/0?f:d),c=a("anchor","start"),u=c===ma?1:"middle"===c?.5:0;var h,d,f;const p={align:"each",bounds:a("bounds","flush"),columns:"vertical"===a("direction")?1:e.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(t){case pa:p.anchor={x:Math.floor(i.x1)-l,column:ma,y:u*(s||i.height()+2*i.y1),row:c};break;case ga:p.anchor={x:Math.ceil(i.x2)+l,y:u*(s||i.height()+2*i.y1),row:c};break;case fa:p.anchor={y:Math.floor(r.y1)-l,row:ma,x:u*(o||r.width()+2*r.x1),column:c};break;case"bottom":p.anchor={y:Math.ceil(r.y2)+l,x:u*(o||r.width()+2*r.x1),column:c};break;case"top-left":p.anchor={x:l,y:l};break;case"top-right":p.anchor={x:o-l,y:l,column:ma};break;case"bottom-left":p.anchor={x:l,y:s-l,row:ma};break;case"bottom-right":p.anchor={x:o-l,y:s-l,column:ma,row:ma}}return p}function Nv(e,t){var n,i,r,o,s=t.items[0],a=s.datum,l=s.orient,c=s.bounds,u=s.x,h=s.y;return s._bounds?s._bounds.clear().union(c):s._bounds=c.clone(),c.clear(),function(e,t,n){var i=t.padding,r=i-n.x,o=i-n.y;if(t.datum.title){var s=t.items[1].items[0],a=s.anchor,l=t.titlePadding||0,c=i-s.x,u=i-s.y;switch(s.orient){case pa:r+=Math.ceil(s.bounds.width())+l;break;case ga:case"bottom":break;default:o+=s.bounds.height()+l}switch((r||o)&&zv(e,n,r,o),s.orient){case pa:u+=Pv(t,n,s,a,1,1);break;case ga:c+=Pv(t,n,s,ma,0,0)+l,u+=Pv(t,n,s,a,1,1);break;case"bottom":c+=Pv(t,n,s,a,0,0),u+=Pv(t,n,s,ma,-1,0,1)+l;break;default:c+=Pv(t,n,s,a,0,0)}(c||u)&&zv(e,s,c,u),(c=Math.round(s.bounds.x1-i))<0&&(zv(e,n,-c,0),zv(e,s,-c,0))}else(r||o)&&zv(e,n,r,o)}(e,s,s.items[0].items[0]),c=function(e,t){return e.items.forEach(e=>t.union(e.bounds)),t.x1=e.padding,t.y1=e.padding,t}(s,c),n=2*s.padding,i=2*s.padding,c.empty()||(n=Math.ceil(c.width()+n),i=Math.ceil(c.height()+i)),"symbol"===a.type&&(r=s.items[0].items[0].items[0].items,o=r.reduce((e,t)=>(e[t.column]=Math.max(t.bounds.x2-t.x,e[t.column]||0),e),{}),r.forEach(e=>{e.width=o[e.column],e.height=e.bounds.y2-e.y})),"none"!==l&&(s.x=u=0,s.y=h=0),s.width=n,s.height=i,bu(c.set(u,h,u+n,h+i),s),s.mark.bounds.clear().union(c),s}function Pv(e,t,n,i,r,o,s){const a="symbol"!==e.datum.type,l=n.datum.vgrad,c=(!a||!o&&l||s?t:t.items[0]).bounds[r?"y2":"x2"]-e.padding,u=l&&o?c:0,h=l&&o?0:c,d=r<=0?0:Jh(n);return Math.round("start"===i?u:i===ma?h-d:.5*(c-d))}function zv(e,t,n,i){t.x+=n,t.y+=i,t.bounds.translate(n,i),t.mark.bounds.translate(n,i),e.dirty(t)}function Iv(e){Nr.call(this,null,e)}function Bv(e){Nr.call(this,null,e)}function Wv(e){Nr.call(this,null,e)}function Uv(){return _({})}function Hv(e){Nr.call(this,null,e)}function qv(e){Nr.call(this,[],e)}Object(p.z)(Iv,Nr,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(t=>{e.layout&&function(e,t,n){var i,r,o,s,a,l,c,u=function(e){for(var t,n,i=e.items,r=i.length,o=0,s={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};o<r;++o)if(n=(t=i[o]).items,"group"===t.marktype)switch(t.role){case"axis":case"legend":case"title":break;case"row-header":s.rowheaders.push(...n);break;case"row-footer":s.rowfooters.push(...n);break;case"column-header":s.colheaders.push(...n);break;case"column-footer":s.colfooters.push(...n);break;case"row-title":s.rowtitle=n[0];break;case"column-title":s.coltitle=n[0];break;default:s.marks.push(...n)}return s}(t),h=u.marks,d="flush"===n.bounds?Rv:Dv,f=n.offset,p=n.columns||h.length,g=p<=0?1:Math.ceil(h.length/p),m=g*p;const v=jv(e,h,n);v.empty()&&v.set(0,0,0,0),u.rowheaders&&(l=Ev(n.headerBand,va,null),i=Tv(e,u.rowheaders,h,p,g,-Ev(f,"rowHeader"),Ov,0,d,"x1",0,p,1,l)),u.colheaders&&(l=Ev(n.headerBand,"column",null),r=Tv(e,u.colheaders,h,p,p,-Ev(f,"columnHeader"),Ov,1,d,"y1",0,1,p,l)),u.rowfooters&&(l=Ev(n.footerBand,va,null),o=Tv(e,u.rowfooters,h,p,g,Ev(f,"rowFooter"),Cv,0,d,"x2",p-1,p,1,l)),u.colfooters&&(l=Ev(n.footerBand,"column",null),s=Tv(e,u.colfooters,h,p,p,Ev(f,"columnFooter"),Cv,1,d,"y2",m-p,1,p,l)),u.rowtitle&&(a=Ev(n.titleAnchor,va),c=Ev(f,"rowTitle"),c=a===ma?o+c:i-c,l=Ev(n.titleBand,va,.5),Lv(e,u.rowtitle,c,0,v,l)),u.coltitle&&(a=Ev(n.titleAnchor,"column"),c=Ev(f,"columnTitle"),c=a===ma?s+c:r-c,l=Ev(n.titleBand,"column",.5),Lv(e,u.coltitle,c,1,v,l))}(n,t,e.layout),function(e,t,n){var i,r,o,s,a,l=t.items,c=Math.max(0,t.width||0),u=Math.max(0,t.height||0),h=(new zc).set(0,0,c,u),d=h.clone(),f=h.clone(),p=[];for(s=0,a=l.length;s<a;++s)switch((r=l[s]).role){case"axis":(_v(r)?d:f).union(kv(e,r,c,u));break;case"title":i=r;break;case"legend":p.push(Nv(e,r));break;case"frame":case"scope":case"row-header":case"row-footer":case"row-title":case"column-header":case"column-footer":case"column-title":d.union(r.bounds),f.union(r.bounds);break;default:h.union(r.bounds)}if(p.length){const t={};p.forEach(e=>{"none"!==(o=e.orient||ga)&&(t[o]||(t[o]=[])).push(e)});for(let i in t){const r=t[i];jv(e,r,Fv(r,i,n.legends,d,f,c,u))}p.forEach(t=>{const i=t.bounds;if(i.equals(t._bounds)||(t.bounds=t._bounds,e.dirty(t),t.bounds=i,e.dirty(t)),n.autosize&&"fit"===n.autosize.type)switch(t.orient){case pa:case ga:h.add(i.x1,0).add(i.x2,0);break;case fa:case"bottom":h.add(0,i.y1).add(0,i.y2)}else h.union(i)})}h.union(d).union(f),i&&h.union(function(e,t,n,i,r){var o,s=t.items[0],a=s.frame,l=s.orient,c=s.anchor,u=s.offset,h=s.padding,d=s.items[0].items[0],f=s.items[1]&&s.items[1].items[0],p=l===pa||l===ga?i:n,g=0,m=0,v=0,b=0,y=0;if("group"!==a?l===pa?(g=r.y2,p=r.y1):l===ga?(g=r.y1,p=r.y2):(g=r.x1,p=r.x2):l===pa&&(g=i,p=0),o="start"===c?g:c===ma?p:(g+p)/2,f&&f.text){switch(l){case fa:case"bottom":y=d.bounds.height()+h;break;case pa:b=d.bounds.width()+h;break;case ga:b=-d.bounds.width()-h}wv.clear().union(f.bounds),wv.translate(b-(f.x||0),y-(f.y||0)),xv(f,"x",b)|xv(f,"y",y)&&(e.dirty(f),f.bounds.clear().union(wv),f.mark.bounds.clear().union(wv),e.dirty(f)),wv.clear().union(f.bounds)}else wv.clear();switch(wv.union(d.bounds),l){case fa:m=o,v=r.y1-wv.height()-u;break;case pa:m=r.x1-wv.width()-u,v=o;break;case ga:m=r.x2+wv.width()+u,v=o;break;case"bottom":m=o,v=r.y2+u;break;default:m=s.x,v=s.y}return xv(s,"x",m)|xv(s,"y",v)&&(wv.translate(m,v),e.dirty(s),s.bounds.clear().union(wv),t.bounds.clear().union(wv),e.dirty(s)),s.bounds}(e,i,c,u,h));t.clip&&h.set(0,0,t.width||0,t.height||0);!function(e,t,n,i){const r=i.autosize||{},o=r.type;if(e._autosize<1||!o)return;let s=e._width,a=e._height,l=Math.max(0,t.width||0),c=Math.max(0,Math.ceil(-n.x1)),u=Math.max(0,Math.ceil(n.x2-l)),h=Math.max(0,t.height||0),d=Math.max(0,Math.ceil(-n.y1)),f=Math.max(0,Math.ceil(n.y2-h));if("padding"===r.contains){const t=e.padding();s-=t.left+t.right,a-=t.top+t.bottom}"none"===o?(c=0,d=0,l=s,h=a):"fit"===o?(l=Math.max(0,s-c-u),h=Math.max(0,a-d-f)):"fit-x"===o?(l=Math.max(0,s-c-u),a=h+d+f):"fit-y"===o?(s=l+c+u,h=Math.max(0,a-d-f)):"pad"===o&&(s=l+c+u,a=h+d+f);e._resizeView(s,a,l,h,[c,d],r.resize)}(e,t,h,n)}(n,t,e)}),(i=e.mark.group)&&"legend-entry"!==i.mark.role?t.reflow():t;var i}}),Object(p.z)(Bv,Nr,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,o=e.scale,s=om(o,null==e.count?e.values?e.values.length:10:e.count,e.minstep),a=e.format||lm(n,o,s,e.formatSpecifier,e.formatType,!!e.values),l=e.values?sm(o,e.values,s):am(o,s);return r&&(i.rem=r),r=l.map((e,t)=>_({index:t/(l.length-1||1),value:e,label:a(e)})),e.extra&&r.length&&r.push(_({index:-1,extra:{value:r[0].value},label:""})),i.source=r,i.add=r,this.value=r,i}}),Object(p.z)(Wv,Nr,{transform(e,t){var n=t.dataflow,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.item||Uv,o=e.key||w,s=this.value;return Object(p.B)(i.encode)&&(i.encode=null),s&&(e.modified("key")||t.modified(o))&&Object(p.o)("DataJoin does not support modified key function or fields."),s||(t=t.addAll(),this.value=s=function(e){const t=Object(p.t)().test(e=>e.exit);return t.lookup=n=>t.get(e(n)),t}(o)),t.visit(t.ADD,e=>{const t=o(e);let n=s.get(t);n?n.exit?(s.empty--,i.add.push(n)):i.mod.push(n):(n=r(e),s.set(t,n),i.add.push(n)),n.datum=e,n.exit=!1}),t.visit(t.MOD,e=>{const t=o(e),n=s.get(t);n&&(n.datum=e,i.mod.push(n))}),t.visit(t.REM,e=>{const t=o(e),n=s.get(t);e!==n.datum||n.exit||(i.rem.push(n),n.exit=!0,++s.empty)}),t.changed(t.ADD_MOD)&&i.modifies("datum"),(t.clean()||e.clean&&s.empty>n.cleanThreshold)&&n.runAfter(s.clean),i}}),Object(p.z)(Hv,Nr,{transform(e,t){var n=t.fork(t.ADD_REM),i=e.mod||!1,r=e.encoders,o=t.encode;if(Object(p.B)(o)){if(!n.changed()&&!o.every((function(e){return r[e]})))return t.StopPropagation;o=o[0],n.encode=null}var s="enter"===o,a=r.update||p.s,l=r.enter||p.s,c=r.exit||p.s,u=(o&&!s?r[o]:a)||p.s;if(t.changed(t.ADD)&&(t.visit(t.ADD,(function(t){l(t,e),a(t,e)})),n.modifies(l.output),n.modifies(a.output),u!==p.s&&u!==a&&(t.visit(t.ADD,(function(t){u(t,e)})),n.modifies(u.output))),t.changed(t.REM)&&c!==p.s&&(t.visit(t.REM,(function(t){c(t,e)})),n.modifies(c.output)),s||u!==p.s){var h=t.MOD|(e.modified()?t.REFLOW:0);s?(t.visit(h,(function(t){var r=l(t,e)||i;(u(t,e)||r)&&n.mod.push(t)})),n.mod.length&&n.modifies(l.output)):t.visit(h,(function(t){(u(t,e)||i)&&n.mod.push(t)})),n.mod.length&&n.modifies(u.output)}return n.changed()?n:t.StopPropagation}}),Object(p.z)(qv,Nr,{transform(e,t){if(null!=this.value&&!e.modified())return t.StopPropagation;var n,i,r,o,s,a=t.dataflow.locale(),l=t.fork(t.NO_SOURCE|t.NO_FIELDS),c=this.value,u=e.type||"symbol",h=e.scale,d=+e.limit,f=om(h,null==e.count?5:e.count,e.minstep),g=!!e.values||"symbol"===u,m=e.format||fm(a,h,f,u,e.formatSpecifier,e.formatType,g),v=e.values||dm(h,f);return c&&(l.rem=c),"symbol"===u?(d&&v.length>d?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),c=v.slice(0,d-1),s=!0):c=v,Object(p.E)(r=e.size)?(e.values||0!==h(c[0])||(c=c.slice(1)),o=c.reduce((function(t,n){return Math.max(t,r(n,e))}),0)):r=Object(p.m)(o=r||8),c=c.map((t,n)=>_({index:n,label:m(t,n,c),value:t,offset:o,size:r(t,e)})),s&&(s=v[c.length],c.push(_({index:c.length,label:`â€¦${v.length-c.length} entries`,value:s,offset:o,size:r(s,e)})))):"gradient"===u?(n=h.domain(),i=Xg(h,n[0],Object(p.V)(n)),v.length<3&&!e.values&&n[0]!==Object(p.V)(n)&&(v=[n[0],Object(p.V)(n)]),c=v.map((e,t)=>_({index:t,label:m(e,t,v),value:e,perc:i(e)}))):(r=v.length-1,i=function(e){let t=e.domain(),n=t.length-1,i=+t[0],r=+Object(p.V)(t),o=r-i;if("threshold"===e.type){const e=n?o/n:.1;i-=e,r+=e,o=r-i}return e=>(e-i)/o}(h),c=v.map((e,t)=>_({index:t,label:m(e,t,v),value:e,perc:t?i(e):0,perc2:t===r?1:i(v[t+1])}))),l.source=c,l.add=c,this.value=c,l}});const Vv=e=>e.source.x,Gv=e=>e.source.y,Kv=e=>e.target.x,Yv=e=>e.target.y;function Xv(e){Nr.call(this,{},e)}Xv.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},Object(p.z)(Xv,Nr,{transform(e,t){var n=e.sourceX||Vv,i=e.sourceY||Gv,r=e.targetX||Kv,o=e.targetY||Yv,s=e.as||"path",a=e.orient||"vertical",l=e.shape||"line",c=eb.get(l+"-"+a)||eb.get(l);return c||Object(p.o)("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,e=>{e[s]=c(n(e),i(e),r(e),o(e))}),t.reflow(e.modified()).modifies(s)}});const Jv=(e,t,n,i)=>"M"+e+","+t+"L"+n+","+i,Qv=(e,t,n,i)=>{var r=n-e,o=i-t,s=Math.sqrt(r*r+o*o)/2;return"M"+e+","+t+"A"+s+","+s+" "+180*Math.atan2(o,r)/Math.PI+" 0 1 "+n+","+i},Zv=(e,t,n,i)=>{const r=n-e,o=i-t,s=.2*(r+o),a=.2*(o-r);return"M"+e+","+t+"C"+(e+s)+","+(t+a)+" "+(n+a)+","+(i-s)+" "+n+","+i},eb=Object(p.t)({line:Jv,"line-radial":(e,t,n,i)=>Jv(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),arc:Qv,"arc-radial":(e,t,n,i)=>Qv(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),curve:Zv,"curve-radial":(e,t,n,i)=>Zv(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),"orthogonal-horizontal":(e,t,n,i)=>"M"+e+","+t+"V"+i+"H"+n,"orthogonal-vertical":(e,t,n,i)=>"M"+e+","+t+"H"+n+"V"+i,"orthogonal-radial":(e,t,n,i)=>{const r=Math.cos(e),o=Math.sin(e),s=Math.cos(n),a=Math.sin(n);return"M"+t*r+","+t*o+"A"+t+","+t+" 0 0,"+((Math.abs(n-e)>Math.PI?n<=e:n>e)?1:0)+" "+t*s+","+t*a+"L"+i*s+","+i*a},"diagonal-horizontal":(e,t,n,i)=>{const r=(e+n)/2;return"M"+e+","+t+"C"+r+","+t+" "+r+","+i+" "+n+","+i},"diagonal-vertical":(e,t,n,i)=>{const r=(t+i)/2;return"M"+e+","+t+"C"+e+","+r+" "+n+","+r+" "+n+","+i},"diagonal-radial":(e,t,n,i)=>{const r=Math.cos(e),o=Math.sin(e),s=Math.cos(n),a=Math.sin(n),l=(t+i)/2;return"M"+t*r+","+t*o+"C"+l*r+","+l*o+" "+l*s+","+l*a+" "+i*s+","+i*a}});function tb(e,t){let n=0;if(void 0===t)for(let t of e)(t=+t)&&(n+=t);else{let i=-1;for(let r of e)(r=+t(r,++i,e))&&(n+=r)}return n}function nb(e){Nr.call(this,null,e)}nb.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},Object(p.z)(nb,Nr,{transform(e,t){var n,i,r,o=e.as||["startAngle","endAngle"],s=o[0],a=o[1],l=e.field||p.P,c=e.startAngle||0,u=null!=e.endAngle?e.endAngle:2*Math.PI,h=t.source,d=h.map(l),f=d.length,g=c,m=(u-c)/tb(d),v=Ys(f);for(e.sort&&v.sort((e,t)=>d[e]-d[t]),n=0;n<f;++n)r=d[v[n]],(i=h[v[n]])[s]=g,i[a]=g+=r*m;return this.value=d,t.reflow(e.modified()).modifies(o)}});function ib(e){return Kp(e)&&"sequential"!==e}const rb=Object(p.eb)(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function ob(e){Nr.call(this,null,e),this.modified(!0)}function sb(e,t,n){Jp(e)&&(Math.abs(t.reduce((function(e,t){return e+(t<0?-1:t>0?1:0)}),0))!==t.length&&n.warn("Log scale domain includes zero: "+Object(p.ab)(t)));return t}function ab(e,t,n){return Object(p.E)(e)&&(t||n)?Gg(e,lb(t||[0,1],n)):e}function lb(e,t){return t?e.slice().reverse():e}function cb(e){Nr.call(this,null,e)}Object(p.z)(ob,Nr,{transform(e,t){var n=t.dataflow,i=this.value,r=function(e){var t,n=e.type,i="";if("sequential"===n)return"sequential-linear";(function(e){const t=e.type;return Kp(t)&&t!==Hd&&t!==qd&&(e.scheme||e.range&&e.range.length&&e.range.every(p.I))})(e)&&(t=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(null!=e.domainMid):0,i=2===t?"sequential-":3===t?"diverging-":"");return(i+n||"linear").toLowerCase()}(e);for(r in i&&r===i.type||(this.value=i=qp(r)()),e)if(!rb[r]){if("padding"===r&&ib(i.type))continue;Object(p.E)(i[r])?i[r](e[r]):n.warn("Unsupported scale property: "+r)}return function(e,t,n){var i=e.type,r=t.round||!1,o=t.range;if(null!=t.rangeStep)o=function(e,t,n){"band"!==e&&"point"!==e&&Object(p.o)("Only band and point scales support rangeStep.");var i=(null!=t.paddingOuter?t.paddingOuter:t.padding)||0,r="point"===e?1:(null!=t.paddingInner?t.paddingInner:t.padding)||0;return[0,t.rangeStep*Wd(n,r,i)]}(i,t,n);else if(t.scheme&&(o=function(e,t,n){var i,r,o=t.schemeExtent;Object(p.B)(t.scheme)?r=Kg(t.scheme,t.interpolate,t.interpolateGamma):(i=t.scheme.toLowerCase(),(r=tm(i))||Object(p.o)("Unrecognized scheme name: "+t.scheme));return n="threshold"===e?n+1:"bin-ordinal"===e?n-1:"quantile"===e||"quantize"===e?+t.schemeCount||5:n,Qp(e)?ab(r,o,t.reverse):Object(p.E)(r)?Yg(ab(r,o),n):"ordinal"===e?r:r.slice(0,n)}(i,t,n),Object(p.E)(o))){if(e.interpolator)return e.interpolator(o);Object(p.o)(`Scale type ${i} does not support interpolating color schemes.`)}if(o&&Qp(i))return e.interpolator(Kg(lb(o,t.reverse),t.interpolate,t.interpolateGamma));o&&t.interpolate&&e.interpolate?e.interpolate(Jg(t.interpolate,t.interpolateGamma)):Object(p.E)(e.round)?e.round(r):Object(p.E)(e.rangeRound)&&e.interpolate(r?sp:op);o&&e.range(lb(o,t.reverse))}(i,e,function(e,t,n){let i=t.bins;if(i&&!Object(p.B)(i)){let t=e.domain(),n=t[0],r=Object(p.V)(t),o=null==i.start?n:i.start,s=null==i.stop?r:i.stop,a=i.step;a||Object(p.o)("Scale bins parameter missing step property."),o<n&&(o=a*Math.ceil(n/a)),s>r&&(s=a*Math.floor(r/a)),i=Ys(o,s+a/2,a)}i?e.bins=i:e.bins&&delete e.bins;"bin-ordinal"===e.type&&(i?t.domain||t.domainRaw||(e.domain(i),n=i.length):e.bins=e.domain());return n}(i,e,function(e,t,n){var i=function(e,t,n){return t?(e.domain(sb(e.type,t,n)),t.length):-1}(e,t.domainRaw,n);if(i>-1)return i;var r,o,s=t.domain,a=e.type,l=t.zero||void 0===t.zero&&function(e){const t=e.type;return!e.bins&&("linear"===t||"pow"===t||"sqrt"===t)}(e);if(!s)return 0;ib(a)&&t.padding&&s[0]!==Object(p.V)(s)&&(s=function(e,t,n,i,r,o){var s=Math.abs(Object(p.V)(n)-n[0]),a=s/(s-2*i),l=e===Ud?Object(p.nb)(t,null,a):"sqrt"===e?Object(p.ob)(t,null,a,.5):"pow"===e?Object(p.ob)(t,null,a,r||1):"symlog"===e?Object(p.pb)(t,null,a,o||1):Object(p.mb)(t,null,a);return(t=t.slice())[0]=l[0],t[t.length-1]=l[1],t}(a,s,t.range,t.padding,t.exponent,t.constant));if((l||null!=t.domainMin||null!=t.domainMax||null!=t.domainMid)&&(r=(s=s.slice()).length-1||1,l&&(s[0]>0&&(s[0]=0),s[r]<0&&(s[r]=0)),null!=t.domainMin&&(s[0]=t.domainMin),null!=t.domainMax&&(s[r]=t.domainMax),null!=t.domainMid)){const e=(o=t.domainMid)>s[r]?r+1:o<s[0]?0:r;e!==r&&n.warn("Scale domainMid exceeds domain min or max.",o),s.splice(e,0,o)}e.domain(sb(a,s,n)),"ordinal"===a&&e.unknown(t.domainImplicit?Zd:void 0);t.nice&&e.nice&&e.nice(!0!==t.nice&&om(e,t.nice)||null);return s.length}(i,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),Object(p.z)(cb,Nr,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(C(e.sort)),this.modified(n),t}});const ub=["y0","y1"];function hb(e){Nr.call(this,null,e)}function db(e,t,n,i,r){for(var o,s=(t-e.sum)/2,a=e.length,l=0;l<a;++l)(o=e[l])[i]=s,o[r]=s+=Math.abs(n(o))}function fb(e,t,n,i,r){for(var o,s=1/e.sum,a=0,l=e.length,c=0,u=0;c<l;++c)(o=e[c])[i]=a,o[r]=a=s*(u+=Math.abs(n(o)))}function pb(e,t,n,i,r){for(var o,s,a=0,l=0,c=e.length,u=0;u<c;++u)(o=+n(s=e[u]))<0?(s[i]=l,s[r]=l+=o):(s[i]=a,s[r]=a+=o)}function gb(){}hb.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:"zero",values:["zero","center","normalize"]},{name:"as",type:"string",array:!0,length:2,default:ub}]},Object(p.z)(hb,Nr,{transform(e,t){var n,i,r,o,s=e.as||ub,a=s[0],l=s[1],c=C(e.sort),u=e.field||p.P,h="center"===e.offset?db:"normalize"===e.offset?fb:pb;for(n=function(e,t,n,i){var r,o,s,a,l,c,u,h,d,f=[],p=e=>e(l);if(null==t)f.push(e.slice());else for(r={},o=0,s=e.length;o<s;++o)l=e[o],c=t.map(p),(u=r[c])||(r[c]=u=[],f.push(u)),u.push(l);for(c=0,d=0,a=f.length;c<a;++c){for(u=f[c],o=0,h=0,s=u.length;o<s;++o)h+=Math.abs(i(u[o]));u.sum=h,h>d&&(d=h),n&&u.sort(n)}return f.max=d,f}(t.source,e.groupby,c,u),i=0,r=n.length,o=n.max;i<r;++i)h(n[i],o,u,a,l);return t.reflow(e.modified()).modifies(s)}});const mb=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];var vb=function(){var e=1,t=1,n=s;function i(e,t){return t.map(t=>r(e,t))}function r(i,r){var s=[],a=[];return function(n,i,r){var s,a,l,c,u,h,d=new Array,f=new Array;s=a=-1,c=n[0]>=i,mb[c<<1].forEach(p);for(;++s<e-1;)l=c,c=n[s+1]>=i,mb[l|c<<1].forEach(p);mb[c<<0].forEach(p);for(;++a<t-1;){for(s=-1,c=n[a*e+e]>=i,u=n[a*e]>=i,mb[c<<1|u<<2].forEach(p);++s<e-1;)l=c,c=n[a*e+e+s+1]>=i,h=u,u=n[a*e+s+1]>=i,mb[l|c<<1|u<<2|h<<3].forEach(p);mb[c|u<<3].forEach(p)}s=-1,u=n[a*e]>=i,mb[u<<2].forEach(p);for(;++s<e-1;)h=u,u=n[a*e+s+1]>=i,mb[u<<2|h<<3].forEach(p);function p(e){var t,n,i=[e[0][0]+s,e[0][1]+a],l=[e[1][0]+s,e[1][1]+a],c=o(i),u=o(l);(t=f[c])?(n=d[u])?(delete f[t.end],delete d[n.start],t===n?(t.ring.push(l),r(t.ring)):d[t.start]=f[n.end]={start:t.start,end:n.end,ring:t.ring.concat(n.ring)}):(delete f[t.end],t.ring.push(l),f[t.end=u]=t):(t=d[u])?(n=f[c])?(delete d[t.start],delete f[n.end],t===n?(t.ring.push(l),r(t.ring)):d[n.start]=f[t.end]={start:n.start,end:t.end,ring:n.ring.concat(t.ring)}):(delete d[t.start],t.ring.unshift(i),d[t.start=c]=t):d[c]=f[u]={start:c,end:u,ring:[i,l]}}mb[u<<3].forEach(p)}(i,r,(function(e){n(e,i,r),function(e){var t=0,n=e.length,i=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];for(;++t<n;)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}(e)>0?s.push([e]):a.push(e)})),a.forEach((function(e){for(var t,n=0,i=s.length;n<i;++n)if(-1!==bb((t=s[n])[0],e))return void t.push(e)})),{type:"MultiPolygon",value:r,coordinates:s}}function o(t){return 2*t[0]+t[1]*(e+1)*4}function s(n,i,r){n.forEach((function(n){var o,s=n[0],a=n[1],l=0|s,c=0|a,u=i[c*e+l];s>0&&s<e&&l===s&&(o=i[c*e+l-1],n[0]=s+(r-o)/(u-o)-.5),a>0&&a<t&&c===a&&(o=i[(c-1)*e+l],n[1]=a+(r-o)/(u-o)-.5)}))}return i.contour=r,i.size=function(n){if(!arguments.length)return[e,t];var r=Math.floor(n[0]),o=Math.floor(n[1]);return r>=0&&o>=0||Object(p.o)("invalid size"),e=r,t=o,i},i.smooth=function(e){return arguments.length?(n=e?s:gb,i):n===s},i};function bb(e,t){for(var n,i=-1,r=t.length;++i<r;)if(n=yb(e,t[i]))return n;return 0}function yb(e,t){for(var n=t[0],i=t[1],r=-1,o=0,s=e.length,a=s-1;o<s;a=o++){var l=e[o],c=l[0],u=l[1],h=e[a],d=h[0],f=h[1];if(wb(l,h,t))return 0;u>i!=f>i&&n<(d-c)*(i-u)/(f-u)+c&&(r=-r)}return r}function wb(e,t,n){var i,r,o,s;return function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}(e,t,n)&&(r=e[i=+(e[0]===t[0])],o=n[i],s=t[i],r<=o&&o<=s||s<=o&&o<=r)}var xb=function(e,t,n){return function(i){var r=Object(p.q)(i),o=n?Math.min(r[0],0):r[0],s=r[1],a=s-o,l=t?Ae(o,s,e):a/(e+1);return Ys(l,s,l)}};function _b(e){Nr.call(this,null,e)}function kb(e,t,n,i,r){const o=e.x1||0,s=e.y1||0,a=t*n<0;function l(e){e.forEach(c)}function c(e){a&&e.reverse(),e.forEach(u)}function u(e){e[0]=(e[0]-o)*t+i,e[1]=(e[1]-s)*n+r}return function(e){return e.coordinates.forEach(l),e}}function Sb(e,t,n){const i=e>=0?e:lo(t,n);return Math.round((Math.sqrt(4*i*i+1)-1)/2)}function Ob(e){return Object(p.E)(e)?e:Object(p.m)(+e)}_b.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},Object(p.z)(_b,Nr,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=e.field||p.y,o=vb().smooth(!1!==e.smooth),s=e.thresholds||function(e,t,n){const i=xb(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?i:i(e.map(e=>to(t(e).values)))}(i,r,e),a=null===e.as?null:e.as||"contour",l=[];return i.forEach(t=>{const n=r(t),i=o.size([n.width,n.height])(n.values,Object(p.B)(s)?s:s(n.values));!function(e,t,n,i){let r=i.scale||t.scale,o=i.translate||t.translate;Object(p.E)(r)&&(r=r(n,i));Object(p.E)(o)&&(o=o(n,i));if((1===r||null==r)&&!o)return;const s=(Object(p.F)(r)?r:r[0])||1,a=(Object(p.F)(r)?r:r[1])||1,l=o&&o[0]||0,c=o&&o[1]||0;e.forEach(kb(t,s,a,l,c))}(i,n,t,e),i.forEach(e=>{l.push(S(t,_(null!=a?{[a]:e}:e)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}});var Cb=function(){var e=e=>e[0],t=e=>e[1],n=p.P,i=[-1,-1],r=960,o=500,s=2;function a(a,l){const c=Sb(i[0],a,e)>>s,u=Sb(i[1],a,t)>>s,h=c?c+2:0,d=u?u+2:0,f=2*h+(r>>s),p=2*d+(o>>s),g=new Float32Array(f*p),m=new Float32Array(f*p);let v=g;a.forEach(i=>{const r=h+(+e(i)>>s),o=d+(+t(i)>>s);r>=0&&r<f&&o>=0&&o<p&&(g[r+o*f]+=+n(i))}),c>0&&u>0?(Ab(f,p,g,m,c),$b(f,p,m,g,u),Ab(f,p,g,m,c),$b(f,p,m,g,u),Ab(f,p,g,m,c),$b(f,p,m,g,u)):c>0?(Ab(f,p,g,m,c),Ab(f,p,m,g,c),Ab(f,p,g,m,c),v=m):u>0&&($b(f,p,g,m,u),$b(f,p,m,g,u),$b(f,p,g,m,u),v=m);let b=l?Math.pow(2,-2*s):1/tb(v);for(let e=0,t=f*p;e<t;++e)v[e]*=b;return{values:v,scale:1<<s,width:f,height:p,x1:h,y1:d,x2:h+(r>>s),y2:d+(o>>s)}}return a.x=function(t){return arguments.length?(e=Ob(t),a):e},a.y=function(e){return arguments.length?(t=Ob(e),a):t},a.weight=function(e){return arguments.length?(n=Ob(e),a):n},a.size=function(e){if(!arguments.length)return[r,o];var t=+e[0],n=+e[1];return t>=0&&n>=0||Object(p.o)("invalid size"),r=t,o=n,a},a.cellSize=function(e){return arguments.length?((e=+e)>=1||Object(p.o)("invalid cell size"),s=Math.floor(Math.log(e)/Math.LN2),a):1<<s},a.bandwidth=function(e){return arguments.length?(1===(e=Object(p.i)(e)).length&&(e=[+e[0],+e[0]]),2!==e.length&&Object(p.o)("invalid bandwidth"),i=e,a):i},a};function Ab(e,t,n,i,r){const o=1+(r<<1);for(let s=0;s<t;++s)for(let t=0,a=0;t<e+r;++t)t<e&&(a+=n[t+s*e]),t>=r&&(t>=o&&(a-=n[t-o+s*e]),i[t-r+s*e]=a/Math.min(t+1,e-1+o-t,o))}function $b(e,t,n,i,r){const o=1+(r<<1);for(let s=0;s<e;++s)for(let a=0,l=0;a<t+r;++a)a<t&&(l+=n[s+a*e]),a>=r&&(a>=o&&(l-=n[s+(a-o)*e]),i[s+(a-r)*e]=l/Math.min(a+1,t-1+o-a,o))}function Eb(e){Nr.call(this,null,e)}Eb.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const Mb=["x","y","weight","size","cellSize","bandwidth"];function jb(e,t){return Mb.forEach(n=>null!=t[n]?e[n](t[n]):0),e}function Rb(e){Nr.call(this,null,e)}Object(p.z)(Eb,Nr,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=function(e,t){var n,i,r,o,s,a,l=[],c=e=>e(o);if(null==t)l.push(e);else for(n={},i=0,r=e.length;i<r;++i)o=e[i],s=t.map(c),(a=n[s])||(n[s]=a=[],a.dims=s,l.push(a)),a.push(o);return l}(t.materialize(t.SOURCE).source,e.groupby),o=(e.groupby||[]).map(p.h),s=jb(Cb(),e),a=e.as||"grid";return n=r.map(t=>_(function(e,t){for(let n=0;n<o.length;++n)e[o[n]]=t[n];return e}({[a]:s(t,e.counts)},t.dims))),this.value&&(i.rem=this.value),this.value=i.source=i.add=n,i}}),Rb.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},Object(p.z)(Rb,Nr,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n,i,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),o=vb().smooth(!1!==e.smooth),s=e.values,a=e.thresholds||xb(e.count||10,e.nice,!!s),l=e.size;return s||(s=t.materialize(t.SOURCE).source,i=kb(n=jb(Cb(),e)(s,!0),n.scale||1,n.scale||1,0,0),l=[n.width,n.height],s=n.values),a=Object(p.B)(a)?a:a(s),s=o.size(l)(s,a),i&&s.forEach(i),this.value&&(r.rem=this.value),this.value=r.source=r.add=(s||[]).map(_),r}});function Db(e){Nr.call(this,null,e)}Db.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},Object(p.z)(Db,Nr,{transform(e,t){var n,i=this._features,r=this._points,o=e.fields,s=o&&o[0],a=o&&o[1],l=e.geojson||!o&&p.y,c=t.ADD;n=e.modified()||t.changed(t.REM)||t.modified(Object(p.g)(l))||s&&t.modified(Object(p.g)(s))||a&&t.modified(Object(p.g)(a)),this.value&&!n||(c=t.SOURCE,this._features=i=[],this._points=r=[]),l&&t.visit(c,e=>i.push(l(e))),s&&a&&(t.visit(c,e=>{var t=s(e),n=a(e);null!=t&&null!=n&&(t=+t)===t&&(n=+n)===n&&r.push([t,n])}),i=i.concat({type:"Feature",geometry:{type:"MultiPoint",coordinates:r}})),this.value={type:"FeatureCollection",features:i}}});var Tb=function(e){return e};function Lb(e,t){e&&Nb.hasOwnProperty(e.type)&&Nb[e.type](e,t)}var Fb={Feature:function(e,t){Lb(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)Lb(n[i].geometry,t)}},Nb={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){Pb(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)Pb(n[i],t,0)},Polygon:function(e,t){zb(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)zb(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)Lb(n[i],t)}};function Pb(e,t,n){var i,r=-1,o=e.length-n;for(t.lineStart();++r<o;)i=e[r],t.point(i[0],i[1],i[2]);t.lineEnd()}function zb(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)Pb(e[n],t,1);t.polygonEnd()}var Ib=function(e,t){e&&Fb.hasOwnProperty(e.type)?Fb[e.type](e,t):Lb(e,t)},Bb=function(){return new Wb};function Wb(){this.reset()}Wb.prototype={constructor:Wb,reset:function(){this.s=this.t=0},add:function(e){Hb(Ub,e,this.t),Hb(this,Ub.s,this.s),this.s?this.t+=Ub.t:this.s=Ub.t},valueOf:function(){return this.s}};var Ub=new Wb;function Hb(e,t,n){var i=e.s=t+n,r=i-t,o=i-r;e.t=t-o+(n-r)}var qb=Math.PI,Vb=qb/2,Gb=qb/4,Kb=2*qb,Yb=180/qb,Xb=qb/180,Jb=Math.abs,Qb=Math.atan,Zb=Math.atan2,ey=Math.cos,ty=Math.ceil,ny=Math.exp,iy=(Math.floor,Math.log),ry=Math.pow,oy=Math.sin,sy=Math.sign||function(e){return e>0?1:e<0?-1:0},ay=Math.sqrt,ly=Math.tan;function cy(e){return e>1?0:e<-1?qb:Math.acos(e)}function uy(e){return e>1?Vb:e<-1?-Vb:Math.asin(e)}function hy(){}var dy,fy,py,gy,my=Bb(),vy=Bb(),by={point:hy,lineStart:hy,lineEnd:hy,polygonStart:function(){by.lineStart=yy,by.lineEnd=_y},polygonEnd:function(){by.lineStart=by.lineEnd=by.point=hy,my.add(Jb(vy)),vy.reset()},result:function(){var e=my/2;return my.reset(),e}};function yy(){by.point=wy}function wy(e,t){by.point=xy,dy=py=e,fy=gy=t}function xy(e,t){vy.add(gy*e-py*t),py=e,gy=t}function _y(){xy(dy,fy)}var ky=by,Sy=1/0,Oy=Sy,Cy=-Sy,Ay=Cy;var $y,Ey,My,jy,Ry={point:function(e,t){e<Sy&&(Sy=e);e>Cy&&(Cy=e);t<Oy&&(Oy=t);t>Ay&&(Ay=t)},lineStart:hy,lineEnd:hy,polygonStart:hy,polygonEnd:hy,result:function(){var e=[[Sy,Oy],[Cy,Ay]];return Cy=Ay=-(Oy=Sy=1/0),e}},Dy=0,Ty=0,Ly=0,Fy=0,Ny=0,Py=0,zy=0,Iy=0,By=0,Wy={point:Uy,lineStart:Hy,lineEnd:Gy,polygonStart:function(){Wy.lineStart=Ky,Wy.lineEnd=Yy},polygonEnd:function(){Wy.point=Uy,Wy.lineStart=Hy,Wy.lineEnd=Gy},result:function(){var e=By?[zy/By,Iy/By]:Py?[Fy/Py,Ny/Py]:Ly?[Dy/Ly,Ty/Ly]:[NaN,NaN];return Dy=Ty=Ly=Fy=Ny=Py=zy=Iy=By=0,e}};function Uy(e,t){Dy+=e,Ty+=t,++Ly}function Hy(){Wy.point=qy}function qy(e,t){Wy.point=Vy,Uy(My=e,jy=t)}function Vy(e,t){var n=e-My,i=t-jy,r=ay(n*n+i*i);Fy+=r*(My+e)/2,Ny+=r*(jy+t)/2,Py+=r,Uy(My=e,jy=t)}function Gy(){Wy.point=Uy}function Ky(){Wy.point=Xy}function Yy(){Jy($y,Ey)}function Xy(e,t){Wy.point=Jy,Uy($y=My=e,Ey=jy=t)}function Jy(e,t){var n=e-My,i=t-jy,r=ay(n*n+i*i);Fy+=r*(My+e)/2,Ny+=r*(jy+t)/2,Py+=r,zy+=(r=jy*e-My*t)*(My+e),Iy+=r*(jy+t),By+=3*r,Uy(My=e,jy=t)}var Qy=Wy;function Zy(e){this._context=e}Zy.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Kb)}},result:hy};var ew,tw,nw,iw,rw,ow=Bb(),sw={point:hy,lineStart:function(){sw.point=aw},lineEnd:function(){ew&&lw(tw,nw),sw.point=hy},polygonStart:function(){ew=!0},polygonEnd:function(){ew=null},result:function(){var e=+ow;return ow.reset(),e}};function aw(e,t){sw.point=lw,tw=iw=e,nw=rw=t}function lw(e,t){iw-=e,rw-=t,ow.add(ay(iw*iw+rw*rw)),iw=e,rw=t}var cw=sw;function uw(){this._string=[]}function hw(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}uw.prototype={_radius:4.5,_circle:hw(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._string.push("M",e,",",t),this._point=1;break;case 1:this._string.push("L",e,",",t);break;default:null==this._circle&&(this._circle=hw(this._radius)),this._string.push("M",e,",",t,this._circle)}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}return null}};var dw=function(e,t){var n,i,r=4.5;function o(e){return e&&("function"==typeof r&&i.pointRadius(+r.apply(this,arguments)),Ib(e,n(i))),i.result()}return o.area=function(e){return Ib(e,n(ky)),ky.result()},o.measure=function(e){return Ib(e,n(cw)),cw.result()},o.bounds=function(e){return Ib(e,n(Ry)),Ry.result()},o.centroid=function(e){return Ib(e,n(Qy)),Qy.result()},o.projection=function(t){return arguments.length?(n=null==t?(e=null,Tb):(e=t).stream,o):e},o.context=function(e){return arguments.length?(i=null==e?(t=null,new uw):new Zy(t=e),"function"!=typeof r&&i.pointRadius(r),o):t},o.pointRadius=function(e){return arguments.length?(r="function"==typeof e?e:(i.pointRadius(+e),+e),o):r},o.projection(e).context(t)},fw=function(){var e,t=[];return{point:function(t,n,i){e.push([t,n,i])},lineStart:function(){t.push(e=[])},lineEnd:hy,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}},pw=function(e,t){return Jb(e[0]-t[0])<1e-6&&Jb(e[1]-t[1])<1e-6};function gw(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}var mw=function(e,t,n,i,r){var o,s,a=[],l=[];if(e.forEach((function(e){if(!((t=e.length-1)<=0)){var t,n,i=e[0],s=e[t];if(pw(i,s)){if(!i[2]&&!s[2]){for(r.lineStart(),o=0;o<t;++o)r.point((i=e[o])[0],i[1]);return void r.lineEnd()}s[0]+=2e-6}a.push(n=new gw(i,e,null,!0)),l.push(n.o=new gw(i,null,n,!1)),a.push(n=new gw(s,e,null,!1)),l.push(n.o=new gw(s,null,n,!0))}})),a.length){for(l.sort(t),vw(a),vw(l),o=0,s=l.length;o<s;++o)l[o].e=n=!n;for(var c,u,h=a[0];;){for(var d=h,f=!0;d.v;)if((d=d.n)===h)return;c=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(f)for(o=0,s=c.length;o<s;++o)r.point((u=c[o])[0],u[1]);else i(d.x,d.n.x,1,r);d=d.n}else{if(f)for(c=d.p.z,o=c.length-1;o>=0;--o)r.point((u=c[o])[0],u[1]);else i(d.x,d.p.x,-1,r);d=d.p}c=(d=d.o).z,f=!f}while(!d.v);r.lineEnd()}}};function vw(e){if(t=e.length){for(var t,n,i=0,r=e[0];++i<t;)r.n=n=e[i],n.p=r,r=n;r.n=n=e[0],n.p=r}}function bw(e){return[Zb(e[1],e[0]),uy(e[2])]}function yw(e){var t=e[0],n=e[1],i=ey(n);return[i*ey(t),i*oy(t),oy(n)]}function ww(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function xw(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function _w(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function kw(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Sw(e){var t=ay(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var Ow=Bb();function Cw(e){return Jb(e[0])<=qb?e[0]:sy(e[0])*((Jb(e[0])+qb)%Kb-qb)}var Aw=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN};var $w,Ew;1===($w=Aw).length&&(Ew=$w,$w=function(e,t){return Aw(Ew(e),t)});var Mw=Array.prototype,jw=(Mw.slice,Mw.map,function(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(r);++i<r;)o[i]=e+i*n;return o});Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);var Rw=function(e){for(var t,n,i,r=e.length,o=-1,s=0;++o<r;)s+=e[o].length;for(n=new Array(s);--r>=0;)for(t=(i=e[r]).length;--t>=0;)n[--s]=i[t];return n};var Dw=function(e,t,n,i){return function(r){var o,s,a,l=t(r),c=fw(),u=t(c),h=!1,d={point:f,lineStart:g,lineEnd:m,polygonStart:function(){d.point=v,d.lineStart=b,d.lineEnd=y,s=[],o=[]},polygonEnd:function(){d.point=f,d.lineStart=g,d.lineEnd=m,s=Rw(s);var e=function(e,t){var n=Cw(t),i=t[1],r=oy(i),o=[oy(n),-ey(n),0],s=0,a=0;Ow.reset(),1===r?i=Vb+1e-6:-1===r&&(i=-Vb-1e-6);for(var l=0,c=e.length;l<c;++l)if(h=(u=e[l]).length)for(var u,h,d=u[h-1],f=Cw(d),p=d[1]/2+Gb,g=oy(p),m=ey(p),v=0;v<h;++v,f=y,g=x,m=_,d=b){var b=u[v],y=Cw(b),w=b[1]/2+Gb,x=oy(w),_=ey(w),k=y-f,S=k>=0?1:-1,O=S*k,C=O>qb,A=g*x;if(Ow.add(Zb(A*S*oy(O),m*_+A*ey(O))),s+=C?k+S*Kb:k,C^f>=n^y>=n){var $=xw(yw(d),yw(b));Sw($);var E=xw(o,$);Sw(E);var M=(C^k>=0?-1:1)*uy(E[2]);(i>M||i===M&&($[0]||$[1]))&&(a+=C^k>=0?1:-1)}}return(s<-1e-6||s<1e-6&&Ow<-1e-6)^1&a}(o,i);s.length?(h||(r.polygonStart(),h=!0),mw(s,Lw,e,n,r)):e&&(h||(r.polygonStart(),h=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),h&&(r.polygonEnd(),h=!1),s=o=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function f(t,n){e(t,n)&&r.point(t,n)}function p(e,t){l.point(e,t)}function g(){d.point=p,l.lineStart()}function m(){d.point=f,l.lineEnd()}function v(e,t){a.push([e,t]),u.point(e,t)}function b(){u.lineStart(),a=[]}function y(){v(a[0][0],a[0][1]),u.lineEnd();var e,t,n,i,l=u.clean(),d=c.result(),f=d.length;if(a.pop(),o.push(a),a=null,f)if(1&l){if((t=(n=d[0]).length-1)>0){for(h||(r.polygonStart(),h=!0),r.lineStart(),e=0;e<t;++e)r.point((i=n[e])[0],i[1]);r.lineEnd()}}else f>1&&2&l&&d.push(d.pop().concat(d.shift())),s.push(d.filter(Tw))}return d}};function Tw(e){return e.length>1}function Lw(e,t){return((e=e.x)[0]<0?e[1]-Vb-1e-6:Vb-e[1])-((t=t.x)[0]<0?t[1]-Vb-1e-6:Vb-t[1])}var Fw=Dw((function(){return!0}),(function(e){var t,n=NaN,i=NaN,r=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(o,s){var a=o>0?qb:-qb,l=Jb(o-n);Jb(l-qb)<1e-6?(e.point(n,i=(i+s)/2>0?Vb:-Vb),e.point(r,i),e.lineEnd(),e.lineStart(),e.point(a,i),e.point(o,i),t=0):r!==a&&l>=qb&&(Jb(n-r)<1e-6&&(n-=1e-6*r),Jb(o-a)<1e-6&&(o-=1e-6*a),i=function(e,t,n,i){var r,o,s=oy(e-n);return Jb(s)>1e-6?Qb((oy(t)*(o=ey(i))*oy(n)-oy(i)*(r=ey(t))*oy(e))/(r*o*s)):(t+i)/2}(n,i,o,s),e.point(r,i),e.lineEnd(),e.lineStart(),e.point(a,i),t=0),e.point(n=o,i=s),r=a},lineEnd:function(){e.lineEnd(),n=i=NaN},clean:function(){return 2-t}}}),(function(e,t,n,i){var r;if(null==e)r=n*Vb,i.point(-qb,r),i.point(0,r),i.point(qb,r),i.point(qb,0),i.point(qb,-r),i.point(0,-r),i.point(-qb,-r),i.point(-qb,0),i.point(-qb,r);else if(Jb(e[0]-t[0])>1e-6){var o=e[0]<t[0]?qb:-qb;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(t[0],t[1])}),[-qb,-Vb]);var Nw=function(e,t){function n(n,i){return n=e(n,i),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,i){return(n=t.invert(n,i))&&e.invert(n[0],n[1])}),n};function Pw(e,t){return[Jb(e)>qb?e+Math.round(-e/Kb)*Kb:e,t]}function zw(e,t,n){return(e%=Kb)?t||n?Nw(Bw(e),Ww(t,n)):Bw(e):t||n?Ww(t,n):Pw}function Iw(e){return function(t,n){return[(t+=e)>qb?t-Kb:t<-qb?t+Kb:t,n]}}function Bw(e){var t=Iw(e);return t.invert=Iw(-e),t}function Ww(e,t){var n=ey(e),i=oy(e),r=ey(t),o=oy(t);function s(e,t){var s=ey(t),a=ey(e)*s,l=oy(e)*s,c=oy(t),u=c*n+a*i;return[Zb(l*r-u*o,a*n-c*i),uy(u*r+l*o)]}return s.invert=function(e,t){var s=ey(t),a=ey(e)*s,l=oy(e)*s,c=oy(t),u=c*r-l*o;return[Zb(l*r+c*o,a*n+u*i),uy(u*n-a*i)]},s}Pw.invert=Pw;function Uw(e,t,n,i,r,o){if(n){var s=ey(t),a=oy(t),l=i*n;null==r?(r=t+i*Kb,o=t-l/2):(r=Hw(s,r),o=Hw(s,o),(i>0?r<o:r>o)&&(r+=i*Kb));for(var c,u=r;i>0?u>o:u<o;u-=l)c=bw([s,-a*ey(u),-a*oy(u)]),e.point(c[0],c[1])}}function Hw(e,t){(t=yw(t))[0]-=e,Sw(t);var n=cy(-t[1]);return((-t[2]<0?-n:n)+Kb-1e-6)%Kb}var qw=function(e){var t=ey(e),n=6*Xb,i=t>0,r=Jb(t)>1e-6;function o(e,n){return ey(e)*ey(n)>t}function s(e,n,i){var r=[1,0,0],o=xw(yw(e),yw(n)),s=ww(o,o),a=o[0],l=s-a*a;if(!l)return!i&&e;var c=t*s/l,u=-t*a/l,h=xw(r,o),d=kw(r,c);_w(d,kw(o,u));var f=h,p=ww(d,f),g=ww(f,f),m=p*p-g*(ww(d,d)-1);if(!(m<0)){var v=ay(m),b=kw(f,(-p-v)/g);if(_w(b,d),b=bw(b),!i)return b;var y,w=e[0],x=n[0],_=e[1],k=n[1];x<w&&(y=w,w=x,x=y);var S=x-w,O=Jb(S-qb)<1e-6;if(!O&&k<_&&(y=_,_=k,k=y),O||S<1e-6?O?_+k>0^b[1]<(Jb(b[0]-w)<1e-6?_:k):_<=b[1]&&b[1]<=k:S>qb^(w<=b[0]&&b[0]<=x)){var C=kw(f,(-p+v)/g);return _w(C,d),[b,bw(C)]}}}function a(t,n){var r=i?e:qb-e,o=0;return t<-r?o|=1:t>r&&(o|=2),n<-r?o|=4:n>r&&(o|=8),o}return Dw(o,(function(e){var t,n,l,c,u;return{lineStart:function(){c=l=!1,u=1},point:function(h,d){var f,p=[h,d],g=o(h,d),m=i?g?0:a(h,d):g?a(h+(h<0?qb:-qb),d):0;if(!t&&(c=l=g)&&e.lineStart(),g!==l&&(!(f=s(t,p))||pw(t,f)||pw(p,f))&&(p[2]=1),g!==l)u=0,g?(e.lineStart(),f=s(p,t),e.point(f[0],f[1])):(f=s(t,p),e.point(f[0],f[1],2),e.lineEnd()),t=f;else if(r&&t&&i^g){var v;m&n||!(v=s(p,t,!0))||(u=0,i?(e.lineStart(),e.point(v[0][0],v[0][1]),e.point(v[1][0],v[1][1]),e.lineEnd()):(e.point(v[1][0],v[1][1]),e.lineEnd(),e.lineStart(),e.point(v[0][0],v[0][1],3)))}!g||t&&pw(t,p)||e.point(p[0],p[1]),t=p,l=g,n=m},lineEnd:function(){l&&e.lineEnd(),t=null},clean:function(){return u|(c&&l)<<1}}}),(function(t,i,r,o){Uw(o,e,n,r,t,i)}),i?[0,-e]:[-qb,e-qb])};function Vw(e,t,n,i){function r(r,o){return e<=r&&r<=n&&t<=o&&o<=i}function o(r,o,a,c){var u=0,h=0;if(null==r||(u=s(r,a))!==(h=s(o,a))||l(r,o)<0^a>0)do{c.point(0===u||3===u?e:n,u>1?i:t)}while((u=(u+a+4)%4)!==h);else c.point(o[0],o[1])}function s(i,r){return Jb(i[0]-e)<1e-6?r>0?0:3:Jb(i[0]-n)<1e-6?r>0?2:1:Jb(i[1]-t)<1e-6?r>0?1:0:r>0?3:2}function a(e,t){return l(e.x,t.x)}function l(e,t){var n=s(e,1),i=s(t,1);return n!==i?n-i:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(s){var l,c,u,h,d,f,p,g,m,v,b,y=s,w=fw(),x={point:_,lineStart:function(){x.point=k,c&&c.push(u=[]);v=!0,m=!1,p=g=NaN},lineEnd:function(){l&&(k(h,d),f&&m&&w.rejoin(),l.push(w.result()));x.point=_,m&&y.lineEnd()},polygonStart:function(){y=w,l=[],c=[],b=!0},polygonEnd:function(){var t=function(){for(var t=0,n=0,r=c.length;n<r;++n)for(var o,s,a=c[n],l=1,u=a.length,h=a[0],d=h[0],f=h[1];l<u;++l)o=d,s=f,h=a[l],d=h[0],f=h[1],s<=i?f>i&&(d-o)*(i-s)>(f-s)*(e-o)&&++t:f<=i&&(d-o)*(i-s)<(f-s)*(e-o)&&--t;return t}(),n=b&&t,r=(l=Rw(l)).length;(n||r)&&(s.polygonStart(),n&&(s.lineStart(),o(null,null,1,s),s.lineEnd()),r&&mw(l,a,t,o,s),s.polygonEnd());y=s,l=c=u=null}};function _(e,t){r(e,t)&&y.point(e,t)}function k(o,s){var a=r(o,s);if(c&&u.push([o,s]),v)h=o,d=s,f=a,v=!1,a&&(y.lineStart(),y.point(o,s));else if(a&&m)y.point(o,s);else{var l=[p=Math.max(-1e9,Math.min(1e9,p)),g=Math.max(-1e9,Math.min(1e9,g))],w=[o=Math.max(-1e9,Math.min(1e9,o)),s=Math.max(-1e9,Math.min(1e9,s))];!function(e,t,n,i,r,o){var s,a=e[0],l=e[1],c=0,u=1,h=t[0]-a,d=t[1]-l;if(s=n-a,h||!(s>0)){if(s/=h,h<0){if(s<c)return;s<u&&(u=s)}else if(h>0){if(s>u)return;s>c&&(c=s)}if(s=r-a,h||!(s<0)){if(s/=h,h<0){if(s>u)return;s>c&&(c=s)}else if(h>0){if(s<c)return;s<u&&(u=s)}if(s=i-l,d||!(s>0)){if(s/=d,d<0){if(s<c)return;s<u&&(u=s)}else if(d>0){if(s>u)return;s>c&&(c=s)}if(s=o-l,d||!(s<0)){if(s/=d,d<0){if(s>u)return;s>c&&(c=s)}else if(d>0){if(s<c)return;s<u&&(u=s)}return c>0&&(e[0]=a+c*h,e[1]=l+c*d),u<1&&(t[0]=a+u*h,t[1]=l+u*d),!0}}}}}(l,w,e,t,n,i)?a&&(y.lineStart(),y.point(o,s),b=!1):(m||(y.lineStart(),y.point(l[0],l[1])),y.point(w[0],w[1]),a||y.lineEnd(),b=!1)}p=o,g=s,m=a}return x}}function Gw(e){return function(t){var n=new Kw;for(var i in e)n[i]=e[i];return n.stream=t,n}}function Kw(){}function Yw(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=i&&e.clipExtent(null),Ib(n,e.stream(Ry)),t(Ry.result()),null!=i&&e.clipExtent(i),e}function Xw(e,t,n){return Yw(e,(function(n){var i=t[1][0]-t[0][0],r=t[1][1]-t[0][1],o=Math.min(i/(n[1][0]-n[0][0]),r/(n[1][1]-n[0][1])),s=+t[0][0]+(i-o*(n[1][0]+n[0][0]))/2,a=+t[0][1]+(r-o*(n[1][1]+n[0][1]))/2;e.scale(150*o).translate([s,a])}),n)}function Jw(e,t,n){return Xw(e,[[0,0],t],n)}function Qw(e,t,n){return Yw(e,(function(n){var i=+t,r=i/(n[1][0]-n[0][0]),o=(i-r*(n[1][0]+n[0][0]))/2,s=-r*n[0][1];e.scale(150*r).translate([o,s])}),n)}function Zw(e,t,n){return Yw(e,(function(n){var i=+t,r=i/(n[1][1]-n[0][1]),o=-r*n[0][0],s=(i-r*(n[1][1]+n[0][1]))/2;e.scale(150*r).translate([o,s])}),n)}Kw.prototype={constructor:Kw,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var ex=ey(30*Xb),tx=function(e,t){return+t?function(e,t){function n(i,r,o,s,a,l,c,u,h,d,f,p,g,m){var v=c-i,b=u-r,y=v*v+b*b;if(y>4*t&&g--){var w=s+d,x=a+f,_=l+p,k=ay(w*w+x*x+_*_),S=uy(_/=k),O=Jb(Jb(_)-1)<1e-6||Jb(o-h)<1e-6?(o+h)/2:Zb(x,w),C=e(O,S),A=C[0],$=C[1],E=A-i,M=$-r,j=b*E-v*M;(j*j/y>t||Jb((v*E+b*M)/y-.5)>.3||s*d+a*f+l*p<ex)&&(n(i,r,o,s,a,l,A,$,O,w/=k,x/=k,_,g,m),m.point(A,$),n(A,$,O,w,x,_,c,u,h,d,f,p,g,m))}}return function(t){var i,r,o,s,a,l,c,u,h,d,f,p,g={point:m,lineStart:v,lineEnd:y,polygonStart:function(){t.polygonStart(),g.lineStart=w},polygonEnd:function(){t.polygonEnd(),g.lineStart=v}};function m(n,i){n=e(n,i),t.point(n[0],n[1])}function v(){u=NaN,g.point=b,t.lineStart()}function b(i,r){var o=yw([i,r]),s=e(i,r);n(u,h,c,d,f,p,u=s[0],h=s[1],c=i,d=o[0],f=o[1],p=o[2],16,t),t.point(u,h)}function y(){g.point=m,t.lineEnd()}function w(){v(),g.point=x,g.lineEnd=_}function x(e,t){b(i=e,t),r=u,o=h,s=d,a=f,l=p,g.point=b}function _(){n(u,h,c,d,f,p,r,o,i,s,a,l,16,t),g.lineEnd=y,y()}return g}}(e,t):function(e){return Gw({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)};var nx=Gw({point:function(e,t){this.stream.point(e*Xb,t*Xb)}});function ix(e,t,n,i,r){function o(o,s){return[t+e*(o*=i),n-e*(s*=r)]}return o.invert=function(o,s){return[(o-t)/e*i,(n-s)/e*r]},o}function rx(e,t,n,i,r,o){var s=ey(o),a=oy(o),l=s*e,c=a*e,u=s/e,h=a/e,d=(a*n-s*t)/e,f=(a*t+s*n)/e;function p(e,o){return[l*(e*=i)-c*(o*=r)+t,n-c*e-l*o]}return p.invert=function(e,t){return[i*(u*e-h*t+d),r*(f-h*e-u*t)]},p}function ox(e){return sx((function(){return e}))()}function sx(e){var t,n,i,r,o,s,a,l,c,u,h=150,d=480,f=250,p=0,g=0,m=0,v=0,b=0,y=0,w=1,x=1,_=null,k=Fw,S=null,O=Tb,C=.5;function A(e){return l(e[0]*Xb,e[1]*Xb)}function $(e){return(e=l.invert(e[0],e[1]))&&[e[0]*Yb,e[1]*Yb]}function E(){var e=rx(h,0,0,w,x,y).apply(null,t(p,g)),i=(y?rx:ix)(h,d-e[0],f-e[1],w,x,y);return n=zw(m,v,b),a=Nw(t,i),l=Nw(n,a),s=tx(a,C),M()}function M(){return c=u=null,A}return A.stream=function(e){return c&&u===e?c:c=nx(function(e){return Gw({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}(n)(k(s(O(u=e)))))},A.preclip=function(e){return arguments.length?(k=e,_=void 0,M()):k},A.postclip=function(e){return arguments.length?(O=e,S=i=r=o=null,M()):O},A.clipAngle=function(e){return arguments.length?(k=+e?qw(_=e*Xb):(_=null,Fw),M()):_*Yb},A.clipExtent=function(e){return arguments.length?(O=null==e?(S=i=r=o=null,Tb):Vw(S=+e[0][0],i=+e[0][1],r=+e[1][0],o=+e[1][1]),M()):null==S?null:[[S,i],[r,o]]},A.scale=function(e){return arguments.length?(h=+e,E()):h},A.translate=function(e){return arguments.length?(d=+e[0],f=+e[1],E()):[d,f]},A.center=function(e){return arguments.length?(p=e[0]%360*Xb,g=e[1]%360*Xb,E()):[p*Yb,g*Yb]},A.rotate=function(e){return arguments.length?(m=e[0]%360*Xb,v=e[1]%360*Xb,b=e.length>2?e[2]%360*Xb:0,E()):[m*Yb,v*Yb,b*Yb]},A.angle=function(e){return arguments.length?(y=e%360*Xb,E()):y*Yb},A.reflectX=function(e){return arguments.length?(w=e?-1:1,E()):w<0},A.reflectY=function(e){return arguments.length?(x=e?-1:1,E()):x<0},A.precision=function(e){return arguments.length?(s=tx(a,C=e*e),M()):ay(C)},A.fitExtent=function(e,t){return Xw(A,e,t)},A.fitSize=function(e,t){return Jw(A,e,t)},A.fitWidth=function(e,t){return Qw(A,e,t)},A.fitHeight=function(e,t){return Zw(A,e,t)},function(){return t=e.apply(this,arguments),A.invert=t.invert&&$,E()}}function ax(e){var t=0,n=qb/3,i=sx(e),r=i(t,n);return r.parallels=function(e){return arguments.length?i(t=e[0]*Xb,n=e[1]*Xb):[t*Yb,n*Yb]},r}function lx(e,t){var n=oy(e),i=(n+oy(t))/2;if(Jb(i)<1e-6)return function(e){var t=ey(e);function n(e,n){return[e*t,oy(n)/t]}return n.invert=function(e,n){return[e/t,uy(n*t)]},n}(e);var r=1+n*(2*i-n),o=ay(r)/i;function s(e,t){var n=ay(r-2*i*oy(t))/i;return[n*oy(e*=i),o-n*ey(e)]}return s.invert=function(e,t){var n=o-t,s=Zb(e,Jb(n))*sy(n);return n*i<0&&(s-=qb*sy(e)*sy(n)),[s/i,uy((r-(e*e+n*n)*i*i)/(2*i))]},s}var cx=function(){return ax(lx).scale(155.424).center([0,33.6442])},ux=function(){return cx().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])};function hx(e){return function(t,n){var i=ey(t),r=ey(n),o=e(i*r);return[o*r*oy(t),o*oy(n)]}}function dx(e){return function(t,n){var i=ay(t*t+n*n),r=e(i),o=oy(r),s=ey(r);return[Zb(t*o,i*s),uy(i&&n*o/i)]}}var fx=hx((function(e){return ay(2/(1+e))}));fx.invert=dx((function(e){return 2*uy(e/2)}));var px=hx((function(e){return(e=cy(e))&&e/oy(e)}));px.invert=dx((function(e){return e}));function gx(e,t){return[e,iy(ly((Vb+t)/2))]}gx.invert=function(e,t){return[e,2*Qb(ny(t))-Vb]};function mx(e){var t,n,i,r=ox(e),o=r.center,s=r.scale,a=r.translate,l=r.clipExtent,c=null;function u(){var o=qb*s(),a=r(function(e){function t(t){return(t=e(t[0]*Xb,t[1]*Xb))[0]*=Yb,t[1]*=Yb,t}return e=zw(e[0]*Xb,e[1]*Xb,e.length>2?e[2]*Xb:0),t.invert=function(t){return(t=e.invert(t[0]*Xb,t[1]*Xb))[0]*=Yb,t[1]*=Yb,t},t}(r.rotate()).invert([0,0]));return l(null==c?[[a[0]-o,a[1]-o],[a[0]+o,a[1]+o]]:e===gx?[[Math.max(a[0]-o,c),t],[Math.min(a[0]+o,n),i]]:[[c,Math.max(a[1]-o,t)],[n,Math.min(a[1]+o,i)]])}return r.scale=function(e){return arguments.length?(s(e),u()):s()},r.translate=function(e){return arguments.length?(a(e),u()):a()},r.center=function(e){return arguments.length?(o(e),u()):o()},r.clipExtent=function(e){return arguments.length?(null==e?c=t=n=i=null:(c=+e[0][0],t=+e[0][1],n=+e[1][0],i=+e[1][1]),u()):null==c?null:[[c,t],[n,i]]},u()}function vx(e){return ly((Vb+e)/2)}function bx(e,t){var n=ey(e),i=e===t?oy(e):iy(n/ey(t))/iy(vx(t)/vx(e)),r=n*ry(vx(e),i)/i;if(!i)return gx;function o(e,t){r>0?t<1e-6-Vb&&(t=1e-6-Vb):t>Vb-1e-6&&(t=Vb-1e-6);var n=r/ry(vx(t),i);return[n*oy(i*e),r-n*ey(i*e)]}return o.invert=function(e,t){var n=r-t,o=sy(i)*ay(e*e+n*n),s=Zb(e,Jb(n))*sy(n);return n*i<0&&(s-=qb*sy(e)*sy(n)),[s/i,2*Qb(ry(r/o,1/i))-Vb]},o}function yx(e,t){return[e,t]}yx.invert=yx;function wx(e,t){var n=ey(e),i=e===t?oy(e):(n-ey(t))/(t-e),r=n/i+e;if(Jb(i)<1e-6)return yx;function o(e,t){var n=r-t,o=i*e;return[n*oy(o),r-n*ey(o)]}return o.invert=function(e,t){var n=r-t,o=Zb(e,Jb(n))*sy(n);return n*i<0&&(o-=qb*sy(e)*sy(n)),[o/i,r-sy(i)*ay(e*e+n*n)]},o}var xx=1.340264,_x=-.081106,kx=893e-6,Sx=.003796,Ox=ay(3)/2;function Cx(e,t){var n=uy(Ox*oy(t)),i=n*n,r=i*i*i;return[e*ey(n)/(Ox*(xx+3*_x*i+r*(7*kx+9*Sx*i))),n*(xx+_x*i+r*(kx+Sx*i))]}Cx.invert=function(e,t){for(var n,i=t,r=i*i,o=r*r*r,s=0;s<12&&(o=(r=(i-=n=(i*(xx+_x*r+o*(kx+Sx*r))-t)/(xx+3*_x*r+o*(7*kx+9*Sx*r)))*i)*r*r,!(Jb(n)<1e-12));++s);return[Ox*e*(xx+3*_x*r+o*(7*kx+9*Sx*r))/ey(i),uy(oy(i)/Ox)]};function Ax(e,t){var n=ey(t),i=ey(e)*n;return[n*oy(e)/i,oy(t)/i]}Ax.invert=dx(Qb);function $x(e,t){var n=t*t,i=n*n;return[e*(.8707-.131979*n+i*(i*(.003971*n-.001529*i)-.013791)),t*(1.007226+n*(.015085+i*(.028874*n-.044475-.005916*i)))]}$x.invert=function(e,t){var n,i=t,r=25;do{var o=i*i,s=o*o;i-=n=(i*(1.007226+o*(.015085+s*(.028874*o-.044475-.005916*s)))-t)/(1.007226+o*(.045255+s*(.259866*o-.311325-.005916*11*s)))}while(Jb(n)>1e-6&&--r>0);return[e/(.8707+(o=i*i)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),i]};function Ex(e,t){return[ey(t)*oy(e),oy(t)]}Ex.invert=dx(uy);function Mx(e,t){var n=ey(t),i=1+ey(e)*n;return[n*oy(e)/i,oy(t)/i]}Mx.invert=dx((function(e){return 2*Qb(e)}));function jx(e,t){return[iy(ly((Vb+t)/2)),-e]}jx.invert=function(e,t){return[-t,2*Qb(ny(e))-Vb]};var Rx=Math.abs,Dx=(Math.atan,Math.atan2,Math.ceil,Math.cos),Tx=(Math.exp,Math.floor,Math.log,Math.max,Math.min,Math.pow,Math.round,Math.sign,Math.sin),Lx=(Math.tan,Math.PI),Fx=Lx/2,Nx=(Math.SQRT1_2,zx(2));zx(Lx);function Px(e){return e>1?Fx:e<-1?-Fx:Math.asin(e)}function zx(e){return e>0?Math.sqrt(e):0}function Ix(e,t){var n,i=e*Tx(t),r=30;do{t-=n=(t+Tx(t)-i)/(1+Dx(t))}while(Rx(n)>1e-6&&--r>0);return t/2}var Bx=function(e,t,n){function i(i,r){return[e*i*Dx(r=Ix(n,r)),t*Tx(r)]}return i.invert=function(i,r){return r=Px(r/t),[i/(e*Dx(r)),Px((2*r+Tx(2*r))/n)]},i}(Nx/Fx,Nx,Lx);const Wx=dw(),Ux=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function Hx(e,t){return function n(){const i=t();return i.type=e,i.path=dw().projection(i),i.copy=i.copy||function(){const e=n();return Ux.forEach((function(t){i[t]&&e[t](i[t]())})),e.path.pointRadius(i.path.pointRadius()),e},i}}function qx(e,t){if(!e||"string"!=typeof e)throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(Gx[e]=Hx(e,t),this):Gx[e]||null}function Vx(e){return e&&e.path||Wx}const Gx={albers:ux,albersusa:function(){var e,t,n,i,r,o,s=ux(),a=cx().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=cx().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(e,t){o=[e,t]}};function u(e){var t=e[0],s=e[1];return o=null,n.point(t,s),o||(i.point(t,s),o)||(r.point(t,s),o)}function h(){return e=t=null,u}return u.invert=function(e){var t=s.scale(),n=s.translate(),i=(e[0]-n[0])/t,r=(e[1]-n[1])/t;return(r>=.12&&r<.234&&i>=-.425&&i<-.214?a:r>=.166&&r<.234&&i>=-.214&&i<-.115?l:s).invert(e)},u.stream=function(n){return e&&t===n?e:(i=[s.stream(t=n),a.stream(n),l.stream(n)],r=i.length,e={point:function(e,t){for(var n=-1;++n<r;)i[n].point(e,t)},sphere:function(){for(var e=-1;++e<r;)i[e].sphere()},lineStart:function(){for(var e=-1;++e<r;)i[e].lineStart()},lineEnd:function(){for(var e=-1;++e<r;)i[e].lineEnd()},polygonStart:function(){for(var e=-1;++e<r;)i[e].polygonStart()},polygonEnd:function(){for(var e=-1;++e<r;)i[e].polygonEnd()}});var i,r},u.precision=function(e){return arguments.length?(s.precision(e),a.precision(e),l.precision(e),h()):s.precision()},u.scale=function(e){return arguments.length?(s.scale(e),a.scale(.35*e),l.scale(e),u.translate(s.translate())):s.scale()},u.translate=function(e){if(!arguments.length)return s.translate();var t=s.scale(),o=+e[0],u=+e[1];return n=s.translate(e).clipExtent([[o-.455*t,u-.238*t],[o+.455*t,u+.238*t]]).stream(c),i=a.translate([o-.307*t,u+.201*t]).clipExtent([[o-.425*t+1e-6,u+.12*t+1e-6],[o-.214*t-1e-6,u+.234*t-1e-6]]).stream(c),r=l.translate([o-.205*t,u+.212*t]).clipExtent([[o-.214*t+1e-6,u+.166*t+1e-6],[o-.115*t-1e-6,u+.234*t-1e-6]]).stream(c),h()},u.fitExtent=function(e,t){return Xw(u,e,t)},u.fitSize=function(e,t){return Jw(u,e,t)},u.fitWidth=function(e,t){return Qw(u,e,t)},u.fitHeight=function(e,t){return Zw(u,e,t)},u.scale(1070)},azimuthalequalarea:function(){return ox(fx).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return ox(px).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return ax(bx).scale(109.5).parallels([30,30])},conicequalarea:cx,conicequidistant:function(){return ax(wx).scale(131.154).center([0,13.9389])},equalEarth:function(){return ox(Cx).scale(177.158)},equirectangular:function(){return ox(yx).scale(152.63)},gnomonic:function(){return ox(Ax).scale(144.049).clipAngle(60)},identity:function(){var e,t,n,i,r,o,s,a=1,l=0,c=0,u=1,h=1,d=0,f=null,p=1,g=1,m=Gw({point:function(e,t){var n=y([e,t]);this.stream.point(n[0],n[1])}}),v=Tb;function b(){return p=a*u,g=a*h,o=s=null,y}function y(n){var i=n[0]*p,r=n[1]*g;if(d){var o=r*e-i*t;i=i*e+r*t,r=o}return[i+l,r+c]}return y.invert=function(n){var i=n[0]-l,r=n[1]-c;if(d){var o=r*e+i*t;i=i*e-r*t,r=o}return[i/p,r/g]},y.stream=function(e){return o&&s===e?o:o=m(v(s=e))},y.postclip=function(e){return arguments.length?(v=e,f=n=i=r=null,b()):v},y.clipExtent=function(e){return arguments.length?(v=null==e?(f=n=i=r=null,Tb):Vw(f=+e[0][0],n=+e[0][1],i=+e[1][0],r=+e[1][1]),b()):null==f?null:[[f,n],[i,r]]},y.scale=function(e){return arguments.length?(a=+e,b()):a},y.translate=function(e){return arguments.length?(l=+e[0],c=+e[1],b()):[l,c]},y.angle=function(n){return arguments.length?(t=oy(d=n%360*Xb),e=ey(d),b()):d*Yb},y.reflectX=function(e){return arguments.length?(u=e?-1:1,b()):u<0},y.reflectY=function(e){return arguments.length?(h=e?-1:1,b()):h<0},y.fitExtent=function(e,t){return Xw(y,e,t)},y.fitSize=function(e,t){return Jw(y,e,t)},y.fitWidth=function(e,t){return Qw(y,e,t)},y.fitHeight=function(e,t){return Zw(y,e,t)},y},mercator:function(){return mx(gx).scale(961/Kb)},mollweide:function(){return ox(Bx).scale(169.529)},naturalEarth1:function(){return ox($x).scale(175.295)},orthographic:function(){return ox(Ex).scale(249.5).clipAngle(90.000001)},stereographic:function(){return ox(Mx).scale(250).clipAngle(142)},transversemercator:function(){var e=mx(jx),t=e.center,n=e.rotate;return e.center=function(e){return arguments.length?t([-e[1],e[0]]):[(e=t())[1],-e[0]]},e.rotate=function(e){return arguments.length?n([e[0],e[1],e.length>2?e[2]+90:90]):[(e=n())[0],e[1],e[2]-90]},n([0,0,90]).scale(159.155)}};for(const e in Gx)qx(e,Gx[e]);function Kx(e){Nr.call(this,null,e)}function Yx(e){Nr.call(this,null,e)}function Xx(e){Nr.call(this,null,e)}function Jx(e,t,n){var i=jw(e,t-1e-6,n).concat(t);return function(e){return i.map((function(t){return[e,t]}))}}function Qx(e,t,n){var i=jw(e,t-1e-6,n).concat(t);return function(e){return i.map((function(t){return[t,e]}))}}function Zx(){var e,t,n,i,r,o,s,a,l,c,u,h,d=10,f=d,p=90,g=360,m=2.5;function v(){return{type:"MultiLineString",coordinates:b()}}function b(){return jw(ty(i/p)*p,n,p).map(u).concat(jw(ty(a/g)*g,s,g).map(h)).concat(jw(ty(t/d)*d,e,d).filter((function(e){return Jb(e%p)>1e-6})).map(l)).concat(jw(ty(o/f)*f,r,f).filter((function(e){return Jb(e%g)>1e-6})).map(c))}return v.lines=function(){return b().map((function(e){return{type:"LineString",coordinates:e}}))},v.outline=function(){return{type:"Polygon",coordinates:[u(i).concat(h(s).slice(1),u(n).reverse().slice(1),h(a).reverse().slice(1))]}},v.extent=function(e){return arguments.length?v.extentMajor(e).extentMinor(e):v.extentMinor()},v.extentMajor=function(e){return arguments.length?(i=+e[0][0],n=+e[1][0],a=+e[0][1],s=+e[1][1],i>n&&(e=i,i=n,n=e),a>s&&(e=a,a=s,s=e),v.precision(m)):[[i,a],[n,s]]},v.extentMinor=function(n){return arguments.length?(t=+n[0][0],e=+n[1][0],o=+n[0][1],r=+n[1][1],t>e&&(n=t,t=e,e=n),o>r&&(n=o,o=r,r=n),v.precision(m)):[[t,o],[e,r]]},v.step=function(e){return arguments.length?v.stepMajor(e).stepMinor(e):v.stepMinor()},v.stepMajor=function(e){return arguments.length?(p=+e[0],g=+e[1],v):[p,g]},v.stepMinor=function(e){return arguments.length?(d=+e[0],f=+e[1],v):[d,f]},v.precision=function(d){return arguments.length?(m=+d,l=Jx(o,r,90),c=Qx(t,e,m),u=Jx(a,s,90),h=Qx(i,n,m),v):m},v.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}function e_(e){Nr.call(this,[],e),this.generator=Zx()}function t_(e){Nr.call(this,null,e)}function n_(e){if(!Object(p.E)(e))return!1;const t=Object(p.eb)(Object(p.g)(e));return t.$x||t.$y||t.$value||t.$max}function i_(e){Nr.call(this,null,e),this.modified(!0)}function r_(e,t,n){Object(p.E)(e[t])&&e[t](n)}Kx.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},Object(p.z)(Kx,Nr,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.field||p.y,o=e.as||"path",s=n.SOURCE;!i||e.modified()?(this.value=i=Vx(e.projection),n.materialize().reflow()):s=r===p.y||t.modified(r.fields)?n.ADD_MOD:n.ADD;var a=function(e,t){var n=e.pointRadius();e.context(null),null!=t&&e.pointRadius(t);return n}(i,e.pointRadius);return n.visit(s,e=>e[o]=i(r(e))),i.pointRadius(a),n.modifies(o)}}),Yx.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},Object(p.z)(Yx,Nr,{transform(e,t){var n,i=e.projection,r=e.fields[0],o=e.fields[1],s=e.as||["x","y"],a=s[0],l=s[1];function c(e){var t=i([r(e),o(e)]);t?(e[a]=t[0],e[l]=t[1]):(e[a]=void 0,e[l]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,c):(n=t.modified(r.fields)||t.modified(o.fields),t.visit(n?t.ADD_MOD:t.ADD,c)),t.modifies(s)}}),Xx.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},Object(p.z)(Xx,Nr,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.as||"shape",o=n.ADD;return i&&!e.modified()||(this.value=i=function(e,t,n){var i=null==n?n=>e(t(n)):i=>{var r=e.pointRadius(),o=e.pointRadius(n)(t(i));return e.pointRadius(r),o};return i.context=t=>(e.context(t),i),i}(Vx(e.projection),e.field||Object(p.u)("datum"),e.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,e=>e[r]=i),n.modifies(r)}}),e_.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},Object(p.z)(e_,Nr,{transform(e,t){var n,i=this.value,r=this.generator;if(!i.length||e.modified())for(var o in e)Object(p.E)(r[o])&&r[o](e[o]);return n=r(),i.length?t.mod.push(O(i[0],n)):t.add.push(_(n)),i[0]=n,t}}),t_.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},Object(p.z)(t_,Nr,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,i="shared"===e.resolve,r=e.field||p.y,o=function(e,t){let n;Object(p.E)(e)?(n=n=>e(n,t),n.dep=n_(e)):e?n=Object(p.m)(e):(n=e=>e.$value/e.$max||0,n.dep=!0);return n}(e.opacity,e),s=function(e,t){let n;Object(p.E)(e)?(n=n=>Af(e(n,t)),n.dep=n_(e)):n=Object(p.m)(Af(e||"#888"));return n}(e.color,e),a=e.as||"image",l={$x:0,$y:0,$value:0,$max:i?to(n.map(e=>to(r(e).values))):0};return n.forEach(e=>{const t=r(e),n=Object(p.p)({},e,l);i||(n.$max=to(t.values||[])),e[a]=function(e,t,n,i){const r=e.width,o=e.height,s=e.x1||0,a=e.y1||0,l=e.x2||r,c=e.y2||o,u=e.values,h=u?e=>u[e]:p.lb,d=Wc(l-s,c-a),f=d.getContext("2d"),g=f.getImageData(0,0,l-s,c-a),m=g.data;for(let e=a,o=0;e<c;++e){t.$y=e-a;for(let a=s,c=e*r;a<l;++a,o+=4){t.$x=a-s,t.$value=h(a+c);const e=n(t);m[o+0]=e.r,m[o+1]=e.g,m[o+2]=e.b,m[o+3]=~~(255*i(t))}}return f.putImageData(g,0,0),d}(t,n,s.dep?s:Object(p.m)(s(n)),o.dep?o:Object(p.m)(o(n)))}),t.reflow(!0).modifies(a)}}),Object(p.z)(i_,Nr,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=function(e){var t=qx((e||"mercator").toLowerCase());t||Object(p.o)("Unrecognized projection type: "+e);return t()}(e.type),Ux.forEach((function(t){null!=e[t]&&r_(n,t,e[t])}))):Ux.forEach((function(t){e.modified(t)&&r_(n,t,e[t])})),null!=e.pointRadius&&n.path.pointRadius(e.pointRadius),e.fit&&function(e,t){var n=function(e){return 1===(e=Object(p.i)(e)).length?e[0]:{type:"FeatureCollection",features:e.reduce((e,t)=>e.concat(function(e){return"FeatureCollection"===e.type?e.features:Object(p.i)(e).filter(e=>null!=e).map(e=>"Feature"===e.type?e:{type:"Feature",geometry:e})}(t)),[])}}(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function o_(e,t,n,i){if(isNaN(t)||isNaN(n))return e;var r,o,s,a,l,c,u,h,d,f=e._root,p={data:i},g=e._x0,m=e._y0,v=e._x1,b=e._y1;if(!f)return e._root=p,e;for(;f.length;)if((c=t>=(o=(g+v)/2))?g=o:v=o,(u=n>=(s=(m+b)/2))?m=s:b=s,r=f,!(f=f[h=u<<1|c]))return r[h]=p,e;if(a=+e._x.call(null,f.data),l=+e._y.call(null,f.data),t===a&&n===l)return p.next=f,r?r[h]=p:e._root=p,e;do{r=r?r[h]=new Array(4):e._root=new Array(4),(c=t>=(o=(g+v)/2))?g=o:v=o,(u=n>=(s=(m+b)/2))?m=s:b=s}while((h=u<<1|c)==(d=(l>=s)<<1|a>=o));return r[d]=f,r[h]=p,e}var s_=function(e,t,n,i,r){this.node=e,this.x0=t,this.y0=n,this.x1=i,this.y1=r};function a_(e){return e[0]}function l_(e){return e[1]}function c_(e,t,n){var i=new u_(null==t?a_:t,null==n?l_:n,NaN,NaN,NaN,NaN);return null==e?i:i.addAll(e)}function u_(e,t,n,i,r,o){this._x=e,this._y=t,this._x0=n,this._y0=i,this._x1=r,this._y1=o,this._root=void 0}function h_(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var d_=c_.prototype=u_.prototype;d_.copy=function(){var e,t,n=new u_(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(!i)return n;if(!i.length)return n._root=h_(i),n;for(e=[{source:i,target:n._root=new Array(4)}];i=e.pop();)for(var r=0;r<4;++r)(t=i.source[r])&&(t.length?e.push({source:t,target:i.target[r]=new Array(4)}):i.target[r]=h_(t));return n},d_.add=function(e){var t=+this._x.call(null,e),n=+this._y.call(null,e);return o_(this.cover(t,n),t,n,e)},d_.addAll=function(e){var t,n,i,r,o=e.length,s=new Array(o),a=new Array(o),l=1/0,c=1/0,u=-1/0,h=-1/0;for(n=0;n<o;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(r=+this._y.call(null,t))||(s[n]=i,a[n]=r,i<l&&(l=i),i>u&&(u=i),r<c&&(c=r),r>h&&(h=r));if(l>u||c>h)return this;for(this.cover(l,c).cover(u,h),n=0;n<o;++n)o_(this,s[n],a[n],e[n]);return this},d_.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,r=this._x1,o=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,o=(i=Math.floor(t))+1;else{for(var s,a,l=r-n,c=this._root;n>e||e>=r||i>t||t>=o;)switch(a=(t<i)<<1|e<n,(s=new Array(4))[a]=c,c=s,l*=2,a){case 0:r=n+l,o=i+l;break;case 1:n=r-l,o=i+l;break;case 2:r=n+l,i=o-l;break;case 3:n=r-l,i=o-l}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=i,this._x1=r,this._y1=o,this},d_.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},d_.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},d_.find=function(e,t,n){var i,r,o,s,a,l,c,u=this._x0,h=this._y0,d=this._x1,f=this._y1,p=[],g=this._root;for(g&&p.push(new s_(g,u,h,d,f)),null==n?n=1/0:(u=e-n,h=t-n,d=e+n,f=t+n,n*=n);l=p.pop();)if(!(!(g=l.node)||(r=l.x0)>d||(o=l.y0)>f||(s=l.x1)<u||(a=l.y1)<h))if(g.length){var m=(r+s)/2,v=(o+a)/2;p.push(new s_(g[3],m,v,s,a),new s_(g[2],r,v,m,a),new s_(g[1],m,o,s,v),new s_(g[0],r,o,m,v)),(c=(t>=v)<<1|e>=m)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-c],p[p.length-1-c]=l)}else{var b=e-+this._x.call(null,g.data),y=t-+this._y.call(null,g.data),w=b*b+y*y;if(w<n){var x=Math.sqrt(n=w);u=e-x,h=t-x,d=e+x,f=t+x,i=g.data}}return i},d_.remove=function(e){if(isNaN(o=+this._x.call(null,e))||isNaN(s=+this._y.call(null,e)))return this;var t,n,i,r,o,s,a,l,c,u,h,d,f=this._root,p=this._x0,g=this._y0,m=this._x1,v=this._y1;if(!f)return this;if(f.length)for(;;){if((c=o>=(a=(p+m)/2))?p=a:m=a,(u=s>=(l=(g+v)/2))?g=l:v=l,t=f,!(f=f[h=u<<1|c]))return this;if(!f.length)break;(t[h+1&3]||t[h+2&3]||t[h+3&3])&&(n=t,d=h)}for(;f.data!==e;)if(i=f,!(f=f.next))return this;return(r=f.next)&&delete f.next,i?(r?i.next=r:delete i.next,this):t?(r?t[h]=r:delete t[h],(f=t[0]||t[1]||t[2]||t[3])&&f===(t[3]||t[2]||t[1]||t[0])&&!f.length&&(n?n[d]=f:this._root=f),this):(this._root=r,this)},d_.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},d_.root=function(){return this._root},d_.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},d_.visit=function(e){var t,n,i,r,o,s,a=[],l=this._root;for(l&&a.push(new s_(l,this._x0,this._y0,this._x1,this._y1));t=a.pop();)if(!e(l=t.node,i=t.x0,r=t.y0,o=t.x1,s=t.y1)&&l.length){var c=(i+o)/2,u=(r+s)/2;(n=l[3])&&a.push(new s_(n,c,u,o,s)),(n=l[2])&&a.push(new s_(n,i,u,c,s)),(n=l[1])&&a.push(new s_(n,c,r,o,u)),(n=l[0])&&a.push(new s_(n,i,r,c,u))}return this},d_.visitAfter=function(e){var t,n=[],i=[];for(this._root&&n.push(new s_(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var r=t.node;if(r.length){var o,s=t.x0,a=t.y0,l=t.x1,c=t.y1,u=(s+l)/2,h=(a+c)/2;(o=r[0])&&n.push(new s_(o,s,a,u,h)),(o=r[1])&&n.push(new s_(o,u,a,l,h)),(o=r[2])&&n.push(new s_(o,s,h,u,c)),(o=r[3])&&n.push(new s_(o,u,h,l,c))}i.push(t)}for(;t=i.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this},d_.x=function(e){return arguments.length?(this._x=e,this):this._x},d_.y=function(e){return arguments.length?(this._y=e,this):this._y};var f_=function(e){return function(){return e}},p_=function(e){return 1e-6*(e()-.5)};function g_(e){return e.x+e.vx}function m_(e){return e.y+e.vy}var v_={value:function(){}};function b_(){for(var e,t=0,n=arguments.length,i={};t<n;++t){if(!(e=arguments[t]+"")||e in i||/[\s.]/.test(e))throw new Error("illegal type: "+e);i[e]=[]}return new y_(i)}function y_(e){this._=e}function w_(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",i=e.indexOf(".");if(i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function x_(e,t){for(var n,i=0,r=e.length;i<r;++i)if((n=e[i]).name===t)return n.value}function __(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=v_,e=e.slice(0,i).concat(e.slice(i+1));break}return null!=n&&e.push({name:t,value:n}),e}y_.prototype=b_.prototype={constructor:y_,on:function(e,t){var n,i=this._,r=w_(e+"",i),o=-1,s=r.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++o<s;)if(n=(e=r[o]).type)i[n]=__(i[n],e.name,t);else if(null==t)for(n in i)i[n]=__(i[n],e.name,null);return this}for(;++o<s;)if((n=(e=r[o]).type)&&(n=x_(i[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new y_(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),o=0;o<n;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,n=(i=this._[e]).length;o<n;++o)i[o].value.apply(t,r)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)}};var k_,S_,O_=b_,C_=0,A_=0,$_=0,E_=0,M_=0,j_=0,R_="object"==typeof performance&&performance.now?performance:Date,D_="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function T_(){return M_||(D_(L_),M_=R_.now()+j_)}function L_(){M_=0}function F_(){this._call=this._time=this._next=null}function N_(e,t,n){var i=new F_;return i.restart(e,t,n),i}function P_(){M_=(E_=R_.now())+j_,C_=A_=0;try{!function(){T_(),++C_;for(var e,t=k_;t;)(e=M_-t._time)>=0&&t._call.call(null,e),t=t._next;--C_}()}finally{C_=0,function(){var e,t,n=k_,i=1/0;for(;n;)n._call?(i>n._time&&(i=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:k_=t);S_=e,I_(i)}(),M_=0}}function z_(){var e=R_.now(),t=e-E_;t>1e3&&(j_-=t,E_=e)}function I_(e){C_||(A_&&(A_=clearTimeout(A_)),e-M_>24?(e<1/0&&(A_=setTimeout(P_,e-R_.now()-j_)),$_&&($_=clearInterval($_))):($_||(E_=R_.now(),$_=setInterval(z_,1e3)),C_=1,D_(P_)))}F_.prototype=N_.prototype={constructor:F_,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?T_():+n)+(null==t?0:+t),this._next||S_===this||(S_?S_._next=this:k_=this,S_=this),this._call=e,this._time=n,I_()},stop:function(){this._call&&(this._call=null,this._time=1/0,I_())}};function B_(e){return e.x}function W_(e){return e.y}var U_=Math.PI*(3-Math.sqrt(5));function H_(e){return e.index}function q_(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}const V_={center:function(e,t){var n,i=1;function r(){var r,o,s=n.length,a=0,l=0;for(r=0;r<s;++r)a+=(o=n[r]).x,l+=o.y;for(a=(a/s-e)*i,l=(l/s-t)*i,r=0;r<s;++r)(o=n[r]).x-=a,o.y-=l}return null==e&&(e=0),null==t&&(t=0),r.initialize=function(e){n=e},r.x=function(t){return arguments.length?(e=+t,r):e},r.y=function(e){return arguments.length?(t=+e,r):t},r.strength=function(e){return arguments.length?(i=+e,r):i},r},collide:function(e){var t,n,i,r=1,o=1;function s(){for(var e,s,l,c,u,h,d,f=t.length,p=0;p<o;++p)for(s=c_(t,g_,m_).visitAfter(a),e=0;e<f;++e)l=t[e],h=n[l.index],d=h*h,c=l.x+l.vx,u=l.y+l.vy,s.visit(g);function g(e,t,n,o,s){var a=e.data,f=e.r,p=h+f;if(!a)return t>c+p||o<c-p||n>u+p||s<u-p;if(a.index>l.index){var g=c-a.x-a.vx,m=u-a.y-a.vy,v=g*g+m*m;v<p*p&&(0===g&&(v+=(g=p_(i))*g),0===m&&(v+=(m=p_(i))*m),v=(p-(v=Math.sqrt(v)))/v*r,l.vx+=(g*=v)*(p=(f*=f)/(d+f)),l.vy+=(m*=v)*p,a.vx-=g*(p=1-p),a.vy-=m*p)}}}function a(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function l(){if(t){var i,r,o=t.length;for(n=new Array(o),i=0;i<o;++i)r=t[i],n[r.index]=+e(r,i,t)}}return"function"!=typeof e&&(e=f_(null==e?1:+e)),s.initialize=function(e,n){t=e,i=n,l()},s.iterations=function(e){return arguments.length?(o=+e,s):o},s.strength=function(e){return arguments.length?(r=+e,s):r},s.radius=function(t){return arguments.length?(e="function"==typeof t?t:f_(+t),l(),s):e},s},nbody:function(){var e,t,n,i,r,o=f_(-30),s=1,a=1/0,l=.81;function c(n){var r,o=e.length,s=c_(e,B_,W_).visitAfter(h);for(i=n,r=0;r<o;++r)t=e[r],s.visit(d)}function u(){if(e){var t,n,i=e.length;for(r=new Array(i),t=0;t<i;++t)n=e[t],r[n.index]=+o(n,t,e)}}function h(e){var t,n,i,o,s,a=0,l=0;if(e.length){for(i=o=s=0;s<4;++s)(t=e[s])&&(n=Math.abs(t.value))&&(a+=t.value,l+=n,i+=n*t.x,o+=n*t.y);e.x=i/l,e.y=o/l}else{(t=e).x=t.data.x,t.y=t.data.y;do{a+=r[t.data.index]}while(t=t.next)}e.value=a}function d(e,o,c,u){if(!e.value)return!0;var h=e.x-t.x,d=e.y-t.y,f=u-o,p=h*h+d*d;if(f*f/l<p)return p<a&&(0===h&&(p+=(h=p_(n))*h),0===d&&(p+=(d=p_(n))*d),p<s&&(p=Math.sqrt(s*p)),t.vx+=h*e.value*i/p,t.vy+=d*e.value*i/p),!0;if(!(e.length||p>=a)){(e.data!==t||e.next)&&(0===h&&(p+=(h=p_(n))*h),0===d&&(p+=(d=p_(n))*d),p<s&&(p=Math.sqrt(s*p)));do{e.data!==t&&(f=r[e.data.index]*i/p,t.vx+=h*f,t.vy+=d*f)}while(e=e.next)}}return c.initialize=function(t,i){e=t,n=i,u()},c.strength=function(e){return arguments.length?(o="function"==typeof e?e:f_(+e),u(),c):o},c.distanceMin=function(e){return arguments.length?(s=e*e,c):Math.sqrt(s)},c.distanceMax=function(e){return arguments.length?(a=e*e,c):Math.sqrt(a)},c.theta=function(e){return arguments.length?(l=e*e,c):Math.sqrt(l)},c},link:function(e){var t,n,i,r,o,s,a=H_,l=function(e){return 1/Math.min(r[e.source.index],r[e.target.index])},c=f_(30),u=1;function h(i){for(var r=0,a=e.length;r<u;++r)for(var l,c,h,d,f,p,g,m=0;m<a;++m)c=(l=e[m]).source,d=(h=l.target).x+h.vx-c.x-c.vx||p_(s),f=h.y+h.vy-c.y-c.vy||p_(s),d*=p=((p=Math.sqrt(d*d+f*f))-n[m])/p*i*t[m],f*=p,h.vx-=d*(g=o[m]),h.vy-=f*g,c.vx+=d*(g=1-g),c.vy+=f*g}function d(){if(i){var s,l,c=i.length,u=e.length,h=new Map(i.map((e,t)=>[a(e,t,i),e]));for(s=0,r=new Array(c);s<u;++s)(l=e[s]).index=s,"object"!=typeof l.source&&(l.source=q_(h,l.source)),"object"!=typeof l.target&&(l.target=q_(h,l.target)),r[l.source.index]=(r[l.source.index]||0)+1,r[l.target.index]=(r[l.target.index]||0)+1;for(s=0,o=new Array(u);s<u;++s)l=e[s],o[s]=r[l.source.index]/(r[l.source.index]+r[l.target.index]);t=new Array(u),f(),n=new Array(u),p()}}function f(){if(i)for(var n=0,r=e.length;n<r;++n)t[n]=+l(e[n],n,e)}function p(){if(i)for(var t=0,r=e.length;t<r;++t)n[t]=+c(e[t],t,e)}return null==e&&(e=[]),h.initialize=function(e,t){i=e,s=t,d()},h.links=function(t){return arguments.length?(e=t,d(),h):e},h.id=function(e){return arguments.length?(a=e,h):a},h.iterations=function(e){return arguments.length?(u=+e,h):u},h.strength=function(e){return arguments.length?(l="function"==typeof e?e:f_(+e),f(),h):l},h.distance=function(e){return arguments.length?(c="function"==typeof e?e:f_(+e),p(),h):c},h},x:function(e){var t,n,i,r=f_(.1);function o(e){for(var r,o=0,s=t.length;o<s;++o)(r=t[o]).vx+=(i[o]-r.x)*n[o]*e}function s(){if(t){var o,s=t.length;for(n=new Array(s),i=new Array(s),o=0;o<s;++o)n[o]=isNaN(i[o]=+e(t[o],o,t))?0:+r(t[o],o,t)}}return"function"!=typeof e&&(e=f_(null==e?0:+e)),o.initialize=function(e){t=e,s()},o.strength=function(e){return arguments.length?(r="function"==typeof e?e:f_(+e),s(),o):r},o.x=function(t){return arguments.length?(e="function"==typeof t?t:f_(+t),s(),o):e},o},y:function(e){var t,n,i,r=f_(.1);function o(e){for(var r,o=0,s=t.length;o<s;++o)(r=t[o]).vy+=(i[o]-r.y)*n[o]*e}function s(){if(t){var o,s=t.length;for(n=new Array(s),i=new Array(s),o=0;o<s;++o)n[o]=isNaN(i[o]=+e(t[o],o,t))?0:+r(t[o],o,t)}}return"function"!=typeof e&&(e=f_(null==e?0:+e)),o.initialize=function(e){t=e,s()},o.strength=function(e){return arguments.length?(r="function"==typeof e?e:f_(+e),s(),o):r},o.y=function(t){return arguments.length?(e="function"==typeof t?t:f_(+t),s(),o):e},o}},G_=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],K_=["static","iterations"],Y_=["x","y","vx","vy"];function X_(e){Nr.call(this,null,e)}function J_(e,t,n,i){var r,o,s,a,l=Object(p.i)(t.forces);for(r=0,o=G_.length;r<o;++r)"forces"!==(s=G_[r])&&t.modified(s)&&e[s](t[s]);for(r=0,o=l.length;r<o;++r)a="forces"+r,(s=n||t.modified("forces",r)?Z_(l[r]):i&&Q_(l[r],i)?e.force(a):null)&&e.force(a,s);for(o=e.numForces||0;r<o;++r)e.force("forces"+r,null);return e.numForces=l.length,e}function Q_(e,t){var n,i;for(n in e)if(Object(p.E)(i=e[n])&&t.modified(Object(p.g)(i)))return 1;return 0}function Z_(e){var t,n;for(n in Object(p.w)(V_,e.force)||Object(p.o)("Unrecognized force: "+e.force),t=V_[e.force](),e)Object(p.E)(t[n])&&ek(t[n],e[n],e);return t}function ek(e,t,n){e(Object(p.E)(t)?e=>t(e,n):t)}X_.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:Y_}]},Object(p.z)(X_,Nr,{transform(e,t){var n,i,r=this.value,o=t.changed(t.ADD_REM),s=e.modified(G_),a=e.iterations||300;if(r?(o&&(t.modifies("index"),r.nodes(t.source)),(s||t.changed(t.MOD))&&J_(r,e,0,t)):(this.value=r=function(e,t){const n=function(e){var t,n=1,i=.001,r=1-Math.pow(i,1/300),o=0,s=.6,a=new Map,l=N_(h),c=O_("tick","end"),u=function(){let e=1;return()=>(e=(1664525*e+1013904223)%4294967296)/4294967296}();function h(){d(),c.call("tick",t),n<i&&(l.stop(),c.call("end",t))}function d(i){var l,c,u=e.length;void 0===i&&(i=1);for(var h=0;h<i;++h)for(n+=(o-n)*r,a.forEach((function(e){e(n)})),l=0;l<u;++l)null==(c=e[l]).fx?c.x+=c.vx*=s:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=s:(c.y=c.fy,c.vy=0);return t}function f(){for(var t,n=0,i=e.length;n<i;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var r=10*Math.sqrt(.5+n),o=n*U_;t.x=r*Math.cos(o),t.y=r*Math.sin(o)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function p(t){return t.initialize&&t.initialize(e,u),t}return null==e&&(e=[]),f(),t={tick:d,restart:function(){return l.restart(h),t},stop:function(){return l.stop(),t},nodes:function(n){return arguments.length?(e=n,f(),a.forEach(p),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(i=+e,t):i},alphaDecay:function(e){return arguments.length?(r=+e,t):+r},alphaTarget:function(e){return arguments.length?(o=+e,t):o},velocityDecay:function(e){return arguments.length?(s=1-e,t):1-s},randomSource:function(e){return arguments.length?(u=e,a.forEach(p),t):u},force:function(e,n){return arguments.length>1?(null==n?a.delete(e):a.set(e,p(n)),t):a.get(e)},find:function(t,n,i){var r,o,s,a,l,c=0,u=e.length;for(null==i?i=1/0:i*=i,c=0;c<u;++c)(s=(r=t-(a=e[c]).x)*r+(o=n-a.y)*o)<i&&(l=a,i=s);return l},on:function(e,n){return arguments.length>1?(c.on(e,n),t):c.on(e)}}}(e),i=n.stop,r=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,r()),n.stop=()=>(o=!0,i()),J_(n,t,!0).on("end",()=>o=!0)}(t.source,e),r.on("tick",(n=t.dataflow,i=this,()=>n.touch(i).run())),e.static||(o=!0,r.tick()),t.modifies("index")),s||o||e.modified(K_)||t.changed()&&e.restart)if(r.alpha(Math.max(r.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(r.alphaMin(),1/a)),e.static)for(r.stop();--a>=0;)r.tick();else if(r.stopped()&&r.restart(),!o)return t.StopPropagation;return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let e,t=this._argops,a=0,l=t.length;a<l;++a)if(e=t[a],"forces"===e.name&&"link"===e.op._argval.force)for(var i,r=e.op._argops,o=0,s=r.length;o<s;++o)if("links"===r[o].name&&(i=r[o].op.source)){n.pulse(i,n.changeset().reflow());break}return t.reflow(e.modified()).modifies(Y_)}});var tk=function(e,t,n){var i={};return e.each((function(e){var r=e.data;n(r)&&(i[t(r)]=e)})),e.lookup=i,e};function nk(e){var t=0,n=e.children,i=n&&n.length;if(i)for(;--i>=0;)t+=n[i].value;else t=1;e.value=t}function ik(e,t){var n,i,r,o,s,a=new ak(e),l=+e.value&&(a.value=e.value),c=[a];for(null==t&&(t=rk);n=c.pop();)if(l&&(n.value=+n.data.value),(r=t(n.data))&&(s=r.length))for(n.children=new Array(s),o=s-1;o>=0;--o)c.push(i=n.children[o]=new ak(r[o])),i.parent=n,i.depth=n.depth+1;return a.eachBefore(sk)}function rk(e){return e.children}function ok(e){e.data=e.data.data}function sk(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function ak(e){this.data=e,this.depth=this.height=0,this.parent=null}function lk(e){Nr.call(this,null,e)}ak.prototype=ik.prototype={constructor:ak,count:function(){return this.eachAfter(nk)},each:function(e){var t,n,i,r,o=this,s=[o];do{for(t=s.reverse(),s=[];o=t.pop();)if(e(o),n=o.children)for(i=0,r=n.length;i<r;++i)s.push(n[i])}while(s.length);return this},eachAfter:function(e){for(var t,n,i,r=this,o=[r],s=[];r=o.pop();)if(s.push(r),t=r.children)for(n=0,i=t.length;n<i;++n)o.push(t[n]);for(;r=s.pop();)e(r);return this},eachBefore:function(e){for(var t,n,i=this,r=[i];i=r.pop();)if(e(i),t=i.children)for(n=t.length-1;n>=0;--n)r.push(t[n]);return this},sum:function(e){return this.eachAfter((function(t){for(var n=+e(t.data)||0,i=t.children,r=i&&i.length;--r>=0;)n+=i[r].value;t.value=n}))},sort:function(e){return this.eachBefore((function(t){t.children&&t.children.sort(e)}))},path:function(e){for(var t=this,n=function(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),r=null;e=n.pop(),t=i.pop();for(;e===t;)r=e,e=n.pop(),t=i.pop();return r}(t,e),i=[t];t!==n;)t=t.parent,i.push(t);for(var r=i.length;e!==n;)i.splice(r,0,e),e=e.parent;return i},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){var e=[];return this.each((function(t){e.push(t)})),e},leaves:function(){var e=[];return this.eachBefore((function(t){t.children||e.push(t)})),e},links:function(){var e=this,t=[];return e.each((function(n){n!==e&&t.push({source:n.parent,target:n})})),t},copy:function(){return ik(this).eachBefore(ok)}},lk.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const ck=e=>e.values;function uk(){const e=[],t={entries:t=>function t(n,i){if(++i>e.length)return n;const r=[];for(const e in n)r.push({key:e,values:t(n[e],i)});return r}(function t(n,i){if(i>=e.length)return n;const r=n.length,o=e[i++],s={},a={};let l,c,u,h=-1;for(;++h<r;)l=o(c=n[h])+"",(u=s[l])?u.push(c):s[l]=[c];for(l in s)a[l]=t(s[l],i);return a}(t,0),0),key:n=>(e.push(n),t)};return t}function hk(e){Nr.call(this,null,e)}Object(p.z)(lk,Nr,{transform(e,t){t.source||Object(p.o)("Nest transform requires an upstream data source.");var n=e.generate,i=e.modified(),r=t.clone(),o=this.value;return(!o||i||t.changed())&&(o&&o.each(e=>{e.children&&y(e.data)&&r.rem.push(e.data)}),this.value=o=ik({values:Object(p.i)(e.keys).reduce((e,t)=>(e.key(t),e),uk()).entries(r.source)},ck),n&&o.each(e=>{e.children&&(e=_(e.data),r.add.push(e),r.source.push(e))}),tk(o,w,w)),r.source.root=o,r}});const dk=(e,t)=>e.parent===t.parent?1:2;Object(p.z)(hk,Nr,{transform(e,t){t.source&&t.source.root||Object(p.o)(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),i=this.fields,r=t.source.root,o=e.as||i;e.field?r.sum(e.field):r.count(),e.sort&&r.sort(C(e.sort,e=>e.data)),function(e,t,n){for(let i,r=0,o=t.length;r<o;++r)i=t[r],i in n&&e[i](n[i])}(n,this.params,e),n.separation&&n.separation(!1!==e.separation?dk:p.P);try{this.value=n(r)}catch(e){Object(p.o)(e)}return r.each(e=>function(e,t,n){const i=e.data,r=t.length-1;for(let o=0;o<r;++o)i[n[o]]=e[t[o]];i[n[r]]=e.children?e.children.length:0}(e,i,o)),t.reflow(e.modified()).modifies(o).modifies("leaf")}});var fk=Array.prototype.slice;var pk=function(e){for(var t,n,i=0,r=(e=function(e){for(var t,n,i=e.length;i;)n=Math.random()*i--|0,t=e[i],e[i]=e[n],e[n]=t;return e}(fk.call(e))).length,o=[];i<r;)t=e[i],n&&vk(n,t)?++i:(n=yk(o=gk(o,t)),i=0);return n};function gk(e,t){var n,i;if(bk(t,e))return[t];for(n=0;n<e.length;++n)if(mk(t,e[n])&&bk(wk(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(i=n+1;i<e.length;++i)if(mk(wk(e[n],e[i]),t)&&mk(wk(e[n],t),e[i])&&mk(wk(e[i],t),e[n])&&bk(xk(e[n],e[i],t),e))return[e[n],e[i],t];throw new Error}function mk(e,t){var n=e.r-t.r,i=t.x-e.x,r=t.y-e.y;return n<0||n*n<i*i+r*r}function vk(e,t){var n=e.r-t.r+1e-6,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function bk(e,t){for(var n=0;n<t.length;++n)if(!vk(e,t[n]))return!1;return!0}function yk(e){switch(e.length){case 1:return{x:(t=e[0]).x,y:t.y,r:t.r};case 2:return wk(e[0],e[1]);case 3:return xk(e[0],e[1],e[2])}var t}function wk(e,t){var n=e.x,i=e.y,r=e.r,o=t.x,s=t.y,a=t.r,l=o-n,c=s-i,u=a-r,h=Math.sqrt(l*l+c*c);return{x:(n+o+l/h*u)/2,y:(i+s+c/h*u)/2,r:(h+r+a)/2}}function xk(e,t,n){var i=e.x,r=e.y,o=e.r,s=t.x,a=t.y,l=t.r,c=n.x,u=n.y,h=n.r,d=i-s,f=i-c,p=r-a,g=r-u,m=l-o,v=h-o,b=i*i+r*r-o*o,y=b-s*s-a*a+l*l,w=b-c*c-u*u+h*h,x=f*p-d*g,_=(p*w-g*y)/(2*x)-i,k=(g*m-p*v)/x,S=(f*y-d*w)/(2*x)-r,O=(d*v-f*m)/x,C=k*k+O*O-1,A=2*(o+_*k+S*O),$=_*_+S*S-o*o,E=-(C?(A+Math.sqrt(A*A-4*C*$))/(2*C):$/A);return{x:i+_+k*E,y:r+S+O*E,r:E}}function _k(e,t,n){var i,r,o,s,a=e.x-t.x,l=e.y-t.y,c=a*a+l*l;c?(r=t.r+n.r,r*=r,s=e.r+n.r,r>(s*=s)?(i=(c+s-r)/(2*c),o=Math.sqrt(Math.max(0,s/c-i*i)),n.x=e.x-i*a-o*l,n.y=e.y-i*l+o*a):(i=(c+r-s)/(2*c),o=Math.sqrt(Math.max(0,r/c-i*i)),n.x=t.x+i*a-o*l,n.y=t.y+i*l+o*a)):(n.x=t.x+n.r,n.y=t.y)}function kk(e,t){var n=e.r+t.r-1e-6,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function Sk(e){var t=e._,n=e.next._,i=t.r+n.r,r=(t.x*n.r+n.x*t.r)/i,o=(t.y*n.r+n.y*t.r)/i;return r*r+o*o}function Ok(e){this._=e,this.next=null,this.previous=null}function Ck(e){if(!(r=e.length))return 0;var t,n,i,r,o,s,a,l,c,u,h;if((t=e[0]).x=0,t.y=0,!(r>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(r>2))return t.r+n.r;_k(n,t,i=e[2]),t=new Ok(t),n=new Ok(n),i=new Ok(i),t.next=i.previous=n,n.next=t.previous=i,i.next=n.previous=t;e:for(a=3;a<r;++a){_k(t._,n._,i=e[a]),i=new Ok(i),l=n.next,c=t.previous,u=n._.r,h=t._.r;do{if(u<=h){if(kk(l._,i._)){n=l,t.next=n,n.previous=t,--a;continue e}u+=l._.r,l=l.next}else{if(kk(c._,i._)){(t=c).next=n,n.previous=t,--a;continue e}h+=c._.r,c=c.previous}}while(l!==c.next);for(i.previous=t,i.next=n,t.next=n.previous=n=i,o=Sk(t);(i=i.next)!==n;)(s=Sk(i))<o&&(t=i,o=s);n=t.next}for(t=[n._],i=n;(i=i.next)!==n;)t.push(i._);for(i=pk(t),a=0;a<r;++a)(t=e[a]).x-=i.x,t.y-=i.y;return i.r}function Ak(e){return null==e?null:$k(e)}function $k(e){if("function"!=typeof e)throw new Error;return e}function Ek(){return 0}var Mk=function(e){return function(){return e}};function jk(e){return Math.sqrt(e.value)}function Rk(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function Dk(e,t){return function(n){if(i=n.children){var i,r,o,s=i.length,a=e(n)*t||0;if(a)for(r=0;r<s;++r)i[r].r+=a;if(o=Ck(i),a)for(r=0;r<s;++r)i[r].r-=a;n.r=o+a}}}function Tk(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}const Lk=["x","y","r","depth","children"];function Fk(e){hk.call(this,e)}Fk.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Lk.length,default:Lk}]},Object(p.z)(Fk,hk,{layout:function(){var e=null,t=1,n=1,i=Ek;function r(r){return r.x=t/2,r.y=n/2,e?r.eachBefore(Rk(e)).eachAfter(Dk(i,.5)).eachBefore(Tk(1)):r.eachBefore(Rk(jk)).eachAfter(Dk(Ek,1)).eachAfter(Dk(i,r.r/Math.min(t,n))).eachBefore(Tk(Math.min(t,n)/(2*r.r))),r}return r.radius=function(t){return arguments.length?(e=Ak(t),r):e},r.size=function(e){return arguments.length?(t=+e[0],n=+e[1],r):[t,n]},r.padding=function(e){return arguments.length?(i="function"==typeof e?e:Mk(+e),r):i},r},params:["radius","size","padding"],fields:Lk});var Nk=function(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)},Pk=function(e,t,n,i,r){for(var o,s=e.children,a=-1,l=s.length,c=e.value&&(i-t)/e.value;++a<l;)(o=s[a]).y0=n,o.y1=r,o.x0=t,o.x1=t+=o.value*c};const zk=["x0","y0","x1","y1","depth","children"];function Ik(e){hk.call(this,e)}Ik.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:zk.length,default:zk}]},Object(p.z)(Ik,hk,{layout:function(){var e=1,t=1,n=0,i=!1;function r(r){var o=r.height+1;return r.x0=r.y0=n,r.x1=e,r.y1=t/o,r.eachBefore(function(e,t){return function(i){i.children&&Pk(i,i.x0,e*(i.depth+1)/t,i.x1,e*(i.depth+2)/t);var r=i.x0,o=i.y0,s=i.x1-n,a=i.y1-n;s<r&&(r=s=(r+s)/2),a<o&&(o=a=(o+a)/2),i.x0=r,i.y0=o,i.x1=s,i.y1=a}}(t,o)),i&&r.eachBefore(Nk),r}return r.round=function(e){return arguments.length?(i=!!e,r):i},r.size=function(n){return arguments.length?(e=+n[0],t=+n[1],r):[e,t]},r.padding=function(e){return arguments.length?(n=+e,r):n},r},params:["size","round","padding"],fields:zk});var Bk={depth:-1},Wk={};function Uk(e){return e.id}function Hk(e){return e.parentId}var qk=function(){var e=Uk,t=Hk;function n(n){var i,r,o,s,a,l,c,u=n.length,h=new Array(u),d={};for(r=0;r<u;++r)i=n[r],a=h[r]=new ak(i),null!=(l=e(i,r,n))&&(l+="")&&(d[c="$"+(a.id=l)]=c in d?Wk:a);for(r=0;r<u;++r)if(a=h[r],null!=(l=t(n[r],r,n))&&(l+="")){if(!(s=d["$"+l]))throw new Error("missing: "+l);if(s===Wk)throw new Error("ambiguous: "+l);s.children?s.children.push(a):s.children=[a],a.parent=s}else{if(o)throw new Error("multiple roots");o=a}if(!o)throw new Error("no root");if(o.parent=Bk,o.eachBefore((function(e){e.depth=e.parent.depth+1,--u})).eachBefore(sk),o.parent=null,u>0)throw new Error("cycle");return o}return n.id=function(t){return arguments.length?(e=$k(t),n):e},n.parentId=function(e){return arguments.length?(t=$k(e),n):t},n};function Vk(e){Nr.call(this,null,e)}function Gk(e,t){return e.parent===t.parent?1:2}function Kk(e){var t=e.children;return t?t[0]:e.t}function Yk(e){var t=e.children;return t?t[t.length-1]:e.t}function Xk(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function Jk(e,t,n){return e.a.parent===t.parent?e.a:n}function Qk(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}Vk.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},Object(p.z)(Vk,Nr,{transform(e,t){t.source||Object(p.o)("Stratify transform requires an upstream data source.");let n=this.value;const i=e.modified(),r=t.fork(t.ALL).materialize(t.SOURCE),o=!n||i||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return r.source=r.source.slice(),o&&(n=r.source.length?tk(qk().id(e.key).parentId(e.parentKey)(r.source),e.key,p.hb):tk(qk()([{}]),e.key,e.key)),r.source.root=this.value=n,r}}),Qk.prototype=Object.create(ak.prototype);function Zk(e,t){return e.parent===t.parent?1:2}function eS(e,t){return e+t.x}function tS(e,t){return Math.max(e,t.y)}var nS={tidy:function(){var e=Gk,t=1,n=1,i=null;function r(r){var l=function(e){for(var t,n,i,r,o,s=new Qk(e,0),a=[s];t=a.pop();)if(i=t._.children)for(t.children=new Array(o=i.length),r=o-1;r>=0;--r)a.push(n=t.children[r]=new Qk(i[r],r)),n.parent=t;return(s.parent=new Qk(null,0)).children=[s],s}(r);if(l.eachAfter(o),l.parent.m=-l.z,l.eachBefore(s),i)r.eachBefore(a);else{var c=r,u=r,h=r;r.eachBefore((function(e){e.x<c.x&&(c=e),e.x>u.x&&(u=e),e.depth>h.depth&&(h=e)}));var d=c===u?1:e(c,u)/2,f=d-c.x,p=t/(u.x+d+f),g=n/(h.depth||1);r.eachBefore((function(e){e.x=(e.x+f)*p,e.y=e.depth*g}))}return r}function o(t){var n=t.children,i=t.parent.children,r=t.i?i[t.i-1]:null;if(n){!function(e){for(var t,n=0,i=0,r=e.children,o=r.length;--o>=0;)(t=r[o]).z+=n,t.m+=n,n+=t.s+(i+=t.c)}(t);var o=(n[0].z+n[n.length-1].z)/2;r?(t.z=r.z+e(t._,r._),t.m=t.z-o):t.z=o}else r&&(t.z=r.z+e(t._,r._));t.parent.A=function(t,n,i){if(n){for(var r,o=t,s=t,a=n,l=o.parent.children[0],c=o.m,u=s.m,h=a.m,d=l.m;a=Yk(a),o=Kk(o),a&&o;)l=Kk(l),(s=Yk(s)).a=t,(r=a.z+h-o.z-c+e(a._,o._))>0&&(Xk(Jk(a,t,i),t,r),c+=r,u+=r),h+=a.m,c+=o.m,d+=l.m,u+=s.m;a&&!Yk(s)&&(s.t=a,s.m+=h-u),o&&!Kk(l)&&(l.t=o,l.m+=c-d,i=t)}return i}(t,r,t.parent.A||i[0])}function s(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function a(e){e.x*=t,e.y=e.depth*n}return r.separation=function(t){return arguments.length?(e=t,r):e},r.size=function(e){return arguments.length?(i=!1,t=+e[0],n=+e[1],r):i?null:[t,n]},r.nodeSize=function(e){return arguments.length?(i=!0,t=+e[0],n=+e[1],r):i?[t,n]:null},r},cluster:function(){var e=Zk,t=1,n=1,i=!1;function r(r){var o,s=0;r.eachAfter((function(t){var n=t.children;n?(t.x=function(e){return e.reduce(eS,0)/e.length}(n),t.y=function(e){return 1+e.reduce(tS,0)}(n)):(t.x=o?s+=e(t,o):0,t.y=0,o=t)}));var a=function(e){for(var t;t=e.children;)e=t[0];return e}(r),l=function(e){for(var t;t=e.children;)e=t[t.length-1];return e}(r),c=a.x-e(a,l)/2,u=l.x+e(l,a)/2;return r.eachAfter(i?function(e){e.x=(e.x-r.x)*t,e.y=(r.y-e.y)*n}:function(e){e.x=(e.x-c)/(u-c)*t,e.y=(1-(r.y?e.y/r.y:1))*n})}return r.separation=function(t){return arguments.length?(e=t,r):e},r.size=function(e){return arguments.length?(i=!1,t=+e[0],n=+e[1],r):i?null:[t,n]},r.nodeSize=function(e){return arguments.length?(i=!0,t=+e[0],n=+e[1],r):i?[t,n]:null},r}};const iS=["x","y","depth","children"];function rS(e){hk.call(this,e)}function oS(e){Nr.call(this,[],e)}rS.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:iS.length,default:iS}]},Object(p.z)(rS,hk,{layout(e){var t=e||"tidy";if(Object(p.w)(nS,t))return nS[t]();Object(p.o)("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:iS}),oS.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},Object(p.z)(oS,Nr,{transform(e,t){const n=this.value,i=t.source&&t.source.root,r=t.fork(t.NO_SOURCE),o={};return i||Object(p.o)("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(r.rem=n,t.visit(t.SOURCE,e=>o[w(e)]=1),i.each(e=>{const t=e.data,n=e.parent&&e.parent.data;n&&o[w(t)]&&o[w(n)]&&r.add.push(_({source:n,target:t}))}),this.value=r.add):t.changed(t.MOD)&&(t.visit(t.MOD,e=>o[w(e)]=1),n.forEach(e=>{(o[w(e.source)]||o[w(e.target)])&&r.mod.push(e)})),r}});var sS=function(e,t,n,i,r){for(var o,s=e.children,a=-1,l=s.length,c=e.value&&(r-n)/e.value;++a<l;)(o=s[a]).x0=t,o.x1=i,o.y0=n,o.y1=n+=o.value*c},aS=(1+Math.sqrt(5))/2;function lS(e,t,n,i,r,o){for(var s,a,l,c,u,h,d,f,p,g,m,v=[],b=t.children,y=0,w=0,x=b.length,_=t.value;y<x;){l=r-n,c=o-i;do{u=b[w++].value}while(!u&&w<x);for(h=d=u,m=u*u*(g=Math.max(c/l,l/c)/(_*e)),p=Math.max(d/m,m/h);w<x;++w){if(u+=a=b[w].value,a<h&&(h=a),a>d&&(d=a),m=u*u*g,(f=Math.max(d/m,m/h))>p){u-=a;break}p=f}v.push(s={value:u,dice:l<c,children:b.slice(y,w)}),s.dice?Pk(s,n,i,r,_?i+=c*u/_:o):sS(s,n,i,_?n+=l*u/_:r,o),_-=u,y=w}return v}var cS=function e(t){function n(e,n,i,r,o){lS(t,e,n,i,r,o)}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(aS),uS=function e(t){function n(e,n,i,r,o){if((s=e._squarify)&&s.ratio===t)for(var s,a,l,c,u,h=-1,d=s.length,f=e.value;++h<d;){for(l=(a=s[h]).children,c=a.value=0,u=l.length;c<u;++c)a.value+=l[c].value;a.dice?Pk(a,n,i,r,i+=(o-i)*a.value/f):sS(a,n,i,n+=(r-n)*a.value/f,o),f-=a.value}else e._squarify=s=lS(t,e,n,i,r,o),s.ratio=t}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(aS);const hS={binary:function(e,t,n,i,r){var o,s,a=e.children,l=a.length,c=new Array(l+1);for(c[0]=s=o=0;o<l;++o)c[o+1]=s+=a[o].value;!function e(t,n,i,r,o,s,l){if(t>=n-1){var u=a[t];return u.x0=r,u.y0=o,u.x1=s,void(u.y1=l)}var h=c[t],d=i/2+h,f=t+1,p=n-1;for(;f<p;){var g=f+p>>>1;c[g]<d?f=g+1:p=g}d-c[f-1]<c[f]-d&&t+1<f&&--f;var m=c[f]-h,v=i-m;if(s-r>l-o){var b=(r*v+s*m)/i;e(t,f,m,r,o,b,l),e(f,n,v,b,o,s,l)}else{var y=(o*v+l*m)/i;e(t,f,m,r,o,s,y),e(f,n,v,r,y,s,l)}}(0,l,e.value,t,n,i,r)},dice:Pk,slice:sS,slicedice:function(e,t,n,i,r){(1&e.depth?sS:Pk)(e,t,n,i,r)},squarify:cS,resquarify:uS},dS=["x0","y0","x1","y1","depth","children"];function fS(e){hk.call(this,e)}fS.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:dS.length,default:dS}]},Object(p.z)(fS,hk,{layout(){const e=function(){var e=cS,t=!1,n=1,i=1,r=[0],o=Ek,s=Ek,a=Ek,l=Ek,c=Ek;function u(e){return e.x0=e.y0=0,e.x1=n,e.y1=i,e.eachBefore(h),r=[0],t&&e.eachBefore(Nk),e}function h(t){var n=r[t.depth],i=t.x0+n,u=t.y0+n,h=t.x1-n,d=t.y1-n;h<i&&(i=h=(i+h)/2),d<u&&(u=d=(u+d)/2),t.x0=i,t.y0=u,t.x1=h,t.y1=d,t.children&&(n=r[t.depth+1]=o(t)/2,i+=c(t)-n,u+=s(t)-n,(h-=a(t)-n)<i&&(i=h=(i+h)/2),(d-=l(t)-n)<u&&(u=d=(u+d)/2),e(t,i,u,h,d))}return u.round=function(e){return arguments.length?(t=!!e,u):t},u.size=function(e){return arguments.length?(n=+e[0],i=+e[1],u):[n,i]},u.tile=function(t){return arguments.length?(e=$k(t),u):e},u.padding=function(e){return arguments.length?u.paddingInner(e).paddingOuter(e):u.paddingInner()},u.paddingInner=function(e){return arguments.length?(o="function"==typeof e?e:Mk(+e),u):o},u.paddingOuter=function(e){return arguments.length?u.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):u.paddingTop()},u.paddingTop=function(e){return arguments.length?(s="function"==typeof e?e:Mk(+e),u):s},u.paddingRight=function(e){return arguments.length?(a="function"==typeof e?e:Mk(+e),u):a},u.paddingBottom=function(e){return arguments.length?(l="function"==typeof e?e:Mk(+e),u):l},u.paddingLeft=function(e){return arguments.length?(c="function"==typeof e?e:Mk(+e),u):c},u}();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{Object(p.w)(hS,t)?e.tile(hS[t]):Object(p.o)("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:dS});var pS=function(e,t){var n,i,r,o,s,a,l=[],c=function(e){return e(o)};if(null==t)l.push(e);else for(n={},i=0,r=e.length;i<r;++i)o=e[i],(a=n[s=t.map(c)])||(n[s]=a=[],a.dims=s,l.push(a)),a.push(o);return l};function gS(e){Nr.call(this,null,e)}gS.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},Object(p.z)(gS,Nr,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=pS(i,e.groupby),o=(e.groupby||[]).map(p.h),s=o.length,a=e.as||[Object(p.h)(e.x),Object(p.h)(e.y)],l=[];r.forEach(t=>{Yo(t,e.x,e.y,e.bandwidth||.3).forEach(e=>{const n={};for(let e=0;e<s;++e)n[o[e]]=t.dims[e];n[a[0]]=e[0],n[a[1]]=e[1],l.push(_(n))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});const mS={linear:Bo,log:Wo,exp:Uo,pow:Ho,quad:qo,poly:Vo};function vS(e){Nr.call(this,null,e)}vS.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(mS)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},Object(p.z)(vS,Nr,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=pS(i,e.groupby),o=(e.groupby||[]).map(p.h),s=e.method||"linear",a=e.order||3,l=((e,t)=>"poly"===e?t:"quad"===e?2:1)(s,a),c=e.as||[Object(p.h)(e.x),Object(p.h)(e.y)],u=mS[s],h=[];let d=e.extent;Object(p.w)(mS,s)||Object(p.o)("Invalid regression method: "+s),null!=d&&"log"===s&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),r.forEach(n=>{if(n.length<=l)return void t.dataflow.warn("Skipping regression with more parameters than data points.");const i=u(n,e.x,e.y,a);if(e.params)return void h.push(_({keys:n.dims,coef:i.coef,rSquared:i.rSquared}));const r=d||Object(p.q)(n,e.x),f=e=>{const t={};for(let e=0;e<o.length;++e)t[o[e]]=n.dims[e];t[c[0]]=e[0],t[c[1]]=e[1],h.push(_(t))};"linear"===s?r.forEach(e=>f([e,i.predict(e)])):Zo(i.predict,r,25,200).forEach(f)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=h}return n}});const bS=Math.pow(2,-52),yS=new Uint32Array(512);class wS{static from(e,t=$S,n=ES){const i=e.length,r=new Float64Array(2*i);for(let o=0;o<i;o++){const i=e[o];r[2*o]=t(i),r[2*o+1]=n(i)}return new wS(r)}constructor(e){const t=e.length>>1;if(t>0&&"number"!=typeof e[0])throw new Error("Expected coords to contain numbers.");this.coords=e;const n=Math.max(2*t-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){const{coords:e,_hullPrev:t,_hullNext:n,_hullTri:i,_hullHash:r}=this,o=e.length>>1;let s=1/0,a=1/0,l=-1/0,c=-1/0;for(let t=0;t<o;t++){const n=e[2*t],i=e[2*t+1];n<s&&(s=n),i<a&&(a=i),n>l&&(l=n),i>c&&(c=i),this._ids[t]=t}const u=(s+l)/2,h=(a+c)/2;let d,f,p,g=1/0;for(let t=0;t<o;t++){const n=xS(u,h,e[2*t],e[2*t+1]);n<g&&(d=t,g=n)}const m=e[2*d],v=e[2*d+1];g=1/0;for(let t=0;t<o;t++){if(t===d)continue;const n=xS(m,v,e[2*t],e[2*t+1]);n<g&&n>0&&(f=t,g=n)}let b=e[2*f],y=e[2*f+1],w=1/0;for(let t=0;t<o;t++){if(t===d||t===f)continue;const n=OS(m,v,b,y,e[2*t],e[2*t+1]);n<w&&(p=t,w=n)}let x=e[2*p],_=e[2*p+1];if(w===1/0){for(let t=0;t<o;t++)this._dists[t]=e[2*t]-e[0]||e[2*t+1]-e[1];CS(this._ids,this._dists,0,o-1);const t=new Uint32Array(o);let n=0;for(let e=0,i=-1/0;e<o;e++){const r=this._ids[e];this._dists[r]>i&&(t[n++]=r,i=this._dists[r])}return this.hull=t.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(kS(m,v,b,y,x,_)){const e=f,t=b,n=y;f=p,b=x,y=_,p=e,x=t,_=n}const k=function(e,t,n,i,r,o){const s=n-e,a=i-t,l=r-e,c=o-t,u=s*s+a*a,h=l*l+c*c,d=.5/(s*c-a*l);return{x:e+(c*u-a*h)*d,y:t+(s*h-l*u)*d}}(m,v,b,y,x,_);this._cx=k.x,this._cy=k.y;for(let t=0;t<o;t++)this._dists[t]=xS(e[2*t],e[2*t+1],k.x,k.y);CS(this._ids,this._dists,0,o-1),this._hullStart=d;let S=3;n[d]=t[p]=f,n[f]=t[d]=p,n[p]=t[f]=d,i[d]=0,i[f]=1,i[p]=2,r.fill(-1),r[this._hashKey(m,v)]=d,r[this._hashKey(b,y)]=f,r[this._hashKey(x,_)]=p,this.trianglesLen=0,this._addTriangle(d,f,p,-1,-1,-1);for(let o,s,a=0;a<this._ids.length;a++){const l=this._ids[a],c=e[2*l],u=e[2*l+1];if(a>0&&Math.abs(c-o)<=bS&&Math.abs(u-s)<=bS)continue;if(o=c,s=u,l===d||l===f||l===p)continue;let h=0;for(let e=0,t=this._hashKey(c,u);e<this._hashSize&&(h=r[(t+e)%this._hashSize],-1===h||h===n[h]);e++);h=t[h];let g,m=h;for(;g=n[m],!kS(c,u,e[2*m],e[2*m+1],e[2*g],e[2*g+1]);)if(m=g,m===h){m=-1;break}if(-1===m)continue;let v=this._addTriangle(m,l,n[m],-1,-1,i[m]);i[l]=this._legalize(v+2),i[m]=v,S++;let b=n[m];for(;g=n[b],kS(c,u,e[2*b],e[2*b+1],e[2*g],e[2*g+1]);)v=this._addTriangle(b,l,g,i[l],-1,i[b]),i[l]=this._legalize(v+2),n[b]=b,S--,b=g;if(m===h)for(;g=t[m],kS(c,u,e[2*g],e[2*g+1],e[2*m],e[2*m+1]);)v=this._addTriangle(g,l,m,-1,i[m],i[g]),this._legalize(v+2),i[g]=v,n[m]=m,S--,m=g;this._hullStart=t[l]=m,n[m]=t[b]=l,n[l]=b,r[this._hashKey(c,u)]=l,r[this._hashKey(e[2*m],e[2*m+1])]=m}this.hull=new Uint32Array(S);for(let e=0,t=this._hullStart;e<S;e++)this.hull[e]=t,t=n[t];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,t){return Math.floor(function(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:t,_halfedges:n,coords:i}=this;let r=0,o=0;for(;;){const s=n[e],a=e-e%3;if(o=a+(e+2)%3,-1===s){if(0===r)break;e=yS[--r];continue}const l=s-s%3,c=a+(e+1)%3,u=l+(s+2)%3,h=t[o],d=t[e],f=t[c],p=t[u];if(SS(i[2*h],i[2*h+1],i[2*d],i[2*d+1],i[2*f],i[2*f+1],i[2*p],i[2*p+1])){t[e]=p,t[s]=h;const i=n[u];if(-1===i){let t=this._hullStart;do{if(this._hullTri[t]===u){this._hullTri[t]=e;break}t=this._hullPrev[t]}while(t!==this._hullStart)}this._link(e,i),this._link(s,n[o]),this._link(o,u);const a=l+(s+1)%3;r<yS.length&&(yS[r++]=a)}else{if(0===r)break;e=yS[--r]}}return o}_link(e,t){this._halfedges[e]=t,-1!==t&&(this._halfedges[t]=e)}_addTriangle(e,t,n,i,r,o){const s=this.trianglesLen;return this._triangles[s]=e,this._triangles[s+1]=t,this._triangles[s+2]=n,this._link(s,i),this._link(s+1,r),this._link(s+2,o),this.trianglesLen+=3,s}}function xS(e,t,n,i){const r=e-n,o=t-i;return r*r+o*o}function _S(e,t,n,i,r,o){const s=(i-t)*(r-e),a=(n-e)*(o-t);return Math.abs(s-a)>=33306690738754716e-32*Math.abs(s+a)?s-a:0}function kS(e,t,n,i,r,o){return(_S(r,o,e,t,n,i)||_S(e,t,n,i,r,o)||_S(n,i,r,o,e,t))<0}function SS(e,t,n,i,r,o,s,a){const l=e-s,c=t-a,u=n-s,h=i-a,d=r-s,f=o-a,p=u*u+h*h,g=d*d+f*f;return l*(h*g-p*f)-c*(u*g-p*d)+(l*l+c*c)*(u*f-h*d)<0}function OS(e,t,n,i,r,o){const s=n-e,a=i-t,l=r-e,c=o-t,u=s*s+a*a,h=l*l+c*c,d=.5/(s*c-a*l),f=(c*u-a*h)*d,p=(s*h-l*u)*d;return f*f+p*p}function CS(e,t,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const i=e[r],o=t[i];let s=r-1;for(;s>=n&&t[e[s]]>o;)e[s+1]=e[s--];e[s+1]=i}else{let r=n+1,o=i;AS(e,n+i>>1,r),t[e[n]]>t[e[i]]&&AS(e,n,i),t[e[r]]>t[e[i]]&&AS(e,r,i),t[e[n]]>t[e[r]]&&AS(e,n,r);const s=e[r],a=t[s];for(;;){do{r++}while(t[e[r]]<a);do{o--}while(t[e[o]]>a);if(o<r)break;AS(e,r,o)}e[n+1]=e[o],e[o]=s,i-r+1>=o-n?(CS(e,t,r,i),CS(e,t,n,o-1)):(CS(e,t,n,o-1),CS(e,t,r,i))}}function AS(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function $S(e){return e[0]}function ES(e){return e[1]}class MS{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,t){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,t){this._+=`L${this._x1=+e},${this._y1=+t}`}arc(e,t,n){const i=(e=+e)+(n=+n),r=t=+t;if(n<0)throw new Error("negative radius");null===this._x1?this._+=`M${i},${r}`:(Math.abs(this._x1-i)>1e-6||Math.abs(this._y1-r)>1e-6)&&(this._+="L"+i+","+r),n&&(this._+=`A${n},${n},0,1,1,${e-n},${t}A${n},${n},0,1,1,${this._x1=i},${this._y1=r}`)}rect(e,t,n,i){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${+n}v${+i}h${-n}Z`}value(){return this._||null}}class jS{constructor(){this._=[]}moveTo(e,t){this._.push([e,t])}closePath(){this._.push(this._[0].slice())}lineTo(e,t){this._.push([e,t])}value(){return this._.length?this._:null}}class RS{constructor(e,[t,n,i,r]=[0,0,960,500]){if(!((i=+i)>=(t=+t)&&(r=+r)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(2*e.points.length),this.vectors=new Float64Array(2*e.points.length),this.xmax=i,this.xmin=t,this.ymax=r,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:t,triangles:n},vectors:i}=this,r=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let t,i,o=0,s=0,a=n.length;o<a;o+=3,s+=2){const a=2*n[o],l=2*n[o+1],c=2*n[o+2],u=e[a],h=e[a+1],d=e[l],f=e[l+1],p=e[c],g=e[c+1],m=d-u,v=f-h,b=p-u,y=g-h,w=m*m+v*v,x=b*b+y*y,_=2*(m*y-v*b);if(_)if(Math.abs(_)<1e-8)t=(u+p)/2,i=(h+g)/2;else{const e=1/_;t=u+(y*w-v*x)*e,i=h+(m*x-b*w)*e}else t=(u+p)/2-1e8*y,i=(h+g)/2+1e8*b;r[s]=t,r[s+1]=i}let o,s,a,l=t[t.length-1],c=4*l,u=e[2*l],h=e[2*l+1];i.fill(0);for(let n=0;n<t.length;++n)l=t[n],o=c,s=u,a=h,c=4*l,u=e[2*l],h=e[2*l+1],i[o+2]=i[c]=a-h,i[o+3]=i[c+1]=u-s}render(e){const t=null==e?e=new MS:void 0,{delaunay:{halfedges:n,inedges:i,hull:r},circumcenters:o,vectors:s}=this;if(r.length<=1)return null;for(let t=0,i=n.length;t<i;++t){const i=n[t];if(i<t)continue;const r=2*Math.floor(t/3),s=2*Math.floor(i/3),a=o[r],l=o[r+1],c=o[s],u=o[s+1];this._renderSegment(a,l,c,u,e)}let a,l=r[r.length-1];for(let t=0;t<r.length;++t){a=l,l=r[t];const n=2*Math.floor(i[l]/3),c=o[n],u=o[n+1],h=4*a,d=this._project(c,u,s[h+2],s[h+3]);d&&this._renderSegment(c,u,d[0],d[1],e)}return t&&t.value()}renderBounds(e){const t=null==e?e=new MS:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}renderCell(e,t){const n=null==t?t=new MS:void 0,i=this._clip(e);if(null===i||!i.length)return;t.moveTo(i[0],i[1]);let r=i.length;for(;i[0]===i[r-2]&&i[1]===i[r-1]&&r>1;)r-=2;for(let e=2;e<r;e+=2)i[e]===i[e-2]&&i[e+1]===i[e-1]||t.lineTo(i[e],i[e+1]);return t.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let t=0,n=e.length/2;t<n;++t){const e=this.cellPolygon(t);e&&(e.index=t,yield e)}}cellPolygon(e){const t=new jS;return this.renderCell(e,t),t.value()}_renderSegment(e,t,n,i,r){let o;const s=this._regioncode(e,t),a=this._regioncode(n,i);0===s&&0===a?(r.moveTo(e,t),r.lineTo(n,i)):(o=this._clipSegment(e,t,n,i,s,a))&&(r.moveTo(o[0],o[1]),r.lineTo(o[2],o[3]))}contains(e,t,n){return(t=+t)==t&&(n=+n)==n&&this.delaunay._step(e,t,n)===e}*neighbors(e){const t=this._clip(e);if(t)for(const n of this.delaunay.neighbors(e)){const e=this._clip(n);if(e)e:for(let i=0,r=t.length;i<r;i+=2)for(let o=0,s=e.length;o<s;o+=2)if(t[i]==e[o]&&t[i+1]==e[o+1]&&t[(i+2)%r]==e[(o+s-2)%s]&&t[(i+3)%r]==e[(o+s-1)%s]){yield n;break e}}}_cell(e){const{circumcenters:t,delaunay:{inedges:n,halfedges:i,triangles:r}}=this,o=n[e];if(-1===o)return null;const s=[];let a=o;do{const n=Math.floor(a/3);if(s.push(t[2*n],t[2*n+1]),a=a%3==2?a-2:a+1,r[a]!==e)break;a=i[a]}while(a!==o&&-1!==a);return s}_clip(e){if(0===e&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const t=this._cell(e);if(null===t)return null;const{vectors:n}=this,i=4*e;return n[i]||n[i+1]?this._clipInfinite(e,t,n[i],n[i+1],n[i+2],n[i+3]):this._clipFinite(e,t)}_clipFinite(e,t){const n=t.length;let i,r,o,s,a,l=null,c=t[n-2],u=t[n-1],h=this._regioncode(c,u);for(let d=0;d<n;d+=2)if(i=c,r=u,c=t[d],u=t[d+1],o=h,h=this._regioncode(c,u),0===o&&0===h)s=a,a=0,l?l.push(c,u):l=[c,u];else{let t,n,d,f,p;if(0===o){if(null===(t=this._clipSegment(i,r,c,u,o,h)))continue;[n,d,f,p]=t}else{if(null===(t=this._clipSegment(c,u,i,r,h,o)))continue;[f,p,n,d]=t,s=a,a=this._edgecode(n,d),s&&a&&this._edge(e,s,a,l,l.length),l?l.push(n,d):l=[n,d]}s=a,a=this._edgecode(f,p),s&&a&&this._edge(e,s,a,l,l.length),l?l.push(f,p):l=[f,p]}if(l)s=a,a=this._edgecode(l[0],l[1]),s&&a&&this._edge(e,s,a,l,l.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return l}_clipSegment(e,t,n,i,r,o){for(;;){if(0===r&&0===o)return[e,t,n,i];if(r&o)return null;let s,a,l=r||o;8&l?(s=e+(n-e)*(this.ymax-t)/(i-t),a=this.ymax):4&l?(s=e+(n-e)*(this.ymin-t)/(i-t),a=this.ymin):2&l?(a=t+(i-t)*(this.xmax-e)/(n-e),s=this.xmax):(a=t+(i-t)*(this.xmin-e)/(n-e),s=this.xmin),r?(e=s,t=a,r=this._regioncode(e,t)):(n=s,i=a,o=this._regioncode(n,i))}}_clipInfinite(e,t,n,i,r,o){let s,a=Array.from(t);if((s=this._project(a[0],a[1],n,i))&&a.unshift(s[0],s[1]),(s=this._project(a[a.length-2],a[a.length-1],r,o))&&a.push(s[0],s[1]),a=this._clipFinite(e,a))for(let t,n=0,i=a.length,r=this._edgecode(a[i-2],a[i-1]);n<i;n+=2)t=r,r=this._edgecode(a[n],a[n+1]),t&&r&&(n=this._edge(e,t,r,a,n),i=a.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(e,t,n,i,r){for(;t!==n;){let n,o;switch(t){case 5:t=4;continue;case 4:t=6,n=this.xmax,o=this.ymin;break;case 6:t=2;continue;case 2:t=10,n=this.xmax,o=this.ymax;break;case 10:t=8;continue;case 8:t=9,n=this.xmin,o=this.ymax;break;case 9:t=1;continue;case 1:t=5,n=this.xmin,o=this.ymin}i[r]===n&&i[r+1]===o||!this.contains(e,n,o)||(i.splice(r,0,n,o),r+=2)}if(i.length>4)for(let e=0;e<i.length;e+=2){const t=(e+2)%i.length,n=(e+4)%i.length;(i[e]===i[t]&&i[t]===i[n]||i[e+1]===i[t+1]&&i[t+1]===i[n+1])&&(i.splice(t,2),e-=2)}return r}_project(e,t,n,i){let r,o,s,a=1/0;if(i<0){if(t<=this.ymin)return null;(r=(this.ymin-t)/i)<a&&(s=this.ymin,o=e+(a=r)*n)}else if(i>0){if(t>=this.ymax)return null;(r=(this.ymax-t)/i)<a&&(s=this.ymax,o=e+(a=r)*n)}if(n>0){if(e>=this.xmax)return null;(r=(this.xmax-e)/n)<a&&(o=this.xmax,s=t+(a=r)*i)}else if(n<0){if(e<=this.xmin)return null;(r=(this.xmin-e)/n)<a&&(o=this.xmin,s=t+(a=r)*i)}return[o,s]}_edgecode(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}_regioncode(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}}const DS=2*Math.PI,TS=Math.pow;function LS(e){return e[0]}function FS(e){return e[1]}function NS(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class PS{static from(e,t=LS,n=FS,i){return new PS("length"in e?function(e,t,n,i){const r=e.length,o=new Float64Array(2*r);for(let s=0;s<r;++s){const r=e[s];o[2*s]=t.call(i,r,s,e),o[2*s+1]=n.call(i,r,s,e)}return o}(e,t,n,i):Float64Array.from(function*(e,t,n,i){let r=0;for(const o of e)yield t.call(i,o,r,e),yield n.call(i,o,r,e),++r}(e,t,n,i)))}constructor(e){this._delaunator=new wS(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&function(e){const{triangles:t,coords:n}=e;for(let e=0;e<t.length;e+=3){const i=2*t[e],r=2*t[e+1],o=2*t[e+2];if((n[o]-n[i])*(n[r+1]-n[i+1])-(n[r]-n[i])*(n[o+1]-n[i+1])>1e-10)return!1}return!0}(e)){this.collinear=Int32Array.from({length:t.length/2},(e,t)=>t).sort((e,n)=>t[2*e]-t[2*n]||t[2*e+1]-t[2*n+1]);const e=this.collinear[0],n=this.collinear[this.collinear.length-1],i=[t[2*e],t[2*e+1],t[2*n],t[2*n+1]],r=1e-8*Math.hypot(i[3]-i[1],i[2]-i[0]);for(let e=0,n=t.length/2;e<n;++e){const n=NS(t[2*e],t[2*e+1],r);t[2*e]=n[0],t[2*e+1]=n[1]}this._delaunator=new wS(t)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,r=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),s=this._hullIndex.fill(-1);for(let e=0,t=n.length;e<t;++e){const t=r[e%3==2?e-2:e+1];-1!==n[e]&&-1!==o[t]||(o[t]=e)}for(let e=0,t=i.length;e<t;++e)s[i[e]]=e;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],this.triangles[1]=i[1],this.triangles[2]=i[1],o[i[0]]=1,2===i.length&&(o[i[1]]=0))}voronoi(e){return new RS(this,e)}*neighbors(e){const{inedges:t,hull:n,_hullIndex:i,halfedges:r,triangles:o,collinear:s}=this;if(s){const t=s.indexOf(e);return t>0&&(yield s[t-1]),void(t<s.length-1&&(yield s[t+1]))}const a=t[e];if(-1===a)return;let l=a,c=-1;do{if(yield c=o[l],l=l%3==2?l-2:l+1,o[l]!==e)return;if(l=r[l],-1===l){const t=n[(i[e]+1)%n.length];return void(t!==c&&(yield t))}}while(l!==a)}find(e,t,n=0){if((e=+e)!=e||(t=+t)!=t)return-1;const i=n;let r;for(;(r=this._step(n,e,t))>=0&&r!==n&&r!==i;)n=r;return r}_step(e,t,n){const{inedges:i,hull:r,_hullIndex:o,halfedges:s,triangles:a,points:l}=this;if(-1===i[e]||!l.length)return(e+1)%(l.length>>1);let c=e,u=TS(t-l[2*e],2)+TS(n-l[2*e+1],2);const h=i[e];let d=h;do{let i=a[d];const h=TS(t-l[2*i],2)+TS(n-l[2*i+1],2);if(h<u&&(u=h,c=i),d=d%3==2?d-2:d+1,a[d]!==e)break;if(d=s[d],-1===d){if(d=r[(o[e]+1)%r.length],d!==i&&TS(t-l[2*d],2)+TS(n-l[2*d+1],2)<u)return d;break}}while(d!==h);return c}render(e){const t=null==e?e=new MS:void 0,{points:n,halfedges:i,triangles:r}=this;for(let t=0,o=i.length;t<o;++t){const o=i[t];if(o<t)continue;const s=2*r[t],a=2*r[o];e.moveTo(n[s],n[s+1]),e.lineTo(n[a],n[a+1])}return this.renderHull(e),t&&t.value()}renderPoints(e,t=2){const n=null==e?e=new MS:void 0,{points:i}=this;for(let n=0,r=i.length;n<r;n+=2){const r=i[n],o=i[n+1];e.moveTo(r+t,o),e.arc(r,o,t,0,DS)}return n&&n.value()}renderHull(e){const t=null==e?e=new MS:void 0,{hull:n,points:i}=this,r=2*n[0],o=n.length;e.moveTo(i[r],i[r+1]);for(let t=1;t<o;++t){const r=2*n[t];e.lineTo(i[r],i[r+1])}return e.closePath(),t&&t.value()}hullPolygon(){const e=new jS;return this.renderHull(e),e.value()}renderTriangle(e,t){const n=null==t?t=new MS:void 0,{points:i,triangles:r}=this,o=2*r[e*=3],s=2*r[e+1],a=2*r[e+2];return t.moveTo(i[o],i[o+1]),t.lineTo(i[s],i[s+1]),t.lineTo(i[a],i[a+1]),t.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:e}=this;for(let t=0,n=e.length/3;t<n;++t)yield this.trianglePolygon(t)}trianglePolygon(e){const t=new jS;return this.renderTriangle(e,t),t.value()}}function zS(e){Nr.call(this,null,e)}zS.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const IS=[-1e5,-1e5,1e5,1e5];function BS(e){const t=e[0][0],n=e[0][1];let i=e.length-1;for(;e[i][0]===t&&e[i][1]===n;--i);return"M"+e.slice(0,i+1).join("L")+"Z"}Object(p.z)(zS,Nr,{transform(e,t){const n=e.as||"path",i=t.source;if(!i||!i.length)return t;let r=e.size;r=r?[0,0,r[0],r[1]]:(r=e.extent)?[r[0][0],r[0][1],r[1][0],r[1][1]]:IS;const o=this.value=PS.from(i,e.x,e.y).voronoi(r);for(let e=0,t=i.length;e<t;++e){const t=o.cellPolygon(e);i[e][n]=t?BS(t):null}return t.reflow(e.modified()).modifies(n)}});var WS=Math.PI/180,US=function(){var e,t,n,i,r,o,s,a=[256,256],l=GS,c=[],u=Math.random,h={};function d(e,t,n){for(var i,r,o,s,c,h=t.x,d=t.y,f=Math.sqrt(a[0]*a[0]+a[1]*a[1]),p=l(a),g=u()<.5?1:-1,m=-g;(i=p(m+=g))&&(r=~~i[0],o=~~i[1],!(Math.min(Math.abs(r),Math.abs(o))>=f));)if(t.x=h+r,t.y=d+o,!(t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>a[0]||t.y+t.y1>a[1]||n&&qS(t,e,a[0])||n&&(c=n,!((s=t).x+s.x1>c[0].x&&s.x+s.x0<c[1].x&&s.y+s.y1>c[0].y&&s.y+s.y0<c[1].y)))){for(var v,b=t.sprite,y=t.width>>5,w=a[0]>>5,x=t.x-(y<<4),_=127&x,k=32-_,S=t.y1-t.y0,O=(t.y+t.y0)*w+(x>>5),C=0;C<S;C++){v=0;for(var A=0;A<=y;A++)e[O+A]|=v<<k|(A<y?(v=b[C*y+A])>>>_:0);O+=w}return t.sprite=null,!0}return!1}return h.layout=function(){for(var l=function(e){e.width=e.height=1;var t=Math.sqrt(e.getContext("2d").getImageData(0,0,1,1).data.length>>2);e.width=2048/t,e.height=2048/t;var n=e.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:t}}(Wc()),h=function(e){var t=[],n=-1;for(;++n<e;)t[n]=0;return t}((a[0]>>5)*a[1]),f=null,p=c.length,g=-1,m=[],v=c.map((function(a){return{text:e(a),font:t(a),style:i(a),weight:r(a),rotate:o(a),size:~~(n(a)+1e-14),padding:s(a),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:a}})).sort((function(e,t){return t.size-e.size}));++g<p;){var b=v[g];b.x=a[0]*(u()+.5)>>1,b.y=a[1]*(u()+.5)>>1,HS(l,b,v,g),b.hasText&&d(h,b,f)&&(m.push(b),f?VS(f,b):f=[{x:b.x+b.x0,y:b.y+b.y0},{x:b.x+b.x1,y:b.y+b.y1}],b.x-=a[0]>>1,b.y-=a[1]>>1)}return m},h.words=function(e){return arguments.length?(c=e,h):c},h.size=function(e){return arguments.length?(a=[+e[0],+e[1]],h):a},h.font=function(e){return arguments.length?(t=KS(e),h):t},h.fontStyle=function(e){return arguments.length?(i=KS(e),h):i},h.fontWeight=function(e){return arguments.length?(r=KS(e),h):r},h.rotate=function(e){return arguments.length?(o=KS(e),h):o},h.text=function(t){return arguments.length?(e=KS(t),h):e},h.spiral=function(e){return arguments.length?(l=YS[e]||e,h):l},h.fontSize=function(e){return arguments.length?(n=KS(e),h):n},h.padding=function(e){return arguments.length?(s=KS(e),h):s},h.random=function(e){return arguments.length?(u=e,h):u},h};function HS(e,t,n,i){if(!t.sprite){var r=e.context,o=e.ratio;r.clearRect(0,0,2048/o,2048/o);var s,a,l,c,u,h=0,d=0,f=0,p=n.length;for(--i;++i<p;){if(t=n[i],r.save(),r.font=t.style+" "+t.weight+" "+~~((t.size+1)/o)+"px "+t.font,s=r.measureText(t.text+"m").width*o,l=t.size<<1,t.rotate){var g=Math.sin(t.rotate*WS),m=Math.cos(t.rotate*WS),v=s*m,b=s*g,y=l*m,w=l*g;s=Math.max(Math.abs(v+w),Math.abs(v-w))+31>>5<<5,l=~~Math.max(Math.abs(b+y),Math.abs(b-y))}else s=s+31>>5<<5;if(l>f&&(f=l),h+s>=2048&&(h=0,d+=f,f=0),d+l>=2048)break;r.translate((h+(s>>1))/o,(d+(l>>1))/o),t.rotate&&r.rotate(t.rotate*WS),r.fillText(t.text,0,0),t.padding&&(r.lineWidth=2*t.padding,r.strokeText(t.text,0,0)),r.restore(),t.width=s,t.height=l,t.xoff=h,t.yoff=d,t.x1=s>>1,t.y1=l>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,h+=s}for(var x=r.getImageData(0,0,2048/o,2048/o).data,_=[];--i>=0;)if((t=n[i]).hasText){for(a=(s=t.width)>>5,l=t.y1-t.y0,c=0;c<l*a;c++)_[c]=0;if(null==(h=t.xoff))return;d=t.yoff;var k=0,S=-1;for(u=0;u<l;u++){for(c=0;c<s;c++){var O=a*u+(c>>5),C=x[2048*(d+u)+(h+c)<<2]?1<<31-c%32:0;_[O]|=C,k|=C}k?S=u:(t.y0++,l--,u--,d++)}t.y1=t.y0+S,t.sprite=_.slice(0,(t.y1-t.y0)*a)}}}function qS(e,t,n){n>>=5;for(var i,r=e.sprite,o=e.width>>5,s=e.x-(o<<4),a=127&s,l=32-a,c=e.y1-e.y0,u=(e.y+e.y0)*n+(s>>5),h=0;h<c;h++){i=0;for(var d=0;d<=o;d++)if((i<<l|(d<o?(i=r[h*o+d])>>>a:0))&t[u+d])return!0;u+=n}return!1}function VS(e,t){var n=e[0],i=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>i.x&&(i.x=t.x+t.x1),t.y+t.y1>i.y&&(i.y=t.y+t.y1)}function GS(e){var t=e[0]/e[1];return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}function KS(e){return"function"==typeof e?e:function(){return e}}var YS={archimedean:GS,rectangular:function(e){var t=4*e[0]/e[1],n=0,i=0;return function(e){var r=e<0?-1:1;switch(Math.sqrt(1+4*r*e)-r&3){case 0:n+=t;break;case 1:i+=4;break;case 2:n-=t;break;default:i-=4}return[n,i]}}},XS=["x","y","font","fontSize","fontStyle","fontWeight","angle"],JS=["text","font","rotate","fontSize","fontStyle","fontWeight"];function QS(e){Nr.call(this,US(),e)}QS.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:XS}]},Object(p.z)(QS,Nr,{transform(e,t){!e.size||e.size[0]&&e.size[1]||Object(p.o)("Wordcloud size dimensions must be non-zero.");const n=e.modified();if(!(n||t.changed(t.ADD_REM)||JS.some((function(n){var i=e[n];return Object(p.E)(i)&&t.modified(i.fields)}))))return;const i=t.materialize(t.SOURCE).source,r=this.value,o=e.as||XS;let s,a=e.fontSize||14;if(Object(p.E)(a)?s=e.fontSizeRange:a=Object(p.m)(a),s){const e=a,t=qp("sqrt")().domain(Object(p.q)(i,e)).range(s);a=n=>t(e(n))}i.forEach(e=>{e[o[0]]=NaN,e[o[1]]=NaN,e[o[3]]=0});const l=r.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(a).random(uo).layout(),c=r.size(),u=c[0]>>1,h=c[1]>>1,d=l.length;for(let e,t,n=0;n<d;++n)e=l[n],t=e.datum,t[o[0]]=e.x+u,t[o[1]]=e.y+h,t[o[2]]=e.font,t[o[3]]=e.size,t[o[4]]=e.style,t[o[5]]=e.weight,t[o[6]]=e.rotate;return t.reflow(n).modifies(o)}});const ZS=e=>new Uint8Array(e),eO=e=>new Uint16Array(e),tO=e=>new Uint32Array(e);function nO(e,t,n){const i=(t<257?ZS:t<65537?eO:tO)(e);return n&&i.set(n),i}var iO=function(e,t,n){const i=1<<t;return{one:i,zero:~i,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(e,t){let n,r=this.bisect(this.range,e.value),o=e.index,s=r[0],a=r[1],l=o.length;for(n=0;n<s;++n)t[o[n]]|=i;for(n=a;n<l;++n)t[o[n]]|=i;return this}}};function rO(){let e=tO(0),t=[],n=0;return{insert:function(i,r,o){if(!r.length)return[];let s,a,l,c=n,u=r.length,h=Array(u),d=tO(u);for(l=0;l<u;++l)h[l]=i(r[l]),d[l]=l;if(h=function(e,t){return e.sort.call(t,(t,n)=>{const i=e[t],r=e[n];return i<r?-1:i>r?1:0}),function(e,t){return Array.from(t,t=>e[t])}(e,t)}(h,d),c)s=t,a=e,t=Array(c+u),e=tO(c+u),function(e,t,n,i,r,o,s,a,l){let c,u=0,h=0;for(c=0;u<i&&h<s;++c)t[u]<r[h]?(a[c]=t[u],l[c]=n[u++]):(a[c]=r[h],l[c]=o[h++]+e);for(;u<i;++u,++c)a[c]=t[u],l[c]=n[u];for(;h<s;++h,++c)a[c]=r[h],l[c]=o[h]+e}(o,s,a,c,h,d,u,t,e);else{if(o>0)for(l=0;l<u;++l)d[l]+=o;t=h,e=d}return n=c+u,{index:d,value:h}},remove:function(i,r){let o,s,a,l=n;for(s=0;!r[e[s]]&&s<l;++s);for(a=s;s<l;++s)r[o=e[s]]||(e[a]=o,t[a]=t[s],++a);n=l-i},bisect:function(e,i){let r;return i?r=i.length:(i=t,r=n),[Yd(i,e[0],0,r),Kd(i,e[1],0,r)]},reindex:function(t){for(let i=0,r=n;i<r;++i)e[i]=t[e[i]]},index:()=>e,size:()=>n}}function oO(e){Nr.call(this,function(){let e=8,t=[],n=tO(0),i=nO(0,e),r=nO(0,e);return{data:()=>t,seen:()=>{return e=n,i=t.length,n=e.length>=i?e:((r=r||new e.constructor(i)).set(e),r);var e,i,r},add(e){for(let n,i=0,r=t.length,o=e.length;i<o;++i)n=e[i],n._index=r++,t.push(n)},remove(e,n){let o,s,a,l=t.length,c=Array(l-e),u=t;for(s=0;!n[s]&&s<l;++s)c[s]=t[s],u[s]=s;for(a=s;s<l;++s)o=t[s],n[s]?u[s]=-1:(u[s]=a,i[a]=i[s],r[a]=r[s],c[a]=o,o._index=a++),i[s]=0;return t=c,u},size:()=>t.length,curr:()=>i,prev:()=>r,reset:e=>r[e]=i[e],all:()=>e<257?255:e<65537?65535:4294967295,set(e,t){i[e]|=t},clear(e,t){i[e]&=~t},resize(t,n){(t>i.length||n>e)&&(e=Math.max(n,e),i=nO(t,e,i),r=nO(t,e))}}}(),e),this._indices=null,this._dims=null}function sO(e){Nr.call(this,null,e)}oO.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},Object(p.z)(oO,Nr,{transform(e,t){return this._dims?e.modified("fields")||e.fields.some(e=>t.modified(e.fields))?this.reinit(e,t):this.eval(e,t):this.init(e,t)},init(e,t){let n,i,r=e.fields,o=e.query,s=this._indices={},a=this._dims=[],l=o.length,c=0;for(;c<l;++c)n=r[c].fname,i=s[n]||(s[n]=rO()),a.push(iO(i,c,o[c]));return this.eval(e,t)},reinit(e,t){let n,i,r,o,s,a,l,c,u,h=t.materialize().fork(),d=e.fields,f=e.query,p=this._indices,g=this._dims,m=this.value,v=m.curr(),b=m.prev(),y=m.all(),w=h.rem=h.add,x=h.mod,_=f.length,k={};if(b.set(v),t.rem.length&&(s=this.remove(e,t,h)),t.add.length&&m.add(t.add),t.mod.length)for(a={},o=t.mod,l=0,c=o.length;l<c;++l)a[o[l]._index]=1;for(l=0;l<_;++l)u=d[l],(!g[l]||e.modified("fields",l)||t.modified(u.fields))&&(r=u.fname,(n=k[r])||(p[r]=i=rO(),k[r]=n=i.insert(u,t.source,0)),g[l]=iO(i,l,f[l]).onAdd(n,v));for(l=0,c=m.data().length;l<c;++l)s[l]||(b[l]!==v[l]?w.push(l):a[l]&&v[l]!==y&&x.push(l));return m.mask=(1<<_)-1,h},eval(e,t){let n=t.materialize().fork(),i=this._dims.length,r=0;return t.rem.length&&(this.remove(e,t,n),r|=(1<<i)-1),e.modified("query")&&!e.modified("fields")&&(r|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),r|=(1<<i)-1),t.mod.length&&(this.modify(t,n),r|=(1<<i)-1),this.value.mask=r,n},insert(e,t,n){let i,r,o,s=t.add,a=this.value,l=this._dims,c=this._indices,u=e.fields,h={},d=n.add,f=a.size(),p=f+s.length,g=l.length;a.resize(p,g),a.add(s);const m=a.curr(),v=a.prev(),b=a.all();for(i=0;i<g;++i)r=u[i].fname,o=h[r]||(h[r]=c[r].insert(u[i],s,f)),l[i].onAdd(o,m);for(;f<p;++f)v[f]=b,m[f]!==b&&d.push(f)},modify(e,t){let n,i,r,o=t.mod,s=this.value,a=s.curr(),l=s.all(),c=e.mod;for(n=0,i=c.length;n<i;++n)r=c[n]._index,a[r]!==l&&o.push(r)},remove(e,t,n){let i,r,o,s,a=this._indices,l=this.value,c=l.curr(),u=l.prev(),h=l.all(),d={},f=n.rem,p=t.rem;for(i=0,r=p.length;i<r;++i)o=p[i]._index,d[o]=1,u[o]=s=c[o],c[o]=h,s!==h&&f.push(o);for(o in a)a[o].remove(r,d);return this.reindex(t,r,d),d},reindex(e,t,n){const i=this._indices,r=this.value;e.runAfter(()=>{const e=r.remove(t,n);for(const t in i)i[t].reindex(e)})},update(e,t,n){let i,r,o=this._dims,s=e.query,a=t.stamp,l=o.length,c=0;for(n.filters=0,r=0;r<l;++r)e.modified("query",r)&&(i=r,++c);if(1===c)c=o[i].one,this.incrementOne(o[i],s[i],n.add,n.rem);else for(r=0,c=0;r<l;++r)e.modified("query",r)&&(c|=o[r].one,this.incrementAll(o[r],s[r],a,n.add),n.rem=n.add);return c},incrementAll(e,t,n,i){let r,o,s,a=this.value,l=a.seen(),c=a.curr(),u=a.prev(),h=e.index(),d=e.bisect(e.range),f=e.bisect(t),p=f[0],g=f[1],m=d[0],v=d[1],b=e.one;if(p<m)for(r=p,o=Math.min(m,g);r<o;++r)s=h[r],l[s]!==n&&(u[s]=c[s],l[s]=n,i.push(s)),c[s]^=b;else if(p>m)for(r=m,o=Math.min(p,v);r<o;++r)s=h[r],l[s]!==n&&(u[s]=c[s],l[s]=n,i.push(s)),c[s]^=b;if(g>v)for(r=Math.max(p,v),o=g;r<o;++r)s=h[r],l[s]!==n&&(u[s]=c[s],l[s]=n,i.push(s)),c[s]^=b;else if(g<v)for(r=Math.max(m,g),o=v;r<o;++r)s=h[r],l[s]!==n&&(u[s]=c[s],l[s]=n,i.push(s)),c[s]^=b;e.range=t.slice()},incrementOne(e,t,n,i){let r,o,s,a=this.value.curr(),l=e.index(),c=e.bisect(e.range),u=e.bisect(t),h=u[0],d=u[1],f=c[0],p=c[1],g=e.one;if(h<f)for(r=h,o=Math.min(f,d);r<o;++r)s=l[r],a[s]^=g,n.push(s);else if(h>f)for(r=f,o=Math.min(h,p);r<o;++r)s=l[r],a[s]^=g,i.push(s);if(d>p)for(r=Math.max(h,p),o=d;r<o;++r)s=l[r],a[s]^=g,n.push(s);else if(d<p)for(r=Math.max(f,d),o=p;r<o;++r)s=l[r],a[s]^=g,i.push(s);e.range=t.slice()}}),sO.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},Object(p.z)(sO,Nr,{transform(e,t){const n=~(e.ignore||0),i=e.filter,r=i.mask;if(0==(r&n))return t.StopPropagation;const o=t.fork(t.ALL),s=i.data(),a=i.curr(),l=i.prev(),c=e=>a[e]&n?null:s[e];return o.filter(o.MOD,c),r&r-1?(o.filter(o.ADD,e=>{const t=a[e]&n;return!t&&t^l[e]&n?s[e]:null}),o.filter(o.REM,e=>{const t=a[e]&n;return t&&!(t^t^l[e]&n)?s[e]:null})):(o.filter(o.ADD,c),o.filter(o.REM,e=>(a[e]&n)===r?s[e]:null)),o.filter(o.SOURCE,e=>c(e._index))}});var aO=n(52);function lO(e,t){e&&(null==t?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function cO(e,t){const n=e.globalCursor()?"undefined"!=typeof document&&document.body:e.container();if(n)return null==t?n.style.removeProperty("cursor"):n.style.cursor=t}function uO(e,t){var n=e._runtime.data;return Object(p.w)(n,t)||Object(p.o)("Unrecognized data set: "+t),n[t]}function hO(e,t){A(t)||Object(p.o)("Second argument to changes must be a changeset.");var n=uO(this,e);return n.modified=!0,this.pulse(n.input,t)}function dO(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function fO(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function pO(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}var gO=function(e,t,n){var i,r,o,s=e._renderer,a=s&&s.canvas();return a&&(o=pO(e),r=t.changedTouches?t.changedTouches[0]:t,(i=wd(r,a))[0]-=o[0],i[1]-=o[1]),t.dataflow=e,t.item=n,t.vega=function(e,t,n){var i=t?"group"===t.mark.marktype?t:t.mark.group:null;function r(e){var n,r=i;if(e)for(n=t;n;n=n.mark.group)if(n.mark.name===e){r=n;break}return r&&r.mark&&r.mark.interactive?r:{}}function o(e){if(!e)return n;Object(p.I)(e)&&(e=r(e));for(var t=n.slice();e;)t[0]-=e.x||0,t[1]-=e.y||0,e=e.mark&&e.mark.group;return t}return{view:Object(p.m)(e),item:Object(p.m)(t||{}),group:r,xy:o,x:function(e){return o(e)[0]},y:function(e){return o(e)[1]}}}(e,n,i),t};const mO={trap:!1};function vO(e,t,n){const i=e._eventConfig&&e._eventConfig[t];return!(!1===i||Object(p.G)(i)&&!i[n])||(e.warn(`Blocked ${t} ${n} event listener.`),!1)}function bO(e){return e.item}function yO(e){return e.item.mark.source}function wO(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}var xO=function(e,t,n){var i=document.createElement(e);for(var r in t)i.setAttribute(r,t[r]);return null!=n&&(i.textContent=n),i};var _O=function(e,t,n){if(!t)return;const i=n.param;let r=n.state;return r||(r=n.state={elements:null,active:!1,set:null,update:t=>{t!==e.signal(i.signal)&&e.runAsync(null,(function(){r.source=!0,e.signal(i.signal,t)}))}},i.debounce&&(r.update=Object(p.n)(i.debounce,r.update))),function(e,t,n,i){const r=xO("div",{class:"vega-bind"}),o="radio"===n.input?r:r.appendChild(xO("label"));o.appendChild(xO("span",{class:"vega-bind-name"},n.name||n.signal)),t.appendChild(r);let s=kO;switch(n.input){case"checkbox":s=SO;break;case"select":s=OO;break;case"radio":s=CO;break;case"range":s=AO}s(e,o,n,i)}(r,t,i,e.signal(i.signal)),r.active||(e.on(e._signals[i.signal],null,()=>{r.source?r.source=!1:r.set(e.signal(i.signal))}),r.active=!0),r};function kO(e,t,n,i){const r=xO("input");for(const e in n)"signal"!==e&&"element"!==e&&r.setAttribute("input"===e?"type":e,n[e]);r.setAttribute("name",n.signal),r.value=i,t.appendChild(r),r.addEventListener("input",()=>e.update(r.value)),e.elements=[r],e.set=e=>r.value=e}function SO(e,t,n,i){const r={type:"checkbox",name:n.signal};i&&(r.checked=!0);const o=xO("input",r);t.appendChild(o),o.addEventListener("change",()=>e.update(o.checked)),e.elements=[o],e.set=e=>o.checked=!!e||null}function OO(e,t,n,i){const r=xO("select",{name:n.signal}),o=n.labels||[];n.options.forEach((e,t)=>{const n={value:e};$O(e,i)&&(n.selected=!0),r.appendChild(xO("option",n,(o[t]||e)+""))}),t.appendChild(r),r.addEventListener("change",()=>{e.update(n.options[r.selectedIndex])}),e.elements=[r],e.set=e=>{for(let t=0,i=n.options.length;t<i;++t)if($O(n.options[t],e))return void(r.selectedIndex=t)}}function CO(e,t,n,i){const r=xO("span",{class:"vega-bind-radio"}),o=n.labels||[];t.appendChild(r),e.elements=n.options.map((t,s)=>{const a={type:"radio",name:n.signal,value:t};$O(t,i)&&(a.checked=!0);const l=xO("input",a);l.addEventListener("change",()=>e.update(t));const c=xO("label",{},(o[s]||t)+"");return c.prepend(l),r.appendChild(c),l}),e.set=t=>{const n=e.elements,i=n.length;for(let e=0;e<i;++e)$O(n[e].value,t)&&(n[e].checked=!0)}}function AO(e,t,n,i){i=void 0!==i?i:(+n.max+ +n.min)/2;const r=null!=n.max?n.max:Math.max(100,+i)||100,o=n.min||Math.min(0,r,+i)||0,s=n.step||Ae(o,r,100),a=xO("input",{type:"range",name:n.signal,min:o,max:r,step:s});a.value=i;const l=xO("span",{},+i);t.appendChild(a),t.appendChild(l);const c=()=>{l.textContent=a.value,e.update(+a.value)};a.addEventListener("input",c),a.addEventListener("change",c),e.elements=[a],e.set=e=>{a.value=e,l.textContent=e}}function $O(e,t){return e===t||e+""==t+""}var EO=function(e,t,n,i,r,o){return(t=t||new i(e.loader())).initialize(n,dO(e),fO(e),pO(e),r,o).background(e.background())},MO=function(e,t){return t?function(){try{t.apply(this,arguments)}catch(t){e.error(t)}}:null};function jO(e,t){if("string"==typeof t){if("undefined"==typeof document)return e.error("DOM document instance not found."),null;if(!(t=document.querySelector(t)))return e.error("Signal bind element not found: "+t),null}if(t)try{t.innerHTML=""}catch(n){t=null,e.error(n)}return t}const RO=e=>+e||0;var DO=function(e){return Object(p.G)(e)?{top:RO(e.top),bottom:RO(e.bottom),left:RO(e.left),right:RO(e.right)}:(e=>({top:e,bottom:e,left:e,right:e}))(RO(e))},TO=async function(e,t,n,i){const r=Qm(t),o=r&&r.headless;return o||Object(p.o)("Unrecognized renderer type: "+t),await e.runAsync(),EO(e,null,null,o,n,i).renderAsync(e._scenegraph.root)};function LO(e){const t=this.context.data[e];return t?t.values.value:[]}const FO=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},NO=FO("format"),PO=FO("timeFormat"),zO=FO("utcFormat"),IO=FO("timeParse"),BO=FO("utcParse"),WO=new Date(2e3,0,1);function UO(e,t,n){return Number.isInteger(e)&&Number.isInteger(t)?(WO.setYear(2e3),WO.setMonth(e),WO.setDate(t),PO.call(this,WO,n)):""}var HO=n(3);function qO(e,t,n,i){t[0].type!==HO.b&&Object(p.o)("First argument to data functions must be a string literal.");const r=t[0].value,o=":"+r;if(!Object(p.w)(o,i))try{i[o]=n.getData(r).tuplesRef()}catch(e){}}function VO(e,t,n,i){if(t[0].type===HO.b)GO(n,i,t[0].value);else for(e in n.scales)GO(n,i,e)}function GO(e,t,n){const i="%"+n;if(!Object(p.w)(t,i))try{t[i]=e.scaleRef(n)}catch(e){}}function KO(e,t){let n;return Object(p.E)(e)?e:Object(p.I)(e)?(n=t.scales[e])&&n.value:void 0}function YO(e,t,n){t.__bandwidth=e=>e&&e.bandwidth?e.bandwidth():0,n._bandwidth=VO,n._range=VO,n._scale=VO;const i=t=>"_["+(t.type===HO.b?Object(p.ab)("%"+t.value):Object(p.ab)("%")+"+"+e(t))+"]";return{_bandwidth:e=>`this.__bandwidth(${i(e[0])})`,_range:e=>i(e[0])+".range()",_scale:t=>`${i(t[0])}(${e(t[1])})`}}var XO,JO,QO,ZO,eC,tC=Bb(),nC=Bb(),iC={point:hy,lineStart:hy,lineEnd:hy,polygonStart:function(){tC.reset(),iC.lineStart=rC,iC.lineEnd=oC},polygonEnd:function(){var e=+tC;nC.add(e<0?Kb+e:e),this.lineStart=this.lineEnd=this.point=hy},sphere:function(){nC.add(Kb)}};function rC(){iC.point=sC}function oC(){aC(XO,JO)}function sC(e,t){iC.point=aC,XO=e,JO=t,QO=e*=Xb,ZO=ey(t=(t*=Xb)/2+Gb),eC=oy(t)}function aC(e,t){var n=(e*=Xb)-QO,i=n>=0?1:-1,r=i*n,o=ey(t=(t*=Xb)/2+Gb),s=oy(t),a=eC*s,l=ZO*o+a*ey(r),c=a*i*oy(r);tC.add(Zb(c,l)),QO=e,ZO=o,eC=s}var lC,cC,uC,hC,dC,fC,pC,gC,mC,vC,bC=Bb(),yC={point:wC,lineStart:_C,lineEnd:kC,polygonStart:function(){yC.point=SC,yC.lineStart=OC,yC.lineEnd=CC,bC.reset(),iC.polygonStart()},polygonEnd:function(){iC.polygonEnd(),yC.point=wC,yC.lineStart=_C,yC.lineEnd=kC,tC<0?(lC=-(uC=180),cC=-(hC=90)):bC>1e-6?hC=90:bC<-1e-6&&(cC=-90),vC[0]=lC,vC[1]=uC},sphere:function(){lC=-(uC=180),cC=-(hC=90)}};function wC(e,t){mC.push(vC=[lC=e,uC=e]),t<cC&&(cC=t),t>hC&&(hC=t)}function xC(e,t){var n=yw([e*Xb,t*Xb]);if(gC){var i=xw(gC,n),r=xw([i[1],-i[0],0],i);Sw(r),r=bw(r);var o,s=e-dC,a=s>0?1:-1,l=r[0]*Yb*a,c=Jb(s)>180;c^(a*dC<l&&l<a*e)?(o=r[1]*Yb)>hC&&(hC=o):c^(a*dC<(l=(l+360)%360-180)&&l<a*e)?(o=-r[1]*Yb)<cC&&(cC=o):(t<cC&&(cC=t),t>hC&&(hC=t)),c?e<dC?AC(lC,e)>AC(lC,uC)&&(uC=e):AC(e,uC)>AC(lC,uC)&&(lC=e):uC>=lC?(e<lC&&(lC=e),e>uC&&(uC=e)):e>dC?AC(lC,e)>AC(lC,uC)&&(uC=e):AC(e,uC)>AC(lC,uC)&&(lC=e)}else mC.push(vC=[lC=e,uC=e]);t<cC&&(cC=t),t>hC&&(hC=t),gC=n,dC=e}function _C(){yC.point=xC}function kC(){vC[0]=lC,vC[1]=uC,yC.point=wC,gC=null}function SC(e,t){if(gC){var n=e-dC;bC.add(Jb(n)>180?n+(n>0?360:-360):n)}else fC=e,pC=t;iC.point(e,t),xC(e,t)}function OC(){iC.lineStart()}function CC(){SC(fC,pC),iC.lineEnd(),Jb(bC)>1e-6&&(lC=-(uC=180)),vC[0]=lC,vC[1]=uC,gC=null}function AC(e,t){return(t-=e)<0?t+360:t}function $C(e,t){return e[0]-t[0]}function EC(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var MC,jC,RC,DC,TC,LC,FC,NC,PC,zC,IC,BC,WC,UC,HC,qC,VC={sphere:hy,point:GC,lineStart:YC,lineEnd:QC,polygonStart:function(){VC.lineStart=ZC,VC.lineEnd=eA},polygonEnd:function(){VC.lineStart=YC,VC.lineEnd=QC}};function GC(e,t){e*=Xb;var n=ey(t*=Xb);KC(n*ey(e),n*oy(e),oy(t))}function KC(e,t,n){++MC,RC+=(e-RC)/MC,DC+=(t-DC)/MC,TC+=(n-TC)/MC}function YC(){VC.point=XC}function XC(e,t){e*=Xb;var n=ey(t*=Xb);UC=n*ey(e),HC=n*oy(e),qC=oy(t),VC.point=JC,KC(UC,HC,qC)}function JC(e,t){e*=Xb;var n=ey(t*=Xb),i=n*ey(e),r=n*oy(e),o=oy(t),s=Zb(ay((s=HC*o-qC*r)*s+(s=qC*i-UC*o)*s+(s=UC*r-HC*i)*s),UC*i+HC*r+qC*o);jC+=s,LC+=s*(UC+(UC=i)),FC+=s*(HC+(HC=r)),NC+=s*(qC+(qC=o)),KC(UC,HC,qC)}function QC(){VC.point=GC}function ZC(){VC.point=tA}function eA(){nA(BC,WC),VC.point=GC}function tA(e,t){BC=e,WC=t,e*=Xb,t*=Xb,VC.point=nA;var n=ey(t);UC=n*ey(e),HC=n*oy(e),qC=oy(t),KC(UC,HC,qC)}function nA(e,t){e*=Xb;var n=ey(t*=Xb),i=n*ey(e),r=n*oy(e),o=oy(t),s=HC*o-qC*r,a=qC*i-UC*o,l=UC*r-HC*i,c=ay(s*s+a*a+l*l),u=uy(c),h=c&&-u/c;PC+=h*s,zC+=h*a,IC+=h*l,jC+=u,LC+=u*(UC+(UC=i)),FC+=u*(HC+(HC=r)),NC+=u*(qC+(qC=o)),KC(UC,HC,qC)}function iA(e,t){return function(n,i,r){if(n){const t=KO(n,(r||this).context);return t&&t.path[e](i)}return t(i)}}const rA=iA("area",(function(e){return nC.reset(),Ib(e,iC),2*nC})),oA=iA("bounds",(function(e){var t,n,i,r,o,s,a;if(hC=uC=-(lC=cC=1/0),mC=[],Ib(e,yC),n=mC.length){for(mC.sort($C),t=1,o=[i=mC[0]];t<n;++t)EC(i,(r=mC[t])[0])||EC(i,r[1])?(AC(i[0],r[1])>AC(i[0],i[1])&&(i[1]=r[1]),AC(r[0],i[1])>AC(i[0],i[1])&&(i[0]=r[0])):o.push(i=r);for(s=-1/0,t=0,i=o[n=o.length-1];t<=n;i=r,++t)r=o[t],(a=AC(i[1],r[0]))>s&&(s=a,lC=r[0],uC=i[1])}return mC=vC=null,lC===1/0||cC===1/0?[[NaN,NaN],[NaN,NaN]]:[[lC,cC],[uC,hC]]})),sA=iA("centroid",(function(e){MC=jC=RC=DC=TC=LC=FC=NC=PC=zC=IC=0,Ib(e,VC);var t=PC,n=zC,i=IC,r=t*t+n*n+i*i;return r<1e-12&&(t=LC,n=FC,i=NC,jC<1e-6&&(t=RC,n=DC,i=TC),(r=t*t+n*n+i*i)<1e-12)?[NaN,NaN]:[Zb(n,t)*Yb,uy(i/ay(r))*Yb]}));function aA(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(t){e.warn(t)}return n[n.length-1]}function lA(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function cA(e){const t=Af(e);return.2126*lA(t.r)+.7152*lA(t.g)+.0722*lA(t.b)}function uA(e,t){return e===t||e!=e&&t!=t||(Object(p.B)(e)?!(!Object(p.B)(t)||e.length!==t.length)&&function(e,t){for(let n=0,i=e.length;n<i;++n)if(!uA(e[n],t[n]))return!1;return!0}(e,t):!(!Object(p.G)(e)||!Object(p.G)(t))&&hA(e,t))}function hA(e,t){for(let n in e)if(!uA(e[n],t[n]))return!1;return!0}function dA(e){return t=>hA(e,t)}var fA=0;function pA(e){return e&&e.gradient}function gA(e,t,n){let i=e.id,r=e.gradient,o="radial"===r?"p_":"";return i||(i=e.id="gradient_"+fA++,"radial"===r?(e.x1=mA(e.x1,.5),e.y1=mA(e.y1,.5),e.r1=mA(e.r1,0),e.x2=mA(e.x2,.5),e.y2=mA(e.y2,.5),e.r2=mA(e.r2,.5),o="p_"):(e.x1=mA(e.x1,0),e.y1=mA(e.y1,0),e.x2=mA(e.x2,1),e.y2=mA(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+o+i+")"}function mA(e,t){return null!=e?e:t}const vA={basis:{curve:Oa},"basis-closed":{curve:$a},"basis-open":{curve:Ma},bundle:{curve:Ra,tension:"beta",value:.85},cardinal:{curve:La,tension:"tension",value:0},"cardinal-open":{curve:Na,tension:"tension",value:0},"cardinal-closed":{curve:za,tension:"tension",value:0},"catmull-rom":{curve:el,tension:"alpha",value:.5},"catmull-rom-closed":{curve:nl,tension:"alpha",value:.5},"catmull-rom-open":{curve:rl,tension:"alpha",value:.5},linear:{curve:sl},"linear-closed":{curve:ll},monotone:{horizontal:vl,vertical:ml},natural:{curve:wl},step:{curve:_l},"step-after":{curve:Sl},"step-before":{curve:kl}};function bA(e,t,n){var i=Object(p.w)(vA,e)&&vA[e],r=null;return i&&(r=i.curve||i[t||"vertical"],i.tension&&null!=n&&(r=r[i.tension](n))),r}const yA={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},wA=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];var xA=function(e){let t,n,i,r,o,s,a,l,c,u,h,d=[];for(t=e.slice().replace(wA[0],"###$1").split(wA[1]).slice(1),l=0,u=t.length;l<u;++l){for(n=t[l],i=n.slice(1).trim().replace(wA[2],"$1###$2").replace(wA[3],"$1###$2").split(wA[4]),s=n.charAt(0),r=[s],c=0,h=i.length;c<h;++c)(o=+i[c])===o&&r.push(o);if(a=yA[s.toLowerCase()],r.length-1>a){let e=1,t=r.length;for(d.push([s].concat(r.slice(e,e+=a))),s="M"===s?"L":"m"===s?"l":s;e<t;e+=a)d.push([s].concat(r.slice(e,e+a)))}else d.push(r)}return d};const _A=Math.PI/180,kA=Math.PI/2,SA=2*Math.PI,OA=Math.sqrt(3)/2;var CA={},AA={},$A=[].join;function EA(e){var t=$A.call(e);if(AA[t])return AA[t];var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=c*s,h=-l*a,d=l*s,f=c*a,p=Math.cos(r),g=Math.sin(r),m=Math.cos(o),v=Math.sin(o),b=.5*(o-r),y=Math.sin(.5*b),w=8/3*y*y/Math.sin(b),x=n+p-w*g,_=i+g+w*p,k=n+m,S=i+v,O=k+w*v,C=S-w*m;return AA[t]=[u*x+h*_,d*x+f*_,u*O+h*C,d*O+f*C,u*k+h*S,d*k+f*S]}var MA=["l",0,0,0,0,0,0,0];function jA(e,t,n){var i=MA[0]=e[0];if("a"===i||"A"===i)MA[1]=t*e[1],MA[2]=n*e[2],MA[3]=e[3],MA[4]=e[4],MA[5]=e[5],MA[6]=t*e[6],MA[7]=n*e[7];else if("h"===i||"H"===i)MA[1]=t*e[1];else if("v"===i||"V"===i)MA[1]=n*e[1];else for(var r=1,o=e.length;r<o;++r)MA[r]=(r%2==1?t:n)*e[r];return MA}var RA=function(e,t,n,i,r,o){var s,a,l,c,u,h=null,d=0,f=0,p=0,g=0;null==n&&(n=0),null==i&&(i=0),null==r&&(r=1),null==o&&(o=r),e.beginPath&&e.beginPath();for(var m=0,v=t.length;m<v;++m){switch(s=t[m],1===r&&1===o||(s=jA(s,r,o)),s[0]){case"l":d+=s[1],f+=s[2],e.lineTo(d+n,f+i);break;case"L":d=s[1],f=s[2],e.lineTo(d+n,f+i);break;case"h":d+=s[1],e.lineTo(d+n,f+i);break;case"H":d=s[1],e.lineTo(d+n,f+i);break;case"v":f+=s[1],e.lineTo(d+n,f+i);break;case"V":f=s[1],e.lineTo(d+n,f+i);break;case"m":d+=s[1],f+=s[2],e.moveTo(d+n,f+i);break;case"M":d=s[1],f=s[2],e.moveTo(d+n,f+i);break;case"c":a=d+s[5],l=f+s[6],p=d+s[3],g=f+s[4],e.bezierCurveTo(d+s[1]+n,f+s[2]+i,p+n,g+i,a+n,l+i),d=a,f=l;break;case"C":d=s[5],f=s[6],p=s[3],g=s[4],e.bezierCurveTo(s[1]+n,s[2]+i,p+n,g+i,d+n,f+i);break;case"s":a=d+s[3],l=f+s[4],p=2*d-p,g=2*f-g,e.bezierCurveTo(p+n,g+i,d+s[1]+n,f+s[2]+i,a+n,l+i),p=d+s[1],g=f+s[2],d=a,f=l;break;case"S":a=s[3],l=s[4],p=2*d-p,g=2*f-g,e.bezierCurveTo(p+n,g+i,s[1]+n,s[2]+i,a+n,l+i),d=a,f=l,p=s[1],g=s[2];break;case"q":a=d+s[3],l=f+s[4],p=d+s[1],g=f+s[2],e.quadraticCurveTo(p+n,g+i,a+n,l+i),d=a,f=l;break;case"Q":a=s[3],l=s[4],e.quadraticCurveTo(s[1]+n,s[2]+i,a+n,l+i),d=a,f=l,p=s[1],g=s[2];break;case"t":a=d+s[1],l=f+s[2],null===h[0].match(/[QqTt]/)?(p=d,g=f):"t"===h[0]?(p=2*d-c,g=2*f-u):"q"===h[0]&&(p=2*d-p,g=2*f-g),c=p,u=g,e.quadraticCurveTo(p+n,g+i,a+n,l+i),f=l,p=(d=a)+s[1],g=f+s[2];break;case"T":a=s[1],l=s[2],p=2*d-p,g=2*f-g,e.quadraticCurveTo(p+n,g+i,a+n,l+i),d=a,f=l;break;case"a":DA(e,d+n,f+i,[s[1],s[2],s[3],s[4],s[5],s[6]+d+n,s[7]+f+i]),d+=s[6],f+=s[7];break;case"A":DA(e,d+n,f+i,[s[1],s[2],s[3],s[4],s[5],s[6]+n,s[7]+i]),d=s[6],f=s[7];break;case"z":case"Z":e.closePath()}h=s}};function DA(e,t,n,i){for(var r=function(e,t,n,i,r,o,s,a,l){var c=$A.call(arguments);if(CA[c])return CA[c];var u=s*_A,h=Math.sin(u),d=Math.cos(u),f=d*(a-e)*.5+h*(l-t)*.5,p=d*(l-t)*.5-h*(a-e)*.5,g=f*f/((n=Math.abs(n))*n)+p*p/((i=Math.abs(i))*i);g>1&&(n*=g=Math.sqrt(g),i*=g);var m=d/n,v=h/n,b=-h/i,y=d/i,w=m*a+v*l,x=b*a+y*l,_=m*e+v*t,k=b*e+y*t,S=(_-w)*(_-w)+(k-x)*(k-x),O=1/S-.25;O<0&&(O=0);var C=Math.sqrt(O);o==r&&(C=-C);var A=.5*(w+_)-C*(k-x),$=.5*(x+k)+C*(_-w),E=Math.atan2(x-$,w-A),M=Math.atan2(k-$,_-A),j=M-E;j<0&&1===o?j+=SA:j>0&&0===o&&(j-=SA);for(var R=Math.ceil(Math.abs(j/(kA+.001))),D=[],T=0;T<R;++T){var L=E+T*j/R,F=E+(T+1)*j/R;D[T]=[A,$,L,F,n,i,h,d]}return CA[c]=D}(i[5],i[6],i[0],i[1],i[3],i[4],i[2],t,n),o=0;o<r.length;++o){var s=EA(r[o]);e.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5])}}var TA={circle:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,SA)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/2.5;e.moveTo(-n,-i),e.lineTo(-n,i),e.lineTo(-i,i),e.lineTo(-i,n),e.lineTo(i,n),e.lineTo(i,i),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(i,-i),e.lineTo(i,-n),e.lineTo(-i,-n),e.lineTo(-i,-i),e.closePath()}},diamond:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),i=-n/2;e.rect(i,i,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/7,r=n/2.5,o=n/8;e.moveTo(-i,n),e.lineTo(i,n),e.lineTo(i,-o),e.lineTo(r,-o),e.lineTo(0,-n),e.lineTo(-r,-o),e.lineTo(-i,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,i=OA*n,r=i-.5773502691896257*n,o=n/4;e.moveTo(0,-i-r),e.lineTo(-o,i-r),e.lineTo(o,i-r),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,i=OA*n,r=i-.5773502691896257*n;e.moveTo(0,-i-r),e.lineTo(-n,i-r),e.lineTo(n,i-r),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,i=OA*n;e.moveTo(0,-i),e.lineTo(-n,i),e.lineTo(n,i),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,i=OA*n;e.moveTo(0,i),e.lineTo(-n,-i),e.lineTo(n,-i),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,i=OA*n;e.moveTo(i,0),e.lineTo(-i,-n),e.lineTo(-i,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,i=OA*n;e.moveTo(-i,0),e.lineTo(i,-n),e.lineTo(i,n),e.closePath()}},stroke:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function LA(e){return Object(p.w)(TA,e)?TA[e]:function(e){if(!Object(p.w)(FA,e)){var t=xA(e);FA[e]={draw:function(e,n){RA(e,t,0,0,Math.sqrt(n)/2)}}}return FA[e]}(e)}var FA={};function NA(e){return e.x}function PA(e){return e.y}function zA(e){return e.width}function IA(e){return e.height}function BA(e){return"function"==typeof e?e:()=>+e}function WA(e,t,n){return Math.max(t,Math.min(e,n))}function UA(e,t){return null!=e?e:t}const HA=e=>e.x||0,qA=e=>e.y||0,VA=e=>!(!1===e.defined),GA=gc().startAngle(e=>e.startAngle||0).endAngle(e=>e.endAngle||0).padAngle(e=>e.padAngle||0).innerRadius(e=>e.innerRadius||0).outerRadius(e=>e.outerRadius||0).cornerRadius(e=>e.cornerRadius||0),KA=yc().x(HA).y1(qA).y0(e=>(e.y||0)+(e.height||0)).defined(VA),YA=yc().y(qA).x1(HA).x0(e=>(e.x||0)+(e.width||0)).defined(VA),XA=bc().x(HA).y(qA).defined(VA),JA=function(){var e=NA,t=PA,n=zA,i=IA,r=BA(0),o=r,s=r,a=r,l=null;function c(c,u,h){var d,f=null!=u?u:+e.call(this,c),p=null!=h?h:+t.call(this,c),g=+n.call(this,c),m=+i.call(this,c),v=Math.min(g,m)/2,b=WA(+r.call(this,c),0,v),y=WA(+o.call(this,c),0,v),w=WA(+s.call(this,c),0,v),x=WA(+a.call(this,c),0,v);if(l||(l=d=Jl()),b<=0&&y<=0&&w<=0&&x<=0)l.rect(f,p,g,m);else{var _=f+g,k=p+m;l.moveTo(f+b,p),l.lineTo(_-y,p),l.bezierCurveTo(_-.448084975506*y,p,_,p+.448084975506*y,_,p+y),l.lineTo(_,k-x),l.bezierCurveTo(_,k-.448084975506*x,_-.448084975506*x,k,_-x,k),l.lineTo(f+w,k),l.bezierCurveTo(f+.448084975506*w,k,f,k-.448084975506*w,f,k-w),l.lineTo(f,p+b),l.bezierCurveTo(f,p+.448084975506*b,f+.448084975506*b,p,f+b,p),l.closePath()}if(d)return l=null,d+""||null}return c.x=function(t){return arguments.length?(e=BA(t),c):e},c.y=function(e){return arguments.length?(t=BA(e),c):t},c.width=function(e){return arguments.length?(n=BA(e),c):n},c.height=function(e){return arguments.length?(i=BA(e),c):i},c.cornerRadius=function(e,t,n,i){return arguments.length?(r=BA(e),o=null!=t?BA(t):r,a=null!=n?BA(n):r,s=null!=i?BA(i):o,c):r},c.context=function(e){return arguments.length?(l=null==e?null:e,c):l},c}().x(HA).y(qA).width(e=>e.width||0).height(e=>e.height||0).cornerRadius(e=>UA(e.cornerRadiusTopLeft,e.cornerRadius)||0,e=>UA(e.cornerRadiusTopRight,e.cornerRadius)||0,e=>UA(e.cornerRadiusBottomRight,e.cornerRadius)||0,e=>UA(e.cornerRadiusBottomLeft,e.cornerRadius)||0),QA=_c().type(e=>LA(e.shape||"circle")).size(e=>UA(e.size,64)),ZA=function(){var e,t,n,i,r,o,s,a,l=null;function c(e,t,n){var i=n/2;if(r){var c=s-t,u=e-o;if(c||u){var h=Math.sqrt(c*c+u*u),d=(c/=h)*a,f=(u/=h)*a,p=Math.atan2(u,c);l.moveTo(o-d,s-f),l.lineTo(e-c*i,t-u*i),l.arc(e,t,i,p-Math.PI,p),l.lineTo(o+d,s+f),l.arc(o,s,a,p,p+Math.PI)}else l.arc(e,t,i,0,SA);l.closePath()}else r=1;o=e,s=t,a=i}function u(o){var s,a,u,h=o.length,d=!1;for(null==l&&(l=u=Jl()),s=0;s<=h;++s)!(s<h&&i(a=o[s],s,o))===d&&(d=!d)&&(r=0),d&&c(+e(a,s,o),+t(a,s,o),+n(a,s,o));if(u)return l=null,u+""||null}return u.x=function(t){return arguments.length?(e=t,u):e},u.y=function(e){return arguments.length?(t=e,u):t},u.size=function(e){return arguments.length?(n=e,u):n},u.defined=function(e){return arguments.length?(i=e,u):i},u.context=function(e){return arguments.length?(l=null==e?null:e,u):l},u}().x(HA).y(qA).defined(VA).size(e=>e.size||1);function e$(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function t$(e,t,n,i){return JA.context(e)(t,n,i)}var n$=1;var i$=function(e,t,n){var i=t.clip,r=e._defs,o=t.clip_id||(t.clip_id="clip"+n$++),s=r.clipping[o]||(r.clipping[o]={id:o});return Object(p.E)(i)?s.path=i(null):e$(n)?s.path=t$(null,n,0,0):(s.width=n.width||0,s.height=n.height||0),"url(#"+o+")"};function r$(e){this.clear(),e&&this.union(e)}function o$(e){this.mark=e,this.bounds=this.bounds||new r$}function s$(e){o$.call(this,e),this.items=this.items||[]}r$.prototype={clone(){return new r$(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const i=this.rotatedPoints(e,t,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(e,t,n){var{x1:i,y1:r,x2:o,y2:s}=this,a=Math.cos(e),l=Math.sin(e),c=t-t*a+n*l,u=n-t*l-n*a;return[a*i-l*r+c,l*i+a*r+u,a*i-l*s+c,l*i+a*s+u,a*o-l*r+c,l*o+a*r+u,a*o-l*s+c,l*o+a*s+u]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},Object(p.z)(s$,o$);const a$=/^([A-Za-z]+:)?\/\//,l$=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,c$=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g;async function u$(e,t){const n=await this.sanitize(e,t),i=n.href;return n.localFile?this.file(i):this.http(i,t)}async function h$(e,t){t=Object(p.p)({},this.options,t);const n=this.fileAccess,i={href:null};let r,o,s;const a=l$.test(e.replace(c$,""));null!=e&&"string"==typeof e&&a||Object(p.o)("Sanitize failure, invalid URI: "+Object(p.ab)(e));const l=a$.test(e);return(s=t.baseURL)&&!l&&(e.startsWith("/")||"/"===s[s.length-1]||(e="/"+e),e=s+e),o=(r=e.startsWith("file://"))||"file"===t.mode||"http"!==t.mode&&!l&&n,r?e=e.slice("file://".length):e.startsWith("//")&&("file"===t.defaultProtocol?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(i,"localFile",{value:!!o}),i.href=e,t.target&&(i.target=t.target+""),t.rel&&(i.rel=t.rel+""),"image"===t.context&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin+""),i}function d$(e){return e?t=>new Promise((n,i)=>{e.readFile(t,(e,t)=>{e?i(e):n(t)})}):f$}async function f$(){Object(p.o)("No file system access.")}function p$(e){return e?async function(t,n){const i=Object(p.p)({},this.options.http,n),r=n&&n.response,o=await e(t,i);return o.ok?Object(p.E)(o[r])?o[r]():o.text():Object(p.o)(o.status+""+o.statusText)}:g$}async function g$(){Object(p.o)("No HTTP fetch method available.")}p.bb,p.db,p.db,p.cb,p.fb,p.y;function m$(e){const t=function(t,n){const i={delimiter:e};return v$(t,n?Object(p.p)(n,i):i)};return t.responseType="text",t}function v$(e,t){return t.header&&(e=t.header.map(p.ab).join(t.delimiter)+"\n"+e),ie(t.delimiter).parse(e+"")}v$.responseType="text";var b$=n(28);const y$={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function w$(e,t){let n,i,r,o;return e=Object(b$.a)(e,t),t&&t.feature?(n=ce,r=t.feature):t&&t.mesh?(n=fe,r=t.mesh,o=y$[t.filter]):Object(p.o)("Missing TopoJSON feature or mesh parameter."),i=(i=e.objects[r])?n(e,i,o):Object(p.o)("Invalid TopoJSON object: "+r),i&&i.features||[i]}w$.responseType="json";m$(","),m$("\t"),b$.a;var x$=function(e,t){return n=>({options:n||{},sanitize:h$,load:u$,fileAccess:!!t,file:d$(t),http:p$(e)})}("undefined"!=typeof fetch&&fetch,null);function _$(e){this._pending=0,this._loader=e||x$()}function k$(e){e._pending+=1}function S$(e){e._pending-=1}_$.prototype={pending(){return this._pending},sanitizeURL(e){var t=this;return k$(t),t._loader.sanitize(e,{context:"href"}).then((function(e){return S$(t),e})).catch((function(){return S$(t),null}))},loadImage(e){const t=this,n=Uc();return k$(t),t._loader.sanitize(e,{context:"image"}).then((function(e){const i=e.href;if(!i||!n)throw{url:i};const r=new n,o=Object(p.w)(e,"crossOrigin")?e.crossOrigin:"anonymous";return null!=o&&(r.crossOrigin=o),r.onload=()=>S$(t),r.onerror=()=>S$(t),r.src=i,r})).catch((function(e){return S$(t),{complete:!1,width:0,height:0,src:e&&e.url||""}}))},ready(){var e=this;return new Promise((function(t){!function n(i){e.pending()?setTimeout((function(){n(!0)}),10):t(i)}(!1)}))}};var O$=function(e,t,n){if(t.stroke&&0!==t.opacity&&0!==t.strokeOpacity){const i=null!=t.strokeWidth?+t.strokeWidth:1;e.expand(i+(n?function(e,t){return e.strokeJoin&&"miter"!==e.strokeJoin?0:t}(t,i):0))}return e};const C$=SA-1e-8;let A$,$$,E$,M$,j$,R$,D$,T$;const L$=(e,t)=>A$.add(e,t),F$=(e,t)=>L$($$=e,E$=t),N$=e=>L$(e,A$.y1),P$=e=>L$(A$.x1,e),z$=(e,t)=>j$*e+D$*t,I$=(e,t)=>R$*e+T$*t,B$=(e,t)=>L$(z$(e,t),I$(e,t)),W$=(e,t)=>F$(z$(e,t),I$(e,t));var U$=function(e,t){return A$=e,t?(M$=t*_A,j$=T$=Math.cos(M$),R$=Math.sin(M$),D$=-R$):(j$=T$=1,M$=R$=D$=0),H$};const H$={beginPath(){},closePath(){},moveTo:W$,lineTo:W$,rect(e,t,n,i){M$?(B$(e+n,t),B$(e+n,t+i),B$(e,t+i),W$(e,t)):(L$(e+n,t+i),F$(e,t))},quadraticCurveTo(e,t,n,i){const r=z$(e,t),o=I$(e,t),s=z$(n,i),a=I$(n,i);q$($$,r,s,N$),q$(E$,o,a,P$),F$(s,a)},bezierCurveTo(e,t,n,i,r,o){const s=z$(e,t),a=I$(e,t),l=z$(n,i),c=I$(n,i),u=z$(r,o),h=I$(r,o);V$($$,s,l,u,N$),V$(E$,a,c,h,P$),F$(u,h)},arc(e,t,n,i,r,o){if(i+=M$,r+=M$,$$=n*Math.cos(r)+e,E$=n*Math.sin(r)+t,Math.abs(r-i)>C$)L$(e-n,t-n),L$(e+n,t+n);else{const s=i=>L$(n*Math.cos(i)+e,n*Math.sin(i)+t);let a,l;if(s(i),s(r),r!==i)if((i%=SA)<0&&(i+=SA),(r%=SA)<0&&(r+=SA),r<i&&(o=!o,a=i,i=r,r=a),o)for(r-=SA,a=i-i%kA,l=0;l<4&&a>r;++l,a-=kA)s(a);else for(a=i-i%kA+kA,l=0;l<4&&a<r;++l,a+=kA)s(a)}}};function q$(e,t,n,i){const r=(e-t)/(e+n-2*t);0<r&&r<1&&i(e+(t-e)*r)}function V$(e,t,n,i,r){const o=i-e+3*t-3*n,s=e+n-2*t,a=e-t;let l,c=0,u=0;Math.abs(o)>1e-14?(l=s*s+a*o,l>=0&&(l=Math.sqrt(l),c=(-s+l)/o,u=(-s-l)/o)):c=.5*a/s,0<c&&c<1&&r(G$(c,e,t,n,i)),0<u&&u<1&&r(G$(u,e,t,n,i))}function G$(e,t,n,i,r){const o=1-e,s=o*o,a=e*e;return s*o*t+3*s*e*n+3*o*a*i+a*e*r}var K$=(K$=Wc(1,1))?K$.getContext("2d"):null;const Y$=new r$;function X$(e){return function(t,n){if(!K$)return!0;e(K$,t),Y$.clear().union(t.bounds).intersect(n).round();const{x1:i,y1:r,x2:o,y2:s}=Y$;for(let e=r;e<=s;++e)for(let t=i;t<=o;++t)if(K$.isPointInPath(t,e))return!0;return!1}}function J$(e,t){return t.contains(e.x||0,e.y||0)}function Q$(e,t){const n=e.x||0,i=e.y||0,r=e.width||0,o=e.height||0;return t.intersects(Y$.set(n,i,n+r,i+o))}function Z$(e,t,n,i,r){const{x1:o,y1:s,x2:a,y2:l}=e,c=i-t,u=r-n;let h,d,f,p,g=0,m=1;for(p=0;p<4;++p){if(0===p&&(h=-c,d=-(o-t)),1===p&&(h=c,d=a-t),2===p&&(h=-u,d=-(s-n)),3===p&&(h=u,d=l-n),Math.abs(h)<1e-10&&d<0)return!1;if(f=d/h,h<0){if(f>m)return!1;f>g&&(g=f)}else if(h>0){if(f<g)return!1;f<m&&(m=f)}}return!0}var eE=function(e,t){e.globalCompositeOperation=t.blend||"source-over"},tE=function(e,t){return null==e?t:e};function nE(e,t){const n=t.length;for(let i=0;i<n;++i)e.addColorStop(t[i].offset,t[i].color);return e}var iE=function(e,t,n){return pA(n)?function(e,t,n){const i=n.width(),r=n.height();let o;if("radial"===t.gradient)o=e.createRadialGradient(n.x1+tE(t.x1,.5)*i,n.y1+tE(t.y1,.5)*r,Math.max(i,r)*tE(t.r1,0),n.x1+tE(t.x2,.5)*i,n.y1+tE(t.y2,.5)*r,Math.max(i,r)*tE(t.r2,.5));else{const s=tE(t.x1,0),a=tE(t.y1,0),l=tE(t.x2,1),c=tE(t.y2,0);if(s!==l&&a!==c&&i!==r){const n=Wc(Math.ceil(i),Math.ceil(r)),o=n.getContext("2d");return o.scale(i,r),o.fillStyle=nE(o.createLinearGradient(s,a,l,c),t.stops),o.fillRect(0,0,i,r),e.createPattern(n,"no-repeat")}o=e.createLinearGradient(n.x1+s*i,n.y1+a*r,n.x1+l*i,n.y1+c*r)}return nE(o,t.stops)}(e,n,t.bounds):n},rE=function(e,t,n){return(n*=null==t.fillOpacity?1:t.fillOpacity)>0&&(e.globalAlpha=n,e.fillStyle=iE(e,t,t.fill),!0)},oE=[],sE=function(e,t,n){var i=null!=(i=t.strokeWidth)?i:1;return!(i<=0)&&((n*=null==t.strokeOpacity?1:t.strokeOpacity)>0&&(e.globalAlpha=n,e.strokeStyle=iE(e,t,t.stroke),e.lineWidth=i,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||oE),e.lineDashOffset=t.strokeDashOffset||0),!0))};function aE(e,t){return e.zindex-t.zindex||e.index-t.index}function lE(e){if(!e.zdirty)return e.zitems;var t,n,i,r=e.items,o=[];for(n=0,i=r.length;n<i;++n)(t=r[n]).index=n,t.zindex&&o.push(t);return e.zdirty=!1,e.zitems=o.sort(aE)}function cE(e,t){var n,i,r=e.items;if(r&&r.length){var o=lE(e);if(o&&o.length){for(n=0,i=r.length;n<i;++n)r[n].zindex||t(r[n]);r=o}for(n=0,i=r.length;n<i;++n)t(r[n])}}function uE(e,t){var n,i,r=e.items;if(!r||!r.length)return null;var o=lE(e);for(o&&o.length&&(r=o),i=r.length;--i>=0;)if(n=t(r[i]))return n;if(r===o)for(i=(r=e.items).length;--i>=0;)if(!r[i].zindex&&(n=t(r[i])))return n;return null}function hE(e){return function(t,n,i){cE(n,(function(n){i&&!i.intersects(n.bounds)||dE(e,t,n,n)}))}}function dE(e,t,n,i){var r=null==n.opacity?1:n.opacity;0!==r&&(e(t,i)||(eE(t,n),n.fill&&rE(t,n,r)&&t.fill(),n.stroke&&sE(t,n,r)&&t.stroke()))}function fE(e){return e=e||p.hb,function(t,n,i,r,o,s){return i*=t.pixelRatio,r*=t.pixelRatio,uE(n,(function(n){var a=n.bounds;if((!a||a.contains(o,s))&&a)return e(t,n,i,r,o,s)?n:void 0}))}}function pE(e,t){return function(n,i,r,o){var s,a,l=Array.isArray(i)?i[0]:i,c=null==t?l.fill:t,u=l.stroke&&n.isPointInStroke;return u&&(s=l.strokeWidth,a=l.strokeCap,n.lineWidth=null!=s?s:1,n.lineCap=null!=a?a:"butt"),!e(n,i)&&(c&&n.isPointInPath(r,o)||u&&n.isPointInStroke(r,o))}}function gE(e){return fE(pE(e))}function mE(e,t){return"translate("+e+","+t+")"}function vE(e){return"rotate("+e+")"}function bE(e){return mE(e.x||0,e.y||0)}var yE=function(e,t,n){function i(e,n){var i=n.x||0,r=n.y||0,o=n.angle||0;e.translate(i,r),o&&e.rotate(o*=_A),e.beginPath(),t(e,n),o&&e.rotate(-o),e.translate(-i,-r)}return{type:e,tag:"path",nested:!1,attr:function(e,n){e("transform",function(e){return mE(e.x||0,e.y||0)+(e.angle?" "+vE(e.angle):"")}(n)),e("d",t(null,n))},bound:function(e,n){return t(U$(e,n.angle),n),O$(e,n).translate(n.x||0,n.y||0)},draw:hE(i),pick:gE(i),isect:n||X$(i)}},wE=yE("arc",(function(e,t){return GA.context(e)(t)}));var xE=function(e,t,n){function i(e,n){e.beginPath(),t(e,n)}var r,o=pE(i);return{type:e,tag:"path",nested:!0,attr:function(e,n){var i=n.mark.items;i.length&&e("d",t(null,i))},bound:function(e,n){var i=n.items;return 0===i.length?e:(t(U$(e),i),O$(e,i[0]))},draw:(r=i,function(e,t,n){!t.items.length||n&&!n.intersects(t.bounds)||dE(r,e,t.items[0],t.items)}),pick:function(e,t,n,i,r,s){var a=t.items,l=t.bounds;return!a||!a.length||l&&!l.contains(r,s)?null:(n*=e.pixelRatio,i*=e.pixelRatio,o(e,a,n,i)?a[0]:null)},isect:J$,tip:n}},_E=xE("area",(function(e,t){const n=t[0],i=n.interpolate||"linear";return("horizontal"===n.orient?YA:KA).curve(bA(i,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,i,r="horizontal"===e[0].orient?t[1]:t[0],o="horizontal"===e[0].orient?"y":"x",s=e.length,a=1/0;--s>=0;)!1!==e[s].defined&&(i=Math.abs(e[s][o]-r))<a&&(a=i,n=e[s]);return n}));function kE(e,t){e.beginPath(),e$(t)?t$(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function SE(e){const t=tE(e.strokeWidth,1);return null!=e.strokeOffset?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function OE(e,t){const n=SE(t);e("d",t$(null,t,n,n))}function CE(e,t,n,i){const r=SE(t);e.beginPath(),t$(e,t,(n||0)+r,(i||0)+r)}const AE=pE(CE),$E=pE(CE,!1),EE=pE(CE,!0);var ME={type:"group",tag:"g",nested:!1,attr:function(e,t){e("transform",bE(t))},bound:function(e,t){if(!t.clip&&t.items){const n=t.items,i=n.length;for(let t=0;t<i;++t)e.union(n[t].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),O$(e,t),e.translate(t.x||0,t.y||0)},draw:function(e,t,n){cE(t,t=>{const i=t.x||0,r=t.y||0,o=t.strokeForeground,s=null==t.opacity?1:t.opacity;(t.stroke||t.fill)&&s&&(CE(e,t,i,r),eE(e,t),t.fill&&rE(e,t,s)&&e.fill(),t.stroke&&!o&&sE(e,t,s)&&e.stroke()),e.save(),e.translate(i,r),t.clip&&kE(e,t),n&&n.translate(-i,-r),cE(t,t=>{this.draw(e,t,n)}),n&&n.translate(i,r),e.restore(),o&&t.stroke&&s&&(CE(e,t,i,r),eE(e,t),sE(e,t,s)&&e.stroke())})},pick:function(e,t,n,i,r,o){if(t.bounds&&!t.bounds.contains(r,o)||!t.items)return null;const s=n*e.pixelRatio,a=i*e.pixelRatio;return uE(t,l=>{let c,u,h,d,f,p,g,m,v;if(m=l.bounds,(!m||m.contains(r,o))&&(d=l.x||0,f=l.y||0,p=d+(l.width||0),g=f+(l.height||0),v=l.clip,!v||!(r<d||r>p||o<f||o>g)))return e.save(),e.translate(d,f),d=r-d,f=o-f,v&&e$(l)&&!EE(e,l,s,a)?(e.restore(),null):(u=l.strokeForeground,h=!1!==t.interactive,h&&u&&l.stroke&&$E(e,l,s,a)?(e.restore(),l):(c=uE(l,e=>function(e,t,n){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}(e,d,f)?this.pick(e,n,i,d,f):null),!c&&h&&(l.fill||!u&&l.stroke)&&AE(e,l,s,a)&&(c=l),e.restore(),c||null))})},isect:Q$,content:function(e,t,n){e("clip-path",t.clip?i$(n,t,t):null)},background:function(e,t){e("class","background"),e("aria-hidden",!0),OE(e,t)},foreground:function(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?OE(e,t):e("d","")}},jE={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function RE(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(t=>{e.image=t,e.image.url=e.url})),n}function DE(e,t){return null!=e.width?e.width:t&&t.width?!1!==e.aspect&&e.height?e.height*t.width/t.height:t.width:0}function TE(e,t){return null!=e.height?e.height:t&&t.height?!1!==e.aspect&&e.width?e.width*t.height/t.width:t.height:0}function LE(e,t){return"center"===e?t/2:"right"===e?t:0}function FE(e,t){return"middle"===e?t/2:"bottom"===e?t:0}var NE={type:"image",tag:"image",nested:!1,attr:function(e,t,n){const i=RE(t,n),r=DE(t,i),o=TE(t,i),s=(t.x||0)-LE(t.align,r),a=(t.y||0)-FE(t.baseline,o);e("href",!i.src&&i.toDataURL?i.toDataURL():i.src||"",jE["xmlns:xlink"],"xlink:href"),e("transform",mE(s,a)),e("width",r),e("height",o),e("preserveAspectRatio",!1===t.aspect?"none":"xMidYMid")},bound:function(e,t){const n=t.image,i=DE(t,n),r=TE(t,n),o=(t.x||0)-LE(t.align,i),s=(t.y||0)-FE(t.baseline,r);return e.set(o,s,o+i,s+r)},draw:function(e,t,n){cE(t,t=>{if(n&&!n.intersects(t.bounds))return;let i,r,o,s,a=RE(t,this),l=DE(t,a),c=TE(t,a),u=(t.x||0)-LE(t.align,l),h=(t.y||0)-FE(t.baseline,c);!1!==t.aspect&&(r=a.width/a.height,o=t.width/t.height,r==r&&o==o&&r!==o&&(o<r?(s=l/r,h+=(c-s)/2,c=s):(s=c*r,u+=(l-s)/2,l=s))),(a.complete||a.toDataURL)&&(eE(e,t),e.globalAlpha=null!=(i=t.opacity)?i:1,e.imageSmoothingEnabled=!1!==t.smooth,e.drawImage(a,u,h,l,c))})},pick:fE(),isect:p.hb,get:RE,xOffset:LE,yOffset:FE},PE=xE("line",(function(e,t){const n=t[0],i=n.interpolate||"linear";return XA.curve(bA(i,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,i,r=Math.pow(e[0].strokeWidth||1,2),o=e.length;--o>=0;)if(!1!==e[o].defined&&(n=e[o].x-t[0])*n+(i=e[o].y-t[1])*i<r)return e[o];return null}));function zE(e,t){var n=t.path;if(null==n)return!0;var i=t.x||0,r=t.y||0,o=t.scaleX||1,s=t.scaleY||1,a=(t.angle||0)*_A,l=t.pathCache;l&&l.path===n||((t.pathCache=l=xA(n)).path=n),a&&e.rotate&&e.translate?(e.translate(i,r),e.rotate(a),RA(e,l,0,0,o,s),e.rotate(-a),e.translate(-i,-r)):RA(e,l,i,r,o,s)}var IE={type:"path",tag:"path",nested:!1,attr:function(e,t){var n=t.scaleX||1,i=t.scaleY||1;1===n&&1===i||e("vector-effect","non-scaling-stroke"),e("transform",function(e){return mE(e.x||0,e.y||0)+(e.angle?" "+vE(e.angle):"")+(e.scaleX||e.scaleY?" "+(t=e.scaleX||1,n=e.scaleY||1,"scale("+t+","+n+")"):"");var t,n}(t)),e("d",t.path)},bound:function(e,t){return zE(U$(e,t.angle),t)?e.set(0,0,0,0):O$(e,t,!0)},draw:hE(zE),pick:gE(zE),isect:X$(zE)};function BE(e,t){e.beginPath(),t$(e,t)}var WE={type:"rect",tag:"path",nested:!1,attr:function(e,t){e("d",t$(null,t))},bound:function(e,t){var n,i;return O$(e.set(n=t.x||0,i=t.y||0,n+t.width||0,i+t.height||0),t)},draw:hE(BE),pick:gE(BE),isect:Q$};function UE(e,t,n){var i,r,o,s;return!(!t.stroke||!sE(e,t,n))&&(i=t.x||0,r=t.y||0,o=null!=t.x2?t.x2:i,s=null!=t.y2?t.y2:r,e.beginPath(),e.moveTo(i,r),e.lineTo(o,s),!0)}var HE={type:"rule",tag:"line",nested:!1,attr:function(e,t){e("transform",bE(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)},bound:function(e,t){var n,i;return O$(e.set(n=t.x||0,i=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:i),t)},draw:function(e,t,n){cE(t,(function(t){if(!n||n.intersects(t.bounds)){var i=null==t.opacity?1:t.opacity;i&&UE(e,t,i)&&(eE(e,t),e.stroke())}}))},pick:fE((function(e,t,n,i){return!!e.isPointInStroke&&(UE(e,t,1)&&e.isPointInStroke(n,i))})),isect:function(e,t){const n=e.x||0,i=e.y||0;return Z$(t,n,i,null!=e.x2?e.x2:n,null!=e.y2?e.y2:i)}},qE=yE("shape",(function(e,t){return(t.mark.shape||t.shape).context(e)(t)})),VE=yE("symbol",(function(e,t){return QA.context(e)(t)}),J$);const GE=Object(p.M)();var KE={height:eM,measureWidth:QE,estimateWidth:XE,width:XE,canvas:YE};function YE(e){KE.width=e&&K$?QE:XE}function XE(e,t){return JE(iM(e,t),eM(e))}function JE(e,t){return~~(.8*e.length*t)}function QE(e,t){return eM(e)<=0||!(t=iM(e,t))?0:ZE(t,oM(e))}function ZE(e,t){const n=`(${t}) ${e}`;let i=GE.get(n);return void 0===i&&(K$.font=t,i=K$.measureText(e).width,GE.set(n,i)),i}function eM(e){return null!=e.fontSize?+e.fontSize||0:11}function tM(e){return null!=e.lineHeight?e.lineHeight:eM(e)+2}function nM(e){return t=e.lineBreak&&e.text&&!Object(p.B)(e.text)?e.text.split(e.lineBreak):e.text,Object(p.B)(t)?t.length>1?t:t[0]:t;var t}function iM(e,t){const n=null==t?"":(t+"").trim();return e.limit>0&&n.length?function(e,t){var n=+e.limit,i=function(e){if(KE.width===QE){const t=oM(e);return e=>ZE(e,t)}{const t=eM(e);return e=>JE(e,t)}}(e);if(i(t)<n)return t;var r,o=e.ellipsis||"â€¦",s="rtl"===e.dir,a=0,l=t.length;if(n-=i(o),s){for(;a<l;)r=a+l>>>1,i(t.slice(r))>n?a=r+1:l=r;return o+t.slice(a)}for(;a<l;)r=1+(a+l>>>1),i(t.slice(0,r))<n?a=r:l=r-1;return t.slice(0,a)+o}(e,n):n}function rM(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function oM(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+eM(e)+"px "+rM(e,t)}function sM(e){var t=e.baseline,n=eM(e);return Math.round("top"===t?.79*n:"middle"===t?.3*n:"bottom"===t?-.21*n:"line-top"===t?.29*n+.5*tM(e):"line-bottom"===t?.29*n-.5*tM(e):0)}YE(!0);var aM={left:"start",center:"middle",right:"end"},lM=new r$;function cM(e){var t,n=e.x||0,i=e.y||0,r=e.radius||0;return r&&(t=(e.theta||0)-kA,n+=r*Math.cos(t),i+=r*Math.sin(t)),lM.x1=n,lM.y1=i,lM}function uM(e,t,n){var i,r=KE.height(t),o=t.align,s=cM(t),a=s.x1,l=s.y1,c=t.dx||0,u=(t.dy||0)+sM(t)-Math.round(.8*r),h=nM(t);if(Object(p.B)(h)?(r+=tM(t)*(h.length-1),i=h.reduce((e,n)=>Math.max(e,KE.width(t,n)),0)):i=KE.width(t,h),"center"===o?c-=i/2:"right"===o&&(c-=i),e.set(c+=a,u+=l,c+i,u+r),t.angle&&!n)e.rotate(t.angle*_A,a,l);else if(2===n)return e.rotatedPoints(t.angle*_A,a,l);return e}var hM={arc:wE,area:_E,group:ME,image:NE,line:PE,path:IE,rect:WE,rule:HE,shape:qE,symbol:VE,text:{type:"text",tag:"text",nested:!1,attr:function(e,t){var n,i=t.dx||0,r=(t.dy||0)+sM(t),o=cM(t),s=o.x1,a=o.y1,l=t.angle||0;e("text-anchor",aM[t.align]||"start"),l?(n=mE(s,a)+" "+vE(l),(i||r)&&(n+=" "+mE(i,r))):n=mE(s+i,a+r),e("transform",n)},bound:uM,draw:function(e,t,n){cE(t,(function(t){var i,r,o,s,a,l,c,u=null==t.opacity?1:t.opacity;if(!(n&&!n.intersects(t.bounds)||0===u||t.fontSize<=0||null==t.text||0===t.text.length)){if(e.font=oM(t),e.textAlign=t.align||"left",r=(i=cM(t)).x1,o=i.y1,t.angle&&(e.save(),e.translate(r,o),e.rotate(t.angle*_A),r=o=0),r+=t.dx||0,o+=(t.dy||0)+sM(t),l=nM(t),eE(e,t),Object(p.B)(l))for(a=tM(t),s=0;s<l.length;++s)c=iM(t,l[s]),t.fill&&rE(e,t,u)&&e.fillText(c,r,o),t.stroke&&sE(e,t,u)&&e.strokeText(c,r,o),o+=a;else c=iM(t,l),t.fill&&rE(e,t,u)&&e.fillText(c,r,o),t.stroke&&sE(e,t,u)&&e.strokeText(c,r,o);t.angle&&e.restore()}}))},pick:fE((function(e,t,n,i,r,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var s=cM(t),a=s.x1,l=s.y1,c=uM(lM,t,1),u=-t.angle*_A,h=Math.cos(u),d=Math.sin(u),f=h*r-d*o+(a-h*a+d*l),p=d*r+h*o+(l-d*a-h*l);return c.contains(f,p)})),isect:function(e,t){var n=uM(lM,e,2);return Z$(t,n[0],n[1],n[2],n[3])||Z$(t,n[0],n[1],n[4],n[5])||Z$(t,n[4],n[5],n[6],n[7])||Z$(t,n[2],n[3],n[6],n[7])}},trail:xE("trail",(function(e,t){return ZA.context(e)(t)}),(function(e,t){for(var n,i,r=e.length;--r>=0;)if(!1!==e[r].defined&&(n=e[r].x-t[0])*n+(i=e[r].y-t[1])*i<(n=e[r].size||1)*n)return e[r];return null}))};function dM(e,t,n){return!e&&"undefined"!=typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function fM(e,t){t=t.toLowerCase();for(var n=e.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===t)return n[i]}function pM(e,t,n,i){var r,o=e.childNodes[t];return o&&o.tagName.toLowerCase()===n.toLowerCase()||(r=o||null,o=dM(e.ownerDocument,n,i),e.insertBefore(o,r)),o}function gM(e,t){for(var n=e.childNodes,i=n.length;i>t;)e.removeChild(n[--i]);return e}function mM(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}var vM=function(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]};function bM(e,t){this._active=null,this._handlers={},this._loader=e||x$(),this._tooltip=t||yM}function yM(e,t,n,i){e.element().setAttribute("title",i||"")}function wM(e){this._el=null,this._bgcolor=null,this._loader=new _$(e)}bM.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let i=e?e.length:0;--i>=0;)if(e[i].type===t&&(!n||e[i].handler===n))return i;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push.apply(n,t[this.eventName(e)]);else for(const e in t)n.push.apply(n,t[e]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(t=>{const n=new MouseEvent(e.type,e),i=dM(null,"a");for(const e in t)i.setAttribute(e,t[e]);i.dispatchEvent(n)}).catch((function(){}))},handleTooltip(e,t,n){if(t&&null!=t.tooltip){t=function(e,t,n,i){var r,o,s=e&&e.mark;if(s&&(r=hM[s.marktype]).tip){for((o=vM(t,n))[0]-=i[0],o[1]-=i[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=r.tip(s.items,o)}return e}(t,e,this.canvas(),this._origin);const i=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,i)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),i=this._origin,r=e.bounds,o=r.width(),s=r.height();let a=r.x1+i[0]+n.left,l=r.y1+i[1]+n.top;for(;e.mark&&(e=e.mark.group);)a+=e.x||0,l+=e.y||0;return{x:a,y:l,width:o,height:s,left:a,top:l,right:a+o,bottom:l+s}}},wM.prototype={initialize(e,t,n,i,r){return this._el=e,this.resize(t,n,i,r)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,i){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=i||1,this},dirty(){},render(e){var t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){var t=this.render(e);return this._ready?this._ready.then((function(){return t})):Promise.resolve(t)},_load(e,t){var n=this,i=n._loader[e](t);if(!n._ready){var r=n._call;n._ready=n._loader.ready().then((function(e){e&&r(),n._ready=null}))}return i},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const xM="dragleave",_M="mousedown",kM="mousemove",SM="mouseout",OM="click",CM=["keydown","keypress","keyup","dragenter",xM,"dragover",_M,"mouseup",kM,SM,"mouseover",OM,"dblclick","wheel","mousewheel","touchstart","touchmove","touchend"],AM=kM,$M=SM,EM=OM;function MM(e,t){bM.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}function jM(e,t){(e=>"touchstart"===e||"touchmove"===e||"touchend"===e?["touchstart","touchmove","touchend"]:[e])(t).forEach(t=>function(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?n=>e[t](n):n=>e.fire(t,n)))}(e,t))}function RM(e,t,n){return function(i){const r=this._active,o=this.pickEvent(i);o===r||(r&&r.exit||this.fire(n,i),this._active=o,this.fire(t,i)),this.fire(e,i)}}function DM(e){return function(t){this.fire(e,t),this._active=null}}Object(p.z)(MM,bM,{initialize(e,t,n){return this._canvas=e&&fM(e,"canvas"),[OM,_M,kM,SM,xM].forEach(e=>jM(this,e)),bM.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:CM,DOMMouseScroll(e){this.fire("mousewheel",e)},mousemove:RM(kM,"mouseover",SM),dragover:RM("dragover","dragenter",xM),mouseout:DM(SM),dragleave:DM(xM),mousedown(e){this._down=this._active,this.fire(_M,e)},click(e){this._down===this._active&&(this.fire(OM,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire("touchstart",e,!0)},touchmove(e){this.fire("touchmove",e,!0)},touchend(e){this.fire("touchend",e,!0),this._touch=null},fire(e,t,n){const i=n?this._touch:this._active,r=this._handlers[e];if(t.vegaType=e,e===EM&&i&&i.href?this.handleHref(t,i,i.href):e!==AM&&e!==$M||this.handleTooltip(t,i,e!==$M),r)for(let e=0,n=r.length;e<n;++e)r[e].handler.call(this._obj,t,i)},on(e,t){const n=this.eventName(e),i=this._handlers;return this._handlerIndex(i[n],e,t)<0&&(jM(this,e),(i[n]||(i[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&i.splice(r,1),this},pickEvent(e){const t=vM(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,i,r){const o=this.context();return hM[e.marktype].pick.call(this,o,e,t,n,i,r)}});var TM="undefined"!=typeof window&&window.devicePixelRatio||1;function LM(e){wM.call(this,e),this._options={},this._redraw=!1,this._dirty=new r$,this._tempb=new r$}const FM=wM.prototype;function NM(e,t){bM.call(this,e,t);const n=this;n._hrefHandler=PM(n,(e,t)=>{t&&t.href&&n.handleHref(e,t,t.href)}),n._tooltipHandler=PM(n,(e,t)=>{n.handleTooltip(e,t,e.type!==$M)})}Object(p.z)(LM,wM,{initialize(e,t,n,i,r,o){return this._options=o||{},this._canvas=this._options.externalContext?null:Wc(1,1,this._options.type),e&&this._canvas&&(gM(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),FM.initialize.call(this,e,t,n,i,r)},resize(e,t,n,i){if(FM.resize.call(this,e,t,n,i),this._canvas)!function(e,t,n,i,r,o){const s="undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,a=e.getContext("2d"),l=s?TM:r;e.width=t*l,e.height=n*l;for(const e in o)a[e]=o[e];s&&1!==l&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=l,a.setTransform(l,0,0,l,l*i[0],l*i[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const e=this._options.externalContext;e||Object(p.o)("CanvasRenderer is missing a valid canvas or context"),e.scale(this._scale,this._scale),e.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){let t=this._tempb.clear().union(e.bounds),n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,i=this._width,r=this._height,o=this._dirty,s=(a=n,l=i,c=r,(new r$).set(0,0,l,c).translate(-a[0],-a[1]));var a,l,c;t.save();const u=this._redraw||o.empty()?(this._redraw=!1,s.expand(1)):function(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-n[0]%1,-n[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}(t,s.intersect(o),n);return this.clear(-n[0],-n[1],i,r),this.draw(t,e,u),t.restore(),o.clear(),this},draw(e,t,n){const i=hM[t.marktype];t.clip&&function(e,t){var n=t.clip;e.save(),Object(p.E)(n)?(e.beginPath(),n(e),e.clip()):kE(e,t.group)}(e,t),i.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,i){const r=this._options,o=this.context();"pdf"===r.type||r.externalContext||o.clearRect(e,t,n,i),null!=this._bgcolor&&(o.fillStyle=this._bgcolor,o.fillRect(e,t,n,i))}});const PM=(e,t)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,t.call(e._obj,n,i)};Object(p.z)(NM,bM,{initialize(e,t,n){let i=this._svg;return i&&(i.removeEventListener(EM,this._hrefHandler),i.removeEventListener(AM,this._tooltipHandler),i.removeEventListener($M,this._tooltipHandler)),this._svg=i=e&&fM(e,"svg"),i&&(i.addEventListener(EM,this._hrefHandler),i.addEventListener(AM,this._tooltipHandler),i.addEventListener($M,this._tooltipHandler)),bM.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),i=this._handlers;if(this._handlerIndex(i[n],e,t)<0){const r={type:e,handler:t,listener:PM(this,t)};(i[n]||(i[n]=[])).push(r),this._svg&&this._svg.addEventListener(n,r.listener)}return this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&(this._svg&&this._svg.removeEventListener(n,i[r].listener),i.splice(r,1)),this}});const zM=(e,t,n)=>({role:e,"aria-roledescription":t,"aria-label":n||void 0}),IM=Object(p.eb)(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),BM={axis:{desc:"axis",caption:function(e){const t=e.datum,n=e.orient,i=t.title?VM(e):null,r=e.context,o=r.scales[t.scale].value,s=r.dataflow.locale(),a=o.type;return("left"===n||"right"===n?"Y":"X")+"-axis"+(i?` titled '${i}'`:"")+` for a ${Yp(a)?"discrete":a} scale with `+wm(s,o,e)}},legend:{desc:"legend",caption:function(e){const t=e.datum,n=t.title?VM(e):null,i=((t.type||"")+" legend").trim(),r=t.scales,o=Object.keys(r),s=e.context,a=s.scales[r[o[0]]].value,l=s.dataflow.locale();return c=i,(c.length?c[0].toUpperCase()+c.slice(1):c)+(n?` titled '${n}'`:"")+" for "+function(e){return(e=e.map(e=>e+("fill"===e||"stroke"===e?" color":""))).length<2?e[0]:e.slice(0,-1).join(", ")+" and "+Object(p.V)(e)}(o)+" with "+wm(l,a,e);var c}},"title-text":{desc:"title",caption:e=>`Title text '${qM(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${qM(e)}'`}},WM={ariaRole:"role",ariaRoleDescription:"aria-roledescription",description:"aria-label"};function UM(e,t){const n=!1===t.aria;if(e("aria-hidden",n||void 0),n||null==t.description)for(const t in WM)e(WM[t],void 0);else{const n=t.mark.marktype;e("aria-label",t.description),e("role",t.ariaRole||("group"===n?"graphics-object":"graphics-symbol")),e("aria-roledescription",t.ariaRoleDescription||n+" mark")}}function HM(e){return!1===e.aria?{"aria-hidden":!0}:IM[e.role]?null:BM[e.role]?function(e,t){try{const n=e.items[0],i=t.caption||(()=>"");return zM(t.role||"graphics-symbol",t.desc,n.description||i(n))}catch(e){return null}}(e,BM[e.role]):function(e){const t=e.marktype,n="group"===t||"text"===t||e.items.some(e=>null!=e.description&&!1!==e.aria);return zM(n?"graphics-object":"graphics-symbol",t+" mark container",e.description)}(e)}function qM(e){return Object(p.i)(e.text).join(" ")}function VM(e){try{return Object(p.i)(Object(p.V)(e.items).items[0].text).join(" ")}catch(e){return null}}const GM=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function KM(){let e="",t="",n="";const i=[],r=()=>t=n="",o=(e,n)=>{var i;return null!=n&&(t+=` ${e}="${i=n,GM(i).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")}"`),s},s={open(a,...l){(o=>{t&&(e+=`${t}>${n}`,r()),i.push(o)})(a),t="<"+a;for(const e of l)for(const t in e)o(t,e[t]);return s},close(){const o=i.pop();return e+=t?t+(n?`>${n}</${o}>`:"/>"):`</${o}>`,r(),s},attr:o,text:e=>(n+=GM(e),s),toString:()=>e};return s}const YM=e=>function e(t,n){if(t.open(n.tagName),n.hasAttributes()){const e=n.attributes,i=e.length;for(let n=0;n<i;++n)t.attr(e[n].name,e[n].value)}if(n.hasChildNodes()){const i=n.childNodes,r=i.length;for(let n=0;n<r;n++){const r=i[n];3===r.nodeType?t.text(r.nodeValue):e(t,r)}}return t.close()}(KM(),e)+"";const XM={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},JM={fill:"none","stroke-miterlimit":10},QM=jE.xmlns;function ZM(e){wM.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const ej=wM.prototype;function tj(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function nj(e,t,n){let i,r,o;if("radial"===t.gradient){let i=pM(e,n++,"pattern",QM);uj(i,{id:"p_"+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),i=pM(i,0,"rect",QM),uj(i,{width:1,height:1,fill:`url(${dj()}#${t.id})`}),uj(e=pM(e,n++,"radialGradient",QM),{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else uj(e=pM(e,n++,"linearGradient",QM),{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(i=0,r=t.stops.length;i<r;++i)o=pM(e,i,"stop",QM),o.setAttribute("offset",t.stops[i].offset),o.setAttribute("stop-color",t.stops[i].color);return gM(e,i),n}function ij(e,t,n){let i;return(e=pM(e,n,"clipPath",QM)).setAttribute("id",t.id),t.path?(i=pM(e,0,"path",QM),i.setAttribute("d",t.path)):(i=pM(e,0,"rect",QM),uj(i,{x:0,y:0,width:t.width,height:t.height})),gM(e,1),n+1}function rj(e,t,n,i,r){let o,s=e._svg;if(!s&&(o=t.ownerDocument,s=dM(o,i,QM),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},"g"===i))){const t=dM(o,"path",QM);s.appendChild(t),t.__data__=e;const n=dM(o,"g",QM);s.appendChild(n),n.__data__=e;const i=dM(o,"path",QM);s.appendChild(i),i.__data__=e,i.__values__={fill:"default"}}return(s.ownerSVGElement!==r||function(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}(s,n))&&t.insertBefore(s,n?n.nextSibling:t.firstChild),s}Object(p.z)(ZM,wM,{initialize(e,t,n,i,r){return this._defs={},this._clearDefs(),e&&(this._svg=pM(e,0,"svg",QM),uj(this._svg,jE),this._svg.setAttribute("class","marks"),gM(e,1),this._root=pM(this._svg,0,"g",QM),uj(this._root,JM),gM(this._svg,1)),this.background(this._bgcolor),ej.initialize.call(this,e,t,n,i,r)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),ej.background.apply(this,arguments)},resize(e,t,n,i){return ej.resize.call(this,e,t,n,i),this._svg&&(uj(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=pM(e,0,"rect",QM),uj(n,{width:this._width,height:this._height,fill:t}));const i=YM(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),i},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),gM(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;let t,n,i,r,o,s,a,l=++this._dirtyID;for(o=0,s=e.length;o<s;++o)t=e[o],n=t.mark,n.marktype!==i&&(i=n.marktype,r=hM[i]),n.zdirty&&n.dirty!==l&&(this._dirtyAll=!1,tj(t,l),n.items.forEach((function(e){e.dirty=l}))),n.zdirty||(t.exit?(r.nested&&n.items.length?(a=n.items[0],a._svg&&this._update(r,a._svg,a)):t._svg&&(a=t._svg.parentNode,a&&a.removeChild(t._svg)),t._svg=null):(t=r.nested?n.items[0]:t,t._update!==l&&(t._svg&&t._svg.ownerSVGElement?this._update(r,t._svg,t):(this._dirtyAll=!1,tj(t,l)),t._update=l)));return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;let i,r=this._svg,o=hM[t.marktype],s=!1===t.interactive?"none":null,a="g"===o.tag,l=null,c=0;i=rj(t,e,n,"g",r),i.setAttribute("class",mM(t));const u=HM(t);for(const e in u)hj(i,e,u[e]);a||hj(i,"pointer-events",s),hj(i,"clip-path",t.clip?i$(this,t,t.group):null);const h=e=>{const t=this.isDirty(e),n=rj(e,i,l,o.tag,r);t&&(this._update(o,n,e),a&&function(e,t,n){t=t.lastChild.previousSibling;let i,r=0;cE(n,n=>{i=e.mark(t,n,i),++r}),gM(t,1+r)}(this,n,e)),l=n,++c};return o.nested?t.items.length&&h(t.items[0]):cE(t,h),gM(i,c),i},_update(e,t,n){oj=t,sj=t.__values__,UM(lj,n),e.attr(lj,n,this);const i=aj[e.type];i&&i.call(this,e,t,n),oj&&this.style(oj,n)},style(e,t){if(null!=t)for(const n in XM){let i="font"===n?rM(t):t[n];if(i===sj[n])continue;const r=XM[n];null==i?e.removeAttribute(r):(pA(i)&&(i=gA(i,this._defs.gradient,dj())),e.setAttribute(r,i+"")),sj[n]=i}},defs(){const e=this._svg,t=this._defs;let n=t.el,i=0;for(const r in t.gradient)n||(t.el=n=pM(e,1,"defs",QM)),i=nj(n,t.gradient[r],i);for(const r in t.clipping)n||(t.el=n=pM(e,1,"defs",QM)),i=ij(n,t.clipping[r],i);n&&(0===i?(e.removeChild(n),t.el=null):gM(n,i))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});let oj=null,sj=null;const aj={group(e,t,n){const i=oj=t.childNodes[2];sj=i.__values__,e.foreground(lj,n,this),sj=t.__values__,oj=t.childNodes[1],e.content(lj,n,this);const r=oj=t.childNodes[0];e.background(lj,n,this);const o=!1===n.mark.interactive?"none":null;if(o!==sj.events&&(hj(i,"pointer-events",o),hj(r,"pointer-events",o),sj.events=o),n.strokeForeground&&n.stroke){const e=n.fill;hj(i,"display",null),this.style(r,n),hj(r,"stroke",null),e&&(n.fill=null),sj=i.__values__,this.style(i,n),e&&(n.fill=e),oj=null}else hj(i,"display","none")},image(e,t,n){!1===n.smooth?(cj(t,"image-rendering","optimizeSpeed"),cj(t,"image-rendering","pixelated")):cj(t,"image-rendering",null)},text(e,t,n){let i,r,o,s,a=nM(n);Object(p.B)(a)?(r=a.map(e=>iM(n,e)),i=r.join("\n"),i!==sj.text&&(gM(t,0),o=t.ownerDocument,s=tM(n),r.forEach((e,i)=>{const r=dM(o,"tspan",QM);r.__data__=n,r.textContent=e,i&&(r.setAttribute("x",0),r.setAttribute("dy",s)),t.appendChild(r)}),sj.text=i)):(r=iM(n,a),r!==sj.text&&(t.textContent=r,sj.text=r)),hj(t,"font-family",rM(n)),hj(t,"font-size",eM(n)+"px"),hj(t,"font-style",n.fontStyle),hj(t,"font-variant",n.fontVariant),hj(t,"font-weight",n.fontWeight)}};function lj(e,t,n){t!==sj[e]&&(n?function(e,t,n,i){null!=n?e.setAttributeNS(i,t,n):e.removeAttributeNS(i,t)}(oj,e,t,n):hj(oj,e,t),sj[e]=t)}function cj(e,t,n){n!==sj[t]&&(null==n?e.style.removeProperty(t):e.style.setProperty(t,n+""),sj[t]=n)}function uj(e,t){for(const n in t)hj(e,n,t[n])}function hj(e,t,n){null!=n?e.setAttribute(t,n):e.removeAttribute(t)}function dj(){let e;return"undefined"==typeof window?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function fj(e){wM.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}Object(p.z)(fj,wM,{svg(){return this._text},_render(e){const t=KM();t.open("svg",Object(p.p)({},jE,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",JM,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=hM[t.marktype],i=n.tag,r=[UM,n.attr];e.open("g",{class:mM(t),"clip-path":t.clip?i$(this,t,t.group):null},HM(t),{"pointer-events":"g"!==i&&!1===t.interactive?"none":null});const o=o=>{const s=this.href(o);if(s&&e.open("a",s),e.open(i,this.attr(t,o,r,"g"!==i?i:null)),"text"===i){const t=nM(o);if(Object(p.B)(t)){const n={x:0,dy:tM(o)};for(let i=0;i<t.length;++i)e.open("tspan",i?n:null).text(iM(o,t[i])).close()}else e.text(iM(o,t))}else if("g"===i){const i=o.strokeForeground,r=o.fill,s=o.stroke;i&&s&&(o.stroke=null),e.open("path",this.attr(t,o,n.background,"bgrect")).close(),e.open("g",this.attr(t,o,n.content)),cE(o,t=>this.mark(e,t)),e.close(),i&&s?(r&&(o.fill=null),o.stroke=s,e.open("path",this.attr(t,o,n.foreground,"bgrect")).close(),r&&(o.fill=r)):e.open("path",this.attr(t,o,n.foreground,"bgfore")).close()}e.close(),s&&e.close()};return n.nested?t.items&&t.items.length&&o(t.items[0]):cE(t,o),e.close()},href(e){let t,n=e.href;if(n){if(t=this._hrefs&&this._hrefs[n])return t;this.sanitizeURL(n).then(e=>{e["xlink:href"]=e.href,e.href=null,(this._hrefs||(this._hrefs={}))[n]=e})}return null},attr(e,t,n,i){const r={},o=(e,t,n,i)=>{r[i||e]=t};return Array.isArray(n)?n.forEach(e=>e(o,t,this)):n(o,t,this),i&&function(e,t,n,i,r){if(null==t)return e;"bgrect"===i&&!1===n.interactive&&(e["pointer-events"]="none");if("bgfore"===i&&(!1===n.interactive&&(e["pointer-events"]="none"),e.display="none",null!==t.fill))return e;"image"===i&&!1===t.smooth&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;");"text"===i&&(e["font-family"]=rM(t),e["font-size"]=eM(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const n in XM){let i=t[n];const o=XM[n];("transparent"!==i||"fill"!==o&&"stroke"!==o)&&null!=i&&(pA(i)&&(i=gA(i,r.gradient,"")),e[o]=i)}}(r,t,e,i,this._defs),r},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(t).length+Object.keys(n).length){e.open("defs");for(const n in t){const i=t[n],r=i.stops;"radial"===i.gradient?(e.open("pattern",{id:"p_"+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),e.close(),e.open("radialGradient",{id:n,fx:i.x1,fy:i.y1,fr:i.r1,cx:i.x2,cy:i.y2,r:i.r2})):e.open("linearGradient",{id:n,x1:i.x1,x2:i.x2,y1:i.y1,y2:i.y2});for(let t=0;t<r.length;++t)e.open("stop",{offset:r[t].offset,"stop-color":r[t].color}).close();e.close()}for(const t in n){const i=n[t];e.open("clipPath",{id:t}),i.path?e.open("path",{d:i.path}).close():e.open("rect",{x:0,y:0,width:i.width,height:i.height}).close(),e.close()}e.close()}}});var pj={};function gj(e,t,n,i){if(function(e,t,n){return e.bounds&&t.intersects(e.bounds)&&("group"===e.marktype||!1!==e.interactive&&(!n||n(e)))}(e,t,n)){const r=e.items,o=e.marktype,s=r.length;let a=0;if("group"===o)for(;a<s;++a)mj(r[a],t,n,i);else for(const e=hM[o].isect;a<s;++a){let n=r[a];vj(n,t,e)&&i.push(n)}}return i}function mj(e,t,n,i){n&&n(e.mark)&&vj(e,t,hM.group.isect)&&i.push(e);const r=e.items,o=r&&r.length;if(o){const s=e.x||0,a=e.y||0;t.translate(-s,-a);for(let e=0;e<o;++e)gj(r[e],t,n,i);t.translate(s,a)}return i}function vj(e,t,n){const i=e.bounds;return t.encloses(i)||t.intersects(i)&&n(e,t)}pj.canvas=pj.png={renderer:LM,headless:LM,handler:MM},pj.svg={renderer:ZM,headless:fj,handler:NM},pj.none={};new r$;const bj=e=>e.data;function yj(e,t){const n=LO.call(t,e);return n.root&&n.root.lookup||{}}const wj=()=>"undefined"!=typeof window&&window||null;function xj(e,t){for(var n,i,r=t.fields,o=t.values,s=r.length,a=0;a<s;++a)if((i=r[a]).getter=p.u.getter||Object(p.u)(i.field),n=i.getter(e),Object(p.D)(n)&&(n=Object(p.db)(n)),Object(p.D)(o[a])&&(o[a]=Object(p.db)(o[a])),Object(p.D)(o[a][0])&&(o[a]=o[a].map(p.db)),"E"===i.type){if(Object(p.B)(o[a])?o[a].indexOf(n)<0:n!==o[a])return!1}else if("R"===i.type){if(!Object(p.A)(n,o[a]))return!1}else if("R-RE"===i.type){if(!Object(p.A)(n,o[a],!0,!1))return!1}else if("R-E"===i.type){if(!Object(p.A)(n,o[a],!1,!1))return!1}else if("R-LE"===i.type&&!Object(p.A)(n,o[a],!1,!0))return!1;return!0}var _j={E_union:function(e,t){if(!e.length)return t;for(var n=0,i=t.length;n<i;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter((function(e){return t.indexOf(e)>=0})):t},R_union:function(e,t){var n=Object(p.db)(t[0]),i=Object(p.db)(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<i&&(e[1]=i),e):[n,i]},R_intersect:function(e,t){var n=Object(p.db)(t[0]),i=Object(p.db)(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?i<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>i&&(e[1]=i),e):[n,i]}};function kj(e,t,n,i){t[0].type!==HO.b&&Object(p.o)("First argument to selection functions must be a string literal.");const r=t[0].value,o=":"+r;"intersect"!==(t.length>=2&&Object(p.V)(t).value)||Object(p.w)(i,"@unit")||(i["@unit"]=n.getData(r).indataRef(n,"unit")),Object(p.w)(i,o)||(i[o]=n.getData(r).tuplesRef())}const Sj={random:()=>uo(),cumulativeNormal:_o,cumulativeLogNormal:$o,cumulativeUniform:To,densityNormal:xo,densityLogNormal:Ao,densityUniform:Do,quantileNormal:ko,quantileLogNormal:Eo,quantileUniform:Lo,sampleNormal:wo,sampleLogNormal:Co,sampleUniform:Ro,isArray:p.B,isBoolean:p.C,isDate:p.D,isDefined:e=>void 0!==e,isNumber:p.F,isObject:p.G,isRegExp:p.H,isString:p.I,isTuple:y,isValid:e=>null!=e&&e==e,toBoolean:p.bb,toDate:p.cb,toNumber:p.db,toString:p.fb,flush:p.v,lerp:p.K,merge:function(){const e=[].slice.call(arguments);return e.unshift({}),p.p.apply(null,e)},pad:p.Q,peek:p.V,span:p.Y,inrange:p.A,truncate:p.gb,rgb:Af,lab:xg,hcl:$g,hsl:Tf,luminance:cA,contrast:function(e,t){const n=cA(e),i=cA(t);return(Math.max(n,i)+.05)/(Math.min(n,i)+.05)},sequence:Ys,format:NO,utcFormat:zO,utcParse:BO,utcOffset:En,utcSequence:Rn,timeFormat:PO,timeParse:IO,timeOffset:$n,timeSequence:jn,timeUnitSpecifier:ut,monthFormat:function(e){return UO.call(this,e,1,"%B")},monthAbbrevFormat:function(e){return UO.call(this,e,1,"%b")},dayFormat:function(e){return UO.call(this,0,2+e,"%A")},dayAbbrevFormat:function(e){return UO.call(this,0,2+e,"%a")},quarter:p.W,utcquarter:p.ib,week:Nt,utcweek:Ut,dayofyear:Ft,utcdayofyear:Wt,warn:function(){return aA(this.context.dataflow,"warn",arguments)},info:function(){return aA(this.context.dataflow,"info",arguments)},debug:function(){return aA(this.context.dataflow,"debug",arguments)},extent:p.q,inScope:function(e){let t=this.context.group,n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n},intersect:function(e,t,n){if(!e)return[];const[i,r]=e,o=(new r$).set(i[0],i[1],r[0],r[1]);return function(e,t,n){const i=[],r=(new r$).union(t),o=e.marktype;return o?gj(e,r,n,i):"group"===o?mj(e,r,n,i):Object(p.o)("Intersect scene must be mark node or group item.")}(n||this.context.dataflow.scenegraph().root,o,function(e){let t=null;if(e){const n=Object(p.i)(e.marktype),i=Object(p.i)(e.markname);t=e=>(!n.length||n.some(t=>e.marktype===t))&&(!i.length||i.some(t=>e.name===t))}return t}(t))},clampRange:p.k,pinchDistance:function(e){const t=e.touches,n=t[0].clientX-t[1].clientX,i=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+i*i)},pinchAngle:function(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)},screen:function(){const e=wj();return e?e.screen:{}},containerSize:function(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]},windowSize:function(){const e=wj();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]},bandspace:function(e,t,n){return Wd(e||0,t||0,n||0)},setdata:function(e,t){const n=this.context.dataflow,i=this.context.data[e].input;return n.pulse(i,n.changeset().remove(p.hb).insert(t)),1},pathShape:function(e){let t=null;return function(n){return n?RA(n,t=t||xA(e)):e}},panLinear:p.R,panLog:p.S,panPow:p.T,panSymlog:p.U,zoomLinear:p.mb,zoomLog:p.nb,zoomPow:p.ob,zoomSymlog:p.pb,encode:function(e,t,n){if(e){const n=this.context.dataflow,i=e.mark.source;n.pulse(i,n.changeset().encode(e,t))}return void 0!==n?n:e},modify:function(e,t,n,i,r,o){let s,a,l=this.context.dataflow,c=this.context.data[e],u=c.input,h=c.changes,d=l.stamp();if(!1===l._trigger||!(u.value.length||t||i))return 0;if((!h||h.stamp<d)&&(c.changes=h=l.changeset(),h.stamp=d,l.runAfter((function(){c.modified=!0,l.pulse(u,h).run()}),!0,1)),n&&(s=!0===n?p.hb:Object(p.B)(n)||y(n)?n:dA(n),h.remove(s)),t&&h.insert(t),i&&(s=dA(i),u.value.some(s)?h.remove(s):h.insert(i)),r)for(a in o)h.modify(r,a,o[a]);return 1}},Oj=["view","item","group","xy","x","y"],Cj={},Aj={blacklist:["_"],whitelist:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${Object(p.ab)("$"+e)}]`,functions:function(e){const t=Object(HO.e)(e);Oj.forEach(e=>t[e]="event.vega."+e);for(let e in Sj)t[e]="this."+e;return Object(p.p)(t,YO(e,Sj,Cj)),t},constants:HO.d,visitors:Cj},$j=Object(HO.c)(Aj);function Ej(e,t,n){return 1===arguments.length?Sj[e]:(Sj[e]=t,n&&(Cj[e]=n),$j&&($j.functions[e]="this."+e),this)}Ej("bandwidth",(function(e,t){const n=KO(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}),VO),Ej("copy",(function(e,t){const n=KO(e,(t||this).context);return n?n.copy():void 0}),VO),Ej("domain",(function(e,t){const n=KO(e,(t||this).context);return n?n.domain():[]}),VO),Ej("range",(function(e,t){const n=KO(e,(t||this).context);return n&&n.range?n.range():[]}),VO),Ej("invert",(function(e,t,n){const i=KO(e,(n||this).context);return i?Object(p.B)(t)?(i.invertRange||i.invert)(t):(i.invert||i.invertExtent)(t):void 0}),VO),Ej("scale",(function(e,t,n){const i=KO(e,(n||this).context);return i?i(t):void 0}),VO),Ej("gradient",(function(e,t,n,i,r){e=KO(e,(r||this).context);const o=function(e,t){var n,i=[];return n={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:i,stop:function(e,t){return i.push({offset:e,color:t}),n}}}(t,n);let s=e.domain(),a=s[0],l=Object(p.V)(s),c=p.y;return l-a?c=Xg(e,a,l):e=(e.interpolator?qp("sequential")().interpolator(e.interpolator()):qp("linear")().interpolate(e.interpolate()).range(e.range())).domain([a=0,l=1]),e.ticks&&(s=e.ticks(+i||15),a!==s[0]&&s.unshift(a),l!==Object(p.V)(s)&&s.push(l)),s.forEach(t=>o.stop(c(t),e(t))),o}),VO),Ej("geoArea",rA,VO),Ej("geoBounds",oA,VO),Ej("geoCentroid",sA,VO),Ej("geoShape",(function(e,t,n){const i=KO(e,(n||this).context);return function(e){return i?i.path.context(e)(t):""}}),VO),Ej("indata",(function(e,t,n){const i=this.context.data[e]["index:"+t],r=i?i.value.get(n):void 0;return r?r.count:r}),(function(e,t,n,i){t[0].type!==HO.b&&Object(p.o)("First argument to indata must be a string literal."),t[1].type!==HO.b&&Object(p.o)("Second argument to indata must be a string literal.");const r=t[0].value,o=t[1].value,s="@"+o;Object(p.w)(s,i)||(i[s]=n.getData(r).indataRef(n,o))})),Ej("data",LO,qO),Ej("treePath",(function(e,t,n){const i=yj(e,this),r=i[t],o=i[n];return r&&o?r.path(o).map(bj):void 0}),qO),Ej("treeAncestors",(function(e,t){const n=yj(e,this)[t];return n?n.ancestors().map(bj):void 0}),qO),Ej("vlSelectionTest",(function(e,t,n){for(var i,r,o,s,a,l=this.context.data[e],c=l?l.values.value:[],u=l?l["index:unit"]&&l["index:unit"].value:void 0,h="intersect"===n,d=c.length,f=0;f<d;++f)if(i=c[f],u&&h){if(-1===(o=(r=r||{})[s=i.unit]||0))continue;if(a=xj(t,i),r[s]=a?-1:++o,a&&1===u.size)return!0;if(!a&&o===u.get(s).count)return!1}else if(h^(a=xj(t,i)))return a;return d&&h}),kj),Ej("vlSelectionResolve",(function(e,t,n){for(var i,r,o,s,a,l,c,u,h,d,f,g=this.context.data[e],m=g?g.values.value:[],v={},b={},y={},w=m.length,x=0;x<w;++x){for(s=(i=m[x]).unit,r=i.fields,o=i.values,d=0,f=r.length;d<f;++d)a=r[d],c=(l=v[a.field]||(v[a.field]={}))[s]||(l[s]=[]),y[a.field]=u=a.type.charAt(0),h=_j[u+"_union"],l[s]=h(c,Object(p.i)(o[d]));n&&(c=b[s]||(b[s]=[])).push(Object(p.i)(o).reduce((e,t,n)=>(e[r[n].field]=t,e),{}))}return t=t||"union",Object.keys(v).forEach((function(e){v[e]=Object.keys(v[e]).map(t=>v[e][t]).reduce((n,i)=>void 0===n?i:_j[y[e]+"_"+t](n,i))})),m=Object.keys(b),n&&m.length&&(v.vlMulti="union"===t?{or:m.reduce((e,t)=>(e.push.apply(e,b[t]),e),[])}:{and:m.map(e=>({or:b[e]}))}),v}),kj);var Mj=function(e,t){let n,i,r={};try{e=Object(p.I)(e)?e:Object(p.ab)(e)+"",n=Object(HO.f)(e)}catch(t){Object(p.o)("Expression parse error: "+e)}return n.visit(e=>{if(e.type!==HO.a)return;const n=e.callee.name,i=Aj.visitors[n];i&&i(n,e.arguments,t,r)}),i=$j(n),i.globals.forEach(e=>{const n="$"+e;!Object(p.w)(r,n)&&t.getSignal(e)&&(r[n]=t.signalRef(e))}),{$expr:Object(p.p)({code:i.code},t.options.ast?{ast:n}:null),$fields:i.fields,$params:r}};const jj=Object(p.eb)(["rule"]),Rj=Object(p.eb)(["group","image","rect"]);function Dj(e){return(e+"").toLowerCase()}function Tj(e,t,n){";"!==n[n.length-1]&&(n="return("+n+");");var i=Function.apply(null,t.concat(n));return e&&e.functions?i.bind(e.functions):i}var Lj={operator:(e,t)=>Tj(e,["_"],t.code),parameter:(e,t)=>Tj(e,["datum","_"],t.code),event:(e,t)=>Tj(e,["event"],t.code),handler:(e,t)=>Tj(e,["_","event"],`var datum=event.item&&event.item.datum;return ${t.code};`),encode:(e,t)=>{const{marktype:n,channels:i}=t;let r="var o=item,datum=o.datum,m=0,$;";for(const e in i){const t="o["+Object(p.ab)(e)+"]";r+=`$=${i[e].code};if(${t}!==$)${t}=$,m=1;`}return r+=function(e,t){let n="";return jj[t]||(e.x2&&(e.x?(Rj[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(Rj[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(i,n),r+="return m;",Tj(e,["item","_"],r)},codegen:{get(e){const t=`[${e.map(p.ab).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n;const i=Function("a","b","var u, v; return "+e.map((e,i)=>{const r=t[i];let o,s;return e.path?(o="a"+e.path,s="b"+e.path):((n=n||{})["f"+i]=e,o=`this.f${i}(a)`,s=`this.f${i}(b)`),function(e,t,n,i){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}\n  : (u > v || v == null) && u != null ? ${i}\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}\n  : v !== v && u === u ? ${i} : `}(o,s,-r,r)}).join("")+"0;");return n?i.bind(n):i}}};function Fj(e,t,n){if(!e||!Object(p.G)(e))return e;for(let i,r=0,o=Nj.length;r<o;++r)if(i=Nj[r],Object(p.w)(e,i.key))return i.parse(e,t,n);return e}var Nj=[{key:"$ref",parse:function(e,t){return t.get(e.$ref)||Object(p.o)("Operator not defined: "+e.$ref)}},{key:"$key",parse:function(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=Object(p.J)(e.$key,e.$flat,t.expr.codegen))}},{key:"$expr",parse:function(e,t,n){e.$params&&t.parseParameters(e.$params,n);const i="e:"+e.$expr.code+"_"+e.$name;return t.fn[i]||(t.fn[i]=Object(p.f)(t.parameterExpression(e.$expr),e.$fields,e.$name))}},{key:"$field",parse:function(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Object(p.u)(e.$field,e.$name,t.expr.codegen))}},{key:"$encode",parse:function(e,t){const n=e.$encode,i={};for(const e in n){const r=n[e];i[e]=Object(p.f)(t.encodeExpression(r.$expr),r.$fields),i[e].output=r.$output}return i}},{key:"$compare",parse:function(e,t){const n="c:"+e.$compare+"_"+e.$order,i=Object(p.i)(e.$compare).map(e=>e&&e.$tupleid?w:e);return t.fn[n]||(t.fn[n]=Object(p.l)(i,e.$order,t.expr.codegen))}},{key:"$context",parse:function(e,t){return t}},{key:"$subflow",parse:function(e,t){const n=e.$subflow;return function(e,i,r){const o=t.fork().parse(n),s=o.get(n.operators[0].id),a=o.signals.parent;return a&&a.set(r),s.detachSubflow=()=>t.detach(o),s}}},{key:"$tupleid",parse:function(){return w}}];var Pj={skip:!0};var zj=function(e,t,n,i){return new Ij(e,t,n,i)};function Ij(e,t,n,i){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=i||Lj,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function Bj(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}Ij.prototype=Bj.prototype={fork(){const e=new Bj(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(t=>t!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,i=n.dataflow,r=e.value;if(n.set(e.id,t),"collect"===Dj(e.type)&&r&&(r.$ingest?i.ingest(t,r.$ingest,r.$format):r.$request?i.preload(t,r.$request,r.$format):i.pulse(t,i.changeset().insert(r))),e.root&&(n.root=t),e.parent){var o=n.get(e.parent.$ref);o?(i.connect(o,[t]),t.targets().add(o)):(n.unresolved=n.unresolved||[]).push(()=>{o=n.get(e.parent.$ref),i.connect(o,[t]),t.targets().add(o)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const i in e.data){const r=n.data[i]||(n.data[i]={});e.data[i].forEach(e=>r[e]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[Dj(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,i,r){this.dataflow.on(t,n,i,r,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:function(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(e=>t.parseOperator(e)),n.forEach(e=>t.parseOperatorParameters(e)),(e.streams||[]).forEach(e=>t.parseStream(e)),(e.updates||[]).forEach(e=>t.parseUpdate(e)),t.resolve()},parseOperator:function(e){const t=this;"operator"!==Dj(e.type)&&e.type?t.transform(e,e.type):t.operator(e,e.update?t.operatorExpression(e.update):null)},parseOperatorParameters:function(e){const t=this;if(e.params){const n=t.get(e.id);n||Object(p.o)("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}},parseParameters:function(e,t){t=t||{};const n=this;for(const i in e){const r=e[i];t[i]=Object(p.B)(r)?r.map(e=>Fj(e,n,t)):Fj(r,n,t)}return t},parseStream:function(e){var t,n=this,i=null!=e.filter?n.eventExpression(e.filter):void 0,r=null!=e.stream?n.get(e.stream):void 0;e.source?r=n.events(e.source,e.type,i):e.merge&&(r=(t=e.merge.map(e=>n.get(e)))[0].merge.apply(t[0],t.slice(1))),e.between&&(t=e.between.map(e=>n.get(e)),r=r.between(t[0],t[1])),e.filter&&(r=r.filter(i)),null!=e.throttle&&(r=r.throttle(+e.throttle)),null!=e.debounce&&(r=r.debounce(+e.debounce)),null==r&&Object(p.o)("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),n.stream(e,r)},parseUpdate:function(e){var t,n=Object(p.G)(n=e.source)?n.$ref:n,i=this.get(n),r=e.update,o=void 0;i||Object(p.o)("Source not defined: "+e.source),t=e.target&&e.target.$expr?this.eventExpression(e.target.$expr):this.get(e.target),r&&r.$expr&&(r.$params&&(o=this.parseParameters(r.$params)),r=this.handlerExpression(r.$expr)),this.update(e,i,t,r,o)},getState:function(e){var t=this,n={};if(e.signals){var i=n.signals={};Object.keys(t.signals).forEach(n=>{var r=t.signals[n];e.signals(n,r)&&(i[n]=r.value)})}if(e.data){var r=n.data={};Object.keys(t.data).forEach(n=>{var i=t.data[n];e.data(n,i)&&(r[n]=i.input.value)})}return t.subcontext&&!1!==e.recurse&&(n.subcontext=t.subcontext.map(t=>t.getState(e))),n},setState:function(e){var t=this,n=t.dataflow,i=e.data,r=e.signals;Object.keys(r||{}).forEach(e=>{n.update(t.signals[e],r[e],Pj)}),Object.keys(i||{}).forEach(e=>{n.pulse(t.data[e].input,n.changeset().remove(p.hb).insert(i[e]))}),(e.subcontext||[]).forEach((e,n)=>{var i=t.subcontext[n];i&&i.setState(e)})}};var Wj={skip:!0};function Uj(e,t){var n=e.autosize(),i=e.padding();return t-(n&&"padding"===n.contains?i.left+i.right:0)}function Hj(e,t){var n=e.autosize(),i=e.padding();return t-(n&&"padding"===n.contains?i.top+i.bottom:0)}function qj(e,t){return t.modified&&Object(p.B)(t.input.value)&&e.indexOf("_:vega:_")}function Vj(e,t){return!("parent"===e||t instanceof Pr.proxy)}var Gj=function(e,t,n,i){var r=e.element();r&&r.setAttribute("title",function(e){return null==e?"":Object(p.B)(e)?Kj(e):Object(p.G)(e)&&!Object(p.D)(e)?(t=e,Object.keys(t).map((function(e){var n=t[e];return e+": "+(Object(p.B)(n)?Kj(n):Yj(n))})).join("\n")):e+"";var t}(i))};function Kj(e){return"["+e.map(Yj).join(", ")+"]"}function Yj(e){return Object(p.B)(e)?"[â€¦]":Object(p.G)(e)&&!Object(p.D)(e)?"{â€¦}":e}function Xj(e,t){const n=this;if(t=t||{},Lr.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),null!=t.logLevel&&n.logLevel(t.logLevel),t.locale||e.locale){const i=Object(p.p)({},e.locale,t.locale);n.locale(vr(i.number,i.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||Xm.Canvas,n._scenegraph=new fd;const i=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||Gj,n._redraw=!0,n._handler=(new Dd).scene(i),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function(e){const t=Object(p.p)({defaults:{}},e),n=(e,t)=>{t.forEach(t=>{Object(p.B)(e[t])&&(e[t]=Object(p.eb)(e[t]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const r=function(e,t,n){return zj(e,Pr,Sj,n).parse(t)}(n,e,t.expr);n._runtime=r,n._signals=r.signals,n._bind=(e.bindings||[]).map(e=>({state:null,param:Object(p.p)({},e)})),r.root&&r.root.set(i),i.source=r.data.root.input,n.pulse(r.data.root.input,n.changeset().insert(i.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=Uj(n,n._width),n._viewHeight=Hj(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(e){var t=e._signals,n=t.width,i=t.height,r=t.padding;function o(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,(function(t){e._width=t.size,e._viewWidth=Uj(e,t.size),o()}),{size:n}),e._resizeHeight=e.add(null,(function(t){e._height=t.size,e._viewHeight=Hj(e,t.size),o()}),{size:i});var s=e.add(null,o,{pad:r});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=i.rank+1,s.rank=r.rank+1}(n),function(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}(n),function(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:"default",item:null}));e.on(e.events("view","mousemove"),t,(function(e,n){const i=t.value,r=i?Object(p.I)(i)?i:i.user:"default",o=n.item&&n.item.cursor||null;return i&&r===i.user&&o==i.item?i:{user:r,item:o}})),e.add(null,(function(t){let n=t.cursor,i=this.value;return Object(p.I)(n)||(i=n.item,n=n.user),cO(e,n&&"default"!==n?n:i||n),i}),{cursor:t})}(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function Jj(e,t){return Object(p.w)(e._signals,t)?e._signals[t]:Object(p.o)("Unrecognized signal name: "+Object(p.ab)(t))}function Qj(e,t){const n=(e._targets||[]).filter(e=>e._update&&e._update.handler===t);return n.length?n[0]:null}function Zj(e,t,n,i){var r=Qj(n,i);return r||((r=MO(e,()=>i(t,n.value))).handler=i,e.on(n,null,r)),e}function eR(e,t,n){var i=Qj(t,n);return i&&t._targets.remove(i),e}Object(p.z)(Xj,Lr,{async evaluate(e,t,n){if(await Lr.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,r=pO(i=this),o=dO(i),s=fO(i),i._renderer.background(i.background()),i._renderer.resize(o,s,r),i._handler.origin(r),i._resizeListeners.forEach((function(e){try{e(o,s)}catch(e){i.error(e)}}))),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(e){this.error(e)}var i,r,o,s;return n&&m(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=null!=e?e+"":null;return t!==this._desc&&lO(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){var i=Jj(this,e);return 1===arguments.length?i.value:this.update(i,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",DO(e)):DO(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(Qm(e)||Object(p.o)("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(Lr.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(Jj(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function(e,t,n,i,r,o){this.runAfter((function(s){var a=0;s._autosize=0,s.width()!==n&&(a=1,s.signal("width",n,Wj),s._resizeWidth.skip(!0)),s.height()!==i&&(a=1,s.signal("height",i,Wj),s._resizeHeight.skip(!0)),s._viewWidth!==e&&(s._resize=1,s._viewWidth=e),s._viewHeight!==t&&(s._resize=1,s._viewHeight=t),s._origin[0]===r[0]&&s._origin[1]===r[1]||(s._resize=1,s._origin=r),a&&s.run("enter"),o&&s.runAfter(e=>e.resize())}),!1,1)},addEventListener(e,t,n){var i=t;return n&&!1===n.trap||((i=MO(this,t)).raw=t),this._handler.on(e,i),this},removeEventListener(e,t){for(var n,i,r=this._handler.handlers(e),o=r.length;--o>=0;)if(i=r[o].type,n=r[o].handler,e===i&&(t===n||t===n.raw)){this._handler.off(i,n);break}return this},addResizeListener(e){var t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return Zj(this,e,Jj(this,e),t)},removeSignalListener(e,t){return eR(this,Jj(this,e),t)},addDataListener(e,t){return Zj(this,e,uO(this,e).values,t)},removeDataListener(e,t){return eR(this,uO(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=cO(this,null);this._globalCursor=!!e,t&&cO(this,t)}return this}return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:function(e,t){this._timers.push(function(e,t,n){var i=new F_,r=t;return null==t?(i.restart(e,t,n),i):(t=+t,n=null==n?T_():+n,i.restart((function o(s){s+=r,i.restart(o,r+=t,n),e(s)}),t,n),i)}((function(t){e({timestamp:Date.now(),elapsed:t})}),t))},events:function(e,t,n){var i,r=this,o=new L(n),s=function(n,i){r.runAsync(null,()=>{"view"===e&&function(e,t){var n=e._eventConfig.defaults,i=n.prevent,r=n.allow;return!1!==i&&!0!==r&&(!0===i||!1===r||(i?i[t]:r?!r[t]:e.preventDefault()))}(r,t)&&n.preventDefault(),o.receive(gO(r,n,i))})};if("timer"===e)vO(r,"timer",t)&&r.timer(s,t);else if("view"===e)vO(r,"view",t)&&r.addEventListener(t,s,mO);else if("window"===e?vO(r,"window",t)&&"undefined"!=typeof window&&(i=[window]):"undefined"!=typeof document&&vO(r,"selector",t)&&(i=document.querySelectorAll(e)),i){for(var a=0,l=i.length;a<l;++a)i[a].addEventListener(t,s);r._eventListeners.push({type:t,sources:i,handler:s})}else r.warn("Can not resolve event source: "+e);return o},finalize:function(){var e,t,n,i=this._tooltip,r=this._timers,o=this._eventListeners;for(e=r.length;--e>=0;)r[e].stop();for(e=o.length;--e>=0;)for(t=(n=o[e]).sources.length;--t>=0;)n.sources[t].removeEventListener(n.type,n.handler);return i&&i.call(this,this._handler,null,null,null),this},hover:function(e,t){return t=[t||"update",(e=[e||"hover"])[0]],this.on(this.events("view","mouseover",bO),yO,wO(e)),this.on(this.events("view","mouseout",bO),yO,wO(t)),this},data:function(e,t){return arguments.length<2?uO(this,e).values.value:hO.call(this,e,$().remove(p.hb).insert(t))},change:hO,insert:function(e,t){return hO.call(this,e,$().insert(t))},remove:function(e,t){return hO.call(this,e,$().remove(t))},scale:function(e){var t=this._runtime.scales;return Object(p.w)(t,e)||Object(p.o)("Unrecognized scale or projection: "+e),t[e].value},initialize:function(e,t){const n=this,i=n._renderType,r=n._eventConfig.bind,o=Qm(i);e=n._el=e?jO(n,e):null,function(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),lO(t,e.description()))}(n),o||n.error("Unrecognized renderer type: "+i);const s=o.handler||Dd,a=e?o.renderer:o.headless;return n._renderer=a?EO(n,n._renderer,e,a):null,n._handler=function(e,t,n,i){var r=new i(e.loader(),MO(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,pO(e),e);return t&&t.handlers().forEach((function(e){r.on(e.type,e.handler)})),r}(n,n._handler,e,s),n._redraw=!0,e&&"none"!==r&&(t=t?n._elBind=jO(n,t):e.appendChild(xO("form",{class:"vega-bindings"})),n._bind.forEach((function(e){e.param.element&&"container"!==r&&(e.element=jO(n,e.param.element))})),n._bind.forEach((function(e){_O(n,e.element||t,e)}))),n},toImageURL:async function(e,t){e!==Xm.Canvas&&e!==Xm.SVG&&e!==Xm.PNG&&Object(p.o)("Unrecognized image type: "+e);const n=await TO(this,e,t);return e===Xm.SVG?(i=n.svg(),r=new Blob([i],{type:"image/svg+xml"}),window.URL.createObjectURL(r)):n.canvas().toDataURL("image/png");var i,r},toCanvas:async function(e,t){return(await TO(this,Xm.Canvas,e,t)).canvas()},toSVG:async function(e){return(await TO(this,Xm.SVG,e)).svg()},getState:function(e){return this._runtime.getState(e||{data:qj,signals:Vj,recurse:!0})},setState:function(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},e=>{e._trigger=!0}),this}});var tR=function(e){return Object(p.G)(e)?e:{type:e||"pad"}};const nR=e=>+e||0;var iR=function(e){return Object(p.G)(e)?e.signal?e:{top:nR(e.top),bottom:nR(e.bottom),left:nR(e.left),right:nR(e.right)}:{top:t=nR(e),bottom:t,left:t,right:t};var t};const rR=e=>Object(p.G)(e)&&!Object(p.B)(e)?Object(p.p)({},e):{value:e};function oR(e,t,n,i){if(null!=n){return Object(p.G)(n)&&!Object(p.B)(n)||Object(p.B)(n)&&n.length&&Object(p.G)(n[0])?e.update[t]=n:e[i||"enter"][t]={value:n},1}return 0}function sR(e,t,n){for(const n in t)oR(e,n,t[n]);for(const t in n)oR(e,t,n[t],"update")}function aR(e,t,n){for(const i in t)n&&Object(p.w)(n,i)||(e[i]=Object(p.p)(e[i]||{},t[i]));return e}function lR(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}function cR(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const uR=e=>Object(p.I)(e)?Object(p.ab)(e):e.signal?`(${e.signal})`:pR(e);function hR(e){if(null!=e.gradient)return function(e){const t=[e.start,e.stop,e.count].map(e=>null==e?null:Object(p.ab)(e));for(;t.length&&null==Object(p.V)(t);)t.pop();return t.unshift(uR(e.gradient)),`gradient(${t.join(",")})`}(e);let t=e.signal?`(${e.signal})`:e.color?function(e){return e.c?dR("hcl",e.h,e.c,e.l):e.h||e.s?dR("hsl",e.h,e.s,e.l):e.l||e.a?dR("lab",e.l,e.a,e.b):e.r||e.g||e.b?dR("rgb",e.r,e.g,e.b):null}(e.color):null!=e.field?pR(e.field):void 0!==e.value?Object(p.ab)(e.value):void 0;return null!=e.scale&&(t=function(e,t){const n=uR(e.scale);null!=e.range?t=`lerp(_range(${n}), ${+e.range})`:(void 0!==t&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(1==+e.band?"":"*"+fR(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),null==t&&(t="0"));return t}(e,t)),void 0===t&&(t=null),null!=e.exponent&&(t=`pow(${t},${fR(e.exponent)})`),null!=e.mult&&(t+="*"+fR(e.mult)),null!=e.offset&&(t+="+"+fR(e.offset)),e.round&&(t=`round(${t})`),t}const dR=(e,t,n,i)=>`(${e}(${[t,n,i].map(hR).join(",")})+'')`;function fR(e){return Object(p.G)(e)?"("+hR(e)+")":e}function pR(e){return function e(t){let n,i,r;if(t.signal)n="datum",r=t.signal;else if(t.group||t.parent){for(i=Math.max(1,t.level||1),n="item";i-- >0;)n+=".mark.group";t.parent?(r=t.parent,n+=".datum"):r=t.group}else t.datum?(n="datum",r=t.datum):Object(p.o)("Invalid field reference: "+Object(p.ab)(t));t.signal||(r=Object(p.I)(r)?Object(p.Z)(r).map(p.ab).join("]["):e(r));return n+"["+r+"]"}(Object(p.G)(e)?e:{datum:e})}var gR=function(e,t,n,i,r,o){const s={};(o=o||{}).encoders={$encode:s},e=function(e,t,n,i,r){const o={},s={};let a,l,c,u;for(l in l="lineBreak","text"!==t||null==r[l]||lR(l,e)||cR(o,l,r[l]),("legend"==n||String(n).startsWith("axis"))&&(n=null),u="frame"===n?r.group:"mark"===n?Object(p.p)({},r.mark,r[t]):null,u)c=lR(l,e)||("fill"===l||"stroke"===l)&&(lR("fill",e)||lR("stroke",e)),c||cR(o,l,u[l]);for(l in Object(p.i)(i).forEach(t=>{const n=r.style&&r.style[t];for(const t in n)lR(t,e)||cR(o,t,n[t])}),e=Object(p.p)({},e),o)u=o[l],u.signal?(a=a||{})[l]=u:s[l]=u;return e.enter=Object(p.p)(s,e.enter),a&&(e.update=Object(p.p)(a,e.update)),e}(e,t,n,i,r.config);for(const n in e)s[n]=mR(e[n],t,o,r);return o};function mR(e,t,n,i){const r={},o={};for(const t in e)null!=e[t]&&(r[t]=vR((s=e[t],Object(p.B)(s)?function(e){let t="";return e.forEach(e=>{const n=hR(e);t+=e.test?`(${e.test})?${n}:`:n}),":"===Object(p.V)(t)&&(t+="null"),t}(s):hR(s)),i,n,o));var s;return{$expr:{marktype:t,channels:r},$fields:Object.keys(o),$output:Object.keys(e)}}function vR(e,t,n,i){const r=Mj(e,t);return r.$fields.forEach(e=>i[e]=1),Object(p.p)(n,r.$params),r.$expr}const bR=["value","update","init","react","bind"];function yR(e,t){Object(p.o)(e+' for "outer" push: '+Object(p.ab)(t))}var wR=function(e,t){const n=e.name;if("outer"===e.push)t.signals[n]||yR("No prior signal definition",n),bR.forEach(t=>{void 0!==e[t]&&yR("Invalid property ",t)});else{const i=t.addSignal(n,e.value);!1===e.react&&(i.react=!1),e.bind&&t.addBinding(n,e.bind)}};function xR(e,t,n,i){this.id=-1,this.type=e,this.value=t,this.params=n,i&&(this.parent=i)}function _R(e,t,n,i){return new xR(e,t,n,i)}function kR(e,t){return _R("operator",e,t)}function SR(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function OR(e,t){return t?{$field:e,$name:t}:{$field:e}}const CR=OR("key");function AR(e,t){return{$compare:e,$order:t}}function $R(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}function ER(e){return e&&e.signal}function MR(e){if(ER(e))return!0;if(Object(p.G)(e))for(const t in e)if(MR(e[t]))return!0;return!1}function jR(e,t){return null!=e?e:t}function RR(e){return e&&e.signal||e}function DR(e,t){return(e.merge?TR:e.stream?LR:e.type?FR:Object(p.o)("Invalid stream specification: "+Object(p.ab)(e)))(e,t)}function TR(e,t){const n=NR({merge:e.merge.map(e=>DR(e,t))},e,t);return t.addStream(n).id}function LR(e,t){const n=NR({stream:DR(e.stream,t)},e,t);return t.addStream(n).id}function FR(e,t){let n,i;var r;return"timer"===e.type?(n=t.event("timer",e.throttle),e={between:e.between,filter:e.filter}):n=t.event("scope"===(r=e.source)?"view":r||"view",e.type),i=NR({stream:n},e,t),1===Object.keys(i).length?n:t.addStream(i).id}function NR(e,t,n){let i=t.between;return i&&(2!==i.length&&Object(p.o)('Stream "between" parameter must have 2 entries: '+Object(p.ab)(t)),e.between=[DR(i[0],n),DR(i[1],n)]),i=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&i.push(function(e,t,n){const i="event.item";return i+(e&&"*"!==e?"&&"+i+".mark.marktype==='"+e+"'":"")+(n?"&&"+i+".mark.role==='"+n+"'":"")+(t?"&&"+i+".mark.name==='"+t+"'":"")}(t.marktype,t.markname,t.markrole)),"scope"===t.source&&i.push("inScope(event.item)"),i.length&&(e.filter=Mj("("+i.join(")&&(")+")",n).$expr),null!=(i=t.throttle)&&(e.throttle=+i),null!=(i=t.debounce)&&(e.debounce=+i),t.consume&&(e.consume=!0),e}var PR=n(6);const zR={code:"_.$value",ast:{type:"Identifier",value:"value"}};var IR=function(e,t,n){let i=e.events,r=e.update,o=e.encode,s=[],a={target:n};i||Object(p.o)("Signal update missing events specification."),Object(p.I)(i)&&(i=Object(PR.a)(i,t.isSubscope()?"scope":"view")),i=Object(p.i)(i).filter(e=>e.signal||e.scale?(s.push(e),0):1),s.length>1&&(s=[BR(s)]),i.length&&s.push(i.length>1?{merge:i}:i[0]),null!=o&&(r&&Object(p.o)("Signal encode and update are mutually exclusive."),r="encode(item(),"+Object(p.ab)(o)+")"),a.update=Object(p.I)(r)?Mj(r,t):null!=r.expr?Mj(r.expr,t):null!=r.value?r.value:null!=r.signal?{$expr:zR,$params:{$value:t.signalRef(r.signal)}}:Object(p.o)("Invalid signal update specification."),e.force&&(a.options={force:!0}),s.forEach(e=>t.addUpdate(Object(p.p)(function(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):DR(e,t)}}(e,t),a)))};function BR(e){return{signal:"["+e.map(e=>e.scale?'scale("'+e.scale+'")':e.signal)+"]"}}const WR=e=>(t,n,i)=>_R(e,n,t||void 0,i),UR=WR("aggregate"),HR=WR("axisticks"),qR=WR("bound"),VR=WR("collect"),GR=WR("compare"),KR=WR("datajoin"),YR=WR("encode"),XR=WR("expression"),JR=(WR("extent"),WR("facet")),QR=WR("field"),ZR=WR("key"),eD=WR("legendentries"),tD=WR("load"),nD=WR("mark"),iD=WR("multiextent"),rD=WR("multivalues"),oD=WR("overlap"),sD=WR("params"),aD=WR("prefacet"),lD=WR("projection"),cD=WR("proxy"),uD=WR("relay"),hD=WR("render"),dD=WR("scale"),fD=WR("sieve"),pD=WR("sortitems"),gD=WR("viewlayout"),mD=WR("values");let vD=0;const bD={min:"min",max:"max",count:"sum"};function yD(e,t){let n,i=t.getScale(e.name).params;var r;for(n in i.domain=kD(e.domain,e,t),null!=e.range&&(i.range=function e(t,n,i){let r=t.range,o=n.config.range;if(r.signal)return n.signalRef(r.signal);if(Object(p.I)(r)){if(o&&Object(p.w)(o,r))return t=Object(p.p)({},t,{range:o[r]}),e(t,n,i);"width"===r?r=[0,{signal:"width"}]:"height"===r?r=Yp(t.type)?[0,{signal:"height"}]:[{signal:"height"},0]:Object(p.o)("Unrecognized scale range value: "+Object(p.ab)(r))}else{if(r.scheme)return i.scheme=Object(p.B)(r.scheme)?xD(r.scheme,n):wD(r.scheme,n),r.extent&&(i.schemeExtent=xD(r.extent,n)),void(r.count&&(i.schemeCount=wD(r.count,n)));if(r.step)return void(i.rangeStep=wD(r.step,n));if(Yp(t.type)&&!Object(p.B)(r))return kD(r,t,n);Object(p.B)(r)||Object(p.o)("Unsupported range type: "+Object(p.ab)(r))}return r.map(e=>(Object(p.B)(e)?xD:wD)(e,n))}(e,t,i)),null!=e.interpolate&&function(e,t){t.interpolate=wD(e.type||e),null!=e.gamma&&(t.interpolateGamma=wD(e.gamma))}(e.interpolate,i),null!=e.nice&&(i.nice=(r=e.nice,Object(p.G)(r)?{interval:wD(r.interval),step:wD(r.step)}:wD(r))),null!=e.bins&&(i.bins=function(e,t){return e.signal||Object(p.B)(e)?xD(e,t):t.objectProperty(e)}(e.bins,t)),e)Object(p.w)(i,n)||"name"===n||(i[n]=wD(e[n],t))}function wD(e,t){return Object(p.G)(e)?e.signal?t.signalRef(e.signal):Object(p.o)("Unsupported object: "+Object(p.ab)(e)):e}function xD(e,t){return e.signal?t.signalRef(e.signal):e.map(e=>wD(e,t))}function _D(e){Object(p.o)("Can not find data set: "+Object(p.ab)(e))}function kD(e,t,n){if(e)return e.signal?n.signalRef(e.signal):(Object(p.B)(e)?SD:e.fields?CD:OD)(e,t,n);null==t.domainMin&&null==t.domainMax||Object(p.o)("No scale domain defined for domainMin/domainMax to override.")}function SD(e,t,n){return e.map(e=>wD(e,n))}function OD(e,t,n){const i=n.getData(e.data);return i||_D(e.data),Yp(t.type)?i.valuesRef(n,e.field,$D(e.sort,!1)):Zp(t.type)?i.domainRef(n,e.field):i.extentRef(n,e.field)}function CD(e,t,n){const i=e.data,r=e.fields.reduce((function(e,t){return t=Object(p.I)(t)?{data:i,field:t}:Object(p.B)(t)||t.signal?function(e,t){const n="_:vega:_"+vD++,i=VR({});if(Object(p.B)(e))i.value={$ingest:e};else if(e.signal){const r="setdata("+Object(p.ab)(n)+","+e.signal+")";i.params.input=t.signalRef(r)}return t.addDataPipeline(n,[i,fD({})]),{data:n,field:"data"}}(t,n):t,e.push(t),e}),[]);return(Yp(t.type)?AD:Zp(t.type)?ED:MD)(e,n,r)}function AD(e,t,n){let i,r,o,s,a,l=$D(e.sort,!0);return i=n.map(e=>{const n=t.getData(e.data);return n||_D(e.data),n.countsRef(t,e.field,l)}),r={groupby:CR,pulse:i},l&&(o=l.op||"count",a=l.field?$R(o,l.field):"count",r.ops=[bD[o]],r.fields=[t.fieldRef(a)],r.as=[a]),o=t.add(UR(r)),s=t.add(VR({pulse:SR(o)})),a=t.add(mD({field:CR,sort:t.sortRef(l),pulse:SR(s)})),SR(a)}function $D(e,t){return e&&(e.field||e.op?e.field||"count"===e.op?t&&e.field&&e.op&&!bD[e.op]&&Object(p.o)("Multiple domain scales can not be sorted using "+e.op):Object(p.o)("No field provided for sort aggregate op: "+e.op):Object(p.G)(e)?e.field="key":e={field:"key"}),e}function ED(e,t,n){const i=n.map(e=>{const n=t.getData(e.data);return n||_D(e.data),n.domainRef(t,e.field)});return SR(t.add(rD({values:i})))}function MD(e,t,n){const i=n.map(e=>{const n=t.getData(e.data);return n||_D(e.data),n.extentRef(t,e.field)});return SR(t.add(iD({extents:i})))}function jD(e,t,n){return Object(p.B)(e)?e.map(e=>jD(e,t,n)):Object(p.G)(e)?e.signal?n.signalRef(e.signal):"fit"===t?e:Object(p.o)("Unsupported parameter object: "+Object(p.ab)(e)):e}const RD="value",DD=["size","shape","fill","stroke","strokeWidth","strokeDash","opacity"],TD={name:1,style:1,interactive:1},LD={value:0},FD={value:1};var ND=function(e){return e.type="group",e.interactive=e.interactive||!1,e};function PD(e,t){const n=(n,i)=>jR(e[n],jR(t[n],i));return n.isVertical=n=>"vertical"===jR(e.direction,t.direction||(n?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>jR(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>jR(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>jR(e.columns,jR(t.columns,+n.isVertical(!0))),n}function zD(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function ID(e,t,n){return`item.anchor === 'start' ? ${e} : item.anchor === 'end' ? ${t} : ${n}`}const BD=ID(Object(p.ab)("left"),Object(p.ab)("right"),Object(p.ab)("center"));function WD(e,t){return t?e?Object(p.G)(e)?Object.assign({},e,{offset:WD(e.offset,t)}):{value:e,offset:t}:t:e}var UD=function(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=aR(e.encode,t,TD)):e.interactive=!1,e},HD=function(e,t,n,i){let r,o,s,a,l,c,u=PD(e,n),h=u.isVertical(),d=u.gradientThickness(),f=u.gradientLength();return h?(s=[0,1],a=[0,0],l=d,c=f):(s=[0,0],a=[1,0],l=f,c=d),r={enter:o={opacity:LD,x:LD,y:LD,width:rR(l),height:rR(c)},update:Object(p.p)({},o,{opacity:FD,fill:{gradient:t,start:s,stop:a}}),exit:{opacity:LD}},sR(r,{stroke:u("gradientStrokeColor"),strokeWidth:u("gradientStrokeWidth")},{opacity:u("gradientOpacity")}),UD({type:"rect",role:"legend-gradient",encode:r},i)},qD=function(e,t,n,i,r){let o,s,a,l,c,u,h=PD(e,n),d=h.isVertical(),f=h.gradientThickness(),g=h.gradientLength(),m="";return d?(a="y",c="y2",l="x",u="width",m="1-"):(a="x",c="x2",l="y",u="height"),s={opacity:LD,fill:{scale:t,field:RD}},s[a]={signal:m+"datum.perc",mult:g},s[l]=LD,s[c]={signal:m+"datum.perc2",mult:g},s[u]=rR(f),o={enter:s,update:Object(p.p)({},s,{opacity:FD}),exit:{opacity:LD}},sR(o,{stroke:h("gradientStrokeColor"),strokeWidth:h("gradientStrokeWidth")},{opacity:h("gradientOpacity")}),UD({type:"rect",role:"legend-band",key:RD,from:r,encode:o},i)};var VD=function(e,t,n,i){let r,o,s,a,l,c=PD(e,t),u=c.isVertical(),h=rR(c.gradientThickness()),d=c.gradientLength(),f=c("labelOverlap"),p="";return r={enter:o={opacity:LD},update:s={opacity:FD,text:{field:"label"}},exit:{opacity:LD}},sR(r,{fill:c("labelColor"),fillOpacity:c("labelOpacity"),font:c("labelFont"),fontSize:c("labelFontSize"),fontStyle:c("labelFontStyle"),fontWeight:c("labelFontWeight"),limit:jR(e.labelLimit,t.gradientLabelLimit)}),u?(o.align={value:"left"},o.baseline=s.baseline={signal:'datum.perc<=0?"bottom":datum.perc>=1?"top":"middle"'},a="y",l="x",p="1-"):(o.align=s.align={signal:'datum.perc<=0?"left":datum.perc>=1?"right":"center"'},o.baseline={value:"top"},a="x",l="y"),o[a]=s[a]={signal:p+"datum.perc",mult:d},o[l]=s[l]=h,h.offset=jR(e.labelOffset,t.gradientLabelOffset)||0,f=f?{separation:c("labelSeparation"),method:f,order:"datum.index"}:void 0,UD({type:"text",role:"legend-label",style:"guide-label",key:RD,from:i,encode:r,overlap:f},n)},GD=function(e,t,n,i,r){let o,s,a,l,c,u,h,d=PD(e,t),f=n.entries,p=!(!f||!f.interactive),g=f?f.name:void 0,m=d("clipHeight"),v=d("symbolOffset"),b={data:"value"},y={},w=`(${r}) ? datum.offset : datum.size`,x=m?rR(m):{field:"size"},_="datum.index",k=`max(1, ${r})`;x.mult=.5,y={enter:o={opacity:LD,x:{signal:w,mult:.5,offset:v},y:x},update:s={opacity:FD,x:o.x,y:o.y},exit:{opacity:LD}};let S=null,O=null;return e.fill||(S=t.symbolBaseFillColor,O=t.symbolBaseStrokeColor),sR(y,{fill:d("symbolFillColor",S),shape:d("symbolType"),size:d("symbolSize"),stroke:d("symbolStrokeColor",O),strokeDash:d("symbolDash"),strokeDashOffset:d("symbolDashOffset"),strokeWidth:d("symbolStrokeWidth")},{opacity:d("symbolOpacity")}),DD.forEach((function(t){e[t]&&(s[t]=o[t]={scale:e[t],field:RD})})),l=UD({type:"symbol",role:"legend-symbol",key:RD,from:b,clip:!!m||void 0,encode:y},n.symbols),a=rR(v),a.offset=d("labelOffset"),y={enter:o={opacity:LD,x:{signal:w,offset:a},y:x},update:s={opacity:FD,text:{field:"label"},x:o.x,y:o.y},exit:{opacity:LD}},sR(y,{align:d("labelAlign"),baseline:d("labelBaseline"),fill:d("labelColor"),fillOpacity:d("labelOpacity"),font:d("labelFont"),fontSize:d("labelFontSize"),fontStyle:d("labelFontStyle"),fontWeight:d("labelFontWeight"),limit:d("labelLimit")}),c=UD({type:"text",role:"legend-label",style:"guide-label",key:RD,from:b,encode:y},n.labels),y={enter:{noBound:{value:!m},width:LD,height:m?rR(m):LD,opacity:LD},exit:{opacity:LD},update:s={opacity:FD,row:{signal:null},column:{signal:null}}},d.isVertical(!0)?(u=`ceil(item.mark.items.length / ${k})`,s.row.signal=`${_}%${u}`,s.column.signal=`floor(${_} / ${u})`,h={field:["row",_]}):(s.row.signal=`floor(${_} / ${k})`,s.column.signal=`${_} % ${k}`,h={field:_}),s.column.signal=`(${r})?${s.column.signal}:${_}`,ND({role:"scope",from:i={facet:{data:i,name:"value",groupby:"index"}},encode:aR(y,f,TD),marks:[l,c],name:g,interactive:p,sort:h})};const KD='item.orient === "left"',YD='item.orient === "right"',XD=`(${KD} || ${YD})`,JD="datum.vgrad && "+XD,QD=ID('"top"','"bottom"','"middle"'),ZD=`datum.vgrad && ${YD} ? (${ID('"right"','"left"','"center"')}) : (${XD} && !(datum.vgrad && ${KD})) ? "left" : ${BD}`,eT=`item._anchor || (${XD} ? "middle" : "start")`,tT=`${JD} ? (${KD} ? -90 : 90) : 0`,nT=`${XD} ? (datum.vgrad ? (${YD} ? "bottom" : "top") : ${QD}) : "top"`;var iT=function(e,t){let n;return Object(p.G)(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+rT(e.path)+")":e.sphere&&(n="geoShape("+rT(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e};function rT(e){return Object(p.G)(e)&&e.signal?e.signal:Object(p.ab)(e)}var oT=function(e){const t=e.role||"";return t.indexOf("axis")&&t.indexOf("legend")&&t.indexOf("title")?"group"===e.type?"scope":t||"mark":t},sT=function(e){return{marktype:e.type,name:e.name||void 0,role:e.role||oT(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}},aT=function(e,t){return e&&e.signal?t.signalRef(e.signal):!1!==e},lT=function(e,t){const n=zr(e.type);n||Object(p.o)("Unrecognized transform type: "+Object(p.ab)(e.type));const i=_R(n.type.toLowerCase(),null,cT(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(i)),i.metadata=n.metadata||{},i};function cT(e,t,n){let i,r,o,s={};for(r=0,o=e.params.length;r<o;++r)i=e.params[r],s[i.name]=uT(i,t,n);return s}function uT(e,t,n){const i=e.type,r=t[e.name];return"index"===i?function(e,t,n){Object(p.I)(t.from)||Object(p.o)('Lookup "from" parameter must be a string literal.');return n.getData(t.from).lookupRef(n,t.key)}(0,t,n):void 0!==r?"param"===i?function(e,t,n){const i=t[e.name];return e.array?(Object(p.B)(i)||Object(p.o)("Expected an array of sub-parameters. Instead: "+Object(p.ab)(i)),i.map(t=>dT(e,t,n))):dT(e,i,n)}(e,t,n):"projection"===i?n.projectionRef(t[e.name]):e.array&&!ER(r)?r.map(t=>hT(e,t,n)):hT(e,r,n):void(e.required&&Object(p.o)("Missing required "+Object(p.ab)(t.type)+" parameter: "+Object(p.ab)(e.name)))}function hT(e,t,n){const i=e.type;if(ER(t))return mT(i)?Object(p.o)("Expression references can not be signals."):vT(i)?n.fieldRef(t):bT(i)?n.compareRef(t):n.signalRef(t.signal);{const r=e.expr||vT(i);return r&&fT(t)?n.exprRef(t.expr,t.as):r&&pT(t)?OR(t.field,t.as):mT(i)?Mj(t,n):gT(i)?SR(n.getData(t).values):vT(i)?OR(t):bT(i)?n.compareRef(t):t}}function dT(e,t,n){let i,r,o,s,a;for(s=0,a=e.params.length;s<a;++s){for(o in r=e.params[s],r.key)if(r.key[o]!==t[o]){r=null;break}if(r)break}return r||Object(p.o)("Unsupported parameter: "+Object(p.ab)(t)),i=Object(p.p)(cT(r,t,n),r.key),SR(n.add(sD(i)))}const fT=e=>e&&e.expr,pT=e=>e&&e.field,gT=e=>"data"===e,mT=e=>"expr"===e,vT=e=>"field"===e,bT=e=>"compare"===e;function yT(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:SR(t.getData(e.data).output)}function wT(e,t,n,i,r){this.scope=e,this.input=t,this.output=n,this.values=i,this.aggregate=r,this.index={}}function xT(e){return Object(p.I)(e)?e:null}function _T(e,t,n){let i,r=$R(n.op,n.field);if(t.ops){for(let e=0,n=t.as.length;e<n;++e)if(t.as[e]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function kT(e,t,n,i,r,o,s){let a,l,c=t[n]||(t[n]={}),u=function(e){return Object(p.G)(e)?("descending"===e.order?"-":"+")+$R(e.op,e.field):""}(o),h=xT(r);if(null!=h&&(e=t.scope,h+=u?"|"+u:"",a=c[h]),!a){const n=o?{field:CR,pulse:t.countsRef(e,r,o)}:{field:e.fieldRef(r),pulse:SR(t.output)};u&&(n.sort=e.sortRef(o)),l=e.add(_R(i,void 0,n)),s&&(t.index[r]=l),a=SR(l),null!=h&&(c[h]=a)}return a}wT.fromEntries=function(e,t){let n=t.length,i=1,r=t[0],o=t[n-1],s=t[n-2],a=null;for(r&&"load"===r.type&&(r=t[1]),e.add(t[0]);i<n;++i)t[i].params.pulse=SR(t[i-1]),e.add(t[i]),"aggregate"===t[i].type&&(a=t[i]);return new wT(e,r,s,o,a)},wT.prototype={countsRef(e,t,n){let i,r,o,s=this,a=s.counts||(s.counts={}),l=xT(t);return null!=l&&(e=s.scope,i=a[l]),i?n&&n.field&&_T(e,i.agg.params,n):(o={groupby:e.fieldRef(t,"key"),pulse:SR(s.output)},n&&n.field&&_T(e,o,n),r=e.add(UR(o)),i=e.add(VR({pulse:SR(r)})),i={agg:r,ref:SR(i)},null!=l&&(a[l]=i)),i.ref},tuplesRef(){return SR(this.values)},extentRef(e,t){return kT(e,this,"extent","extent",t,!1)},domainRef(e,t){return kT(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return kT(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return kT(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return kT(e,this,"indata","tupleindex",t,!0,!0)}};var ST=function(e,t,n){let i,r,o=e.remove,s=e.insert,a=e.toggle,l=e.modify,c=e.values,u=t.add(kR());i="if("+e.trigger+',modify("'+n+'",'+[s,o,a,l,c].map(e=>null==e?"null":e).join(",")+"),0)",r=Mj(i,t),u.update=r.$expr,u.params=r.$params},OT=function(e,t){let n,i,r,o,s,a,l,c,u,h,d,f,g,m,v=oT(e),b="group"===e.type,y=e.from&&e.from.facet,w=e.layout||"scope"===v||"frame"===v,x="mark"===v||w||y,_=e.overlap;r=function(e,t,n){let i,r,o,s,a;return e?(i=e.facet)&&(t||Object(p.o)("Only group marks can be faceted."),null!=i.field?s=a=yT(i,n):(e.data?a=SR(n.getData(e.data).aggregate):(o=lT(Object(p.p)({type:"aggregate",groupby:Object(p.i)(i.groupby)},i.aggregate),n),o.params.key=n.keyRef(i.groupby),o.params.pulse=yT(i,n),s=a=SR(n.add(o))),r=n.keyRef(i.groupby,!0))):s=SR(n.add(VR(null,[{}]))),s||(s=yT(e,n)),{key:r,pulse:s,parent:a}}(e.from,b,t),i=t.add(KR({key:r.key||(e.key?OR(e.key):void 0),pulse:r.pulse,clean:!b})),h=SR(i),i=o=t.add(VR({pulse:h})),i=t.add(nD({markdef:sT(e),interactive:aT(e.interactive,t),clip:iT(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:SR(i)})),d=SR(i),i=s=t.add(YR(gR(e.encode,e.type,v,e.style,t,{mod:!1,pulse:d}))),i.params.parent=t.encode(),e.transform&&e.transform.forEach(e=>{const n=lT(e,t),r=n.metadata;(r.generates||r.changes)&&Object(p.o)("Mark transforms should not generate new data."),r.nomod||(s.params.mod=!0),n.params.pulse=SR(i),t.add(i=n)}),e.sort&&(i=t.add(pD({sort:t.compareRef(e.sort),pulse:SR(i)}))),f=SR(i),(y||w)&&(w=t.add(gD({layout:t.objectProperty(e.layout),legends:t.legends,mark:d,pulse:f})),g=SR(w)),a=t.add(qR({mark:d,pulse:g||f})),m=SR(a),b&&(x&&(n=t.operators,n.pop(),w&&n.pop()),t.pushState(f,g||m,h),y?function(e,t,n){let i,r,o,s,a=e.from.facet,l=a.name,c=yT(a,t);a.name||Object(p.o)("Facet must have a name: "+Object(p.ab)(a)),a.data||Object(p.o)("Facet must reference a data set: "+Object(p.ab)(a)),a.field?s=t.add(aD({field:t.fieldRef(a.field),pulse:c})):a.groupby?s=t.add(JR({key:t.keyRef(a.groupby),group:SR(t.proxy(n.parent)),pulse:c})):Object(p.o)("Facet must specify groupby or field: "+Object(p.ab)(a)),i=t.fork(),r=i.add(VR()),o=i.add(fD({pulse:SR(r)})),i.addData(l,new wT(i,r,r,o)),i.addSignal("parent",null),s.params.subflow={$subflow:i.parse(e).toRuntime()}}(e,t,r):x?function(e,t,n){const i=t.add(aD({pulse:n.pulse})),r=t.fork();r.add(fD()),r.addSignal("parent",null),i.params.subflow={$subflow:r.parse(e).toRuntime()}}(e,t,r):t.parse(e),t.popState(),x&&(w&&n.push(w),n.push(a))),_&&(m=function(e,t,n){const i=e.method,r=e.bound,o=e.separation,s={separation:ER(o)?n.signalRef(o.signal):o,method:ER(i)?n.signalRef(i.signal):i,pulse:t};e.order&&(s.sort=n.compareRef({field:e.order}));if(r){const e=r.tolerance;s.boundTolerance=ER(e)?n.signalRef(e.signal):+e,s.boundScale=n.scaleRef(r.scale),s.boundOrient=r.orient}return SR(n.add(oD(s)))}(_,m,t)),l=t.add(hD({pulse:m})),c=t.add(fD({pulse:SR(l)},void 0,t.parent())),null!=e.name&&(u=e.name,t.addData(u,new wT(t,o,l,c)),e.on&&e.on.forEach(e=>{(e.insert||e.remove||e.toggle)&&Object(p.o)("Marks only support modify triggers."),ST(e,t,u)}))};var CT=function(e,t){let n,i,r,o,s,a,l,c,u=t.config.legend,h=e.encode||{},d=h.legend||{},f=d.name||void 0,g=d.interactive,m=d.style,v=PD(e,u),b={},y=0;return DD.forEach(t=>e[t]?(b[t]=e[t],y=y||e[t]):0),y||Object(p.o)("Missing valid scale for legend."),s=function(e,t){let n=e.type||"symbol";e.type||1!==function(e){return DD.reduce((function(t,n){return t+(e[n]?1:0)}),0)}(e)||!e.fill&&!e.stroke||(n=Kp(t)?"gradient":Xp(t)?"discrete":"symbol");return"gradient"!==n?n:Xp(t)?"discrete":"gradient"}(e,t.scaleType(y)),a={title:null!=e.title,scales:b,type:s,vgrad:"symbol"!==s&&v.isVertical()},l=SR(t.add(VR(null,[a]))),d=aR(function(e,t,n){const i={enter:{},update:{}};return sR(i,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),i}(v,e,u),d,TD),n={enter:{x:{value:0},y:{value:0}}},c=SR(t.add(eD(r={type:s,scale:t.scaleRef(y),count:t.objectProperty(v("tickCount")),limit:t.property(v("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),"gradient"===s?(o=[HD(e,y,u,h.gradient),VD(e,u,h.labels,c)],r.count=r.count||t.signalRef(`max(2,2*floor((${RR(v.gradientLength())})/100))`)):"discrete"===s?o=[qD(e,y,u,h.gradient,c),VD(e,u,h.labels,c)]:(i=function(e,t){const n=PD(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(e,u),o=[GD(e,u,h,c,RR(i.columns))],r.size=function(e,t,n){const i=RR(AT("size",e,n)),r=RR(AT("strokeWidth",e,n)),o=RR(function(e,t,n){return zD("fontSize",e)||function(e,t,n){const i=t.config.style[n];return i&&i[e]}("fontSize",t,n)}(n[1].encode,t,"guide-label"));return Mj(`max(ceil(sqrt(${i})+${r}),${o})`,t)}(e,t,o[0].marks)),o=[ND({role:"legend-entry",from:l,encode:n,marks:o,layout:i,interactive:g})],a.title&&o.push(function(e,t,n,i){let r,o=PD(e,t);return r={enter:{opacity:LD},update:{opacity:FD,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:LD}},sR(r,{orient:o("titleOrient"),_anchor:o("titleAnchor"),anchor:{signal:eT},angle:{signal:tT},align:{signal:ZD},baseline:{signal:nT},text:e.title,fill:o("titleColor"),fillOpacity:o("titleOpacity"),font:o("titleFont"),fontSize:o("titleFontSize"),fontStyle:o("titleFontStyle"),fontWeight:o("titleFontWeight"),limit:o("titleLimit"),lineHeight:o("titleLineHeight")},{align:o("titleAlign"),baseline:o("titleBaseline")}),UD({type:"text",role:"legend-title",style:"guide-title",from:i,encode:r},n)}(e,u,h.title,l)),OT(ND({role:"legend",from:l,encode:d,marks:o,aria:v("aria"),description:v("description"),zindex:v("zindex"),name:f,interactive:g,style:m}),t)};function AT(e,t,n){return t[e]?`scale("${t[e]}",datum)`:zD(e,n[0].encode)}var $T=function(e,t){let n,i,r=PD(e=Object(p.I)(e)?{text:e}:e,t.config.title),o=e.encode||{},s=o.group||{},a=s.name||void 0,l=s.interactive,c=s.style,u=[];return n={},i=SR(t.add(VR(null,[n]))),u.push(function(e,t,n,i){const r={value:0},o=e.text,s={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return sR(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),UD({type:"text",role:"title-text",style:"group-title",from:i,encode:s},n)}(e,r,function(e){const t=e.encode;return t&&t.title||Object(p.p)({name:e.name,interactive:e.interactive,style:e.style},t)}(e),i)),e.subtitle&&u.push(function(e,t,n,i){const r={value:0},o=e.subtitle,s={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return sR(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),UD({type:"text",role:"title-subtitle",style:"group-subtitle",from:i,encode:s},n)}(e,r,o.subtitle,i)),OT(ND({role:"title",from:i,encode:ET(r,s),marks:u,aria:r("aria"),description:r("description"),zindex:r("zindex"),name:a,interactive:l,style:c}),t)};function ET(e,t){const n={enter:{},update:{}};return sR(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:BD},angle:{signal:'item.orient==="left"?-90:item.orient==="right"?90:0'},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),aR(n,t,TD)}function MT(e,t){const n=[];e.transform&&e.transform.forEach(e=>{n.push(lT(e,t))}),e.on&&e.on.forEach((function(n){ST(n,t,e.name)})),t.addDataPipeline(e.name,function(e,t,n){let i,r,o,s,a,l=[],c=null,u=!1,h=!1;e.values?MR(e.values)||MR(e.format)?(l.push(RT(t,e)),l.push(c=jT())):l.push(c=jT({$ingest:e.values,$format:e.format})):e.url?MR(e.url)||MR(e.format)?(l.push(RT(t,e)),l.push(c=jT())):l.push(c=jT({$request:e.url,$format:e.format})):e.source&&(c=i=Object(p.i)(e.source).map(e=>SR(t.getData(e).output)),l.push(null));for(r=0,o=n.length;r<o;++r)s=n[r],a=s.metadata,c||a.source||l.push(c=jT()),l.push(s),a.generates&&(h=!0),a.modifies&&!h&&(u=!0),a.source?c=s:a.changes&&(c=null);i&&(o=i.length-1,l[0]=uD({derive:u,pulse:o?i:i[0]}),(u||o)&&l.splice(1,0,jT()));c||l.push(jT());return l.push(fD({})),l}(e,t,n))}function jT(e){const t=VR({},e);return t.metadata={source:!0},t}function RT(e,t){return tD({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const DT=e=>"bottom"===e||"top"===e,TT=(e,t,n)=>ER(e)?IT(e.signal,t,n):"left"===e||"top"===e?t:n,LT=(e,t,n)=>ER(e)?PT(e.signal,t,n):DT(e)?t:n,FT=(e,t,n)=>ER(e)?zT(e.signal,t,n):DT(e)?n:t,NT=(e,t,n)=>ER(e)?BT(e.signal,t,n):"top"===e?{value:t}:{value:n},PT=(e,t,n)=>UT(`${e} === 'top' || ${e} === 'bottom'`,t,n),zT=(e,t,n)=>UT(`${e} !== 'top' && ${e} !== 'bottom'`,t,n),IT=(e,t,n)=>qT(`${e} === 'left' || ${e} === 'top'`,t,n),BT=(e,t,n)=>qT(e+" === 'top'",t,n),WT=(e,t,n)=>qT(e+" === 'right'",t,n),UT=(e,t,n)=>(t=null!=t?rR(t):t,n=null!=n?rR(n):n,HT(t)&&HT(n)?{signal:`${e} ? (${t=t?t.signal||Object(p.ab)(t.value):null}) : (${n=n?n.signal||Object(p.ab)(n.value):null})`}:[Object(p.p)({test:e},t)].concat(n||[])),HT=e=>null==e||1===Object.keys(e).length,qT=(e,t,n)=>({signal:`${e} ? (${VT(t)}) : (${VT(n)})`}),VT=e=>ER(e)?e.signal:null==e?null:Object(p.ab)(e),GT=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function KT(e,t,n,i){let r;if(t&&Object(p.w)(t,e))return t[e];if(Object(p.w)(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":r="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":r=e[5].toLowerCase()+e.slice(6)}return i["guide-title"][r]}if(e.startsWith("label")){switch(e){case"labelColor":r="fill";break;case"labelFont":case"labelFontSize":r=e[5].toLowerCase()+e.slice(6)}return i["guide-label"][r]}return null}function YT(e){const t={};for(const n of e)if(n)for(const e in n)t[e]=1;return Object.keys(t)}function XT(e,t){return{scale:e.scale,range:t}}var JT=function(e,t,n,i,r){let o,s,a,l,c,u,h,d,f=PD(e,t),g=e.orient,m=e.gridScale,v=TT(g,1,-1),b=function(e,t){if(1===t);else if(Object(p.G)(e)){let n=e=Object(p.p)({},e);for(;null!=n.mult;){if(!Object(p.G)(n.mult))return n.mult=ER(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n=n.mult=Object(p.p)({},n.mult)}n.mult=t}else e=ER(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);return e}(e.offset,v);return o={enter:s={opacity:LD},update:l={opacity:FD},exit:a={opacity:LD}},sR(o,{stroke:f("gridColor"),strokeCap:f("gridCap"),strokeDash:f("gridDash"),strokeDashOffset:f("gridDashOffset"),strokeOpacity:f("gridOpacity"),strokeWidth:f("gridWidth")}),c={scale:e.scale,field:RD,band:r.band,extra:r.extra,offset:r.offset,round:f("tickRound")},d=LT(g,{signal:"height"},{signal:"width"}),u=m?{scale:m,range:0,mult:v,offset:b}:{value:0,offset:b},h=m?{scale:m,range:1,mult:v,offset:b}:Object(p.p)(d,{mult:v,offset:b}),s.x=l.x=LT(g,c,u),s.y=l.y=FT(g,c,u),s.x2=l.x2=FT(g,h),s.y2=l.y2=LT(g,h),a.x=LT(g,c),a.y=FT(g,c),UD({type:"rule",role:"axis-grid",key:RD,from:i,encode:o},n)};function QT(e,t,n,i,r){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+i+","+r+")"}}var ZT=function(e,t,n,i,r,o){let s,a,l,c,u,h,d,f,p,g,m=PD(e,t),v=e.orient,b=e.scale,y=TT(v,-1,1),w=RR(m("labelFlush")),x=RR(m("labelFlushOffset")),_=0===w||!!w,k=m("labelAlign"),S=m("labelBaseline");return c=rR(r),c.mult=y,c.offset=rR(m("labelPadding")||0),c.offset.mult=y,u={scale:b,field:RD,band:.5,offset:WD(o.offset,m("labelOffset"))},h=LT(v,_?QT(b,w,'"left"','"right"','"center"'):{value:"center"},((e,t,n)=>ER(e)?WT(e.signal,t,n):"right"===e?{value:t}:{value:n})(v,"left","right")),d=LT(v,NT(v,"bottom","top"),_?QT(b,w,'"top"','"bottom"','"middle"'):{value:"middle"}),g=QT(b,w,`-(${x})`,x,0),_=_&&x,a={opacity:LD,x:LT(v,u,c),y:FT(v,u,c)},s={enter:a,update:l={opacity:FD,text:{field:"label"},x:a.x,y:a.y,align:h,baseline:d},exit:{opacity:LD,x:a.x,y:a.y}},sR(s,{dx:!k&&_?LT(v,g):null,dy:!S&&_?FT(v,g):null}),sR(s,{angle:m("labelAngle"),fill:m("labelColor"),fillOpacity:m("labelOpacity"),font:m("labelFont"),fontSize:m("labelFontSize"),fontWeight:m("labelFontWeight"),fontStyle:m("labelFontStyle"),limit:m("labelLimit"),lineHeight:m("labelLineHeight")},{align:k,baseline:S}),f=m("labelBound"),p=m("labelOverlap"),p=p||f?{separation:m("labelSeparation"),method:p,order:"datum.index",bound:f?{scale:b,orient:v,tolerance:f}:null}:void 0,l.align!==h&&(l.align=GT(l.align,h)),l.baseline!==d&&(l.baseline=GT(l.baseline,d)),UD({type:"text",role:"axis-label",style:"guide-label",key:RD,from:i,encode:s,overlap:p},n)},eL=function(e,t,n,i){let r,o,s,a,l=PD(e,t),c=e.orient,u=TT(c,-1,1);return r={enter:o={opacity:LD,anchor:rR(l("titleAnchor",null)),align:{signal:BD}},update:s=Object(p.p)({},o,{opacity:FD,text:rR(e.title)}),exit:{opacity:LD}},a={signal:`lerp(range("${e.scale}"), ${ID(0,1,.5)})`},s.x=LT(c,a),s.y=FT(c,a),o.angle=LT(c,LD,((e,t)=>0===t?0:ER(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t})(u,90)),o.baseline=LT(c,NT(c,"bottom","top"),{value:"bottom"}),s.angle=o.angle,s.baseline=o.baseline,sR(r,{fill:l("titleColor"),fillOpacity:l("titleOpacity"),font:l("titleFont"),fontSize:l("titleFontSize"),fontStyle:l("titleFontStyle"),fontWeight:l("titleFontWeight"),limit:l("titleLimit"),lineHeight:l("titleLineHeight")},{align:l("titleAlign"),angle:l("titleAngle"),baseline:l("titleBaseline")}),function(e,t,n,i){const r=(e,t)=>null!=e?(n.update[t]=GT(rR(e),n.update[t]),!1):!lR(t,i),o=r(e("titleX"),"x"),s=r(e("titleY"),"y");n.enter.auto=s===o?rR(s):LT(t,rR(s),rR(o))}(l,c,r,n),r.update.align=GT(r.update.align,o.align),r.update.angle=GT(r.update.angle,o.angle),r.update.baseline=GT(r.update.baseline,o.baseline),UD({type:"text",role:"axis-title",style:"guide-title",from:i,encode:r},n)};var tL=function(e,t){let n,i,r,o,s,a=function(e,t){var n,i,r,o,s,a,l,c,u=t.config,h=u.style,d=u.axis,f="band"===t.scaleType(e.scale)&&u.axisBand,g=e.orient;if(ER(g)){const e=YT([u.axisX,u.axisY]),t=YT([u.axisTop,u.axisBottom,u.axisLeft,u.axisRight]);for(r of(n={},e))n[r]=LT(g,KT(r,u.axisX,d,h),KT(r,u.axisY,d,h));for(r of(i={},t))i[r]=(o=g.signal,s=KT(r,u.axisTop,d,h),a=KT(r,u.axisBottom,d,h),l=KT(r,u.axisLeft,d,h),c=KT(r,u.axisRight,d,h),{signal:(null!=l?`${o} === 'left' ? (${VT(l)}) : `:"")+(null!=a?`${o} === 'bottom' ? (${VT(a)}) : `:"")+(null!=c?`${o} === 'right' ? (${VT(c)}) : `:"")+(null!=s?`${o} === 'top' ? (${VT(s)}) : `:"")+"(null)"})}else n="top"===g||"bottom"===g?u.axisX:u.axisY,i=u["axis"+g[0].toUpperCase()+g.slice(1)];return n||i||f?Object(p.p)({},d,n,i,f):d}(e,t),l=e.encode||{},c=l.axis||{},u=c.name||void 0,h=c.interactive,d=c.style,f=PD(e,a),g=function(e){let t,n,i=e("tickBand"),r=e("tickOffset");return i?i.signal?(t={signal:`(${i.signal}) === 'extent' ? 1 : 0.5`},n={signal:`(${i.signal}) === 'extent'`},Object(p.G)(r)||(r={signal:`(${i.signal}) === 'extent' ? 0 : ${r}`})):"extent"===i?(t=1,n=!0,r=0):(t=.5,n=!1):(t=e("bandPosition"),n=e("tickExtra")),{extra:n,band:t,offset:r}}(f);return n={scale:e.scale,ticks:!!f("ticks"),labels:!!f("labels"),grid:!!f("grid"),domain:!!f("domain"),title:null!=e.title},i=SR(t.add(VR({},[n]))),c=aR(function(e,t){const n={enter:{},update:{}};return sR(n,{orient:e("orient"),offset:e("offset")||0,position:jR(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}(f,e),c,TD),r=SR(t.add(HR({scale:t.scaleRef(e.scale),extra:t.property(g.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),s=[],n.grid&&s.push(JT(e,a,l.grid,r,g)),n.ticks&&(o=f("tickSize"),s.push(function(e,t,n,i,r,o){let s,a,l,c,u,h,d=PD(e,t),f=e.orient,p=TT(f,-1,1);return s={enter:a={opacity:LD},update:c={opacity:FD},exit:l={opacity:LD}},sR(s,{stroke:d("tickColor"),strokeCap:d("tickCap"),strokeDash:d("tickDash"),strokeDashOffset:d("tickDashOffset"),strokeOpacity:d("tickOpacity"),strokeWidth:d("tickWidth")}),u=rR(r),u.mult=p,h={scale:e.scale,field:RD,band:o.band,extra:o.extra,offset:o.offset,round:d("tickRound")},c.y=a.y=LT(f,LD,h),c.y2=a.y2=LT(f,u),l.x=LT(f,h),c.x=a.x=FT(f,LD,h),c.x2=a.x2=FT(f,u),l.y=FT(f,h),UD({type:"rule",role:"axis-tick",key:RD,from:i,encode:s},n)}(e,a,l.ticks,r,o,g))),n.labels&&(o=n.ticks?o:0,s.push(ZT(e,a,l.labels,r,o,g))),n.domain&&s.push(function(e,t,n,i){let r,o,s,a=PD(e,t),l=e.orient;r={enter:o={opacity:LD},update:s={opacity:FD},exit:{opacity:LD}},sR(r,{stroke:a("domainColor"),strokeCap:a("domainCap"),strokeDash:a("domainDash"),strokeDashOffset:a("domainDashOffset"),strokeWidth:a("domainWidth"),strokeOpacity:a("domainOpacity")});const c=XT(e,0),u=XT(e,1);return o.x=s.x=LT(l,c,LD),o.x2=s.x2=LT(l,u),o.y=s.y=FT(l,c,LD),o.y2=s.y2=FT(l,u),UD({type:"rule",role:"axis-domain",from:i,encode:r},n)}(e,a,l.domain,i)),n.title&&s.push(eL(e,a,l.title,i)),OT(ND({role:"axis",from:i,encode:c,marks:s,aria:f("aria"),description:f("description"),zindex:f("zindex"),name:u,interactive:h,style:d}),t)};var nL=function(e,t,n){const i=Object(p.i)(e.signals),r=Object(p.i)(e.scales);return n||i.forEach(e=>wR(e,t)),Object(p.i)(e.projections).forEach(e=>function(e,t){const n=t.config.projection||{},i={};for(const n in e)"name"!==n&&(i[n]=jD(e[n],n,t));for(const e in n)null==i[e]&&(i[e]=jD(n[e],e,t));t.addProjection(e.name,i)}(e,t)),r.forEach(e=>function(e,t){const n=e.type||"linear";Vp(n)||Object(p.o)("Unrecognized scale type: "+Object(p.ab)(n)),t.addScale(e.name,{type:n,domain:void 0})}(e,t)),Object(p.i)(e.data).forEach(e=>MT(e,t)),r.forEach(e=>yD(e,t)),(n||i).forEach(e=>function(e,t){let n=t.getSignal(e.name),i=e.update;e.init&&(i?Object(p.o)("Signals can not include both init and update expressions."):(i=e.init,n.initonly=!0)),i&&(i=Mj(i,t),n.update=i.$expr,n.params=i.$params),e.on&&e.on.forEach(e=>IR(e,t,n.id))}(e,t)),Object(p.i)(e.axes).forEach(e=>tL(e,t)),Object(p.i)(e.marks).forEach(e=>OT(e,t)),Object(p.i)(e.legends).forEach(e=>CT(e,t)),e.title&&$T(e.title,t),t.parseLambdas(),t};function iL(e,t){const n=t.config,i=SR(t.root=t.add(kR())),r=function(e,t){const n=n=>jR(e[n],t[n]),i=[rL("background",n("background")),rL("autosize",tR(n("autosize"))),rL("padding",iR(n("padding"))),rL("width",n("width")||0),rL("height",n("height")||0)],r=i.reduce((e,t)=>(e[t.name]=t,e),{}),o={};return Object(p.i)(e.signals).forEach(e=>{Object(p.w)(r,e.name)?e=Object(p.p)(r[e.name],e):i.push(e),o[e.name]=e}),Object(p.i)(t.signals).forEach(e=>{Object(p.w)(o,e.name)||Object(p.w)(r,e.name)||i.push(e)}),i}(e,n);r.forEach(e=>wR(e,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const o=t.add(VR()),s=t.add(YR(gR((e=>aR({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e))(e.encode),"group","frame",e.style,t,{pulse:SR(o)}))),a=t.add(gD({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:i,pulse:SR(s)}));t.operators.pop(),t.pushState(SR(s),SR(a),null),nL(e,t,r),t.operators.push(a);let l=t.add(qR({mark:i,pulse:SR(a)}));return l=t.add(hD({pulse:SR(l)})),l=t.add(fD({pulse:SR(l)})),t.addData("root",new wT(t,o,o,l)),t}function rL(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function oL(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function sL(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}function aL(e){return(Object(p.B)(e)?lL:cL)(e)}function lL(e){let t,n="[",i=0,r=e.length;for(;i<r;++i)t=e[i],n+=(i>0?",":"")+(Object(p.G)(t)?t.signal||aL(t):Object(p.ab)(t));return n+"]"}function cL(e){let t,n,i="{",r=0;for(t in e)n=e[t],i+=(++r>1?",":"")+Object(p.ab)(t)+":"+(Object(p.G)(n)?n.signal||aL(n):Object(p.ab)(n));return i+"}"}oL.prototype=sL.prototype={parse(e){return nL(e,this)},fork(){return new sL(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach((function(t){t.$ref=e.id})),e.refs=null),e},proxy(e){const t=e instanceof xR?SR(e):e;return this.add(cD({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;for(e in this.root&&(this.root.root=!0),this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(e,t,n){let i,r;e&&(i=e.data||(e.data={}),r=i[t]||(i[t]=[]),r.push(n))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const i in t.index)n(t.index[i],e,"index:"+i)}return this},pushState(e,t,n){this._encode.push(SR(this.add(fD({pulse:e})))),this._parent.push(t),this._lookup.push(n?SR(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return Object(p.V)(this._parent)},encode(){return Object(p.V)(this._encode)},lookup(){return Object(p.V)(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(Object(p.I)(e))return OR(e,t);e.signal||Object(p.o)("Unsupported field reference: "+Object(p.ab)(e));let n=e.signal,i=this.field[n];if(!i){const e={name:this.signalRef(n)};t&&(e.as=t),this.field[n]=i=SR(this.add(QR(e)))}return i},compareRef(e){let t=!1;const n=e=>ER(e)?(t=!0,this.signalRef(e.signal)):function(e){return e&&e.expr}(e)?(t=!0,this.exprRef(e.expr)):e,i=Object(p.i)(e.field).map(n),r=Object(p.i)(e.order).map(n);return t?SR(this.add(GR({fields:i,orders:r}))):AR(i,r)},keyRef(e,t){let n=!1;const i=this.signals;return e=Object(p.i)(e).map(e=>ER(e)?(n=!0,SR(i[e.signal])):e),n?SR(this.add(ZR({fields:e,flat:t}))):function(e,t){const n={$key:e};return t&&(n.$flat=!0),n}(e,t)},sortRef(e){if(!e)return e;const t=$R(e.op,e.field),n=e.order||"ascending";return n.signal?SR(this.add(GR({fields:t,orders:this.signalRef(n.signal)}))):AR(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const i=this.id();this.streams.push({id:i,source:e,type:t}),this.events[n]=i}return this.events[n]},hasOwnSignal(e){return Object(p.w)(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&Object(p.o)("Duplicate signal name: "+Object(p.ab)(e));const n=t instanceof xR?t:this.add(kR(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||Object(p.o)("Unrecognized signal name: "+Object(p.ab)(e)),this.signals[e]},signalRef(e){return this.signals[e]?SR(this.signals[e]):(Object(p.w)(this.lambdas,e)||(this.lambdas[e]=this.add(kR(null))),SR(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const n=e[t],i=Mj(n,this),r=this.lambdas[n];r.params=i.$params,r.update=i.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return e&&Object(p.G)(e)?this.signalRef(e.signal||aL(e)):e},exprRef(e,t){const n={expr:Mj(e,this)};return t&&(n.expr.$name=t),SR(this.add(XR(n)))},addBinding(e,t){this.bindings||Object(p.o)("Nested signals do not support binding: "+Object(p.ab)(e)),this.bindings.push(Object(p.p)({signal:e},t))},addScaleProj(e,t){Object(p.w)(this.scales,e)&&Object(p.o)("Duplicate scale or projection name: "+Object(p.ab)(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,dD(t))},addProjection(e,t){this.addScaleProj(e,lD(t))},getScale(e){return this.scales[e]||Object(p.o)("Unrecognized scale name: "+Object(p.ab)(e)),this.scales[e]},scaleRef(e){return SR(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return Object(p.w)(this.data,e)&&Object(p.o)("Duplicate data set name: "+Object(p.ab)(e)),this.data[e]=t},getData(e){return this.data[e]||Object(p.o)("Undefined data set name: "+Object(p.ab)(e)),this.data[e]},addDataPipeline(e,t){return Object(p.w)(this.data,e)&&Object(p.o)("Duplicate data set name: "+Object(p.ab)(e)),this.addData(e,wT.fromEntries(this,t))}};var uL=function(e,t,n){return Object(p.G)(e)||Object(p.o)("Input Vega specification must be an object."),iL(e,new oL(t=Object(p.O)({description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:"#4c78a8"},area:{fill:"#4c78a8"},image:null,line:{stroke:"#4c78a8",strokeWidth:2},path:{stroke:"#4c78a8"},rect:{fill:"#4c78a8"},rule:{stroke:"#000"},shape:{stroke:"#4c78a8"},symbol:{fill:"#4c78a8",size:64},text:{fill:"#000",font:"sans-serif",fontSize:11},trail:{fill:"#4c78a8",size:2},style:{"guide-label":{fill:"#000",font:"sans-serif",fontSize:10},"guide-title":{fill:"#000",font:"sans-serif",fontSize:11,fontWeight:"bold"},"group-title":{fill:"#000",font:"sans-serif",fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:"#000",font:"sans-serif",fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:"#ddd"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:"#888",grid:!1,gridWidth:1,gridColor:"#ddd",labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:"#888",tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:"#ddd",gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:"#888",titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}},t,e.config),n)).toRuntime()};n.d(t,"version",(function(){return aO.a})),n.d(t,"bandwidthNRD",(function(){return lo})),n.d(t,"bin",(function(){return co})),n.d(t,"bootstrapCI",(function(){return fo})),n.d(t,"dotbin",(function(){return po})),n.d(t,"quantiles",(function(){return so})),n.d(t,"quartiles",(function(){return ao})),n.d(t,"random",(function(){return uo})),n.d(t,"setRandom",(function(){return ho})),n.d(t,"randomLCG",(function(){return go})),n.d(t,"randomInteger",(function(){return mo})),n.d(t,"randomKDE",(function(){return Oo})),n.d(t,"randomLogNormal",(function(){return Mo})),n.d(t,"sampleLogNormal",(function(){return Co})),n.d(t,"densityLogNormal",(function(){return Ao})),n.d(t,"cumulativeLogNormal",(function(){return $o})),n.d(t,"quantileLogNormal",(function(){return Eo})),n.d(t,"randomMixture",(function(){return jo})),n.d(t,"randomNormal",(function(){return So})),n.d(t,"sampleNormal",(function(){return wo})),n.d(t,"densityNormal",(function(){return xo})),n.d(t,"cumulativeNormal",(function(){return _o})),n.d(t,"quantileNormal",(function(){return ko})),n.d(t,"randomUniform",(function(){return Fo})),n.d(t,"sampleUniform",(function(){return Ro})),n.d(t,"densityUniform",(function(){return Do})),n.d(t,"cumulativeUniform",(function(){return To})),n.d(t,"quantileUniform",(function(){return Lo})),n.d(t,"regressionLinear",(function(){return Bo})),n.d(t,"regressionLog",(function(){return Wo})),n.d(t,"regressionExp",(function(){return Uo})),n.d(t,"regressionPow",(function(){return Ho})),n.d(t,"regressionQuad",(function(){return qo})),n.d(t,"regressionPoly",(function(){return Vo})),n.d(t,"regressionLoess",(function(){return Yo})),n.d(t,"sampleCurve",(function(){return Zo})),n.d(t,"TIME_UNITS",(function(){return st})),n.d(t,"YEAR",(function(){return Je})),n.d(t,"QUARTER",(function(){return Qe})),n.d(t,"MONTH",(function(){return Ze})),n.d(t,"WEEK",(function(){return et})),n.d(t,"DATE",(function(){return tt})),n.d(t,"DAY",(function(){return nt})),n.d(t,"DAYOFYEAR",(function(){return"dayofyear"})),n.d(t,"HOURS",(function(){return it})),n.d(t,"MINUTES",(function(){return rt})),n.d(t,"SECONDS",(function(){return ot})),n.d(t,"MILLISECONDS",(function(){return"milliseconds"})),n.d(t,"timeUnitSpecifier",(function(){return ut})),n.d(t,"timeUnits",(function(){return lt})),n.d(t,"dayofyear",(function(){return Ft})),n.d(t,"week",(function(){return Nt})),n.d(t,"utcdayofyear",(function(){return Wt})),n.d(t,"utcweek",(function(){return Ut})),n.d(t,"timeFloor",(function(){return Qt})),n.d(t,"utcFloor",(function(){return tn})),n.d(t,"timeInterval",(function(){return On})),n.d(t,"timeOffset",(function(){return $n})),n.d(t,"timeSequence",(function(){return jn})),n.d(t,"utcInterval",(function(){return Cn})),n.d(t,"utcOffset",(function(){return En})),n.d(t,"utcSequence",(function(){return Rn})),n.d(t,"timeBin",(function(){return Un})),n.d(t,"accessor",(function(){return p.f})),n.d(t,"accessorName",(function(){return p.h})),n.d(t,"accessorFields",(function(){return p.g})),n.d(t,"id",(function(){return p.x})),n.d(t,"identity",(function(){return p.y})),n.d(t,"zero",(function(){return p.lb})),n.d(t,"one",(function(){return p.P})),n.d(t,"truthy",(function(){return p.hb})),n.d(t,"falsy",(function(){return p.s})),n.d(t,"logger",(function(){return p.L})),n.d(t,"None",(function(){return p.d})),n.d(t,"Error",(function(){return p.b})),n.d(t,"Warn",(function(){return p.e})),n.d(t,"Info",(function(){return p.c})),n.d(t,"Debug",(function(){return p.a})),n.d(t,"mergeConfig",(function(){return p.O})),n.d(t,"writeConfig",(function(){return p.kb})),n.d(t,"panLinear",(function(){return p.R})),n.d(t,"panLog",(function(){return p.S})),n.d(t,"panPow",(function(){return p.T})),n.d(t,"panSymlog",(function(){return p.U})),n.d(t,"zoomLinear",(function(){return p.mb})),n.d(t,"zoomLog",(function(){return p.nb})),n.d(t,"zoomPow",(function(){return p.ob})),n.d(t,"zoomSymlog",(function(){return p.pb})),n.d(t,"quarter",(function(){return p.W})),n.d(t,"utcquarter",(function(){return p.ib})),n.d(t,"array",(function(){return p.i})),n.d(t,"clampRange",(function(){return p.k})),n.d(t,"compare",(function(){return p.l})),n.d(t,"ascending",(function(){return p.j})),n.d(t,"constant",(function(){return p.m})),n.d(t,"debounce",(function(){return p.n})),n.d(t,"error",(function(){return p.o})),n.d(t,"extend",(function(){return p.p})),n.d(t,"extent",(function(){return p.q})),n.d(t,"extentIndex",(function(){return p.r})),n.d(t,"fastmap",(function(){return p.t})),n.d(t,"field",(function(){return p.u})),n.d(t,"flush",(function(){return p.v})),n.d(t,"hasOwnProperty",(function(){return p.w})),n.d(t,"inherits",(function(){return p.z})),n.d(t,"inrange",(function(){return p.A})),n.d(t,"isArray",(function(){return p.B})),n.d(t,"isBoolean",(function(){return p.C})),n.d(t,"isDate",(function(){return p.D})),n.d(t,"isFunction",(function(){return p.E})),n.d(t,"isNumber",(function(){return p.F})),n.d(t,"isObject",(function(){return p.G})),n.d(t,"isRegExp",(function(){return p.H})),n.d(t,"isString",(function(){return p.I})),n.d(t,"key",(function(){return p.J})),n.d(t,"lerp",(function(){return p.K})),n.d(t,"lruCache",(function(){return p.M})),n.d(t,"merge",(function(){return p.N})),n.d(t,"pad",(function(){return p.Q})),n.d(t,"peek",(function(){return p.V})),n.d(t,"repeat",(function(){return p.X})),n.d(t,"span",(function(){return p.Y})),n.d(t,"splitAccessPath",(function(){return p.Z})),n.d(t,"stringValue",(function(){return p.ab})),n.d(t,"toBoolean",(function(){return p.bb})),n.d(t,"toDate",(function(){return p.cb})),n.d(t,"toNumber",(function(){return p.db})),n.d(t,"toString",(function(){return p.fb})),n.d(t,"toSet",(function(){return p.eb})),n.d(t,"truncate",(function(){return p.gb})),n.d(t,"visitArray",(function(){return p.jb})),n.d(t,"loader",(function(){return pu})),n.d(t,"read",(function(){return fu})),n.d(t,"inferType",(function(){return iu})),n.d(t,"inferTypes",(function(){return ru})),n.d(t,"typeParsers",(function(){return eu})),n.d(t,"format",(function(){return uu})),n.d(t,"formats",(function(){return hu})),n.d(t,"responseType",(function(){return du})),n.d(t,"Bounds",(function(){return zc})),n.d(t,"Gradient",(function(){return _a})),n.d(t,"GroupItem",(function(){return Bc})),n.d(t,"ResourceLoader",(function(){return gu})),n.d(t,"Item",(function(){return Ic})),n.d(t,"Scenegraph",(function(){return fd})),n.d(t,"Handler",(function(){return xd})),n.d(t,"Renderer",(function(){return kd})),n.d(t,"CanvasHandler",(function(){return Dd})),n.d(t,"CanvasRenderer",(function(){return Pd})),n.d(t,"SVGHandler",(function(){return Id})),n.d(t,"SVGRenderer",(function(){return Lm})),n.d(t,"SVGStringRenderer",(function(){return Ym})),n.d(t,"RenderType",(function(){return Xm})),n.d(t,"renderModule",(function(){return Qm})),n.d(t,"intersect",(function(){return Zm})),n.d(t,"Marks",(function(){return sd})),n.d(t,"boundClip",(function(){return rv})),n.d(t,"boundContext",(function(){return Fu})),n.d(t,"boundStroke",(function(){return bu})),n.d(t,"boundItem",(function(){return ad})),n.d(t,"boundMark",(function(){return cd})),n.d(t,"pathCurves",(function(){return Cl})),n.d(t,"pathSymbols",(function(){return Hl})),n.d(t,"pathRectangle",(function(){return oc})),n.d(t,"pathTrail",(function(){return sc})),n.d(t,"pathParse",(function(){return El})),n.d(t,"pathRender",(function(){return Il})),n.d(t,"point",(function(){return wd})),n.d(t,"domCreate",(function(){return gd})),n.d(t,"domFind",(function(){return md})),n.d(t,"domChild",(function(){return vd})),n.d(t,"domClear",(function(){return bd})),n.d(t,"markup",(function(){return Mm})),n.d(t,"serializeXML",(function(){return jm})),n.d(t,"font",(function(){return ed})),n.d(t,"fontFamily",(function(){return Zh})),n.d(t,"fontSize",(function(){return Kh})),n.d(t,"lineHeight",(function(){return Yh})),n.d(t,"multiLineOffset",(function(){return Jh})),n.d(t,"textMetrics",(function(){return Wh})),n.d(t,"sceneEqual",(function(){return ov})),n.d(t,"pathEqual",(function(){return sv})),n.d(t,"sceneToJSON",(function(){return hd})),n.d(t,"sceneFromJSON",(function(){return dd})),n.d(t,"intersectPath",(function(){return Uu})),n.d(t,"intersectPoint",(function(){return Hu})),n.d(t,"intersectRule",(function(){return Vu})),n.d(t,"intersectBoxLine",(function(){return Gu})),n.d(t,"sceneZOrder",(function(){return nh})),n.d(t,"sceneVisit",(function(){return ih})),n.d(t,"scenePickVisit",(function(){return rh})),n.d(t,"resetSVGClipId",(function(){return Nc})),n.d(t,"resetSVGDefIds",(function(){return av})),n.d(t,"Dataflow",(function(){return Lr})),n.d(t,"EventStream",(function(){return L})),n.d(t,"Parameters",(function(){return E})),n.d(t,"Pulse",(function(){return Cr})),n.d(t,"MultiPulse",(function(){return Mr})),n.d(t,"Operator",(function(){return R})),n.d(t,"Transform",(function(){return Nr})),n.d(t,"changeset",(function(){return $})),n.d(t,"ingest",(function(){return _})),n.d(t,"isTuple",(function(){return y})),n.d(t,"definition",(function(){return zr})),n.d(t,"transform",(function(){return Ir})),n.d(t,"transforms",(function(){return Pr})),n.d(t,"tupleid",(function(){return w})),n.d(t,"scale",(function(){return qp})),n.d(t,"scheme",(function(){return tm})),n.d(t,"interpolate",(function(){return Jg})),n.d(t,"interpolateColors",(function(){return Kg})),n.d(t,"interpolateRange",(function(){return Gg})),n.d(t,"quantizeInterpolator",(function(){return Yg})),n.d(t,"projection",(function(){return qx})),n.d(t,"View",(function(){return Xj})),n.d(t,"formatLocale",(function(){return Xe})),n.d(t,"timeFormatLocale",(function(){return gr})),n.d(t,"locale",(function(){return vr})),n.d(t,"defaultLocale",(function(){return br})),n.d(t,"resetDefaultLocale",(function(){return yr})),n.d(t,"expressionFunction",(function(){return Ej})),n.d(t,"parse",(function(){return uL})),n.d(t,"runtimeContext",(function(){return zj})),Object(p.p)(Pr,i,o,s,a,l,c,u,h,d,f)},function(e,t,n){"use strict";var i=/("(?:[^\\"]|\\.)*")|[:,]/g;e.exports=function(e,t){var n,r,o;return t=t||{},n=JSON.stringify([1],void 0,void 0===t.indent?2:t.indent).slice(2,-3),r=""===n?1/0:void 0===t.maxLength?80:t.maxLength,o=t.replacer,function e(t,s,a){var l,c,u,h,d,f,p,g,m,v,b,y;if(t&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0===(b=JSON.stringify(t,o)))return b;if(p=r-s.length-a,b.length<=p&&(m=b.replace(i,(function(e,t){return t||e+" "}))).length<=p)return m;if(null!=o&&(t=JSON.parse(b),o=void 0),"object"==typeof t&&null!==t){if(g=s+n,u=[],c=0,Array.isArray(t))for(v="[",l="]",p=t.length;c<p;c++)u.push(e(t[c],g,c===p-1?0:1)||"null");else for(v="{",l="}",p=(f=Object.keys(t)).length;c<p;c++)h=f[c],d=JSON.stringify(h)+": ",void 0!==(y=e(t[h],g,d.length+(c===p-1?0:1)))&&u.push(d+y);if(u.length>0)return[v,n+u.join(",\n"+g),l].join("\n"+s)}return b}(e,"",0)}},function(e,t,n){"use strict";t.a='.vega-embed {\n  position: relative;\n  display: inline-block; }\n  .vega-embed.has-actions {\n    padding-right: 38px; }\n  .vega-embed details:not([open]) > :not(summary) {\n    display: none !important; }\n  .vega-embed summary {\n    list-style: none;\n    position: absolute;\n    top: 0;\n    right: 0;\n    padding: 6px;\n    z-index: 1000;\n    background: white;\n    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n    color: #1b1e23;\n    border: 1px solid #aaa;\n    border-radius: 999px;\n    opacity: 0.2;\n    transition: opacity 0.4s ease-in;\n    outline: none;\n    cursor: pointer;\n    line-height: 0px; }\n    .vega-embed summary::-webkit-details-marker {\n      display: none; }\n    .vega-embed summary:active {\n      box-shadow: #aaa 0px 0px 0px 1px inset; }\n    .vega-embed summary svg {\n      width: 14px;\n      height: 14px; }\n  .vega-embed details[open] summary {\n    opacity: 0.7; }\n  .vega-embed:hover summary,\n  .vega-embed:focus summary {\n    opacity: 1 !important;\n    transition: opacity 0.2s ease; }\n  .vega-embed .vega-actions {\n    position: absolute;\n    z-index: 1001;\n    top: 35px;\n    right: -9px;\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 8px;\n    padding-top: 8px;\n    border-radius: 4px;\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n    border: 1px solid #d9d9d9;\n    background: white;\n    animation-duration: 0.15s;\n    animation-name: scale-in;\n    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n    text-align: left; }\n    .vega-embed .vega-actions a {\n      padding: 8px 16px;\n      font-family: sans-serif;\n      font-size: 14px;\n      font-weight: 600;\n      white-space: nowrap;\n      color: #434a56;\n      text-decoration: none; }\n      .vega-embed .vega-actions a:hover {\n        background-color: #f7f7f9;\n        color: black; }\n    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n      content: "";\n      display: inline-block;\n      position: absolute; }\n    .vega-embed .vega-actions::before {\n      left: auto;\n      right: 14px;\n      top: -16px;\n      border: 8px solid #0000;\n      border-bottom-color: #d9d9d9; }\n    .vega-embed .vega-actions::after {\n      left: auto;\n      right: 15px;\n      top: -14px;\n      border: 7px solid #0000;\n      border-bottom-color: #fff; }\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: scroll;\n  padding-right: 14px; }\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6); }\n  to {\n    opacity: 1;\n    transform: scale(1); } }\n'},,,,function(e,t){const n=/^[0-9]+$/,i=(e,t)=>{const i=n.test(e),r=n.test(t);return i&&r&&(e=+e,t=+t),e===t?0:i&&!r?-1:r&&!i?1:e<t?-1:1};e.exports={compareIdentifiers:i,rcompareIdentifiers:(e,t)=>i(t,e)}},function(e,t,n){const i=n(7);e.exports=(e,t,n)=>0===i(e,t,n)},function(e,t,n){const i=n(5);e.exports=(e,t,n)=>{const r=new i(e,n),o=new i(t,n);return r.compare(o)||r.compareBuild(o)}},function(e,t,n){const i=n(7);e.exports=(e,t,n)=>i(e,t,n)<0},function(e,t,n){const i=n(7);e.exports=(e,t,n)=>i(e,t,n)>=0},function(e,t,n){const i=n(7);e.exports=(e,t,n)=>i(e,t,n)<=0},function(e,t,n){const i=n(5),r=n(21),{ANY:o}=r,s=n(8),a=n(22),l=n(20),c=n(38),u=n(40),h=n(39);e.exports=(e,t,n,d)=>{let f,p,g,m,v;switch(e=new i(e,d),t=new s(t,d),n){case">":f=l,p=u,g=c,m=">",v=">=";break;case"<":f=c,p=h,g=l,m="<",v="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(a(e,t,d))return!1;for(let n=0;n<t.set.length;++n){const i=t.set[n];let s=null,a=null;if(i.forEach(e=>{e.semver===o&&(e=new r(">=0.0.0")),s=s||e,a=a||e,f(e.semver,s.semver,d)?s=e:g(e.semver,a.semver,d)&&(a=e)}),s.operator===m||s.operator===v)return!1;if((!a.operator||a.operator===m)&&p(e,a.semver))return!1;if(a.operator===v&&g(e,a.semver))return!1}return!0}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){(function(e){!function(){var e=function(){return this}();e||"undefined"==typeof window||(e=window);var t=function(e,n,i){"string"==typeof e?(2==arguments.length&&(i=n),t.modules[e]||(t.payloads[e]=i,t.modules[e]=null)):t.original?t.original.apply(this,arguments):(console.error("dropping module because define wasn't a string."),console.trace())};t.modules={},t.payloads={};var n,i,r=function(e,t,n){if("string"==typeof t){var i=a(e,t);if(null!=i)return n&&n(),i}else if("[object Array]"===Object.prototype.toString.call(t)){for(var r=[],s=0,l=t.length;s<l;++s){var c=a(e,t[s]);if(null==c&&o.original)return;r.push(c)}return n&&n.apply(null,r)||!0}},o=function(e,t){var n=r("",e,t);return null==n&&o.original?o.original.apply(this,arguments):n},s=function(e,t){if(-1!==t.indexOf("!")){var n=t.split("!");return s(e,n[0])+"!"+s(e,n[1])}if("."==t.charAt(0))for(t=e.split("/").slice(0,-1).join("/")+"/"+t;-1!==t.indexOf(".")&&i!=t;){var i=t;t=t.replace(/\/\.\//,"/").replace(/[^\/]+\/\.\.\//,"")}return t},a=function(e,n){n=s(e,n);var i=t.modules[n];if(!i){if("function"==typeof(i=t.payloads[n])){var o={},a={id:n,uri:"",exports:o,packaged:!0};o=i((function(e,t){return r(n,e,t)}),o,a)||a.exports,t.modules[n]=o,delete t.payloads[n]}i=t.modules[n]=o||i}return i};i=e,(n="ace")&&(e[n]||(e[n]={}),i=e[n]),i.define&&i.define.packaged||(t.original=i.define,i.define=t,i.define.packaged=!0),i.require&&i.require.packaged||(o.original=i.require,i.require=o,i.require.packaged=!0)}(),ace.define("ace/lib/fixoldbrowsers",["require","exports","module"],(function(e,t,n){"use strict";"undefined"==typeof Element||Element.prototype.remove||Object.defineProperty(Element.prototype,"remove",{enumerable:!1,writable:!0,configurable:!0,value:function(){this.parentNode&&this.parentNode.removeChild(this)}})})),ace.define("ace/lib/useragent",["require","exports","module"],(function(e,t,n){"use strict";t.OS={LINUX:"LINUX",MAC:"MAC",WINDOWS:"WINDOWS"},t.getOS=function(){return t.isMac?t.OS.MAC:t.isLinux?t.OS.LINUX:t.OS.WINDOWS};var i="object"==typeof navigator?navigator:{},r=(/mac|win|linux/i.exec(i.platform)||["other"])[0].toLowerCase(),o=i.userAgent||"",s=i.appName||"";t.isWin="win"==r,t.isMac="mac"==r,t.isLinux="linux"==r,t.isIE="Microsoft Internet Explorer"==s||s.indexOf("MSAppHost")>=0?parseFloat((o.match(/(?:MSIE |Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]):parseFloat((o.match(/(?:Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]),t.isOldIE=t.isIE&&t.isIE<9,t.isGecko=t.isMozilla=o.match(/ Gecko\/\d+/),t.isOpera="object"==typeof opera&&"[object Opera]"==Object.prototype.toString.call(window.opera),t.isWebKit=parseFloat(o.split("WebKit/")[1])||void 0,t.isChrome=parseFloat(o.split(" Chrome/")[1])||void 0,t.isEdge=parseFloat(o.split(" Edge/")[1])||void 0,t.isAIR=o.indexOf("AdobeAIR")>=0,t.isAndroid=o.indexOf("Android")>=0,t.isChromeOS=o.indexOf(" CrOS ")>=0,t.isIOS=/iPad|iPhone|iPod/.test(o)&&!window.MSStream,t.isIOS&&(t.isMac=!0),t.isMobile=t.isIOS||t.isAndroid})),ace.define("ace/lib/dom",["require","exports","module","ace/lib/useragent"],(function(e,t,n){"use strict";var i=e("./useragent");if(t.buildDom=function e(t,n,i){if("string"==typeof t&&t){var r=document.createTextNode(t);return n&&n.appendChild(r),r}if(!Array.isArray(t))return t&&t.appendChild&&n&&n.appendChild(t),t;if("string"!=typeof t[0]||!t[0]){for(var o=[],s=0;s<t.length;s++){var a=e(t[s],n,i);a&&o.push(a)}return o}var l=document.createElement(t[0]),c=t[1],u=1;c&&"object"==typeof c&&!Array.isArray(c)&&(u=2);for(s=u;s<t.length;s++)e(t[s],l,i);return 2==u&&Object.keys(c).forEach((function(e){var t=c[e];"class"===e?l.className=Array.isArray(t)?t.join(" "):t:"function"==typeof t||"value"==e||"$"==e[0]?l[e]=t:"ref"===e?i&&(i[t]=l):null!=t&&l.setAttribute(e,t)})),n&&n.appendChild(l),l},t.getDocumentHead=function(e){return e||(e=document),e.head||e.getElementsByTagName("head")[0]||e.documentElement},t.createElement=function(e,t){return document.createElementNS?document.createElementNS(t||"http://www.w3.org/1999/xhtml",e):document.createElement(e)},t.removeChildren=function(e){e.innerHTML=""},t.createTextNode=function(e,t){return(t?t.ownerDocument:document).createTextNode(e)},t.createFragment=function(e){return(e?e.ownerDocument:document).createDocumentFragment()},t.hasCssClass=function(e,t){return-1!==(e.className+"").split(/\s+/g).indexOf(t)},t.addCssClass=function(e,n){t.hasCssClass(e,n)||(e.className+=" "+n)},t.removeCssClass=function(e,t){for(var n=e.className.split(/\s+/g);;){var i=n.indexOf(t);if(-1==i)break;n.splice(i,1)}e.className=n.join(" ")},t.toggleCssClass=function(e,t){for(var n=e.className.split(/\s+/g),i=!0;;){var r=n.indexOf(t);if(-1==r)break;i=!1,n.splice(r,1)}return i&&n.push(t),e.className=n.join(" "),i},t.setCssClass=function(e,n,i){i?t.addCssClass(e,n):t.removeCssClass(e,n)},t.hasCssString=function(e,t){var n,i=0;if(n=(t=t||document).querySelectorAll("style"))for(;i<n.length;)if(n[i++].id===e)return!0},t.importCssString=function(e,n,i){var r=i;i&&i.getRootNode&&(r=i.getRootNode())&&r!=i||(r=document);var o=r.ownerDocument||r;if(n&&t.hasCssString(n,r))return null;n&&(e+="\n/*# sourceURL=ace/css/"+n+" */");var s=t.createElement("style");s.appendChild(o.createTextNode(e)),n&&(s.id=n),r==o&&(r=t.getDocumentHead(o)),r.insertBefore(s,r.firstChild)},t.importCssStylsheet=function(e,n){t.buildDom(["link",{rel:"stylesheet",href:e}],t.getDocumentHead(n))},t.scrollbarWidth=function(e){var n=t.createElement("ace_inner");n.style.width="100%",n.style.minWidth="0px",n.style.height="200px",n.style.display="block";var i=t.createElement("ace_outer"),r=i.style;r.position="absolute",r.left="-10000px",r.overflow="hidden",r.width="200px",r.minWidth="0px",r.height="150px",r.display="block",i.appendChild(n);var o=e.documentElement;o.appendChild(i);var s=n.offsetWidth;r.overflow="scroll";var a=n.offsetWidth;return s==a&&(a=i.clientWidth),o.removeChild(i),s-a},"undefined"==typeof document&&(t.importCssString=function(){}),t.computedStyle=function(e,t){return window.getComputedStyle(e,"")||{}},t.setStyle=function(e,t,n){e[t]!==n&&(e[t]=n)},t.HAS_CSS_ANIMATION=!1,t.HAS_CSS_TRANSFORMS=!1,t.HI_DPI=!i.isWin||"undefined"!=typeof window&&window.devicePixelRatio>=1.5,"undefined"!=typeof document){var r=document.createElement("div");t.HI_DPI&&void 0!==r.style.transform&&(t.HAS_CSS_TRANSFORMS=!0),i.isEdge||void 0===r.style.animationName||(t.HAS_CSS_ANIMATION=!0),r=null}t.HAS_CSS_TRANSFORMS?t.translate=function(e,t,n){e.style.transform="translate("+Math.round(t)+"px, "+Math.round(n)+"px)"}:t.translate=function(e,t,n){e.style.top=Math.round(n)+"px",e.style.left=Math.round(t)+"px"}})),ace.define("ace/lib/oop",["require","exports","module"],(function(e,t,n){"use strict";t.inherits=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})},t.mixin=function(e,t){for(var n in t)e[n]=t[n];return e},t.implement=function(e,n){t.mixin(e,n)}})),ace.define("ace/lib/keys",["require","exports","module","ace/lib/oop"],(function(e,t,n){"use strict";var i=e("./oop"),r=function(){var e,t,n={MODIFIER_KEYS:{16:"Shift",17:"Ctrl",18:"Alt",224:"Meta",91:"MetaLeft",92:"MetaRight",93:"ContextMenu"},KEY_MODS:{ctrl:1,alt:2,option:2,shift:4,super:8,meta:8,command:8,cmd:8,control:1},FUNCTION_KEYS:{8:"Backspace",9:"Tab",13:"Return",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock"},PRINTABLE_KEYS:{32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*"}};for(t in n.FUNCTION_KEYS)e=n.FUNCTION_KEYS[t].toLowerCase(),n[e]=parseInt(t,10);for(t in n.PRINTABLE_KEYS)e=n.PRINTABLE_KEYS[t].toLowerCase(),n[e]=parseInt(t,10);return i.mixin(n,n.MODIFIER_KEYS),i.mixin(n,n.PRINTABLE_KEYS),i.mixin(n,n.FUNCTION_KEYS),n.enter=n.return,n.escape=n.esc,n.del=n.delete,n[173]="-",function(){for(var e=["cmd","ctrl","alt","shift"],t=Math.pow(2,e.length);t--;)n.KEY_MODS[t]=e.filter((function(e){return t&n.KEY_MODS[e]})).join("-")+"-"}(),n.KEY_MODS[0]="",n.KEY_MODS[-1]="input-",n}();i.mixin(t,r),t.keyCodeToString=function(e){var t=r[e];return"string"!=typeof t&&(t=String.fromCharCode(e)),t.toLowerCase()}})),ace.define("ace/lib/event",["require","exports","module","ace/lib/keys","ace/lib/useragent"],(function(e,t,n){"use strict";var i,r=e("./keys"),o=e("./useragent"),s=null,a=0;function l(){return null==i&&function(){i=!1;try{document.createComment("").addEventListener("test",(function(){}),{get passive(){i={passive:!1}}})}catch(e){}}(),i}function c(e,t,n){this.elem=e,this.type=t,this.callback=n}c.prototype.destroy=function(){h(this.elem,this.type,this.callback),this.elem=this.type=this.callback=void 0};var u=t.addListener=function(e,t,n,i){e.addEventListener(t,n,l()),i&&i.$toDestroy.push(new c(e,t,n))},h=t.removeListener=function(e,t,n){e.removeEventListener(t,n,l())};t.stopEvent=function(e){return t.stopPropagation(e),t.preventDefault(e),!1},t.stopPropagation=function(e){e.stopPropagation&&e.stopPropagation()},t.preventDefault=function(e){e.preventDefault&&e.preventDefault()},t.getButton=function(e){return"dblclick"==e.type?0:"contextmenu"==e.type||o.isMac&&e.ctrlKey&&!e.altKey&&!e.shiftKey?2:e.button},t.capture=function(e,t,n){var i=e&&e.ownerDocument||document;function r(e){t&&t(e),n&&n(e),h(i,"mousemove",t),h(i,"mouseup",r),h(i,"dragstart",r)}return u(i,"mousemove",t),u(i,"mouseup",r),u(i,"dragstart",r),r},t.addMouseWheelListener=function(e,t,n){"onmousewheel"in e?u(e,"mousewheel",(function(e){void 0!==e.wheelDeltaX?(e.wheelX=-e.wheelDeltaX/8,e.wheelY=-e.wheelDeltaY/8):(e.wheelX=0,e.wheelY=-e.wheelDelta/8),t(e)}),n):"onwheel"in e?u(e,"wheel",(function(e){switch(e.deltaMode){case e.DOM_DELTA_PIXEL:e.wheelX=.35*e.deltaX||0,e.wheelY=.35*e.deltaY||0;break;case e.DOM_DELTA_LINE:case e.DOM_DELTA_PAGE:e.wheelX=5*(e.deltaX||0),e.wheelY=5*(e.deltaY||0)}t(e)}),n):u(e,"DOMMouseScroll",(function(e){e.axis&&e.axis==e.HORIZONTAL_AXIS?(e.wheelX=5*(e.detail||0),e.wheelY=0):(e.wheelX=0,e.wheelY=5*(e.detail||0)),t(e)}),n)},t.addMultiMouseDownListener=function(e,n,i,r,s){var a,l,c,h=0,d={2:"dblclick",3:"tripleclick",4:"quadclick"};function f(e){if(0!==t.getButton(e)?h=0:e.detail>1?++h>4&&(h=1):h=1,o.isIE){var s=Math.abs(e.clientX-a)>5||Math.abs(e.clientY-l)>5;c&&!s||(h=1),c&&clearTimeout(c),c=setTimeout((function(){c=null}),n[h-1]||600),1==h&&(a=e.clientX,l=e.clientY)}if(e._clicks=h,i[r]("mousedown",e),h>4)h=0;else if(h>1)return i[r](d[h],e)}Array.isArray(e)||(e=[e]),e.forEach((function(e){u(e,"mousedown",f,s)}))};var d=function(e){return 0|(e.ctrlKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.metaKey?8:0)};function f(e,t,n){var i=d(t);if(!o.isMac&&s){if(t.getModifierState&&(t.getModifierState("OS")||t.getModifierState("Win"))&&(i|=8),s.altGr){if(3==(3&i))return;s.altGr=0}if(18===n||17===n){var l="location"in t?t.location:t.keyLocation;if(17===n&&1===l)1==s[n]&&(a=t.timeStamp);else if(18===n&&3===i&&2===l){t.timeStamp-a<50&&(s.altGr=!0)}}}if((n in r.MODIFIER_KEYS&&(n=-1),!i&&13===n)&&(3===(l="location"in t?t.location:t.keyLocation)&&(e(t,i,-n),t.defaultPrevented)))return;if(o.isChromeOS&&8&i){if(e(t,i,n),t.defaultPrevented)return;i&=-9}return!!(i||n in r.FUNCTION_KEYS||n in r.PRINTABLE_KEYS)&&e(t,i,n)}function p(){s=Object.create(null)}if(t.getModifierString=function(e){return r.KEY_MODS[d(e)]},t.addCommandKeyListener=function(e,n,i){if(o.isOldGecko||o.isOpera&&!("KeyboardEvent"in window)){var r=null;u(e,"keydown",(function(e){r=e.keyCode}),i),u(e,"keypress",(function(e){return f(n,e,r)}),i)}else{var a=null;u(e,"keydown",(function(e){s[e.keyCode]=(s[e.keyCode]||0)+1;var t=f(n,e,e.keyCode);return a=e.defaultPrevented,t}),i),u(e,"keypress",(function(e){a&&(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)&&(t.stopEvent(e),a=null)}),i),u(e,"keyup",(function(e){s[e.keyCode]=null}),i),s||(p(),u(window,"focus",p))}},"object"==typeof window&&window.postMessage&&!o.isOldIE){var g=1;t.nextTick=function(e,n){n=n||window;var i="zero-timeout-message-"+g++,r=function(o){o.data==i&&(t.stopPropagation(o),h(n,"message",r),e())};u(n,"message",r),n.postMessage(i,"*")}}t.$idleBlocked=!1,t.onIdle=function(e,n){return setTimeout((function n(){t.$idleBlocked?setTimeout(n,100):e()}),n)},t.$idleBlockId=null,t.blockIdle=function(e){t.$idleBlockId&&clearTimeout(t.$idleBlockId),t.$idleBlocked=!0,t.$idleBlockId=setTimeout((function(){t.$idleBlocked=!1}),e||100)},t.nextFrame="object"==typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame),t.nextFrame?t.nextFrame=t.nextFrame.bind(window):t.nextFrame=function(e){setTimeout(e,17)}})),ace.define("ace/range",["require","exports","module"],(function(e,t,n){"use strict";var i=function(e,t,n,i){this.start={row:e,column:t},this.end={row:n,column:i}};(function(){this.isEqual=function(e){return this.start.row===e.start.row&&this.end.row===e.end.row&&this.start.column===e.start.column&&this.end.column===e.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(e,t){return 0==this.compare(e,t)},this.compareRange=function(e){var t,n=e.end,i=e.start;return 1==(t=this.compare(n.row,n.column))?1==(t=this.compare(i.row,i.column))?2:0==t?1:0:-1==t?-2:-1==(t=this.compare(i.row,i.column))?-1:1==t?42:0},this.comparePoint=function(e){return this.compare(e.row,e.column)},this.containsRange=function(e){return 0==this.comparePoint(e.start)&&0==this.comparePoint(e.end)},this.intersects=function(e){var t=this.compareRange(e);return-1==t||0==t||1==t},this.isEnd=function(e,t){return this.end.row==e&&this.end.column==t},this.isStart=function(e,t){return this.start.row==e&&this.start.column==t},this.setStart=function(e,t){"object"==typeof e?(this.start.column=e.column,this.start.row=e.row):(this.start.row=e,this.start.column=t)},this.setEnd=function(e,t){"object"==typeof e?(this.end.column=e.column,this.end.row=e.row):(this.end.row=e,this.end.column=t)},this.inside=function(e,t){return 0==this.compare(e,t)&&(!this.isEnd(e,t)&&!this.isStart(e,t))},this.insideStart=function(e,t){return 0==this.compare(e,t)&&!this.isEnd(e,t)},this.insideEnd=function(e,t){return 0==this.compare(e,t)&&!this.isStart(e,t)},this.compare=function(e,t){return this.isMultiLine()||e!==this.start.row?e<this.start.row?-1:e>this.end.row?1:this.start.row===e?t>=this.start.column?0:-1:this.end.row===e?t<=this.end.column?0:1:0:t<this.start.column?-1:t>this.end.column?1:0},this.compareStart=function(e,t){return this.start.row==e&&this.start.column==t?-1:this.compare(e,t)},this.compareEnd=function(e,t){return this.end.row==e&&this.end.column==t?1:this.compare(e,t)},this.compareInside=function(e,t){return this.end.row==e&&this.end.column==t?1:this.start.row==e&&this.start.column==t?-1:this.compare(e,t)},this.clipRows=function(e,t){if(this.end.row>t)var n={row:t+1,column:0};else if(this.end.row<e)n={row:e,column:0};if(this.start.row>t)var r={row:t+1,column:0};else if(this.start.row<e)r={row:e,column:0};return i.fromPoints(r||this.start,n||this.end)},this.extend=function(e,t){var n=this.compare(e,t);if(0==n)return this;if(-1==n)var r={row:e,column:t};else var o={row:e,column:t};return i.fromPoints(r||this.start,o||this.end)},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return i.fromPoints(this.start,this.end)},this.collapseRows=function(){return 0==this.end.column?new i(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new i(this.start.row,0,this.end.row,0)},this.toScreenRange=function(e){var t=e.documentToScreenPosition(this.start),n=e.documentToScreenPosition(this.end);return new i(t.row,t.column,n.row,n.column)},this.moveBy=function(e,t){this.start.row+=e,this.start.column+=t,this.end.row+=e,this.end.column+=t}}).call(i.prototype),i.fromPoints=function(e,t){return new i(e.row,e.column,t.row,t.column)},i.comparePoints=function(e,t){return e.row-t.row||e.column-t.column},i.comparePoints=function(e,t){return e.row-t.row||e.column-t.column},t.Range=i})),ace.define("ace/lib/lang",["require","exports","module"],(function(e,t,n){"use strict";t.last=function(e){return e[e.length-1]},t.stringReverse=function(e){return e.split("").reverse().join("")},t.stringRepeat=function(e,t){for(var n="";t>0;)1&t&&(n+=e),(t>>=1)&&(e+=e);return n};var i=/^\s\s*/,r=/\s\s*$/;t.stringTrimLeft=function(e){return e.replace(i,"")},t.stringTrimRight=function(e){return e.replace(r,"")},t.copyObject=function(e){var t={};for(var n in e)t[n]=e[n];return t},t.copyArray=function(e){for(var t=[],n=0,i=e.length;n<i;n++)e[n]&&"object"==typeof e[n]?t[n]=this.copyObject(e[n]):t[n]=e[n];return t},t.deepCopy=function e(t){if("object"!=typeof t||!t)return t;var n;if(Array.isArray(t)){n=[];for(var i=0;i<t.length;i++)n[i]=e(t[i]);return n}if("[object Object]"!==Object.prototype.toString.call(t))return t;for(var i in n={},t)n[i]=e(t[i]);return n},t.arrayToMap=function(e){for(var t={},n=0;n<e.length;n++)t[e[n]]=1;return t},t.createMap=function(e){var t=Object.create(null);for(var n in e)t[n]=e[n];return t},t.arrayRemove=function(e,t){for(var n=0;n<=e.length;n++)t===e[n]&&e.splice(n,1)},t.escapeRegExp=function(e){return e.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")},t.escapeHTML=function(e){return(""+e).replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&#60;")},t.getMatchOffsets=function(e,t){var n=[];return e.replace(t,(function(e){n.push({offset:arguments[arguments.length-2],length:e.length})})),n},t.deferredCall=function(e){var t=null,n=function(){t=null,e()},i=function(e){return i.cancel(),t=setTimeout(n,e||0),i};return i.schedule=i,i.call=function(){return this.cancel(),e(),i},i.cancel=function(){return clearTimeout(t),t=null,i},i.isPending=function(){return t},i},t.delayedCall=function(e,t){var n=null,i=function(){n=null,e()},r=function(e){null==n&&(n=setTimeout(i,e||t))};return r.delay=function(e){n&&clearTimeout(n),n=setTimeout(i,e||t)},r.schedule=r,r.call=function(){this.cancel(),e()},r.cancel=function(){n&&clearTimeout(n),n=null},r.isPending=function(){return n},r}})),ace.define("ace/clipboard",["require","exports","module"],(function(e,t,n){"use strict";var i;n.exports={lineMode:!1,pasteCancelled:function(){return!!(i&&i>Date.now()-50)||(i=!1)},cancel:function(){i=Date.now()}}})),ace.define("ace/keyboard/textinput",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/lib/dom","ace/lib/lang","ace/clipboard","ace/lib/keys"],(function(e,t,n){"use strict";var i=e("../lib/event"),r=e("../lib/useragent"),o=e("../lib/dom"),s=e("../lib/lang"),a=e("../clipboard"),l=r.isChrome<18,c=r.isIE,u=r.isChrome>63,h=e("../lib/keys"),d=h.KEY_MODS,f=r.isIOS,p=f?/\s/:/\n/,g=r.isMobile;t.TextInput=function(e,t){var n=o.createElement("textarea");n.className="ace_text-input",n.setAttribute("wrap","off"),n.setAttribute("autocorrect","off"),n.setAttribute("autocapitalize","off"),n.setAttribute("spellcheck",!1),n.style.opacity="0",e.insertBefore(n,e.firstChild);var m=!1,v=!1,b=!1,y=!1,w="";g||(n.style.fontSize="1px");var x=!1,_=!1,k="",S=0,O=0,C=0;try{var A=document.activeElement===n}catch(e){}i.addListener(n,"blur",(function(e){_||(t.onBlur(e),A=!1)}),t),i.addListener(n,"focus",(function(e){if(!_){if(A=!0,r.isEdge)try{if(!document.hasFocus())return}catch(e){}t.onFocus(e),r.isEdge?setTimeout($):$()}}),t),this.$focusScroll=!1,this.focus=function(){if(w||u||"browser"==this.$focusScroll)return n.focus({preventScroll:!0});var e=n.style.top;n.style.position="fixed",n.style.top="0px";try{var t=0!=n.getBoundingClientRect().top}catch(e){return}var i=[];if(t)for(var r=n.parentElement;r&&1==r.nodeType;)i.push(r),r.setAttribute("ace_nocontext",!0),r=!r.parentElement&&r.getRootNode?r.getRootNode().host:r.parentElement;n.focus({preventScroll:!0}),t&&i.forEach((function(e){e.removeAttribute("ace_nocontext")})),setTimeout((function(){n.style.position="","0px"==n.style.top&&(n.style.top=e)}),0)},this.blur=function(){n.blur()},this.isFocused=function(){return A},t.on("beforeEndOperation",(function(){var e=t.curOp,i=e&&e.command&&e.command.name;if("insertstring"!=i){var r=i&&(e.docChanged||e.selectionChanged);b&&r&&(k=n.value="",z()),$()}}));var $=f?function(e){if(A&&(!m||e)&&!y){e||(e="");var i="\n ab"+e+"cde fg\n";i!=n.value&&(n.value=k=i);var r=4+(e.length||(t.selection.isEmpty()?0:1));4==S&&O==r||n.setSelectionRange(4,r),S=4,O=r}}:function(){if(!b&&!y&&(A||M)){b=!0;var e=0,i=0,r="";if(t.session){var o=t.selection,s=o.getRange(),a=o.cursor.row;if(e=s.start.column,i=s.end.column,r=t.session.getLine(a),s.start.row!=a){var l=t.session.getLine(a-1);e=s.start.row<a-1?0:e,i+=l.length+1,r=l+"\n"+r}else if(s.end.row!=a){var c=t.session.getLine(a+1);i=s.end.row>a+1?c.length:i,i+=r.length+1,r=r+"\n"+c}else g&&a>0&&(r="\n"+r,i+=1,e+=1);r.length>400&&(e<400&&i<400?r=r.slice(0,400):(r="\n",e==i?e=i=0:(e=0,i=1)))}var u=r+"\n\n";if(u!=k&&(n.value=k=u,S=O=u.length),M&&(S=n.selectionStart,O=n.selectionEnd),O!=i||S!=e||n.selectionEnd!=O)try{n.setSelectionRange(e,i),S=e,O=i}catch(e){}b=!1}};this.resetSelection=$,A&&t.onFocus();var E=null;this.setInputHandler=function(e){E=e},this.getInputHandler=function(){return E};var M=!1,j=function(e,i){if(M&&(M=!1),v)return $(),e&&t.onPaste(e),v=!1,"";for(var o=n.selectionStart,s=n.selectionEnd,a=S,l=k.length-O,c=e,u=e.length-o,h=e.length-s,d=0;a>0&&k[d]==e[d];)d++,a--;for(c=c.slice(d),d=1;l>0&&k.length-d>S-1&&k[k.length-d]==e[e.length-d];)d++,l--;u-=d-1,h-=d-1;var f=c.length-d+1;if(f<0&&(a=-f,f=0),c=c.slice(0,f),!(i||c||u||a||l||h))return"";y=!0;var p=!1;return r.isAndroid&&". "==c&&(c="  ",p=!0),c&&!a&&!l&&!u&&!h||x?t.onTextInput(c):t.onTextInput(c,{extendLeft:a,extendRight:l,restoreStart:u,restoreEnd:h}),y=!1,k=e,S=o,O=s,C=h,p?"\n":c},R=function(e){if(b)return P();if(e&&e.inputType){if("historyUndo"==e.inputType)return t.execCommand("undo");if("historyRedo"==e.inputType)return t.execCommand("redo")}var i=n.value,r=j(i,!0);(i.length>500||p.test(r)||g&&S<1&&S==O)&&$()},D=function(e,t,n){var i=e.clipboardData||window.clipboardData;if(i&&!l){var r=c||n?"Text":"text/plain";try{return t?!1!==i.setData(r,t):i.getData(r)}catch(e){if(!n)return D(e,t,!0)}}},T=function(e,r){var o=t.getCopyText();if(!o)return i.preventDefault(e);D(e,o)?(f&&($(o),m=o,setTimeout((function(){m=!1}),10)),r?t.onCut():t.onCopy(),i.preventDefault(e)):(m=!0,n.value=o,n.select(),setTimeout((function(){m=!1,$(),r?t.onCut():t.onCopy()})))},L=function(e){T(e,!0)},F=function(e){T(e,!1)},N=function(e){var o=D(e);a.pasteCancelled()||("string"==typeof o?(o&&t.onPaste(o,e),r.isIE&&setTimeout($),i.preventDefault(e)):(n.value="",v=!0))};i.addCommandKeyListener(n,t.onCommandKey.bind(t),t),i.addListener(n,"select",(function(e){b||(m?m=!1:!function(e){return 0===e.selectionStart&&e.selectionEnd>=k.length&&e.value===k&&k&&e.selectionEnd!==O}(n)?g&&n.selectionStart!=S&&$():(t.selectAll(),$()))}),t),i.addListener(n,"input",R,t),i.addListener(n,"cut",L,t),i.addListener(n,"copy",F,t),i.addListener(n,"paste",N,t),"oncut"in n&&"oncopy"in n&&"onpaste"in n||i.addListener(e,"keydown",(function(e){if((!r.isMac||e.metaKey)&&e.ctrlKey)switch(e.keyCode){case 67:F(e);break;case 86:N(e);break;case 88:L(e)}}),t);var P=function(){if(b&&t.onCompositionUpdate&&!t.$readOnly){if(x)return I();if(b.useTextareaForIME)t.onCompositionUpdate(n.value);else{var e=n.value;j(e),b.markerRange&&(b.context&&(b.markerRange.start.column=b.selectionStart=b.context.compositionStartOffset),b.markerRange.end.column=b.markerRange.start.column+O-b.selectionStart+C)}}},z=function(e){t.onCompositionEnd&&!t.$readOnly&&(b=!1,t.onCompositionEnd(),t.off("mousedown",I),e&&R())};function I(){_=!0,n.blur(),n.focus(),_=!1}var B,W=s.delayedCall(P,50).schedule.bind(null,null);function U(){clearTimeout(B),B=setTimeout((function(){w&&(n.style.cssText=w,w=""),t.renderer.$isMousePressed=!1,t.renderer.$keepTextAreaAtCursor&&t.renderer.$moveTextAreaToCursor()}),0)}i.addListener(n,"compositionstart",(function(e){if(!b&&t.onCompositionStart&&!t.$readOnly&&(b={},!x)){e.data&&(b.useTextareaForIME=!1),setTimeout(P,0),t._signal("compositionStart"),t.on("mousedown",I);var i=t.getSelectionRange();i.end.row=i.start.row,i.end.column=i.start.column,b.markerRange=i,b.selectionStart=S,t.onCompositionStart(b),b.useTextareaForIME?(k=n.value="",S=0,O=0):(n.msGetInputContext&&(b.context=n.msGetInputContext()),n.getInputContext&&(b.context=n.getInputContext()))}}),t),i.addListener(n,"compositionupdate",P,t),i.addListener(n,"keyup",(function(e){27==e.keyCode&&n.value.length<n.selectionStart&&(b||(k=n.value),S=O=-1,$()),W()}),t),i.addListener(n,"keydown",W,t),i.addListener(n,"compositionend",z,t),this.getElement=function(){return n},this.setCommandMode=function(e){x=e,n.readOnly=!1},this.setReadOnly=function(e){x||(n.readOnly=e)},this.setCopyWithEmptySelection=function(e){},this.onContextMenu=function(e){M=!0,$(),t._emit("nativecontextmenu",{target:t,domEvent:e}),this.moveToMouse(e,!0)},this.moveToMouse=function(e,s){w||(w=n.style.cssText),n.style.cssText=(s?"z-index:100000;":"")+(r.isIE?"opacity:0.1;":"")+"text-indent: -"+(S+O)*t.renderer.characterWidth*.5+"px;";var a=t.container.getBoundingClientRect(),l=o.computedStyle(t.container),c=a.top+(parseInt(l.borderTopWidth)||0),u=a.left+(parseInt(a.borderLeftWidth)||0),h=a.bottom-c-n.clientHeight-2,d=function(e){o.translate(n,e.clientX-u-2,Math.min(e.clientY-c-2,h))};d(e),"mousedown"==e.type&&(t.renderer.$isMousePressed=!0,clearTimeout(B),r.isWin&&i.capture(t.container,d,U))},this.onContextMenuClose=U;var H=function(e){t.textInput.onContextMenu(e),U()};i.addListener(n,"mouseup",H,t),i.addListener(n,"mousedown",(function(e){e.preventDefault(),U()}),t),i.addListener(t.renderer.scroller,"contextmenu",H,t),i.addListener(n,"contextmenu",H,t),f&&function(e,t,n){var i=null,r=!1;n.addEventListener("keydown",(function(e){i&&clearTimeout(i),r=!0}),!0),n.addEventListener("keyup",(function(e){i=setTimeout((function(){r=!1}),100)}),!0);var o=function(e){if(document.activeElement===n&&!(r||b||t.$mouseHandler.isMousePressed||m)){var i=n.selectionStart,o=n.selectionEnd,s=null,a=0;if(0==i?s=h.up:1==i?s=h.home:o>O&&"\n"==k[o]?s=h.end:i<S&&" "==k[i-1]?(s=h.left,a=d.option):i<S||i==S&&O!=S&&i==o?s=h.left:o>O&&k.slice(0,o).split("\n").length>2?s=h.down:o>O&&" "==k[o-1]?(s=h.right,a=d.option):(o>O||o==O&&O!=S&&i==o)&&(s=h.right),i!==o&&(a|=d.shift),s){if(!t.onCommandKey({},a,s)&&t.commands){s=h.keyCodeToString(s);var l=t.commands.findKeyCommand(a,s);l&&t.execCommand(l)}S=i,O=o,$("")}}};document.addEventListener("selectionchange",o),t.on("destroy",(function(){document.removeEventListener("selectionchange",o)}))}(0,t,n)},t.$setUserAgentForTests=function(e,t){g=e,f=t}})),ace.define("ace/mouse/default_handlers",["require","exports","module","ace/lib/useragent"],(function(e,t,n){"use strict";var i=e("../lib/useragent");function r(e){e.$clickSelection=null;var t=e.editor;t.setDefaultHandler("mousedown",this.onMouseDown.bind(e)),t.setDefaultHandler("dblclick",this.onDoubleClick.bind(e)),t.setDefaultHandler("tripleclick",this.onTripleClick.bind(e)),t.setDefaultHandler("quadclick",this.onQuadClick.bind(e)),t.setDefaultHandler("mousewheel",this.onMouseWheel.bind(e));["select","startSelect","selectEnd","selectAllEnd","selectByWordsEnd","selectByLinesEnd","dragWait","dragWaitEnd","focusWait"].forEach((function(t){e[t]=this[t]}),this),e.selectByLines=this.extendSelectionBy.bind(e,"getLineRange"),e.selectByWords=this.extendSelectionBy.bind(e,"getWordRange")}function o(e,t){if(e.start.row==e.end.row)var n=2*t.column-e.start.column-e.end.column;else if(e.start.row!=e.end.row-1||e.start.column||e.end.column)n=2*t.row-e.start.row-e.end.row;else var n=t.column-4;return n<0?{cursor:e.start,anchor:e.end}:{cursor:e.end,anchor:e.start}}(function(){this.onMouseDown=function(e){var t=e.inSelection(),n=e.getDocumentPosition();this.mousedownEvent=e;var r=this.editor,o=e.getButton();return 0!==o?((r.getSelectionRange().isEmpty()||1==o)&&r.selection.moveToPosition(n),void(2==o&&(r.textInput.onContextMenu(e.domEvent),i.isMozilla||e.preventDefault()))):(this.mousedownEvent.time=Date.now(),!t||r.isFocused()||(r.focus(),!this.$focusTimeout||this.$clickSelection||r.inMultiSelectMode)?(this.captureMouse(e),this.startSelect(n,e.domEvent._clicks>1),e.preventDefault()):(this.setState("focusWait"),void this.captureMouse(e)))},this.startSelect=function(e,t){e=e||this.editor.renderer.screenToTextCoordinates(this.x,this.y);var n=this.editor;this.mousedownEvent&&(this.mousedownEvent.getShiftKey()?n.selection.selectToPosition(e):t||n.selection.moveToPosition(e),t||this.select(),n.renderer.scroller.setCapture&&n.renderer.scroller.setCapture(),n.setStyle("ace_selecting"),this.setState("select"))},this.select=function(){var e,t=this.editor,n=t.renderer.screenToTextCoordinates(this.x,this.y);if(this.$clickSelection){var i=this.$clickSelection.comparePoint(n);if(-1==i)e=this.$clickSelection.end;else if(1==i)e=this.$clickSelection.start;else{var r=o(this.$clickSelection,n);n=r.cursor,e=r.anchor}t.selection.setSelectionAnchor(e.row,e.column)}t.selection.selectToPosition(n),t.renderer.scrollCursorIntoView()},this.extendSelectionBy=function(e){var t,n=this.editor,i=n.renderer.screenToTextCoordinates(this.x,this.y),r=n.selection[e](i.row,i.column);if(this.$clickSelection){var s=this.$clickSelection.comparePoint(r.start),a=this.$clickSelection.comparePoint(r.end);if(-1==s&&a<=0)t=this.$clickSelection.end,r.end.row==i.row&&r.end.column==i.column||(i=r.start);else if(1==a&&s>=0)t=this.$clickSelection.start,r.start.row==i.row&&r.start.column==i.column||(i=r.end);else if(-1==s&&1==a)i=r.end,t=r.start;else{var l=o(this.$clickSelection,i);i=l.cursor,t=l.anchor}n.selection.setSelectionAnchor(t.row,t.column)}n.selection.selectToPosition(i),n.renderer.scrollCursorIntoView()},this.selectEnd=this.selectAllEnd=this.selectByWordsEnd=this.selectByLinesEnd=function(){this.$clickSelection=null,this.editor.unsetStyle("ace_selecting"),this.editor.renderer.scroller.releaseCapture&&this.editor.renderer.scroller.releaseCapture()},this.focusWait=function(){var e,t,n,i,r=(e=this.mousedownEvent.x,t=this.mousedownEvent.y,n=this.x,i=this.y,Math.sqrt(Math.pow(n-e,2)+Math.pow(i-t,2))),o=Date.now();(r>0||o-this.mousedownEvent.time>this.$focusTimeout)&&this.startSelect(this.mousedownEvent.getDocumentPosition())},this.onDoubleClick=function(e){var t=e.getDocumentPosition(),n=this.editor,i=n.session.getBracketRange(t);i?(i.isEmpty()&&(i.start.column--,i.end.column++),this.setState("select")):(i=n.selection.getWordRange(t.row,t.column),this.setState("selectByWords")),this.$clickSelection=i,this.select()},this.onTripleClick=function(e){var t=e.getDocumentPosition(),n=this.editor;this.setState("selectByLines");var i=n.getSelectionRange();i.isMultiLine()&&i.contains(t.row,t.column)?(this.$clickSelection=n.selection.getLineRange(i.start.row),this.$clickSelection.end=n.selection.getLineRange(i.end.row).end):this.$clickSelection=n.selection.getLineRange(t.row),this.select()},this.onQuadClick=function(e){var t=this.editor;t.selectAll(),this.$clickSelection=t.getSelectionRange(),this.setState("selectAll")},this.onMouseWheel=function(e){if(!e.getAccelKey()){e.getShiftKey()&&e.wheelY&&!e.wheelX&&(e.wheelX=e.wheelY,e.wheelY=0);var t=this.editor;this.$lastScroll||(this.$lastScroll={t:0,vx:0,vy:0,allowed:0});var n=this.$lastScroll,i=e.domEvent.timeStamp,r=i-n.t,o=r?e.wheelX/r:n.vx,s=r?e.wheelY/r:n.vy;r<550&&(o=(o+n.vx)/2,s=(s+n.vy)/2);var a=Math.abs(o/s),l=!1;if(a>=1&&t.renderer.isScrollableBy(e.wheelX*e.speed,0)&&(l=!0),a<=1&&t.renderer.isScrollableBy(0,e.wheelY*e.speed)&&(l=!0),l)n.allowed=i;else if(i-n.allowed<550){Math.abs(o)<=1.5*Math.abs(n.vx)&&Math.abs(s)<=1.5*Math.abs(n.vy)?(l=!0,n.allowed=i):n.allowed=0}return n.t=i,n.vx=o,n.vy=s,l?(t.renderer.scrollBy(e.wheelX*e.speed,e.wheelY*e.speed),e.stop()):void 0}}}).call(r.prototype),t.DefaultHandlers=r})),ace.define("ace/tooltip",["require","exports","module","ace/lib/oop","ace/lib/dom"],(function(e,t,n){"use strict";e("./lib/oop");var i=e("./lib/dom");function r(e){this.isOpen=!1,this.$element=null,this.$parentNode=e}(function(){this.$init=function(){return this.$element=i.createElement("div"),this.$element.className="ace_tooltip",this.$element.style.display="none",this.$parentNode.appendChild(this.$element),this.$element},this.getElement=function(){return this.$element||this.$init()},this.setText=function(e){this.getElement().textContent=e},this.setHtml=function(e){this.getElement().innerHTML=e},this.setPosition=function(e,t){this.getElement().style.left=e+"px",this.getElement().style.top=t+"px"},this.setClassName=function(e){i.addCssClass(this.getElement(),e)},this.show=function(e,t,n){null!=e&&this.setText(e),null!=t&&null!=n&&this.setPosition(t,n),this.isOpen||(this.getElement().style.display="block",this.isOpen=!0)},this.hide=function(){this.isOpen&&(this.getElement().style.display="none",this.isOpen=!1)},this.getHeight=function(){return this.getElement().offsetHeight},this.getWidth=function(){return this.getElement().offsetWidth},this.destroy=function(){this.isOpen=!1,this.$element&&this.$element.parentNode&&this.$element.parentNode.removeChild(this.$element)}}).call(r.prototype),t.Tooltip=r})),ace.define("ace/mouse/default_gutter_handler",["require","exports","module","ace/lib/dom","ace/lib/oop","ace/lib/event","ace/tooltip"],(function(e,t,n){"use strict";var i=e("../lib/dom"),r=e("../lib/oop"),o=e("../lib/event"),s=e("../tooltip").Tooltip;function a(e){s.call(this,e)}r.inherits(a,s),function(){this.setPosition=function(e,t){var n=window.innerWidth||document.documentElement.clientWidth,i=window.innerHeight||document.documentElement.clientHeight,r=this.getWidth(),o=this.getHeight();(e+=15)+r>n&&(e-=e+r-n),(t+=15)+o>i&&(t-=20+o),s.prototype.setPosition.call(this,e,t)}}.call(a.prototype),t.GutterHandler=function(e){var t,n,r,s=e.editor,l=s.renderer.$gutterLayer,c=new a(s.container);function u(){t&&(t=clearTimeout(t)),r&&(c.hide(),r=null,s._signal("hideGutterTooltip",c),s.off("mousewheel",u))}function h(e){c.setPosition(e.x,e.y)}e.editor.setDefaultHandler("guttermousedown",(function(t){if(s.isFocused()&&0==t.getButton()&&"foldWidgets"!=l.getRegion(t)){var n=t.getDocumentPosition().row,i=s.session.selection;if(t.getShiftKey())i.selectTo(n,0);else{if(2==t.domEvent.detail)return s.selectAll(),t.preventDefault();e.$clickSelection=s.selection.getLineRange(n)}return e.setState("selectByLines"),e.captureMouse(t),t.preventDefault()}})),e.editor.setDefaultHandler("guttermousemove",(function(o){var a=o.domEvent.target||o.domEvent.srcElement;if(i.hasCssClass(a,"ace_fold-widget"))return u();r&&e.$tooltipFollowsMouse&&h(o),n=o,t||(t=setTimeout((function(){t=null,n&&!e.isMousePressed?function(){var t=n.getDocumentPosition().row,i=l.$annotations[t];if(!i)return u();if(t==s.session.getLength()){var o=s.renderer.pixelToScreenCoordinates(0,n.y).row,a=n.$pos;if(o>s.session.documentToScreenRow(a.row,a.column))return u()}if(r!=i)if(r=i.text.join("<br/>"),c.setHtml(r),c.show(),s._signal("showGutterTooltip",c),s.on("mousewheel",u),e.$tooltipFollowsMouse)h(n);else{var d=n.domEvent.target.getBoundingClientRect(),f=c.getElement().style;f.left=d.right+"px",f.top=d.bottom+"px"}}():u()}),50))})),o.addListener(s.renderer.$gutter,"mouseout",(function(e){n=null,r&&!t&&(t=setTimeout((function(){t=null,u()}),50))}),s),s.on("changeSession",u)}})),ace.define("ace/mouse/mouse_event",["require","exports","module","ace/lib/event","ace/lib/useragent"],(function(e,t,n){"use strict";var i=e("../lib/event"),r=e("../lib/useragent"),o=t.MouseEvent=function(e,t){this.domEvent=e,this.editor=t,this.x=this.clientX=e.clientX,this.y=this.clientY=e.clientY,this.$pos=null,this.$inSelection=null,this.propagationStopped=!1,this.defaultPrevented=!1};(function(){this.stopPropagation=function(){i.stopPropagation(this.domEvent),this.propagationStopped=!0},this.preventDefault=function(){i.preventDefault(this.domEvent),this.defaultPrevented=!0},this.stop=function(){this.stopPropagation(),this.preventDefault()},this.getDocumentPosition=function(){return this.$pos||(this.$pos=this.editor.renderer.screenToTextCoordinates(this.clientX,this.clientY)),this.$pos},this.inSelection=function(){if(null!==this.$inSelection)return this.$inSelection;var e=this.editor.getSelectionRange();if(e.isEmpty())this.$inSelection=!1;else{var t=this.getDocumentPosition();this.$inSelection=e.contains(t.row,t.column)}return this.$inSelection},this.getButton=function(){return i.getButton(this.domEvent)},this.getShiftKey=function(){return this.domEvent.shiftKey},this.getAccelKey=r.isMac?function(){return this.domEvent.metaKey}:function(){return this.domEvent.ctrlKey}}).call(o.prototype)})),ace.define("ace/mouse/dragdrop_handler",["require","exports","module","ace/lib/dom","ace/lib/event","ace/lib/useragent"],(function(e,t,n){"use strict";var i=e("../lib/dom"),r=e("../lib/event"),o=e("../lib/useragent");function s(e){var t=e.editor,n=i.createElement("img");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",o.isOpera&&(n.style.cssText="width:1px;height:1px;position:fixed;top:0;left:0;z-index:2147483647;opacity:0;");["dragWait","dragWaitEnd","startDrag","dragReadyEnd","onMouseDrag"].forEach((function(t){e[t]=this[t]}),this),t.on("mousedown",this.onMouseDown.bind(e));var s,l,c,u,h,d,f,p,g,m,v,b=t.container,y=0;function w(){var e=d;(function(e,n){var i=Date.now(),r=!n||e.row!=n.row,o=!n||e.column!=n.column;!m||r||o?(t.moveCursorToPosition(e),m=i,v={x:l,y:c}):a(v.x,v.y,l,c)>5?m=null:i-m>=200&&(t.renderer.scrollCursorIntoView(),m=null)})(d=t.renderer.screenToTextCoordinates(l,c),e),function(e,n){var i=Date.now(),r=t.renderer.layerConfig.lineHeight,o=t.renderer.layerConfig.characterWidth,s=t.renderer.scroller.getBoundingClientRect(),a={x:{left:l-s.left,right:s.right-l},y:{top:c-s.top,bottom:s.bottom-c}},u=Math.min(a.x.left,a.x.right),h=Math.min(a.y.top,a.y.bottom),d={row:e.row,column:e.column};u/o<=2&&(d.column+=a.x.left<a.x.right?-3:2),h/r<=1&&(d.row+=a.y.top<a.y.bottom?-1:1);var f=e.row!=d.row,p=e.column!=d.column,m=!n||e.row!=n.row;f||p&&!m?g?i-g>=200&&t.renderer.scrollCursorIntoView(d):g=i:g=null}(d,e)}function x(){h=t.selection.toOrientedRange(),s=t.session.addMarker(h,"ace_selection",t.getSelectionStyle()),t.clearSelection(),t.isFocused()&&t.renderer.$cursorLayer.setBlinking(!1),clearInterval(u),w(),u=setInterval(w,20),y=0,r.addListener(document,"mousemove",S)}function _(){clearInterval(u),t.session.removeMarker(s),s=null,t.selection.fromOrientedRange(h),t.isFocused()&&!p&&t.$resetCursorStyle(),h=null,d=null,y=0,g=null,m=null,r.removeListener(document,"mousemove",S)}this.onDragStart=function(e){if(this.cancelDrag||!b.draggable){var i=this;return setTimeout((function(){i.startSelect(),i.captureMouse(e)}),0),e.preventDefault()}h=t.getSelectionRange();var r=e.dataTransfer;r.effectAllowed=t.getReadOnly()?"copy":"copyMove",o.isOpera&&(t.container.appendChild(n),n.scrollTop=0),r.setDragImage&&r.setDragImage(n,0,0),o.isOpera&&t.container.removeChild(n),r.clearData(),r.setData("Text",t.session.getTextRange()),p=!0,this.setState("drag")},this.onDragEnd=function(e){if(b.draggable=!1,p=!1,this.setState(null),!t.getReadOnly()){var n=e.dataTransfer.dropEffect;f||"move"!=n||t.session.remove(t.getSelectionRange()),t.$resetCursorStyle()}this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle("")},this.onDragEnter=function(e){if(!t.getReadOnly()&&O(e.dataTransfer))return l=e.clientX,c=e.clientY,s||x(),y++,e.dataTransfer.dropEffect=f=C(e),r.preventDefault(e)},this.onDragOver=function(e){if(!t.getReadOnly()&&O(e.dataTransfer))return l=e.clientX,c=e.clientY,s||(x(),y++),null!==k&&(k=null),e.dataTransfer.dropEffect=f=C(e),r.preventDefault(e)},this.onDragLeave=function(e){if(--y<=0&&s)return _(),f=null,r.preventDefault(e)},this.onDrop=function(e){if(d){var n=e.dataTransfer;if(p)switch(f){case"move":h=h.contains(d.row,d.column)?{start:d,end:d}:t.moveText(h,d);break;case"copy":h=t.moveText(h,d,!0)}else{var i=n.getData("Text");h={start:d,end:t.session.insert(d,i)},t.focus(),f=null}return _(),r.preventDefault(e)}},r.addListener(b,"dragstart",this.onDragStart.bind(e),t),r.addListener(b,"dragend",this.onDragEnd.bind(e),t),r.addListener(b,"dragenter",this.onDragEnter.bind(e),t),r.addListener(b,"dragover",this.onDragOver.bind(e),t),r.addListener(b,"dragleave",this.onDragLeave.bind(e),t),r.addListener(b,"drop",this.onDrop.bind(e),t);var k=null;function S(){null==k&&(k=setTimeout((function(){null!=k&&s&&_()}),20))}function O(e){var t=e.types;return!t||Array.prototype.some.call(t,(function(e){return"text/plain"==e||"Text"==e}))}function C(e){var t=["copy","copymove","all","uninitialized"],n=o.isMac?e.altKey:e.ctrlKey,i="uninitialized";try{i=e.dataTransfer.effectAllowed.toLowerCase()}catch(e){}var r="none";return n&&t.indexOf(i)>=0?r="copy":["move","copymove","linkmove","all","uninitialized"].indexOf(i)>=0?r="move":t.indexOf(i)>=0&&(r="copy"),r}}function a(e,t,n,i){return Math.sqrt(Math.pow(n-e,2)+Math.pow(i-t,2))}(function(){this.dragWait=function(){Date.now()-this.mousedownEvent.time>this.editor.getDragDelay()&&this.startDrag()},this.dragWaitEnd=function(){this.editor.container.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition()),this.selectEnd()},this.dragReadyEnd=function(e){this.editor.$resetCursorStyle(),this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle(""),this.dragWaitEnd()},this.startDrag=function(){this.cancelDrag=!1;var e=this.editor;e.container.draggable=!0,e.renderer.$cursorLayer.setBlinking(!1),e.setStyle("ace_dragging");var t=o.isWin?"default":"move";e.renderer.setCursorStyle(t),this.setState("dragReady")},this.onMouseDrag=function(e){var t=this.editor.container;o.isIE&&"dragReady"==this.state&&(a(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y)>3&&t.dragDrop());"dragWait"===this.state&&(a(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y)>0&&(t.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition())))},this.onMouseDown=function(e){if(this.$dragEnabled){this.mousedownEvent=e;var t=this.editor,n=e.inSelection(),i=e.getButton();if(1===(e.domEvent.detail||1)&&0===i&&n){if(e.editor.inMultiSelectMode&&(e.getAccelKey()||e.getShiftKey()))return;this.mousedownEvent.time=Date.now();var r=e.domEvent.target||e.domEvent.srcElement;if("unselectable"in r&&(r.unselectable="on"),t.getDragDelay()){if(o.isWebKit)this.cancelDrag=!0,t.container.draggable=!0;this.setState("dragWait")}else this.startDrag();this.captureMouse(e,this.onMouseDrag.bind(this)),e.defaultPrevented=!0}}}}).call(s.prototype),t.DragdropHandler=s})),ace.define("ace/mouse/touch_handler",["require","exports","module","ace/mouse/mouse_event","ace/lib/event","ace/lib/dom"],(function(e,t,n){"use strict";var i=e("./mouse_event").MouseEvent,r=e("../lib/event"),o=e("../lib/dom");t.addTouchListeners=function(e,t){var n,s,a,l,c,u,h,d,f,p="scroll",g=0,m=0,v=0,b=0;function y(){var e=window.navigator&&window.navigator.clipboard,n=!1,i=function(i){var r,s,a=i.target.getAttribute("action");if("more"==a||!n)return n=!n,r=t.getCopyText(),s=t.session.getUndoManager().hasUndo(),void f.replaceChild(o.buildDom(n?["span",!r&&["span",{class:"ace_mobile-button",action:"selectall"},"Select All"],r&&["span",{class:"ace_mobile-button",action:"copy"},"Copy"],r&&["span",{class:"ace_mobile-button",action:"cut"},"Cut"],e&&["span",{class:"ace_mobile-button",action:"paste"},"Paste"],s&&["span",{class:"ace_mobile-button",action:"undo"},"Undo"],["span",{class:"ace_mobile-button",action:"find"},"Find"],["span",{class:"ace_mobile-button",action:"openCommandPallete"},"Pallete"]]:["span"]),f.firstChild);"paste"==a?e.readText().then((function(e){t.execCommand(a,e)})):a&&("cut"!=a&&"copy"!=a||(e?e.writeText(t.getCopyText()):document.execCommand("copy")),t.execCommand(a)),f.firstChild.style.display="none",n=!1,"openCommandPallete"!=a&&t.focus()};f=o.buildDom(["div",{class:"ace_mobile-menu",ontouchstart:function(e){p="menu",e.stopPropagation(),e.preventDefault(),t.textInput.focus()},ontouchend:function(e){e.stopPropagation(),e.preventDefault(),i(e)},onclick:i},["span"],["span",{class:"ace_mobile-button",action:"more"},"..."]],t.container)}function w(){f||y();var e=t.selection.cursor,n=t.renderer.textToScreenCoordinates(e.row,e.column),i=t.renderer.textToScreenCoordinates(0,0).pageX,r=t.renderer.scrollLeft,o=t.container.getBoundingClientRect();f.style.top=n.pageY-o.top-3+"px",n.pageX-o.left<o.width-70?(f.style.left="",f.style.right="10px"):(f.style.right="",f.style.left=i+r-o.left+"px"),f.style.display="",f.firstChild.style.display="none",t.on("input",x)}function x(e){f&&(f.style.display="none"),t.off("input",x)}function _(){c=null,clearTimeout(c);var e=t.selection.getRange(),n=e.contains(h.row,h.column);!e.isEmpty()&&n||(t.selection.moveToPosition(h),t.selection.selectWord()),p="wait",w()}r.addListener(e,"contextmenu",(function(e){d&&t.textInput.getElement().focus()}),t),r.addListener(e,"touchstart",(function(e){var r=e.touches;if(c||r.length>1)return clearTimeout(c),c=null,a=-1,void(p="zoom");d=t.$mouseHandler.isMousePressed=!0;var o=t.renderer.layerConfig.lineHeight,u=t.renderer.layerConfig.lineHeight,f=e.timeStamp;l=f;var y=r[0],w=y.clientX,x=y.clientY;Math.abs(n-w)+Math.abs(s-x)>o&&(a=-1),n=e.clientX=w,s=e.clientY=x,v=b=0;var k=new i(e,t);if(h=k.getDocumentPosition(),f-a<500&&1==r.length&&!g)m++,e.preventDefault(),e.button=0,function(){c=null,clearTimeout(c),t.selection.moveToPosition(h);var e=m>=2?t.selection.getLineRange(h.row):t.session.getBracketRange(h);e&&!e.isEmpty()?t.selection.setRange(e):t.selection.selectWord(),p="wait"}();else{m=0;var S=t.selection.cursor,O=t.selection.isEmpty()?S:t.selection.anchor,C=t.renderer.$cursorLayer.getPixelPosition(S,!0),A=t.renderer.$cursorLayer.getPixelPosition(O,!0),$=t.renderer.scroller.getBoundingClientRect(),E=t.renderer.layerConfig.offset,M=t.renderer.scrollLeft,j=function(e,t){return(e/=u)*e+(t=t/o-.75)*t};if(e.clientX<$.left)return void(p="zoom");var R=j(e.clientX-$.left-C.left+M,e.clientY-$.top-C.top+E),D=j(e.clientX-$.left-A.left+M,e.clientY-$.top-A.top+E);R<3.5&&D<3.5&&(p=R>D?"cursor":"anchor"),p=D<3.5?"anchor":R<3.5?"cursor":"scroll",c=setTimeout(_,450)}a=f}),t),r.addListener(e,"touchend",(function(e){d=t.$mouseHandler.isMousePressed=!1,u&&clearInterval(u),"zoom"==p?(p="",g=0):c?(t.selection.moveToPosition(h),g=0,w()):"scroll"==p?(g+=60,u=setInterval((function(){g--<=0&&(clearInterval(u),u=null),Math.abs(v)<.01&&(v=0),Math.abs(b)<.01&&(b=0),g<20&&(v*=.9),g<20&&(b*=.9);var e=t.session.getScrollTop();t.renderer.scrollBy(10*v,10*b),e==t.session.getScrollTop()&&(g=0)}),10),x()):w(),clearTimeout(c),c=null}),t),r.addListener(e,"touchmove",(function(e){c&&(clearTimeout(c),c=null);var r=e.touches;if(!(r.length>1||"zoom"==p)){var o=r[0],a=n-o.clientX,u=s-o.clientY;if("wait"==p){if(!(a*a+u*u>4))return e.preventDefault();p="cursor"}n=o.clientX,s=o.clientY,e.clientX=o.clientX,e.clientY=o.clientY;var h=e.timeStamp,d=h-l;if(l=h,"scroll"==p){var f=new i(e,t);f.speed=1,f.wheelX=a,f.wheelY=u,10*Math.abs(a)<Math.abs(u)&&(a=0),10*Math.abs(u)<Math.abs(a)&&(u=0),0!=d&&(v=a/d,b=u/d),t._emit("mousewheel",f),f.propagationStopped||(v=b=0)}else{var g=new i(e,t).getDocumentPosition();"cursor"==p?t.selection.moveCursorToPosition(g):"anchor"==p&&t.selection.setSelectionAnchor(g.row,g.column),t.renderer.scrollCursorIntoView(g),e.preventDefault()}}}),t)}})),ace.define("ace/lib/net",["require","exports","module","ace/lib/dom"],(function(e,t,n){"use strict";var i=e("./dom");t.get=function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.onreadystatechange=function(){4===n.readyState&&t(n.responseText)},n.send(null)},t.loadScript=function(e,t){var n=i.getDocumentHead(),r=document.createElement("script");r.src=e,n.appendChild(r),r.onload=r.onreadystatechange=function(e,n){!n&&r.readyState&&"loaded"!=r.readyState&&"complete"!=r.readyState||(r=r.onload=r.onreadystatechange=null,n||t())}},t.qualifyURL=function(e){var t=document.createElement("a");return t.href=e,t.href}})),ace.define("ace/lib/event_emitter",["require","exports","module"],(function(e,t,n){"use strict";var i={},r=function(){this.propagationStopped=!0},o=function(){this.defaultPrevented=!0};i._emit=i._dispatchEvent=function(e,t){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var n=this._eventRegistry[e]||[],i=this._defaultHandlers[e];if(n.length||i){"object"==typeof t&&t||(t={}),t.type||(t.type=e),t.stopPropagation||(t.stopPropagation=r),t.preventDefault||(t.preventDefault=o),n=n.slice();for(var s=0;s<n.length&&(n[s](t,this),!t.propagationStopped);s++);return i&&!t.defaultPrevented?i(t,this):void 0}},i._signal=function(e,t){var n=(this._eventRegistry||{})[e];if(n){n=n.slice();for(var i=0;i<n.length;i++)n[i](t,this)}},i.once=function(e,t){var n=this;if(this.on(e,(function i(){n.off(e,i),t.apply(null,arguments)})),!t)return new Promise((function(e){t=e}))},i.setDefaultHandler=function(e,t){var n=this._defaultHandlers;if(n||(n=this._defaultHandlers={_disabled_:{}}),n[e]){var i=n[e],r=n._disabled_[e];r||(n._disabled_[e]=r=[]),r.push(i);var o=r.indexOf(t);-1!=o&&r.splice(o,1)}n[e]=t},i.removeDefaultHandler=function(e,t){var n=this._defaultHandlers;if(n){var i=n._disabled_[e];if(n[e]==t)i&&this.setDefaultHandler(e,i.pop());else if(i){var r=i.indexOf(t);-1!=r&&i.splice(r,1)}}},i.on=i.addEventListener=function(e,t,n){this._eventRegistry=this._eventRegistry||{};var i=this._eventRegistry[e];return i||(i=this._eventRegistry[e]=[]),-1==i.indexOf(t)&&i[n?"unshift":"push"](t),t},i.off=i.removeListener=i.removeEventListener=function(e,t){this._eventRegistry=this._eventRegistry||{};var n=this._eventRegistry[e];if(n){var i=n.indexOf(t);-1!==i&&n.splice(i,1)}},i.removeAllListeners=function(e){e||(this._eventRegistry=this._defaultHandlers=void 0),this._eventRegistry&&(this._eventRegistry[e]=void 0),this._defaultHandlers&&(this._defaultHandlers[e]=void 0)},t.EventEmitter=i})),ace.define("ace/lib/app_config",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],(function(e,t,n){var i=e("./oop"),r=e("./event_emitter").EventEmitter,o={setOptions:function(e){Object.keys(e).forEach((function(t){this.setOption(t,e[t])}),this)},getOptions:function(e){var t={};if(e)Array.isArray(e)||(t=e,e=Object.keys(t));else{var n=this.$options;e=Object.keys(n).filter((function(e){return!n[e].hidden}))}return e.forEach((function(e){t[e]=this.getOption(e)}),this),t},setOption:function(e,t){if(this["$"+e]!==t){var n=this.$options[e];if(!n)return s('misspelled option "'+e+'"');if(n.forwardTo)return this[n.forwardTo]&&this[n.forwardTo].setOption(e,t);n.handlesSet||(this["$"+e]=t),n&&n.set&&n.set.call(this,t)}},getOption:function(e){var t=this.$options[e];return t?t.forwardTo?this[t.forwardTo]&&this[t.forwardTo].getOption(e):t&&t.get?t.get.call(this):this["$"+e]:s('misspelled option "'+e+'"')}};function s(e){"undefined"!=typeof console&&console.warn&&console.warn.apply(console,arguments)}function a(e,t){var n=new Error(e);n.data=t,"object"==typeof console&&console.error&&console.error(n),setTimeout((function(){throw n}))}var l=function(){this.$defaultOptions={}};(function(){i.implement(this,r),this.defineOptions=function(e,t,n){return e.$options||(this.$defaultOptions[t]=e.$options={}),Object.keys(n).forEach((function(t){var i=n[t];"string"==typeof i&&(i={forwardTo:i}),i.name||(i.name=t),e.$options[i.name]=i,"initialValue"in i&&(e["$"+i.name]=i.initialValue)})),i.implement(e,o),this},this.resetOptions=function(e){Object.keys(e.$options).forEach((function(t){var n=e.$options[t];"value"in n&&e.setOption(t,n.value)}))},this.setDefaultValue=function(e,t,n){if(!e){for(e in this.$defaultOptions)if(this.$defaultOptions[e][t])break;if(!this.$defaultOptions[e][t])return!1}var i=this.$defaultOptions[e]||(this.$defaultOptions[e]={});i[t]&&(i.forwardTo?this.setDefaultValue(i.forwardTo,t,n):i[t].value=n)},this.setDefaultValues=function(e,t){Object.keys(t).forEach((function(n){this.setDefaultValue(e,n,t[n])}),this)},this.warn=s,this.reportError=a}).call(l.prototype),t.AppConfig=l})),ace.define("ace/config",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/lib/net","ace/lib/app_config"],(function(e,t,i){var r=e("./lib/lang"),o=(e("./lib/oop"),e("./lib/net")),s=e("./lib/app_config").AppConfig;i.exports=t=new s;var a=function(){return this||"undefined"!=typeof window&&window}(),l={packaged:!1,workerPath:null,modePath:null,themePath:null,basePath:"",suffix:".js",$moduleUrls:{},loadWorkerFromBlob:!0,sharedPopups:!1};t.get=function(e){if(!l.hasOwnProperty(e))throw new Error("Unknown config key: "+e);return l[e]},t.set=function(e,t){if(l.hasOwnProperty(e))l[e]=t;else if(0==this.setDefaultValue("",e,t))throw new Error("Unknown config key: "+e)},t.all=function(){return r.copyObject(l)},t.$modes={},t.moduleUrl=function(e,t){if(l.$moduleUrls[e])return l.$moduleUrls[e];var n=e.split("/"),i="snippets"==(t=t||n[n.length-2]||"")?"/":"-",r=n[n.length-1];if("worker"==t&&"-"==i){var o=new RegExp("^"+t+"[\\-_]|[\\-_]"+t+"$","g");r=r.replace(o,"")}(!r||r==t)&&n.length>1&&(r=n[n.length-2]);var s=l[t+"Path"];return null==s?s=l.basePath:"/"==i&&(t=i=""),s&&"/"!=s.slice(-1)&&(s+="/"),s+t+i+r+this.get("suffix")},t.setModuleUrl=function(e,t){return l.$moduleUrls[e]=t},t.$loading={},t.loadModule=function(n,i){var r,s;Array.isArray(n)&&(s=n[0],n=n[1]);try{r=e(n)}catch(e){}if(r&&!t.$loading[n])return i&&i(r);if(t.$loading[n]||(t.$loading[n]=[]),t.$loading[n].push(i),!(t.$loading[n].length>1)){var a=function(){e([n],(function(e){t._emit("load.module",{name:n,module:e});var i=t.$loading[n];t.$loading[n]=null,i.forEach((function(t){t&&t(e)}))}))};if(!t.get("packaged"))return a();o.loadScript(t.moduleUrl(n,s),a),c()}};var c=function(){l.basePath||l.workerPath||l.modePath||l.themePath||Object.keys(l.$moduleUrls).length||(console.error("Unable to infer path to ace from script src,","use ace.config.set('basePath', 'path') to enable dynamic loading of modes and themes","or with webpack use ace/webpack-resolver"),c=function(){})};function u(r){if(a&&a.document){l.packaged=r||e.packaged||i.packaged||a.define&&n(57).packaged;for(var o,s={},c="",u=document.currentScript||document._currentScript,h=(u&&u.ownerDocument||document).getElementsByTagName("script"),d=0;d<h.length;d++){var f=h[d],p=f.src||f.getAttribute("src");if(p){for(var g=f.attributes,m=0,v=g.length;m<v;m++){var b=g[m];0===b.name.indexOf("data-ace-")&&(s[(o=b.name.replace(/^data-ace-/,""),o.replace(/-(.)/g,(function(e,t){return t.toUpperCase()})))]=b.value)}var y=p.match(/^(.*)\/ace(\-\w+)?\.js(\?|$)/);y&&(c=y[1])}}for(var w in c&&(s.base=s.base||c,s.packaged=!0),s.basePath=s.base,s.workerPath=s.workerPath||s.base,s.modePath=s.modePath||s.base,s.themePath=s.themePath||s.base,delete s.base,s)void 0!==s[w]&&t.set(w,s[w])}}u(!0),t.init=u,t.version="1.4.12"})),ace.define("ace/mouse/mouse_handler",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/mouse/default_handlers","ace/mouse/default_gutter_handler","ace/mouse/mouse_event","ace/mouse/dragdrop_handler","ace/mouse/touch_handler","ace/config"],(function(e,t,n){"use strict";var i=e("../lib/event"),r=e("../lib/useragent"),o=e("./default_handlers").DefaultHandlers,s=e("./default_gutter_handler").GutterHandler,a=e("./mouse_event").MouseEvent,l=e("./dragdrop_handler").DragdropHandler,c=e("./touch_handler").addTouchListeners,u=e("../config"),h=function(e){var t=this;this.editor=e,new o(this),new s(this),new l(this);var n=function(t){(!document.hasFocus||!document.hasFocus()||!e.isFocused()&&document.activeElement==(e.textInput&&e.textInput.getElement()))&&window.focus(),e.focus()},a=e.renderer.getMouseEventTarget();i.addListener(a,"click",this.onMouseEvent.bind(this,"click"),e),i.addListener(a,"mousemove",this.onMouseMove.bind(this,"mousemove"),e),i.addMultiMouseDownListener([a,e.renderer.scrollBarV&&e.renderer.scrollBarV.inner,e.renderer.scrollBarH&&e.renderer.scrollBarH.inner,e.textInput&&e.textInput.getElement()].filter(Boolean),[400,300,250],this,"onMouseEvent",e),i.addMouseWheelListener(e.container,this.onMouseWheel.bind(this,"mousewheel"),e),c(e.container,e);var u=e.renderer.$gutter;i.addListener(u,"mousedown",this.onMouseEvent.bind(this,"guttermousedown"),e),i.addListener(u,"click",this.onMouseEvent.bind(this,"gutterclick"),e),i.addListener(u,"dblclick",this.onMouseEvent.bind(this,"gutterdblclick"),e),i.addListener(u,"mousemove",this.onMouseEvent.bind(this,"guttermousemove"),e),i.addListener(a,"mousedown",n,e),i.addListener(u,"mousedown",n,e),r.isIE&&e.renderer.scrollBarV&&(i.addListener(e.renderer.scrollBarV.element,"mousedown",n,e),i.addListener(e.renderer.scrollBarH.element,"mousedown",n,e)),e.on("mousemove",(function(n){if(!t.state&&!t.$dragDelay&&t.$dragEnabled){var i=e.renderer.screenToTextCoordinates(n.x,n.y),r=e.session.selection.getRange(),o=e.renderer;!r.isEmpty()&&r.insideStart(i.row,i.column)?o.setCursorStyle("default"):o.setCursorStyle("")}}),e)};(function(){this.onMouseEvent=function(e,t){this.editor._emit(e,new a(t,this.editor))},this.onMouseMove=function(e,t){var n=this.editor._eventRegistry&&this.editor._eventRegistry.mousemove;n&&n.length&&this.editor._emit(e,new a(t,this.editor))},this.onMouseWheel=function(e,t){var n=new a(t,this.editor);n.speed=2*this.$scrollSpeed,n.wheelX=t.wheelX,n.wheelY=t.wheelY,this.editor._emit(e,n)},this.setState=function(e){this.state=e},this.captureMouse=function(e,t){this.x=e.x,this.y=e.y,this.isMousePressed=!0;var n=this.editor,o=this.editor.renderer;o.$isMousePressed=!0;var s=this,l=function(e){if(e){if(r.isWebKit&&!e.which&&s.releaseMouse)return s.releaseMouse();s.x=e.clientX,s.y=e.clientY,t&&t(e),s.mouseEvent=new a(e,s.editor),s.$mouseMoved=!0}},c=function(e){n.off("beforeEndOperation",h),clearInterval(d),u(),s[s.state+"End"]&&s[s.state+"End"](e),s.state="",s.isMousePressed=o.$isMousePressed=!1,o.$keepTextAreaAtCursor&&o.$moveTextAreaToCursor(),s.$onCaptureMouseMove=s.releaseMouse=null,e&&s.onMouseEvent("mouseup",e),n.endOperation()},u=function(){s[s.state]&&s[s.state](),s.$mouseMoved=!1};if(r.isOldIE&&"dblclick"==e.domEvent.type)return setTimeout((function(){c(e)}));var h=function(e){s.releaseMouse&&n.curOp.command.name&&n.curOp.selectionChanged&&(s[s.state+"End"]&&s[s.state+"End"](),s.state="",s.releaseMouse())};n.on("beforeEndOperation",h),n.startOperation({command:{name:"mouse"}}),s.$onCaptureMouseMove=l,s.releaseMouse=i.capture(this.editor.container,l,c);var d=setInterval(u,20)},this.releaseMouse=null,this.cancelContextMenu=function(){var e=function(t){t&&t.domEvent&&"contextmenu"!=t.domEvent.type||(this.editor.off("nativecontextmenu",e),t&&t.domEvent&&i.stopEvent(t.domEvent))}.bind(this);setTimeout(e,10),this.editor.on("nativecontextmenu",e)},this.destroy=function(){this.releaseMouse&&this.releaseMouse()}}).call(h.prototype),u.defineOptions(h.prototype,"mouseHandler",{scrollSpeed:{initialValue:2},dragDelay:{initialValue:r.isMac?150:0},dragEnabled:{initialValue:!0},focusTimeout:{initialValue:0},tooltipFollowsMouse:{initialValue:!0}}),t.MouseHandler=h})),ace.define("ace/mouse/fold_handler",["require","exports","module","ace/lib/dom"],(function(e,t,n){"use strict";var i=e("../lib/dom");t.FoldHandler=function(e){e.on("click",(function(t){var n=t.getDocumentPosition(),r=e.session,o=r.getFoldAt(n.row,n.column,1);o&&(t.getAccelKey()?r.removeFold(o):r.expandFold(o),t.stop());var s=t.domEvent&&t.domEvent.target;s&&i.hasCssClass(s,"ace_inline_button")&&i.hasCssClass(s,"ace_toggle_wrap")&&(r.setOption("wrap",!r.getUseWrapMode()),e.renderer.scrollCursorIntoView())})),e.on("gutterclick",(function(t){if("foldWidgets"==e.renderer.$gutterLayer.getRegion(t)){var n=t.getDocumentPosition().row,i=e.session;i.foldWidgets&&i.foldWidgets[n]&&e.session.onFoldWidgetClick(n,t),e.isFocused()||e.focus(),t.stop()}})),e.on("gutterdblclick",(function(t){if("foldWidgets"==e.renderer.$gutterLayer.getRegion(t)){var n=t.getDocumentPosition().row,i=e.session,r=i.getParentFoldRangeData(n,!0),o=r.range||r.firstRange;if(o){n=o.start.row;var s=i.getFoldAt(n,i.getLine(n).length,1);s?i.removeFold(s):(i.addFold("...",o),e.renderer.scrollCursorIntoView({row:o.start.row,column:0}))}t.stop()}}))}})),ace.define("ace/keyboard/keybinding",["require","exports","module","ace/lib/keys","ace/lib/event"],(function(e,t,n){"use strict";var i=e("../lib/keys"),r=e("../lib/event"),o=function(e){this.$editor=e,this.$data={editor:e},this.$handlers=[],this.setDefaultHandler(e.commands)};(function(){this.setDefaultHandler=function(e){this.removeKeyboardHandler(this.$defaultHandler),this.$defaultHandler=e,this.addKeyboardHandler(e,0)},this.setKeyboardHandler=function(e){var t=this.$handlers;if(t[t.length-1]!=e){for(;t[t.length-1]&&t[t.length-1]!=this.$defaultHandler;)this.removeKeyboardHandler(t[t.length-1]);this.addKeyboardHandler(e,1)}},this.addKeyboardHandler=function(e,t){if(e){"function"!=typeof e||e.handleKeyboard||(e.handleKeyboard=e);var n=this.$handlers.indexOf(e);-1!=n&&this.$handlers.splice(n,1),null==t?this.$handlers.push(e):this.$handlers.splice(t,0,e),-1==n&&e.attach&&e.attach(this.$editor)}},this.removeKeyboardHandler=function(e){var t=this.$handlers.indexOf(e);return-1!=t&&(this.$handlers.splice(t,1),e.detach&&e.detach(this.$editor),!0)},this.getKeyboardHandler=function(){return this.$handlers[this.$handlers.length-1]},this.getStatusText=function(){var e=this.$data,t=e.editor;return this.$handlers.map((function(n){return n.getStatusText&&n.getStatusText(t,e)||""})).filter(Boolean).join(" ")},this.$callKeyboardHandlers=function(e,t,n,i){for(var o,s=!1,a=this.$editor.commands,l=this.$handlers.length;l--&&!((o=this.$handlers[l].handleKeyboard(this.$data,e,t,n,i))&&o.command&&((s="null"==o.command||a.exec(o.command,this.$editor,o.args,i))&&i&&-1!=e&&1!=o.passEvent&&1!=o.command.passEvent&&r.stopEvent(i),s)););return s||-1!=e||(o={command:"insertstring"},s=a.exec("insertstring",this.$editor,t)),s&&this.$editor._signal&&this.$editor._signal("keyboardActivity",o),s},this.onCommandKey=function(e,t,n){var r=i.keyCodeToString(n);return this.$callKeyboardHandlers(t,r,n,e)},this.onTextInput=function(e){return this.$callKeyboardHandlers(-1,e)}}).call(o.prototype),t.KeyBinding=o})),ace.define("ace/lib/bidiutil",["require","exports","module"],(function(e,t,n){"use strict";var i=0,r=0,o=!1,s=!1,a=!1,l=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],c=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],u=[18,18,18,18,18,18,18,18,18,6,5,6,8,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,5,5,5,6,8,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,18,18,18,18,18,18,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,4,11,11,11,11,4,4,4,4,0,4,4,18,4,4,11,11,2,2,4,0,4,4,4,2,0,4,4,4,4,4],h=[8,8,8,8,8,8,8,8,8,8,8,18,18,18,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,11,11,11,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8];function d(e,t,n){if(!(r<e))if(1!=e||1!=i||s)for(var o,a,l,c,u=n.length,h=0;h<u;){if(t[h]>=e){for(o=h+1;o<u&&t[o]>=e;)o++;for(a=h,l=o-1;a<l;a++,l--)c=n[a],n[a]=n[l],n[l]=c;h=o}h++}else n.reverse()}function f(e,t,n,r){var l,c,u,h,d=t[r];switch(d){case 0:case 1:o=!1;case 4:case 3:return d;case 2:return o?3:2;case 7:return o=!0,!0,1;case 8:return 4;case 9:return r<1||r+1>=t.length||2!=(l=n[r-1])&&3!=l||2!=(c=t[r+1])&&3!=c?4:(o&&(c=3),c==l?c:4);case 10:return 2==(l=r>0?n[r-1]:5)&&r+1<t.length&&2==t[r+1]?2:4;case 11:if(r>0&&2==n[r-1])return 2;if(o)return 4;for(h=r+1,u=t.length;h<u&&11==t[h];)h++;return h<u&&2==t[h]?2:4;case 12:for(u=t.length,h=r+1;h<u&&12==t[h];)h++;if(h<u){var f=e[r],p=f>=1425&&f<=2303||64286==f;if(l=t[h],p&&(1==l||7==l))return 1}return r<1||5==(l=t[r-1])?4:n[r-1];case 5:return o=!1,s=!0,i;case 6:return a=!0,4;case 13:case 14:case 16:case 17:case 15:o=!1;case 18:return 4}}function p(e){var t=e.charCodeAt(0),n=t>>8;return 0==n?t>191?0:u[t]:5==n?/[\u0591-\u05f4]/.test(e)?1:0:6==n?/[\u0610-\u061a\u064b-\u065f\u06d6-\u06e4\u06e7-\u06ed]/.test(e)?12:/[\u0660-\u0669\u066b-\u066c]/.test(e)?3:1642==t?11:/[\u06f0-\u06f9]/.test(e)?2:7:32==n&&t<=8287?h[255&t]:254==n&&t>=65136?7:4}t.L=0,t.R=1,t.EN=2,t.ON_R=3,t.AN=4,t.R_H=5,t.B=6,t.RLE=7,t.DOT="Â·",t.doBidiReorder=function(e,n,u){if(e.length<2)return{};var h=e.split(""),g=new Array(h.length),m=new Array(h.length),v=[];i=u?1:0,function(e,t,n,u){var h=i?c:l,d=null,g=null,m=null,v=0,b=null,y=-1,w=null,x=null,_=[];if(!u)for(w=0,u=[];w<n;w++)u[w]=p(e[w]);for(r=i,o=!1,!1,s=!1,a=!1,x=0;x<n;x++){if(d=v,_[x]=g=f(e,u,_,x),b=240&(v=h[d][g]),v&=15,t[x]=m=h[v][5],b>0)if(16==b){for(w=y;w<x;w++)t[w]=1;y=-1}else y=-1;if(h[v][6])-1==y&&(y=x);else if(y>-1){for(w=y;w<x;w++)t[w]=m;y=-1}5==u[x]&&(t[x]=0),r|=m}if(a)for(w=0;w<n;w++)if(6==u[w]){t[w]=i;for(var k=w-1;k>=0&&8==u[k];k--)t[k]=i}}(h,v,h.length,n);for(var b=0;b<g.length;g[b]=b,b++);d(2,v,g),d(1,v,g);for(b=0;b<g.length-1;b++)3===n[b]?v[b]=t.AN:1===v[b]&&(n[b]>7&&n[b]<13||4===n[b]||18===n[b])?v[b]=t.ON_R:b>0&&"Ù„"===h[b-1]&&/\u0622|\u0623|\u0625|\u0627/.test(h[b])&&(v[b-1]=v[b]=t.R_H,b++);h[h.length-1]===t.DOT&&(v[h.length-1]=t.B),"â€«"===h[0]&&(v[0]=t.RLE);for(b=0;b<g.length;b++)m[b]=v[g[b]];return{logicalFromVisual:g,bidiLevels:m}},t.hasBidiCharacters=function(e,t){for(var n=!1,i=0;i<e.length;i++)t[i]=p(e.charAt(i)),n||1!=t[i]&&7!=t[i]&&3!=t[i]||(n=!0);return n},t.getVisualFromLogicalIdx=function(e,t){for(var n=0;n<t.logicalFromVisual.length;n++)if(t.logicalFromVisual[n]==e)return n;return 0}})),ace.define("ace/bidihandler",["require","exports","module","ace/lib/bidiutil","ace/lib/lang"],(function(e,t,n){"use strict";var i=e("./lib/bidiutil"),r=e("./lib/lang"),o=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\u202B]/,s=function(e){this.session=e,this.bidiMap={},this.currentRow=null,this.bidiUtil=i,this.charWidths=[],this.EOL="Â¬",this.showInvisibles=!0,this.isRtlDir=!1,this.$isRtl=!1,this.line="",this.wrapIndent=0,this.EOF="Â¶",this.RLE="â€«",this.contentWidth=0,this.fontMetrics=null,this.rtlLineOffset=0,this.wrapOffset=0,this.isMoveLeftOperation=!1,this.seenBidi=o.test(e.getValue())};(function(){this.isBidiRow=function(e,t,n){return!!this.seenBidi&&(e!==this.currentRow&&(this.currentRow=e,this.updateRowLine(t,n),this.updateBidiMap()),this.bidiMap.bidiLevels)},this.onChange=function(e){this.seenBidi?this.currentRow=null:"insert"==e.action&&o.test(e.lines.join("\n"))&&(this.seenBidi=!0,this.currentRow=null)},this.getDocumentRow=function(){var e=0,t=this.session.$screenRowCache;if(t.length){var n=this.session.$getRowCacheIndex(t,this.currentRow);n>=0&&(e=this.session.$docRowCache[n])}return e},this.getSplitIndex=function(){var e=0,t=this.session.$screenRowCache;if(t.length)for(var n,i=this.session.$getRowCacheIndex(t,this.currentRow);this.currentRow-e>0&&(n=this.session.$getRowCacheIndex(t,this.currentRow-e-1))===i;)i=n,e++;else e=this.currentRow;return e},this.updateRowLine=function(e,t){void 0===e&&(e=this.getDocumentRow());var n=e===this.session.getLength()-1?this.EOF:this.EOL;if(this.wrapIndent=0,this.line=this.session.getLine(e),this.isRtlDir=this.$isRtl||this.line.charAt(0)===this.RLE,this.session.$useWrapMode){var o=this.session.$wrapData[e];o&&(void 0===t&&(t=this.getSplitIndex()),t>0&&o.length?(this.wrapIndent=o.indent,this.wrapOffset=this.wrapIndent*this.charWidths[i.L],this.line=t<o.length?this.line.substring(o[t-1],o[t]):this.line.substring(o[o.length-1])):this.line=this.line.substring(0,o[t])),t==o.length&&(this.line+=this.showInvisibles?n:i.DOT)}else this.line+=this.showInvisibles?n:i.DOT;var s,a=this.session,l=0;this.line=this.line.replace(/\t|[\u1100-\u2029, \u202F-\uFFE6]/g,(function(e,t){return"\t"===e||a.isFullWidth(e.charCodeAt(0))?(s="\t"===e?a.getScreenTabSize(t+l):2,l+=s-1,r.stringRepeat(i.DOT,s)):e})),this.isRtlDir&&(this.fontMetrics.$main.textContent=this.line.charAt(this.line.length-1)==i.DOT?this.line.substr(0,this.line.length-1):this.line,this.rtlLineOffset=this.contentWidth-this.fontMetrics.$main.getBoundingClientRect().width)},this.updateBidiMap=function(){var e=[];i.hasBidiCharacters(this.line,e)||this.isRtlDir?this.bidiMap=i.doBidiReorder(this.line,e,this.isRtlDir):this.bidiMap={}},this.markAsDirty=function(){this.currentRow=null},this.updateCharacterWidths=function(e){if(this.characterWidth!==e.$characterSize.width){this.fontMetrics=e;var t=this.characterWidth=e.$characterSize.width,n=e.$measureCharWidth("×”");this.charWidths[i.L]=this.charWidths[i.EN]=this.charWidths[i.ON_R]=t,this.charWidths[i.R]=this.charWidths[i.AN]=n,this.charWidths[i.R_H]=.45*n,this.charWidths[i.B]=this.charWidths[i.RLE]=0,this.currentRow=null}},this.setShowInvisibles=function(e){this.showInvisibles=e,this.currentRow=null},this.setEolChar=function(e){this.EOL=e},this.setContentWidth=function(e){this.contentWidth=e},this.isRtlLine=function(e){return!!this.$isRtl||(null!=e?this.session.getLine(e).charAt(0)==this.RLE:this.isRtlDir)},this.setRtlDirection=function(e,t){for(var n=e.getCursorPosition(),i=e.selection.getSelectionAnchor().row;i<=n.row;i++)t||e.session.getLine(i).charAt(0)!==e.session.$bidiHandler.RLE?t&&e.session.getLine(i).charAt(0)!==e.session.$bidiHandler.RLE&&e.session.doc.insert({column:0,row:i},e.session.$bidiHandler.RLE):e.session.doc.removeInLine(i,0,1)},this.getPosLeft=function(e){e-=this.wrapIndent;var t=this.line.charAt(0)===this.RLE?1:0,n=e>t?this.session.getOverwrite()?e:e-1:t,r=i.getVisualFromLogicalIdx(n,this.bidiMap),o=this.bidiMap.bidiLevels,s=0;!this.session.getOverwrite()&&e<=t&&o[r]%2!=0&&r++;for(var a=0;a<r;a++)s+=this.charWidths[o[a]];return!this.session.getOverwrite()&&e>t&&o[r]%2==0&&(s+=this.charWidths[o[r]]),this.wrapIndent&&(s+=this.isRtlDir?-1*this.wrapOffset:this.wrapOffset),this.isRtlDir&&(s+=this.rtlLineOffset),s},this.getSelections=function(e,t){var n,i=this.bidiMap,r=i.bidiLevels,o=[],s=0,a=Math.min(e,t)-this.wrapIndent,l=Math.max(e,t)-this.wrapIndent,c=!1,u=!1,h=0;this.wrapIndent&&(s+=this.isRtlDir?-1*this.wrapOffset:this.wrapOffset);for(var d,f=0;f<r.length;f++)d=i.logicalFromVisual[f],n=r[f],(c=d>=a&&d<l)&&!u?h=s:!c&&u&&o.push({left:h,width:s-h}),s+=this.charWidths[n],u=c;if(c&&f===r.length&&o.push({left:h,width:s-h}),this.isRtlDir)for(var p=0;p<o.length;p++)o[p].left+=this.rtlLineOffset;return o},this.offsetToCol=function(e){this.isRtlDir&&(e-=this.rtlLineOffset);var t=0,n=(e=Math.max(e,0),0),i=0,r=this.bidiMap.bidiLevels,o=this.charWidths[r[i]];for(this.wrapIndent&&(e-=this.isRtlDir?-1*this.wrapOffset:this.wrapOffset);e>n+o/2;){if(n+=o,i===r.length-1){o=0;break}o=this.charWidths[r[++i]]}return i>0&&r[i-1]%2!=0&&r[i]%2==0?(e<n&&i--,t=this.bidiMap.logicalFromVisual[i]):i>0&&r[i-1]%2==0&&r[i]%2!=0?t=1+(e>n?this.bidiMap.logicalFromVisual[i]:this.bidiMap.logicalFromVisual[i-1]):this.isRtlDir&&i===r.length-1&&0===o&&r[i-1]%2==0||!this.isRtlDir&&0===i&&r[i]%2!=0?t=1+this.bidiMap.logicalFromVisual[i]:(i>0&&r[i-1]%2!=0&&0!==o&&i--,t=this.bidiMap.logicalFromVisual[i]),0===t&&this.isRtlDir&&t++,t+this.wrapIndent}}).call(s.prototype),t.BidiHandler=s})),ace.define("ace/selection",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/lib/event_emitter","ace/range"],(function(e,t,n){"use strict";var i=e("./lib/oop"),r=e("./lib/lang"),o=e("./lib/event_emitter").EventEmitter,s=e("./range").Range,a=function(e){this.session=e,this.doc=e.getDocument(),this.clearSelection(),this.cursor=this.lead=this.doc.createAnchor(0,0),this.anchor=this.doc.createAnchor(0,0),this.$silent=!1;var t=this;this.cursor.on("change",(function(e){t.$cursorChanged=!0,t.$silent||t._emit("changeCursor"),t.$isEmpty||t.$silent||t._emit("changeSelection"),t.$keepDesiredColumnOnChange||e.old.column==e.value.column||(t.$desiredColumn=null)})),this.anchor.on("change",(function(){t.$anchorChanged=!0,t.$isEmpty||t.$silent||t._emit("changeSelection")}))};(function(){i.implement(this,o),this.isEmpty=function(){return this.$isEmpty||this.anchor.row==this.lead.row&&this.anchor.column==this.lead.column},this.isMultiLine=function(){return!this.$isEmpty&&this.anchor.row!=this.cursor.row},this.getCursor=function(){return this.lead.getPosition()},this.setSelectionAnchor=function(e,t){this.$isEmpty=!1,this.anchor.setPosition(e,t)},this.getAnchor=this.getSelectionAnchor=function(){return this.$isEmpty?this.getSelectionLead():this.anchor.getPosition()},this.getSelectionLead=function(){return this.lead.getPosition()},this.isBackwards=function(){var e=this.anchor,t=this.lead;return e.row>t.row||e.row==t.row&&e.column>t.column},this.getRange=function(){var e=this.anchor,t=this.lead;return this.$isEmpty?s.fromPoints(t,t):this.isBackwards()?s.fromPoints(t,e):s.fromPoints(e,t)},this.clearSelection=function(){this.$isEmpty||(this.$isEmpty=!0,this._emit("changeSelection"))},this.selectAll=function(){this.$setSelection(0,0,Number.MAX_VALUE,Number.MAX_VALUE)},this.setRange=this.setSelectionRange=function(e,t){var n=t?e.end:e.start,i=t?e.start:e.end;this.$setSelection(n.row,n.column,i.row,i.column)},this.$setSelection=function(e,t,n,i){if(!this.$silent){var r=this.$isEmpty,o=this.inMultiSelectMode;this.$silent=!0,this.$cursorChanged=this.$anchorChanged=!1,this.anchor.setPosition(e,t),this.cursor.setPosition(n,i),this.$isEmpty=!s.comparePoints(this.anchor,this.cursor),this.$silent=!1,this.$cursorChanged&&this._emit("changeCursor"),(this.$cursorChanged||this.$anchorChanged||r!=this.$isEmpty||o)&&this._emit("changeSelection")}},this.$moveSelection=function(e){var t=this.lead;this.$isEmpty&&this.setSelectionAnchor(t.row,t.column),e.call(this)},this.selectTo=function(e,t){this.$moveSelection((function(){this.moveCursorTo(e,t)}))},this.selectToPosition=function(e){this.$moveSelection((function(){this.moveCursorToPosition(e)}))},this.moveTo=function(e,t){this.clearSelection(),this.moveCursorTo(e,t)},this.moveToPosition=function(e){this.clearSelection(),this.moveCursorToPosition(e)},this.selectUp=function(){this.$moveSelection(this.moveCursorUp)},this.selectDown=function(){this.$moveSelection(this.moveCursorDown)},this.selectRight=function(){this.$moveSelection(this.moveCursorRight)},this.selectLeft=function(){this.$moveSelection(this.moveCursorLeft)},this.selectLineStart=function(){this.$moveSelection(this.moveCursorLineStart)},this.selectLineEnd=function(){this.$moveSelection(this.moveCursorLineEnd)},this.selectFileEnd=function(){this.$moveSelection(this.moveCursorFileEnd)},this.selectFileStart=function(){this.$moveSelection(this.moveCursorFileStart)},this.selectWordRight=function(){this.$moveSelection(this.moveCursorWordRight)},this.selectWordLeft=function(){this.$moveSelection(this.moveCursorWordLeft)},this.getWordRange=function(e,t){if(void 0===t){var n=e||this.lead;e=n.row,t=n.column}return this.session.getWordRange(e,t)},this.selectWord=function(){this.setSelectionRange(this.getWordRange())},this.selectAWord=function(){var e=this.getCursor(),t=this.session.getAWordRange(e.row,e.column);this.setSelectionRange(t)},this.getLineRange=function(e,t){var n,i="number"==typeof e?e:this.lead.row,r=this.session.getFoldLine(i);return r?(i=r.start.row,n=r.end.row):n=i,!0===t?new s(i,0,n,this.session.getLine(n).length):new s(i,0,n+1,0)},this.selectLine=function(){this.setSelectionRange(this.getLineRange())},this.moveCursorUp=function(){this.moveCursorBy(-1,0)},this.moveCursorDown=function(){this.moveCursorBy(1,0)},this.wouldMoveIntoSoftTab=function(e,t,n){var i=e.column,r=e.column+t;return n<0&&(i=e.column-t,r=e.column),this.session.isTabStop(e)&&this.doc.getLine(e.row).slice(i,r).split(" ").length-1==t},this.moveCursorLeft=function(){var e,t=this.lead.getPosition();if(e=this.session.getFoldAt(t.row,t.column,-1))this.moveCursorTo(e.start.row,e.start.column);else if(0===t.column)t.row>0&&this.moveCursorTo(t.row-1,this.doc.getLine(t.row-1).length);else{var n=this.session.getTabSize();this.wouldMoveIntoSoftTab(t,n,-1)&&!this.session.getNavigateWithinSoftTabs()?this.moveCursorBy(0,-n):this.moveCursorBy(0,-1)}},this.moveCursorRight=function(){var e,t=this.lead.getPosition();if(e=this.session.getFoldAt(t.row,t.column,1))this.moveCursorTo(e.end.row,e.end.column);else if(this.lead.column==this.doc.getLine(this.lead.row).length)this.lead.row<this.doc.getLength()-1&&this.moveCursorTo(this.lead.row+1,0);else{var n=this.session.getTabSize();t=this.lead;this.wouldMoveIntoSoftTab(t,n,1)&&!this.session.getNavigateWithinSoftTabs()?this.moveCursorBy(0,n):this.moveCursorBy(0,1)}},this.moveCursorLineStart=function(){var e=this.lead.row,t=this.lead.column,n=this.session.documentToScreenRow(e,t),i=this.session.screenToDocumentPosition(n,0),r=this.session.getDisplayLine(e,null,i.row,i.column).match(/^\s*/);r[0].length==t||this.session.$useEmacsStyleLineStart||(i.column+=r[0].length),this.moveCursorToPosition(i)},this.moveCursorLineEnd=function(){var e=this.lead,t=this.session.getDocumentLastRowColumnPosition(e.row,e.column);if(this.lead.column==t.column){var n=this.session.getLine(t.row);if(t.column==n.length){var i=n.search(/\s+$/);i>0&&(t.column=i)}}this.moveCursorTo(t.row,t.column)},this.moveCursorFileEnd=function(){var e=this.doc.getLength()-1,t=this.doc.getLine(e).length;this.moveCursorTo(e,t)},this.moveCursorFileStart=function(){this.moveCursorTo(0,0)},this.moveCursorLongWordRight=function(){var e=this.lead.row,t=this.lead.column,n=this.doc.getLine(e),i=n.substring(t);this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0;var r=this.session.getFoldAt(e,t,1);if(r)this.moveCursorTo(r.end.row,r.end.column);else{if(this.session.nonTokenRe.exec(i)&&(t+=this.session.nonTokenRe.lastIndex,this.session.nonTokenRe.lastIndex=0,i=n.substring(t)),t>=n.length)return this.moveCursorTo(e,n.length),this.moveCursorRight(),void(e<this.doc.getLength()-1&&this.moveCursorWordRight());this.session.tokenRe.exec(i)&&(t+=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),this.moveCursorTo(e,t)}},this.moveCursorLongWordLeft=function(){var e,t=this.lead.row,n=this.lead.column;if(e=this.session.getFoldAt(t,n,-1))this.moveCursorTo(e.start.row,e.start.column);else{var i=this.session.getFoldStringAt(t,n,-1);null==i&&(i=this.doc.getLine(t).substring(0,n));var o=r.stringReverse(i);if(this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0,this.session.nonTokenRe.exec(o)&&(n-=this.session.nonTokenRe.lastIndex,o=o.slice(this.session.nonTokenRe.lastIndex),this.session.nonTokenRe.lastIndex=0),n<=0)return this.moveCursorTo(t,0),this.moveCursorLeft(),void(t>0&&this.moveCursorWordLeft());this.session.tokenRe.exec(o)&&(n-=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),this.moveCursorTo(t,n)}},this.$shortWordEndIndex=function(e){var t,n=0,i=/\s/,r=this.session.tokenRe;if(r.lastIndex=0,this.session.tokenRe.exec(e))n=this.session.tokenRe.lastIndex;else{for(;(t=e[n])&&i.test(t);)n++;if(n<1)for(r.lastIndex=0;(t=e[n])&&!r.test(t);)if(r.lastIndex=0,n++,i.test(t)){if(n>2){n--;break}for(;(t=e[n])&&i.test(t);)n++;if(n>2)break}}return r.lastIndex=0,n},this.moveCursorShortWordRight=function(){var e=this.lead.row,t=this.lead.column,n=this.doc.getLine(e),i=n.substring(t),r=this.session.getFoldAt(e,t,1);if(r)return this.moveCursorTo(r.end.row,r.end.column);if(t==n.length){var o=this.doc.getLength();do{e++,i=this.doc.getLine(e)}while(e<o&&/^\s*$/.test(i));/^\s+/.test(i)||(i=""),t=0}var s=this.$shortWordEndIndex(i);this.moveCursorTo(e,t+s)},this.moveCursorShortWordLeft=function(){var e,t=this.lead.row,n=this.lead.column;if(e=this.session.getFoldAt(t,n,-1))return this.moveCursorTo(e.start.row,e.start.column);var i=this.session.getLine(t).substring(0,n);if(0===n){do{t--,i=this.doc.getLine(t)}while(t>0&&/^\s*$/.test(i));n=i.length,/\s+$/.test(i)||(i="")}var o=r.stringReverse(i),s=this.$shortWordEndIndex(o);return this.moveCursorTo(t,n-s)},this.moveCursorWordRight=function(){this.session.$selectLongWords?this.moveCursorLongWordRight():this.moveCursorShortWordRight()},this.moveCursorWordLeft=function(){this.session.$selectLongWords?this.moveCursorLongWordLeft():this.moveCursorShortWordLeft()},this.moveCursorBy=function(e,t){var n,i=this.session.documentToScreenPosition(this.lead.row,this.lead.column);if(0===t&&(0!==e&&(this.session.$bidiHandler.isBidiRow(i.row,this.lead.row)?(n=this.session.$bidiHandler.getPosLeft(i.column),i.column=Math.round(n/this.session.$bidiHandler.charWidths[0])):n=i.column*this.session.$bidiHandler.charWidths[0]),this.$desiredColumn?i.column=this.$desiredColumn:this.$desiredColumn=i.column),0!=e&&this.session.lineWidgets&&this.session.lineWidgets[this.lead.row]){var r=this.session.lineWidgets[this.lead.row];e<0?e-=r.rowsAbove||0:e>0&&(e+=r.rowCount-(r.rowsAbove||0))}var o=this.session.screenToDocumentPosition(i.row+e,i.column,n);0!==e&&0===t&&o.row===this.lead.row&&(o.column,this.lead.column),this.moveCursorTo(o.row,o.column+t,0===t)},this.moveCursorToPosition=function(e){this.moveCursorTo(e.row,e.column)},this.moveCursorTo=function(e,t,n){var i=this.session.getFoldAt(e,t,1);i&&(e=i.start.row,t=i.start.column),this.$keepDesiredColumnOnChange=!0;var r=this.session.getLine(e);/[\uDC00-\uDFFF]/.test(r.charAt(t))&&r.charAt(t-1)&&(this.lead.row==e&&this.lead.column==t+1?t-=1:t+=1),this.lead.setPosition(e,t),this.$keepDesiredColumnOnChange=!1,n||(this.$desiredColumn=null)},this.moveCursorToScreen=function(e,t,n){var i=this.session.screenToDocumentPosition(e,t);this.moveCursorTo(i.row,i.column,n)},this.detach=function(){this.lead.detach(),this.anchor.detach(),this.session=this.doc=null},this.fromOrientedRange=function(e){this.setSelectionRange(e,e.cursor==e.start),this.$desiredColumn=e.desiredColumn||this.$desiredColumn},this.toOrientedRange=function(e){var t=this.getRange();return e?(e.start.column=t.start.column,e.start.row=t.start.row,e.end.column=t.end.column,e.end.row=t.end.row):e=t,e.cursor=this.isBackwards()?e.start:e.end,e.desiredColumn=this.$desiredColumn,e},this.getRangeOfMovements=function(e){var t=this.getCursor();try{e(this);var n=this.getCursor();return s.fromPoints(t,n)}catch(e){return s.fromPoints(t,t)}finally{this.moveCursorToPosition(t)}},this.toJSON=function(){if(this.rangeCount)var e=this.ranges.map((function(e){var t=e.clone();return t.isBackwards=e.cursor==e.start,t}));else(e=this.getRange()).isBackwards=this.isBackwards();return e},this.fromJSON=function(e){if(null==e.start){if(this.rangeList&&e.length>1){this.toSingleRange(e[0]);for(var t=e.length;t--;){var n=s.fromPoints(e[t].start,e[t].end);e[t].isBackwards&&(n.cursor=n.start),this.addRange(n,!0)}return}e=e[0]}this.rangeList&&this.toSingleRange(e),this.setSelectionRange(e,e.isBackwards)},this.isEqual=function(e){if((e.length||this.rangeCount)&&e.length!=this.rangeCount)return!1;if(!e.length||!this.ranges)return this.getRange().isEqual(e);for(var t=this.ranges.length;t--;)if(!this.ranges[t].isEqual(e[t]))return!1;return!0}}).call(a.prototype),t.Selection=a})),ace.define("ace/tokenizer",["require","exports","module","ace/config"],(function(e,t,n){"use strict";var i=e("./config"),r=2e3,o=function(e){for(var t in this.states=e,this.regExps={},this.matchMappings={},this.states){for(var n=this.states[t],i=[],r=0,o=this.matchMappings[t]={defaultToken:"text"},s="g",a=[],l=0;l<n.length;l++){var c=n[l];if(c.defaultToken&&(o.defaultToken=c.defaultToken),c.caseInsensitive&&(s="gi"),null!=c.regex){c.regex instanceof RegExp&&(c.regex=c.regex.toString().slice(1,-1));var u=c.regex,h=new RegExp("(?:("+u+")|(.))").exec("a").length-2;Array.isArray(c.token)?1==c.token.length||1==h?c.token=c.token[0]:h-1!=c.token.length?(this.reportError("number of classes and regexp groups doesn't match",{rule:c,groupCount:h-1}),c.token=c.token[0]):(c.tokenArray=c.token,c.token=null,c.onMatch=this.$arrayTokens):"function"!=typeof c.token||c.onMatch||(c.onMatch=h>1?this.$applyToken:c.token),h>1&&(/\\\d/.test(c.regex)?u=c.regex.replace(/\\([0-9]+)/g,(function(e,t){return"\\"+(parseInt(t,10)+r+1)})):(h=1,u=this.removeCapturingGroups(c.regex)),c.splitRegex||"string"==typeof c.token||a.push(c)),o[r]=l,r+=h,i.push(u),c.onMatch||(c.onMatch=null)}}i.length||(o[0]=0,i.push("$")),a.forEach((function(e){e.splitRegex=this.createSplitterRegexp(e.regex,s)}),this),this.regExps[t]=new RegExp("("+i.join(")|(")+")|($)",s)}};(function(){this.$setMaxTokenCount=function(e){r=0|e},this.$applyToken=function(e){var t=this.splitRegex.exec(e).slice(1),n=this.token.apply(this,t);if("string"==typeof n)return[{type:n,value:e}];for(var i=[],r=0,o=n.length;r<o;r++)t[r]&&(i[i.length]={type:n[r],value:t[r]});return i},this.$arrayTokens=function(e){if(!e)return[];var t=this.splitRegex.exec(e);if(!t)return"text";for(var n=[],i=this.tokenArray,r=0,o=i.length;r<o;r++)t[r+1]&&(n[n.length]={type:i[r],value:t[r+1]});return n},this.removeCapturingGroups=function(e){return e.replace(/\\.|\[(?:\\.|[^\\\]])*|\(\?[:=!]|(\()/g,(function(e,t){return t?"(?:":e}))},this.createSplitterRegexp=function(e,t){if(-1!=e.indexOf("(?=")){var n=0,i=!1,r={};e.replace(/(\\.)|(\((?:\?[=!])?)|(\))|([\[\]])/g,(function(e,t,o,s,a,l){return i?i="]"!=a:a?i=!0:s?(n==r.stack&&(r.end=l+1,r.stack=-1),n--):o&&(n++,1!=o.length&&(r.stack=n,r.start=l)),e})),null!=r.end&&/^\)*$/.test(e.substr(r.end))&&(e=e.substring(0,r.start)+e.substr(r.end))}return"^"!=e.charAt(0)&&(e="^"+e),"$"!=e.charAt(e.length-1)&&(e+="$"),new RegExp(e,(t||"").replace("g",""))},this.getLineTokens=function(e,t){if(t&&"string"!=typeof t){var n=t.slice(0);"#tmp"===(t=n[0])&&(n.shift(),t=n.shift())}else n=[];var i=t||"start",o=this.states[i];o||(i="start",o=this.states[i]);var s=this.matchMappings[i],a=this.regExps[i];a.lastIndex=0;for(var l,c=[],u=0,h=0,d={type:null,value:""};l=a.exec(e);){var f=s.defaultToken,p=null,g=l[0],m=a.lastIndex;if(m-g.length>u){var v=e.substring(u,m-g.length);d.type==f?d.value+=v:(d.type&&c.push(d),d={type:f,value:v})}for(var b=0;b<l.length-2;b++)if(void 0!==l[b+1]){f=(p=o[s[b]]).onMatch?p.onMatch(g,i,n,e):p.token,p.next&&(i="string"==typeof p.next?p.next:p.next(i,n),(o=this.states[i])||(this.reportError("state doesn't exist",i),i="start",o=this.states[i]),s=this.matchMappings[i],u=m,(a=this.regExps[i]).lastIndex=m),p.consumeLineEnd&&(u=m);break}if(g)if("string"==typeof f)p&&!1===p.merge||d.type!==f?(d.type&&c.push(d),d={type:f,value:g}):d.value+=g;else if(f){d.type&&c.push(d),d={type:null,value:""};for(b=0;b<f.length;b++)c.push(f[b])}if(u==e.length)break;if(u=m,h++>r){for(h>2*e.length&&this.reportError("infinite loop with in ace tokenizer",{startState:t,line:e});u<e.length;)d.type&&c.push(d),d={value:e.substring(u,u+=500),type:"overflow"};i="start",n=[];break}}return d.type&&c.push(d),n.length>1&&n[0]!==i&&n.unshift("#tmp",i),{tokens:c,state:n.length?n:i}},this.reportError=i.reportError}).call(o.prototype),t.Tokenizer=o})),ace.define("ace/mode/text_highlight_rules",["require","exports","module","ace/lib/lang"],(function(e,t,n){"use strict";var i=e("../lib/lang"),r=function(){this.$rules={start:[{token:"empty_line",regex:"^$"},{defaultToken:"text"}]}};(function(){this.addRules=function(e,t){if(t)for(var n in e){for(var i=e[n],r=0;r<i.length;r++){var o=i[r];(o.next||o.onMatch)&&("string"==typeof o.next&&0!==o.next.indexOf(t)&&(o.next=t+o.next),o.nextState&&0!==o.nextState.indexOf(t)&&(o.nextState=t+o.nextState))}this.$rules[t+n]=i}else for(var n in e)this.$rules[n]=e[n]},this.getRules=function(){return this.$rules},this.embedRules=function(e,t,n,r,o){var s="function"==typeof e?(new e).getRules():e;if(r)for(var a=0;a<r.length;a++)r[a]=t+r[a];else for(var l in r=[],s)r.push(t+l);if(this.addRules(s,t),n){var c=Array.prototype[o?"push":"unshift"];for(a=0;a<r.length;a++)c.apply(this.$rules[r[a]],i.deepCopy(n))}this.$embeds||(this.$embeds=[]),this.$embeds.push(t)},this.getEmbeds=function(){return this.$embeds};var e=function(e,t){return("start"!=e||t.length)&&t.unshift(this.nextState,e),this.nextState},t=function(e,t){return t.shift(),t.shift()||"start"};this.normalizeRules=function(){var n=0,i=this.$rules;Object.keys(i).forEach((function r(o){var s=i[o];s.processed=!0;for(var a=0;a<s.length;a++){var l=s[a],c=null;Array.isArray(l)&&(c=l,l={}),!l.regex&&l.start&&(l.regex=l.start,l.next||(l.next=[]),l.next.push({defaultToken:l.token},{token:l.token+".end",regex:l.end||l.start,next:"pop"}),l.token=l.token+".start",l.push=!0);var u=l.next||l.push;if(u&&Array.isArray(u)){var h=l.stateName;h||("string"!=typeof(h=l.token)&&(h=h[0]||""),i[h]&&(h+=n++)),i[h]=u,l.next=h,r(h)}else"pop"==u&&(l.next=t);if(l.push&&(l.nextState=l.next||l.push,l.next=e,delete l.push),l.rules)for(var d in l.rules)i[d]?i[d].push&&i[d].push.apply(i[d],l.rules[d]):i[d]=l.rules[d];var f="string"==typeof l?l:l.include;if(f&&(c=Array.isArray(f)?f.map((function(e){return i[e]})):i[f]),c){var p=[a,1].concat(c);l.noEscape&&(p=p.filter((function(e){return!e.next}))),s.splice.apply(s,p),a--}l.keywordMap&&(l.token=this.createKeywordMapper(l.keywordMap,l.defaultToken||"text",l.caseInsensitive),delete l.defaultToken)}}),this)},this.createKeywordMapper=function(e,t,n,i){var r=Object.create(null);return this.$keywordList=[],Object.keys(e).forEach((function(t){for(var o=e[t].split(i||"|"),s=o.length;s--;){var a=o[s];this.$keywordList.push(a),n&&(a=a.toLowerCase()),r[a]=t}}),this),e=null,n?function(e){return r[e.toLowerCase()]||t}:function(e){return r[e]||t}},this.getKeywords=function(){return this.$keywords}}).call(r.prototype),t.TextHighlightRules=r})),ace.define("ace/mode/behaviour",["require","exports","module"],(function(e,t,n){"use strict";var i=function(){this.$behaviours={}};(function(){this.add=function(e,t,n){switch(void 0){case this.$behaviours:this.$behaviours={};case this.$behaviours[e]:this.$behaviours[e]={}}this.$behaviours[e][t]=n},this.addBehaviours=function(e){for(var t in e)for(var n in e[t])this.add(t,n,e[t][n])},this.remove=function(e){this.$behaviours&&this.$behaviours[e]&&delete this.$behaviours[e]},this.inherit=function(e,t){if("function"==typeof e)var n=(new e).getBehaviours(t);else n=e.getBehaviours(t);this.addBehaviours(n)},this.getBehaviours=function(e){if(e){for(var t={},n=0;n<e.length;n++)this.$behaviours[e[n]]&&(t[e[n]]=this.$behaviours[e[n]]);return t}return this.$behaviours}}).call(i.prototype),t.Behaviour=i})),ace.define("ace/token_iterator",["require","exports","module","ace/range"],(function(e,t,n){"use strict";var i=e("./range").Range,r=function(e,t,n){this.$session=e,this.$row=t,this.$rowTokens=e.getTokens(t);var i=e.getTokenAt(t,n);this.$tokenIndex=i?i.index:-1};(function(){this.stepBackward=function(){for(this.$tokenIndex-=1;this.$tokenIndex<0;){if(this.$row-=1,this.$row<0)return this.$row=0,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=this.$rowTokens.length-1}return this.$rowTokens[this.$tokenIndex]},this.stepForward=function(){var e;for(this.$tokenIndex+=1;this.$tokenIndex>=this.$rowTokens.length;){if(this.$row+=1,e||(e=this.$session.getLength()),this.$row>=e)return this.$row=e-1,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=0}return this.$rowTokens[this.$tokenIndex]},this.getCurrentToken=function(){return this.$rowTokens[this.$tokenIndex]},this.getCurrentTokenRow=function(){return this.$row},this.getCurrentTokenColumn=function(){var e=this.$rowTokens,t=this.$tokenIndex,n=e[t].start;if(void 0!==n)return n;for(n=0;t>0;)n+=e[t-=1].value.length;return n},this.getCurrentTokenPosition=function(){return{row:this.$row,column:this.getCurrentTokenColumn()}},this.getCurrentTokenRange=function(){var e=this.$rowTokens[this.$tokenIndex],t=this.getCurrentTokenColumn();return new i(this.$row,t,this.$row,t+e.value.length)}}).call(r.prototype),t.TokenIterator=r})),ace.define("ace/mode/behaviour/cstyle",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/token_iterator","ace/lib/lang"],(function(e,t,n){"use strict";var i,r=e("../../lib/oop"),o=e("../behaviour").Behaviour,s=e("../../token_iterator").TokenIterator,a=e("../../lib/lang"),l=["text","paren.rparen","rparen","paren","punctuation.operator"],c=["text","paren.rparen","rparen","paren","punctuation.operator","comment"],u={},h={'"':'"',"'":"'"},d=function(e){var t=-1;if(e.multiSelect&&(t=e.selection.index,u.rangeCount!=e.multiSelect.rangeCount&&(u={rangeCount:e.multiSelect.rangeCount})),u[t])return i=u[t];i=u[t]={autoInsertedBrackets:0,autoInsertedRow:-1,autoInsertedLineEnd:"",maybeInsertedBrackets:0,maybeInsertedRow:-1,maybeInsertedLineStart:"",maybeInsertedLineEnd:""}},f=function(e,t,n,i){var r=e.end.row-e.start.row;return{text:n+t+i,selection:[0,e.start.column+1,r,e.end.column+(r?0:1)]}},p=function(e){this.add("braces","insertion",(function(t,n,r,o,s){var l=r.getCursorPosition(),c=o.doc.getLine(l.row);if("{"==s){d(r);var u=r.getSelectionRange(),h=o.doc.getTextRange(u);if(""!==h&&"{"!==h&&r.getWrapBehavioursEnabled())return f(u,h,"{","}");if(p.isSaneInsertion(r,o))return/[\]\}\)]/.test(c[l.column])||r.inMultiSelectMode||e&&e.braces?(p.recordAutoInsert(r,o,"}"),{text:"{}",selection:[1,1]}):(p.recordMaybeInsert(r,o,"{"),{text:"{",selection:[1,1]})}else if("}"==s){if(d(r),"}"==c.substring(l.column,l.column+1))if(null!==o.$findOpeningBracket("}",{column:l.column+1,row:l.row})&&p.isAutoInsertedClosing(l,c,s))return p.popAutoInsertedClosing(),{text:"",selection:[1,1]}}else{if("\n"==s||"\r\n"==s){d(r);var g="";if(p.isMaybeInsertedClosing(l,c)&&(g=a.stringRepeat("}",i.maybeInsertedBrackets),p.clearMaybeInsertedClosing()),"}"===c.substring(l.column,l.column+1)){var m=o.findMatchingBracket({row:l.row,column:l.column+1},"}");if(!m)return null;var v=this.$getIndent(o.getLine(m.row))}else{if(!g)return void p.clearMaybeInsertedClosing();v=this.$getIndent(c)}var b=v+o.getTabString();return{text:"\n"+b+"\n"+v+g,selection:[1,b.length,1,b.length]}}p.clearMaybeInsertedClosing()}})),this.add("braces","deletion",(function(e,t,n,r,o){var s=r.doc.getTextRange(o);if(!o.isMultiLine()&&"{"==s){if(d(n),"}"==r.doc.getLine(o.start.row).substring(o.end.column,o.end.column+1))return o.end.column++,o;i.maybeInsertedBrackets--}})),this.add("parens","insertion",(function(e,t,n,i,r){if("("==r){d(n);var o=n.getSelectionRange(),s=i.doc.getTextRange(o);if(""!==s&&n.getWrapBehavioursEnabled())return f(o,s,"(",")");if(p.isSaneInsertion(n,i))return p.recordAutoInsert(n,i,")"),{text:"()",selection:[1,1]}}else if(")"==r){d(n);var a=n.getCursorPosition(),l=i.doc.getLine(a.row);if(")"==l.substring(a.column,a.column+1))if(null!==i.$findOpeningBracket(")",{column:a.column+1,row:a.row})&&p.isAutoInsertedClosing(a,l,r))return p.popAutoInsertedClosing(),{text:"",selection:[1,1]}}})),this.add("parens","deletion",(function(e,t,n,i,r){var o=i.doc.getTextRange(r);if(!r.isMultiLine()&&"("==o&&(d(n),")"==i.doc.getLine(r.start.row).substring(r.start.column+1,r.start.column+2)))return r.end.column++,r})),this.add("brackets","insertion",(function(e,t,n,i,r){if("["==r){d(n);var o=n.getSelectionRange(),s=i.doc.getTextRange(o);if(""!==s&&n.getWrapBehavioursEnabled())return f(o,s,"[","]");if(p.isSaneInsertion(n,i))return p.recordAutoInsert(n,i,"]"),{text:"[]",selection:[1,1]}}else if("]"==r){d(n);var a=n.getCursorPosition(),l=i.doc.getLine(a.row);if("]"==l.substring(a.column,a.column+1))if(null!==i.$findOpeningBracket("]",{column:a.column+1,row:a.row})&&p.isAutoInsertedClosing(a,l,r))return p.popAutoInsertedClosing(),{text:"",selection:[1,1]}}})),this.add("brackets","deletion",(function(e,t,n,i,r){var o=i.doc.getTextRange(r);if(!r.isMultiLine()&&"["==o&&(d(n),"]"==i.doc.getLine(r.start.row).substring(r.start.column+1,r.start.column+2)))return r.end.column++,r})),this.add("string_dquotes","insertion",(function(e,t,n,i,r){var o=i.$mode.$quotes||h;if(1==r.length&&o[r]){if(this.lineCommentStart&&-1!=this.lineCommentStart.indexOf(r))return;d(n);var s=r,a=n.getSelectionRange(),l=i.doc.getTextRange(a);if(!(""===l||1==l.length&&o[l])&&n.getWrapBehavioursEnabled())return f(a,l,s,s);if(!l){var c=n.getCursorPosition(),u=i.doc.getLine(c.row),p=u.substring(c.column-1,c.column),g=u.substring(c.column,c.column+1),m=i.getTokenAt(c.row,c.column),v=i.getTokenAt(c.row,c.column+1);if("\\"==p&&m&&/escape/.test(m.type))return null;var b,y=m&&/string|escape/.test(m.type),w=!v||/string|escape/.test(v.type);if(g==s)(b=y!==w)&&/string\.end/.test(v.type)&&(b=!1);else{if(y&&!w)return null;if(y&&w)return null;var x=i.$mode.tokenRe;x.lastIndex=0;var _=x.test(p);x.lastIndex=0;var k=x.test(p);if(_||k)return null;if(g&&!/[\s;,.})\]\\]/.test(g))return null;var S=u[c.column-2];if(p==s&&(S==s||x.test(S)))return null;b=!0}return{text:b?s+s:"",selection:[1,1]}}}})),this.add("string_dquotes","deletion",(function(e,t,n,i,r){var o=i.$mode.$quotes||h,s=i.doc.getTextRange(r);if(!r.isMultiLine()&&o.hasOwnProperty(s)&&(d(n),i.doc.getLine(r.start.row).substring(r.start.column+1,r.start.column+2)==s))return r.end.column++,r}))};p.isSaneInsertion=function(e,t){var n=e.getCursorPosition(),i=new s(t,n.row,n.column);if(!this.$matchTokenType(i.getCurrentToken()||"text",l)){if(/[)}\]]/.test(e.session.getLine(n.row)[n.column]))return!0;var r=new s(t,n.row,n.column+1);if(!this.$matchTokenType(r.getCurrentToken()||"text",l))return!1}return i.stepForward(),i.getCurrentTokenRow()!==n.row||this.$matchTokenType(i.getCurrentToken()||"text",c)},p.$matchTokenType=function(e,t){return t.indexOf(e.type||e)>-1},p.recordAutoInsert=function(e,t,n){var r=e.getCursorPosition(),o=t.doc.getLine(r.row);this.isAutoInsertedClosing(r,o,i.autoInsertedLineEnd[0])||(i.autoInsertedBrackets=0),i.autoInsertedRow=r.row,i.autoInsertedLineEnd=n+o.substr(r.column),i.autoInsertedBrackets++},p.recordMaybeInsert=function(e,t,n){var r=e.getCursorPosition(),o=t.doc.getLine(r.row);this.isMaybeInsertedClosing(r,o)||(i.maybeInsertedBrackets=0),i.maybeInsertedRow=r.row,i.maybeInsertedLineStart=o.substr(0,r.column)+n,i.maybeInsertedLineEnd=o.substr(r.column),i.maybeInsertedBrackets++},p.isAutoInsertedClosing=function(e,t,n){return i.autoInsertedBrackets>0&&e.row===i.autoInsertedRow&&n===i.autoInsertedLineEnd[0]&&t.substr(e.column)===i.autoInsertedLineEnd},p.isMaybeInsertedClosing=function(e,t){return i.maybeInsertedBrackets>0&&e.row===i.maybeInsertedRow&&t.substr(e.column)===i.maybeInsertedLineEnd&&t.substr(0,e.column)==i.maybeInsertedLineStart},p.popAutoInsertedClosing=function(){i.autoInsertedLineEnd=i.autoInsertedLineEnd.substr(1),i.autoInsertedBrackets--},p.clearMaybeInsertedClosing=function(){i&&(i.maybeInsertedBrackets=0,i.maybeInsertedRow=-1)},r.inherits(p,o),t.CstyleBehaviour=p})),ace.define("ace/unicode",["require","exports","module"],(function(e,t,n){"use strict";for(var i=[48,9,8,25,5,0,2,25,48,0,11,0,5,0,6,22,2,30,2,457,5,11,15,4,8,0,2,0,18,116,2,1,3,3,9,0,2,2,2,0,2,19,2,82,2,138,2,4,3,155,12,37,3,0,8,38,10,44,2,0,2,1,2,1,2,0,9,26,6,2,30,10,7,61,2,9,5,101,2,7,3,9,2,18,3,0,17,58,3,100,15,53,5,0,6,45,211,57,3,18,2,5,3,11,3,9,2,1,7,6,2,2,2,7,3,1,3,21,2,6,2,0,4,3,3,8,3,1,3,3,9,0,5,1,2,4,3,11,16,2,2,5,5,1,3,21,2,6,2,1,2,1,2,1,3,0,2,4,5,1,3,2,4,0,8,3,2,0,8,15,12,2,2,8,2,2,2,21,2,6,2,1,2,4,3,9,2,2,2,2,3,0,16,3,3,9,18,2,2,7,3,1,3,21,2,6,2,1,2,4,3,8,3,1,3,2,9,1,5,1,2,4,3,9,2,0,17,1,2,5,4,2,2,3,4,1,2,0,2,1,4,1,4,2,4,11,5,4,4,2,2,3,3,0,7,0,15,9,18,2,2,7,2,2,2,22,2,9,2,4,4,7,2,2,2,3,8,1,2,1,7,3,3,9,19,1,2,7,2,2,2,22,2,9,2,4,3,8,2,2,2,3,8,1,8,0,2,3,3,9,19,1,2,7,2,2,2,22,2,15,4,7,2,2,2,3,10,0,9,3,3,9,11,5,3,1,2,17,4,23,2,8,2,0,3,6,4,0,5,5,2,0,2,7,19,1,14,57,6,14,2,9,40,1,2,0,3,1,2,0,3,0,7,3,2,6,2,2,2,0,2,0,3,1,2,12,2,2,3,4,2,0,2,5,3,9,3,1,35,0,24,1,7,9,12,0,2,0,2,0,5,9,2,35,5,19,2,5,5,7,2,35,10,0,58,73,7,77,3,37,11,42,2,0,4,328,2,3,3,6,2,0,2,3,3,40,2,3,3,32,2,3,3,6,2,0,2,3,3,14,2,56,2,3,3,66,5,0,33,15,17,84,13,619,3,16,2,25,6,74,22,12,2,6,12,20,12,19,13,12,2,2,2,1,13,51,3,29,4,0,5,1,3,9,34,2,3,9,7,87,9,42,6,69,11,28,4,11,5,11,11,39,3,4,12,43,5,25,7,10,38,27,5,62,2,28,3,10,7,9,14,0,89,75,5,9,18,8,13,42,4,11,71,55,9,9,4,48,83,2,2,30,14,230,23,280,3,5,3,37,3,5,3,7,2,0,2,0,2,0,2,30,3,52,2,6,2,0,4,2,2,6,4,3,3,5,5,12,6,2,2,6,67,1,20,0,29,0,14,0,17,4,60,12,5,0,4,11,18,0,5,0,3,9,2,0,4,4,7,0,2,0,2,0,2,3,2,10,3,3,6,4,5,0,53,1,2684,46,2,46,2,132,7,6,15,37,11,53,10,0,17,22,10,6,2,6,2,6,2,6,2,6,2,6,2,6,2,6,2,31,48,0,470,1,36,5,2,4,6,1,5,85,3,1,3,2,2,89,2,3,6,40,4,93,18,23,57,15,513,6581,75,20939,53,1164,68,45,3,268,4,27,21,31,3,13,13,1,2,24,9,69,11,1,38,8,3,102,3,1,111,44,25,51,13,68,12,9,7,23,4,0,5,45,3,35,13,28,4,64,15,10,39,54,10,13,3,9,7,22,4,1,5,66,25,2,227,42,2,1,3,9,7,11171,13,22,5,48,8453,301,3,61,3,105,39,6,13,4,6,11,2,12,2,4,2,0,2,1,2,1,2,107,34,362,19,63,3,53,41,11,5,15,17,6,13,1,25,2,33,4,2,134,20,9,8,25,5,0,2,25,12,88,4,5,3,5,3,5,3,2],r=0,o=[],s=0;s<i.length;s+=2)o.push(r+=i[s]),i[s+1]&&o.push(45,r+=i[s+1]);t.wordChars=String.fromCharCode.apply(null,o)})),ace.define("ace/mode/text",["require","exports","module","ace/config","ace/tokenizer","ace/mode/text_highlight_rules","ace/mode/behaviour/cstyle","ace/unicode","ace/lib/lang","ace/token_iterator","ace/range"],(function(e,t,n){"use strict";var i=e("../config"),r=e("../tokenizer").Tokenizer,o=e("./text_highlight_rules").TextHighlightRules,s=e("./behaviour/cstyle").CstyleBehaviour,a=e("../unicode"),l=e("../lib/lang"),c=e("../token_iterator").TokenIterator,u=e("../range").Range,h=function(){this.HighlightRules=o};(function(){this.$defaultBehaviour=new s,this.tokenRe=new RegExp("^["+a.wordChars+"\\$_]+","g"),this.nonTokenRe=new RegExp("^(?:[^"+a.wordChars+"\\$_]|\\s])+","g"),this.getTokenizer=function(){return this.$tokenizer||(this.$highlightRules=this.$highlightRules||new this.HighlightRules(this.$highlightRuleConfig),this.$tokenizer=new r(this.$highlightRules.getRules())),this.$tokenizer},this.lineCommentStart="",this.blockComment="",this.toggleCommentLines=function(e,t,n,i){var r=t.doc,o=!0,s=!0,a=1/0,c=t.getTabSize(),u=!1;if(this.lineCommentStart){if(Array.isArray(this.lineCommentStart))g=this.lineCommentStart.map(l.escapeRegExp).join("|"),f=this.lineCommentStart[0];else g=l.escapeRegExp(this.lineCommentStart),f=this.lineCommentStart;g=new RegExp("^(\\s*)(?:"+g+") ?"),u=t.getUseSoftTabs();b=function(e,t){var n=e.match(g);if(n){var i=n[1].length,o=n[0].length;d(e,i,o)||" "!=n[0][o-1]||o--,r.removeInLine(t,i,o)}};var h=f+" ",d=(v=function(e,t){o&&!/\S/.test(e)||(d(e,a,a)?r.insertInLine({row:t,column:a},h):r.insertInLine({row:t,column:a},f))},y=function(e,t){return g.test(e)},function(e,t,n){for(var i=0;t--&&" "==e.charAt(t);)i++;if(i%c!=0)return!1;for(i=0;" "==e.charAt(n++);)i++;return c>2?i%c!=c-1:i%c==0})}else{if(!this.blockComment)return!1;var f=this.blockComment.start,p=this.blockComment.end,g=new RegExp("^(\\s*)(?:"+l.escapeRegExp(f)+")"),m=new RegExp("(?:"+l.escapeRegExp(p)+")\\s*$"),v=function(e,t){y(e,t)||o&&!/\S/.test(e)||(r.insertInLine({row:t,column:e.length},p),r.insertInLine({row:t,column:a},f))},b=function(e,t){var n;(n=e.match(m))&&r.removeInLine(t,e.length-n[0].length,e.length),(n=e.match(g))&&r.removeInLine(t,n[1].length,n[0].length)},y=function(e,n){if(g.test(e))return!0;for(var i=t.getTokens(n),r=0;r<i.length;r++)if("comment"===i[r].type)return!0}}function w(e){for(var t=n;t<=i;t++)e(r.getLine(t),t)}var x=1/0;w((function(e,t){var n=e.search(/\S/);-1!==n?(n<a&&(a=n),s&&!y(e,t)&&(s=!1)):x>e.length&&(x=e.length)})),a==1/0&&(a=x,o=!1,s=!1),u&&a%c!=0&&(a=Math.floor(a/c)*c),w(s?b:v)},this.toggleBlockComment=function(e,t,n,i){var r=this.blockComment;if(r){!r.start&&r[0]&&(r=r[0]);var o,s,a=(g=new c(t,i.row,i.column)).getCurrentToken(),l=(t.selection,t.selection.toOrientedRange());if(a&&/comment/.test(a.type)){for(var h,d;a&&/comment/.test(a.type);){if(-1!=(m=a.value.indexOf(r.start))){var f=g.getCurrentTokenRow(),p=g.getCurrentTokenColumn()+m;h=new u(f,p,f,p+r.start.length);break}a=g.stepBackward()}var g;for(a=(g=new c(t,i.row,i.column)).getCurrentToken();a&&/comment/.test(a.type);){var m;if(-1!=(m=a.value.indexOf(r.end))){f=g.getCurrentTokenRow(),p=g.getCurrentTokenColumn()+m;d=new u(f,p,f,p+r.end.length);break}a=g.stepForward()}d&&t.remove(d),h&&(t.remove(h),o=h.start.row,s=-r.start.length)}else s=r.start.length,o=n.start.row,t.insert(n.end,r.end),t.insert(n.start,r.start);l.start.row==o&&(l.start.column+=s),l.end.row==o&&(l.end.column+=s),t.selection.fromOrientedRange(l)}},this.getNextLineIndent=function(e,t,n){return this.$getIndent(t)},this.checkOutdent=function(e,t,n){return!1},this.autoOutdent=function(e,t,n){},this.$getIndent=function(e){return e.match(/^\s*/)[0]},this.createWorker=function(e){return null},this.createModeDelegates=function(e){for(var t in this.$embeds=[],this.$modes={},e)if(e[t]){var n=e[t],r=n.prototype.$id,o=i.$modes[r];o||(i.$modes[r]=o=new n),i.$modes[t]||(i.$modes[t]=o),this.$embeds.push(t),this.$modes[t]=o}var s=["toggleBlockComment","toggleCommentLines","getNextLineIndent","checkOutdent","autoOutdent","transformAction","getCompletions"];for(t=0;t<s.length;t++)!function(e){var n=s[t],i=e[n];e[s[t]]=function(){return this.$delegator(n,arguments,i)}}(this)},this.$delegator=function(e,t,n){var i=t[0]||"start";if("string"!=typeof i){if(Array.isArray(i[2])){var r=i[2][i[2].length-1];if(s=this.$modes[r])return s[e].apply(s,[i[1]].concat([].slice.call(t,1)))}i=i[0]||"start"}for(var o=0;o<this.$embeds.length;o++)if(this.$modes[this.$embeds[o]]){var s,a=i.split(this.$embeds[o]);if(!a[0]&&a[1])return t[0]=a[1],(s=this.$modes[this.$embeds[o]])[e].apply(s,t)}var l=n.apply(this,t);return n?l:void 0},this.transformAction=function(e,t,n,i,r){if(this.$behaviour){var o=this.$behaviour.getBehaviours();for(var s in o)if(o[s][t]){var a=o[s][t].apply(this,arguments);if(a)return a}}},this.getKeywords=function(e){if(!this.completionKeywords){var t=this.$tokenizer.rules,n=[];for(var i in t)for(var r=t[i],o=0,s=r.length;o<s;o++)if("string"==typeof r[o].token)/keyword|support|storage/.test(r[o].token)&&n.push(r[o].regex);else if("object"==typeof r[o].token)for(var a=0,l=r[o].token.length;a<l;a++)if(/keyword|support|storage/.test(r[o].token[a])){i=r[o].regex.match(/\(.+?\)/g)[a];n.push(i.substr(1,i.length-2))}this.completionKeywords=n}return e?n.concat(this.$keywordList||[]):this.$keywordList},this.$createKeywordList=function(){return this.$highlightRules||this.getTokenizer(),this.$keywordList=this.$highlightRules.$keywordList||[]},this.getCompletions=function(e,t,n,i){return(this.$keywordList||this.$createKeywordList()).map((function(e){return{name:e,value:e,score:0,meta:"keyword"}}))},this.$id="ace/mode/text"}).call(h.prototype),t.Mode=h})),ace.define("ace/apply_delta",["require","exports","module"],(function(e,t,n){"use strict";t.applyDelta=function(e,t,n){var i=t.start.row,r=t.start.column,o=e[i]||"";switch(t.action){case"insert":if(1===t.lines.length)e[i]=o.substring(0,r)+t.lines[0]+o.substring(r);else{var s=[i,1].concat(t.lines);e.splice.apply(e,s),e[i]=o.substring(0,r)+e[i],e[i+t.lines.length-1]+=o.substring(r)}break;case"remove":var a=t.end.column,l=t.end.row;i===l?e[i]=o.substring(0,r)+o.substring(a):e.splice(i,l-i+1,o.substring(0,r)+e[l].substring(a))}}})),ace.define("ace/anchor",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],(function(e,t,n){"use strict";var i=e("./lib/oop"),r=e("./lib/event_emitter").EventEmitter,o=t.Anchor=function(e,t,n){this.$onChange=this.onChange.bind(this),this.attach(e),void 0===n?this.setPosition(t.row,t.column):this.setPosition(t,n)};(function(){function e(e,t,n){var i=n?e.column<=t.column:e.column<t.column;return e.row<t.row||e.row==t.row&&i}i.implement(this,r),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.$insertRight=!1,this.onChange=function(t){if(!(t.start.row==t.end.row&&t.start.row!=this.row||t.start.row>this.row)){var n=function(t,n,i){var r="insert"==t.action,o=(r?1:-1)*(t.end.row-t.start.row),s=(r?1:-1)*(t.end.column-t.start.column),a=t.start,l=r?a:t.end;if(e(n,a,i))return{row:n.row,column:n.column};if(e(l,n,!i))return{row:n.row+o,column:n.column+(n.row==l.row?s:0)};return{row:a.row,column:a.column}}(t,{row:this.row,column:this.column},this.$insertRight);this.setPosition(n.row,n.column,!0)}},this.setPosition=function(e,t,n){var i;if(i=n?{row:e,column:t}:this.$clipPositionToDocument(e,t),this.row!=i.row||this.column!=i.column){var r={row:this.row,column:this.column};this.row=i.row,this.column=i.column,this._signal("change",{old:r,value:i})}},this.detach=function(){this.document.off("change",this.$onChange)},this.attach=function(e){this.document=e||this.document,this.document.on("change",this.$onChange)},this.$clipPositionToDocument=function(e,t){var n={};return e>=this.document.getLength()?(n.row=Math.max(0,this.document.getLength()-1),n.column=this.document.getLine(n.row).length):e<0?(n.row=0,n.column=0):(n.row=e,n.column=Math.min(this.document.getLine(n.row).length,Math.max(0,t))),t<0&&(n.column=0),n}}).call(o.prototype)})),ace.define("ace/document",["require","exports","module","ace/lib/oop","ace/apply_delta","ace/lib/event_emitter","ace/range","ace/anchor"],(function(e,t,n){"use strict";var i=e("./lib/oop"),r=e("./apply_delta").applyDelta,o=e("./lib/event_emitter").EventEmitter,s=e("./range").Range,a=e("./anchor").Anchor,l=function(e){this.$lines=[""],0===e.length?this.$lines=[""]:Array.isArray(e)?this.insertMergedLines({row:0,column:0},e):this.insert({row:0,column:0},e)};(function(){i.implement(this,o),this.setValue=function(e){var t=this.getLength()-1;this.remove(new s(0,0,t,this.getLine(t).length)),this.insert({row:0,column:0},e)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},this.createAnchor=function(e,t){return new a(this,e,t)},0==="aaa".split(/a/).length?this.$split=function(e){return e.replace(/\r\n|\r/g,"\n").split("\n")}:this.$split=function(e){return e.split(/\r\n|\r|\n/)},this.$detectNewLine=function(e){var t=e.match(/^.*?(\r\n|\r|\n)/m);this.$autoNewLine=t?t[1]:"\n",this._signal("changeNewLineMode")},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\r\n";case"unix":return"\n";default:return this.$autoNewLine||"\n"}},this.$autoNewLine="",this.$newLineMode="auto",this.setNewLineMode=function(e){this.$newLineMode!==e&&(this.$newLineMode=e,this._signal("changeNewLineMode"))},this.getNewLineMode=function(){return this.$newLineMode},this.isNewLine=function(e){return"\r\n"==e||"\r"==e||"\n"==e},this.getLine=function(e){return this.$lines[e]||""},this.getLines=function(e,t){return this.$lines.slice(e,t+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getTextRange=function(e){return this.getLinesForRange(e).join(this.getNewLineCharacter())},this.getLinesForRange=function(e){var t;if(e.start.row===e.end.row)t=[this.getLine(e.start.row).substring(e.start.column,e.end.column)];else{(t=this.getLines(e.start.row,e.end.row))[0]=(t[0]||"").substring(e.start.column);var n=t.length-1;e.end.row-e.start.row==n&&(t[n]=t[n].substring(0,e.end.column))}return t},this.insertLines=function(e,t){return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."),this.insertFullLines(e,t)},this.removeLines=function(e,t){return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."),this.removeFullLines(e,t)},this.insertNewLine=function(e){return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, ['', '']) instead."),this.insertMergedLines(e,["",""])},this.insert=function(e,t){return this.getLength()<=1&&this.$detectNewLine(t),this.insertMergedLines(e,this.$split(t))},this.insertInLine=function(e,t){var n=this.clippedPos(e.row,e.column),i=this.pos(e.row,e.column+t.length);return this.applyDelta({start:n,end:i,action:"insert",lines:[t]},!0),this.clonePos(i)},this.clippedPos=function(e,t){var n=this.getLength();void 0===e?e=n:e<0?e=0:e>=n&&(e=n-1,t=void 0);var i=this.getLine(e);return null==t&&(t=i.length),{row:e,column:t=Math.min(Math.max(t,0),i.length)}},this.clonePos=function(e){return{row:e.row,column:e.column}},this.pos=function(e,t){return{row:e,column:t}},this.$clipPosition=function(e){var t=this.getLength();return e.row>=t?(e.row=Math.max(0,t-1),e.column=this.getLine(t-1).length):(e.row=Math.max(0,e.row),e.column=Math.min(Math.max(e.column,0),this.getLine(e.row).length)),e},this.insertFullLines=function(e,t){var n=0;(e=Math.min(Math.max(e,0),this.getLength()))<this.getLength()?(t=t.concat([""]),n=0):(t=[""].concat(t),e--,n=this.$lines[e].length),this.insertMergedLines({row:e,column:n},t)},this.insertMergedLines=function(e,t){var n=this.clippedPos(e.row,e.column),i={row:n.row+t.length-1,column:(1==t.length?n.column:0)+t[t.length-1].length};return this.applyDelta({start:n,end:i,action:"insert",lines:t}),this.clonePos(i)},this.remove=function(e){var t=this.clippedPos(e.start.row,e.start.column),n=this.clippedPos(e.end.row,e.end.column);return this.applyDelta({start:t,end:n,action:"remove",lines:this.getLinesForRange({start:t,end:n})}),this.clonePos(t)},this.removeInLine=function(e,t,n){var i=this.clippedPos(e,t),r=this.clippedPos(e,n);return this.applyDelta({start:i,end:r,action:"remove",lines:this.getLinesForRange({start:i,end:r})},!0),this.clonePos(i)},this.removeFullLines=function(e,t){e=Math.min(Math.max(0,e),this.getLength()-1);var n=(t=Math.min(Math.max(0,t),this.getLength()-1))==this.getLength()-1&&e>0,i=t<this.getLength()-1,r=n?e-1:e,o=n?this.getLine(r).length:0,a=i?t+1:t,l=i?0:this.getLine(a).length,c=new s(r,o,a,l),u=this.$lines.slice(e,t+1);return this.applyDelta({start:c.start,end:c.end,action:"remove",lines:this.getLinesForRange(c)}),u},this.removeNewLine=function(e){e<this.getLength()-1&&e>=0&&this.applyDelta({start:this.pos(e,this.getLine(e).length),end:this.pos(e+1,0),action:"remove",lines:["",""]})},this.replace=function(e,t){return e instanceof s||(e=s.fromPoints(e.start,e.end)),0===t.length&&e.isEmpty()?e.start:t==this.getTextRange(e)?e.end:(this.remove(e),t?this.insert(e.start,t):e.start)},this.applyDeltas=function(e){for(var t=0;t<e.length;t++)this.applyDelta(e[t])},this.revertDeltas=function(e){for(var t=e.length-1;t>=0;t--)this.revertDelta(e[t])},this.applyDelta=function(e,t){var n="insert"==e.action;(n?e.lines.length<=1&&!e.lines[0]:!s.comparePoints(e.start,e.end))||(n&&e.lines.length>2e4?this.$splitAndapplyLargeDelta(e,2e4):(r(this.$lines,e,t),this._signal("change",e)))},this.$safeApplyDelta=function(e){var t=this.$lines.length;("remove"==e.action&&e.start.row<t&&e.end.row<t||"insert"==e.action&&e.start.row<=t)&&this.applyDelta(e)},this.$splitAndapplyLargeDelta=function(e,t){for(var n=e.lines,i=n.length-t+1,r=e.start.row,o=e.start.column,s=0,a=0;s<i;s=a){a+=t-1;var l=n.slice(s,a);l.push(""),this.applyDelta({start:this.pos(r+s,o),end:this.pos(r+a,o=0),action:e.action,lines:l},!0)}e.lines=n.slice(s),e.start.row=r+s,e.start.column=o,this.applyDelta(e,!0)},this.revertDelta=function(e){this.$safeApplyDelta({start:this.clonePos(e.start),end:this.clonePos(e.end),action:"insert"==e.action?"remove":"insert",lines:e.lines.slice()})},this.indexToPosition=function(e,t){for(var n=this.$lines||this.getAllLines(),i=this.getNewLineCharacter().length,r=t||0,o=n.length;r<o;r++)if((e-=n[r].length+i)<0)return{row:r,column:e+n[r].length+i};return{row:o-1,column:e+n[o-1].length+i}},this.positionToIndex=function(e,t){for(var n=this.$lines||this.getAllLines(),i=this.getNewLineCharacter().length,r=0,o=Math.min(e.row,n.length),s=t||0;s<o;++s)r+=n[s].length+i;return r+e.column}}).call(l.prototype),t.Document=l})),ace.define("ace/background_tokenizer",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],(function(e,t,n){"use strict";var i=e("./lib/oop"),r=e("./lib/event_emitter").EventEmitter,o=function(e,t){this.running=!1,this.lines=[],this.states=[],this.currentLine=0,this.tokenizer=e;var n=this;this.$worker=function(){if(n.running){for(var e=new Date,t=n.currentLine,i=-1,r=n.doc,o=t;n.lines[t];)t++;var s=r.getLength(),a=0;for(n.running=!1;t<s;){n.$tokenizeRow(t),i=t;do{t++}while(n.lines[t]);if(++a%5==0&&new Date-e>20){n.running=setTimeout(n.$worker,20);break}}n.currentLine=t,-1==i&&(i=t),o<=i&&n.fireUpdateEvent(o,i)}}};(function(){i.implement(this,r),this.setTokenizer=function(e){this.tokenizer=e,this.lines=[],this.states=[],this.start(0)},this.setDocument=function(e){this.doc=e,this.lines=[],this.states=[],this.stop()},this.fireUpdateEvent=function(e,t){var n={first:e,last:t};this._signal("update",{data:n})},this.start=function(e){this.currentLine=Math.min(e||0,this.currentLine,this.doc.getLength()),this.lines.splice(this.currentLine,this.lines.length),this.states.splice(this.currentLine,this.states.length),this.stop(),this.running=setTimeout(this.$worker,700)},this.scheduleStart=function(){this.running||(this.running=setTimeout(this.$worker,700))},this.$updateOnChange=function(e){var t=e.start.row,n=e.end.row-t;if(0===n)this.lines[t]=null;else if("remove"==e.action)this.lines.splice(t,n+1,null),this.states.splice(t,n+1,null);else{var i=Array(n+1);i.unshift(t,1),this.lines.splice.apply(this.lines,i),this.states.splice.apply(this.states,i)}this.currentLine=Math.min(t,this.currentLine,this.doc.getLength()),this.stop()},this.stop=function(){this.running&&clearTimeout(this.running),this.running=!1},this.getTokens=function(e){return this.lines[e]||this.$tokenizeRow(e)},this.getState=function(e){return this.currentLine==e&&this.$tokenizeRow(e),this.states[e]||"start"},this.$tokenizeRow=function(e){var t=this.doc.getLine(e),n=this.states[e-1],i=this.tokenizer.getLineTokens(t,n,e);return this.states[e]+""!=i.state+""?(this.states[e]=i.state,this.lines[e+1]=null,this.currentLine>e+1&&(this.currentLine=e+1)):this.currentLine==e&&(this.currentLine=e+1),this.lines[e]=i.tokens}}).call(o.prototype),t.BackgroundTokenizer=o})),ace.define("ace/search_highlight",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/range"],(function(e,t,n){"use strict";var i=e("./lib/lang"),r=(e("./lib/oop"),e("./range").Range),o=function(e,t,n){this.setRegexp(e),this.clazz=t,this.type=n||"text"};(function(){this.MAX_RANGES=500,this.setRegexp=function(e){this.regExp+""!=e+""&&(this.regExp=e,this.cache=[])},this.update=function(e,t,n,o){if(this.regExp)for(var s=o.firstRow,a=o.lastRow,l=s;l<=a;l++){var c=this.cache[l];null==c&&((c=i.getMatchOffsets(n.getLine(l),this.regExp)).length>this.MAX_RANGES&&(c=c.slice(0,this.MAX_RANGES)),c=c.map((function(e){return new r(l,e.offset,l,e.offset+e.length)})),this.cache[l]=c.length?c:"");for(var u=c.length;u--;)t.drawSingleLineMarker(e,c[u].toScreenRange(n),this.clazz,o)}}}).call(o.prototype),t.SearchHighlight=o})),ace.define("ace/edit_session/fold_line",["require","exports","module","ace/range"],(function(e,t,n){"use strict";var i=e("../range").Range;function r(e,t){this.foldData=e,Array.isArray(t)?this.folds=t:t=this.folds=[t];var n=t[t.length-1];this.range=new i(t[0].start.row,t[0].start.column,n.end.row,n.end.column),this.start=this.range.start,this.end=this.range.end,this.folds.forEach((function(e){e.setFoldLine(this)}),this)}(function(){this.shiftRow=function(e){this.start.row+=e,this.end.row+=e,this.folds.forEach((function(t){t.start.row+=e,t.end.row+=e}))},this.addFold=function(e){if(e.sameRow){if(e.start.row<this.startRow||e.endRow>this.endRow)throw new Error("Can't add a fold to this FoldLine as it has no connection");this.folds.push(e),this.folds.sort((function(e,t){return-e.range.compareEnd(t.start.row,t.start.column)})),this.range.compareEnd(e.start.row,e.start.column)>0?(this.end.row=e.end.row,this.end.column=e.end.column):this.range.compareStart(e.end.row,e.end.column)<0&&(this.start.row=e.start.row,this.start.column=e.start.column)}else if(e.start.row==this.end.row)this.folds.push(e),this.end.row=e.end.row,this.end.column=e.end.column;else{if(e.end.row!=this.start.row)throw new Error("Trying to add fold to FoldRow that doesn't have a matching row");this.folds.unshift(e),this.start.row=e.start.row,this.start.column=e.start.column}e.foldLine=this},this.containsRow=function(e){return e>=this.start.row&&e<=this.end.row},this.walk=function(e,t,n){var i,r,o=0,s=this.folds,a=!0;null==t&&(t=this.end.row,n=this.end.column);for(var l=0;l<s.length;l++){if(-1==(r=(i=s[l]).range.compareStart(t,n)))return void e(null,t,n,o,a);if(!e(null,i.start.row,i.start.column,o,a)&&e(i.placeholder,i.start.row,i.start.column,o)||0===r)return;a=!i.sameRow,o=i.end.column}e(null,t,n,o,a)},this.getNextFoldTo=function(e,t){for(var n,i,r=0;r<this.folds.length;r++){if(-1==(i=(n=this.folds[r]).range.compareEnd(e,t)))return{fold:n,kind:"after"};if(0===i)return{fold:n,kind:"inside"}}return null},this.addRemoveChars=function(e,t,n){var i,r,o=this.getNextFoldTo(e,t);if(o)if(i=o.fold,"inside"==o.kind&&i.start.column!=t&&i.start.row!=e)window.console&&window.console.log(e,t,i);else if(i.start.row==e){var s=(r=this.folds).indexOf(i);for(0===s&&(this.start.column+=n);s<r.length;s++){if((i=r[s]).start.column+=n,!i.sameRow)return;i.end.column+=n}this.end.column+=n}},this.split=function(e,t){var n=this.getNextFoldTo(e,t);if(!n||"inside"==n.kind)return null;var i=n.fold,o=this.folds,s=this.foldData,a=o.indexOf(i),l=o[a-1];this.end.row=l.end.row,this.end.column=l.end.column;var c=new r(s,o=o.splice(a,o.length-a));return s.splice(s.indexOf(this)+1,0,c),c},this.merge=function(e){for(var t=e.folds,n=0;n<t.length;n++)this.addFold(t[n]);var i=this.foldData;i.splice(i.indexOf(e),1)},this.toString=function(){var e=[this.range.toString()+": ["];return this.folds.forEach((function(t){e.push("  "+t.toString())})),e.push("]"),e.join("\n")},this.idxToPosition=function(e){for(var t=0,n=0;n<this.folds.length;n++){var i=this.folds[n];if((e-=i.start.column-t)<0)return{row:i.start.row,column:i.start.column+e};if((e-=i.placeholder.length)<0)return i.start;t=i.end.column}return{row:this.end.row,column:this.end.column+e}}}).call(r.prototype),t.FoldLine=r})),ace.define("ace/range_list",["require","exports","module","ace/range"],(function(e,t,n){"use strict";var i=e("./range").Range.comparePoints,r=function(){this.ranges=[],this.$bias=1};(function(){this.comparePoints=i,this.pointIndex=function(e,t,n){for(var r=this.ranges,o=n||0;o<r.length;o++){var s=r[o],a=i(e,s.end);if(!(a>0)){var l=i(e,s.start);return 0===a?t&&0!==l?-o-2:o:l>0||0===l&&!t?o:-o-1}}return-o-1},this.add=function(e){var t=!e.isEmpty(),n=this.pointIndex(e.start,t);n<0&&(n=-n-1);var i=this.pointIndex(e.end,t,n);return i<0?i=-i-1:i++,this.ranges.splice(n,i-n,e)},this.addList=function(e){for(var t=[],n=e.length;n--;)t.push.apply(t,this.add(e[n]));return t},this.substractPoint=function(e){var t=this.pointIndex(e);if(t>=0)return this.ranges.splice(t,1)},this.merge=function(){for(var e,t=[],n=this.ranges,r=(n=n.sort((function(e,t){return i(e.start,t.start)})))[0],o=1;o<n.length;o++){e=r,r=n[o];var s=i(e.end,r.start);s<0||(0!=s||e.isEmpty()||r.isEmpty())&&(i(e.end,r.end)<0&&(e.end.row=r.end.row,e.end.column=r.end.column),n.splice(o,1),t.push(r),r=e,o--)}return this.ranges=n,t},this.contains=function(e,t){return this.pointIndex({row:e,column:t})>=0},this.containsPoint=function(e){return this.pointIndex(e)>=0},this.rangeAtPoint=function(e){var t=this.pointIndex(e);if(t>=0)return this.ranges[t]},this.clipRows=function(e,t){var n=this.ranges;if(n[0].start.row>t||n[n.length-1].start.row<e)return[];var i=this.pointIndex({row:e,column:0});i<0&&(i=-i-1);var r=this.pointIndex({row:t,column:0},i);r<0&&(r=-r-1);for(var o=[],s=i;s<r;s++)o.push(n[s]);return o},this.removeAll=function(){return this.ranges.splice(0,this.ranges.length)},this.attach=function(e){this.session&&this.detach(),this.session=e,this.onChange=this.$onChange.bind(this),this.session.on("change",this.onChange)},this.detach=function(){this.session&&(this.session.removeListener("change",this.onChange),this.session=null)},this.$onChange=function(e){for(var t=e.start,n=e.end,i=t.row,r=n.row,o=this.ranges,s=0,a=o.length;s<a;s++){if((u=o[s]).end.row>=i)break}if("insert"==e.action)for(var l=r-i,c=-t.column+n.column;s<a;s++){if((u=o[s]).start.row>i)break;if(u.start.row==i&&u.start.column>=t.column&&(u.start.column==t.column&&this.$bias<=0||(u.start.column+=c,u.start.row+=l)),u.end.row==i&&u.end.column>=t.column){if(u.end.column==t.column&&this.$bias<0)continue;u.end.column==t.column&&c>0&&s<a-1&&u.end.column>u.start.column&&u.end.column==o[s+1].start.column&&(u.end.column-=c),u.end.column+=c,u.end.row+=l}}else for(l=i-r,c=t.column-n.column;s<a;s++){if((u=o[s]).start.row>r)break;u.end.row<r&&(i<u.end.row||i==u.end.row&&t.column<u.end.column)?(u.end.row=i,u.end.column=t.column):u.end.row==r?u.end.column<=n.column?(l||u.end.column>t.column)&&(u.end.column=t.column,u.end.row=t.row):(u.end.column+=c,u.end.row+=l):u.end.row>r&&(u.end.row+=l),u.start.row<r&&(i<u.start.row||i==u.start.row&&t.column<u.start.column)?(u.start.row=i,u.start.column=t.column):u.start.row==r?u.start.column<=n.column?(l||u.start.column>t.column)&&(u.start.column=t.column,u.start.row=t.row):(u.start.column+=c,u.start.row+=l):u.start.row>r&&(u.start.row+=l)}if(0!=l&&s<a)for(;s<a;s++){var u;(u=o[s]).start.row+=l,u.end.row+=l}}}).call(r.prototype),t.RangeList=r})),ace.define("ace/edit_session/fold",["require","exports","module","ace/range_list","ace/lib/oop"],(function(e,t,n){"use strict";var i=e("../range_list").RangeList,r=e("../lib/oop"),o=t.Fold=function(e,t){this.foldLine=null,this.placeholder=t,this.range=e,this.start=e.start,this.end=e.end,this.sameRow=e.start.row==e.end.row,this.subFolds=this.ranges=[]};function s(e,t){e.row-=t.row,0==e.row&&(e.column-=t.column)}function a(e,t){0==e.row&&(e.column+=t.column),e.row+=t.row}r.inherits(o,i),function(){this.toString=function(){return'"'+this.placeholder+'" '+this.range.toString()},this.setFoldLine=function(e){this.foldLine=e,this.subFolds.forEach((function(t){t.setFoldLine(e)}))},this.clone=function(){var e=this.range.clone(),t=new o(e,this.placeholder);return this.subFolds.forEach((function(e){t.subFolds.push(e.clone())})),t.collapseChildren=this.collapseChildren,t},this.addSubFold=function(e){if(!this.range.isEqual(e)){var t,n;t=e,n=this.start,s(t.start,n),s(t.end,n);for(var i=e.start.row,r=e.start.column,o=0,a=-1;o<this.subFolds.length&&1==(a=this.subFolds[o].range.compare(i,r));o++);var l=this.subFolds[o],c=0;if(0==a){if(l.range.containsRange(e))return l.addSubFold(e);c=1}i=e.range.end.row,r=e.range.end.column;var u=o;for(a=-1;u<this.subFolds.length&&1==(a=this.subFolds[u].range.compare(i,r));u++);0==a&&u++;for(var h=this.subFolds.splice(o,u-o,e),d=0==a?h.length-1:h.length,f=c;f<d;f++)e.addSubFold(h[f]);return e.setFoldLine(this.foldLine),e}},this.restoreRange=function(e){return function(e,t){a(e.start,t),a(e.end,t)}(e,this.start)}}.call(o.prototype)})),ace.define("ace/edit_session/folding",["require","exports","module","ace/range","ace/edit_session/fold_line","ace/edit_session/fold","ace/token_iterator"],(function(e,t,n){"use strict";var i=e("../range").Range,r=e("./fold_line").FoldLine,o=e("./fold").Fold,s=e("../token_iterator").TokenIterator;t.Folding=function(){this.getFoldAt=function(e,t,n){var i=this.getFoldLine(e);if(!i)return null;for(var r=i.folds,o=0;o<r.length;o++){var s=r[o].range;if(s.contains(e,t)){if(1==n&&s.isEnd(e,t)&&!s.isEmpty())continue;if(-1==n&&s.isStart(e,t)&&!s.isEmpty())continue;return r[o]}}},this.getFoldsInRange=function(e){var t=e.start,n=e.end,i=this.$foldData,r=[];t.column+=1,n.column-=1;for(var o=0;o<i.length;o++){var s=i[o].range.compareRange(e);if(2!=s){if(-2==s)break;for(var a=i[o].folds,l=0;l<a.length;l++){var c=a[l];if(-2==(s=c.range.compareRange(e)))break;if(2!=s){if(42==s)break;r.push(c)}}}}return t.column-=1,n.column+=1,r},this.getFoldsInRangeList=function(e){if(Array.isArray(e)){var t=[];e.forEach((function(e){t=t.concat(this.getFoldsInRange(e))}),this)}else t=this.getFoldsInRange(e);return t},this.getAllFolds=function(){for(var e=[],t=this.$foldData,n=0;n<t.length;n++)for(var i=0;i<t[n].folds.length;i++)e.push(t[n].folds[i]);return e},this.getFoldStringAt=function(e,t,n,i){if(!(i=i||this.getFoldLine(e)))return null;for(var r,o,s={end:{column:0}},a=0;a<i.folds.length;a++){var l=(o=i.folds[a]).range.compareEnd(e,t);if(-1==l){r=this.getLine(o.start.row).substring(s.end.column,o.start.column);break}if(0===l)return null;s=o}return r||(r=this.getLine(o.start.row).substring(s.end.column)),-1==n?r.substring(0,t-s.end.column):1==n?r.substring(t-s.end.column):r},this.getFoldLine=function(e,t){var n=this.$foldData,i=0;for(t&&(i=n.indexOf(t)),-1==i&&(i=0);i<n.length;i++){var r=n[i];if(r.start.row<=e&&r.end.row>=e)return r;if(r.end.row>e)return null}return null},this.getNextFoldLine=function(e,t){var n=this.$foldData,i=0;for(t&&(i=n.indexOf(t)),-1==i&&(i=0);i<n.length;i++){var r=n[i];if(r.end.row>=e)return r}return null},this.getFoldedRowCount=function(e,t){for(var n=this.$foldData,i=t-e+1,r=0;r<n.length;r++){var o=n[r],s=o.end.row,a=o.start.row;if(s>=t){a<t&&(a>=e?i-=t-a:i=0);break}s>=e&&(i-=a>=e?s-a:s-e+1)}return i},this.$addFoldLine=function(e){return this.$foldData.push(e),this.$foldData.sort((function(e,t){return e.start.row-t.start.row})),e},this.addFold=function(e,t){var n,i=this.$foldData,s=!1;e instanceof o?n=e:(n=new o(t,e)).collapseChildren=t.collapseChildren,this.$clipRangeToDocument(n.range);var a=n.start.row,l=n.start.column,c=n.end.row,u=n.end.column,h=this.getFoldAt(a,l,1),d=this.getFoldAt(c,u,-1);if(h&&d==h)return h.addSubFold(n);h&&!h.range.isStart(a,l)&&this.removeFold(h),d&&!d.range.isEnd(c,u)&&this.removeFold(d);var f=this.getFoldsInRange(n.range);f.length>0&&(this.removeFolds(f),n.collapseChildren||f.forEach((function(e){n.addSubFold(e)})));for(var p=0;p<i.length;p++){var g=i[p];if(c==g.start.row){g.addFold(n),s=!0;break}if(a==g.end.row){if(g.addFold(n),s=!0,!n.sameRow){var m=i[p+1];if(m&&m.start.row==c){g.merge(m);break}}break}if(c<=g.start.row)break}return s||(g=this.$addFoldLine(new r(this.$foldData,n))),this.$useWrapMode?this.$updateWrapData(g.start.row,g.start.row):this.$updateRowLengthCache(g.start.row,g.start.row),this.$modified=!0,this._signal("changeFold",{data:n,action:"add"}),n},this.addFolds=function(e){e.forEach((function(e){this.addFold(e)}),this)},this.removeFold=function(e){var t=e.foldLine,n=t.start.row,i=t.end.row,r=this.$foldData,o=t.folds;if(1==o.length)r.splice(r.indexOf(t),1);else if(t.range.isEnd(e.end.row,e.end.column))o.pop(),t.end.row=o[o.length-1].end.row,t.end.column=o[o.length-1].end.column;else if(t.range.isStart(e.start.row,e.start.column))o.shift(),t.start.row=o[0].start.row,t.start.column=o[0].start.column;else if(e.sameRow)o.splice(o.indexOf(e),1);else{var s=t.split(e.start.row,e.start.column);(o=s.folds).shift(),s.start.row=o[0].start.row,s.start.column=o[0].start.column}this.$updating||(this.$useWrapMode?this.$updateWrapData(n,i):this.$updateRowLengthCache(n,i)),this.$modified=!0,this._signal("changeFold",{data:e,action:"remove"})},this.removeFolds=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);t.forEach((function(e){this.removeFold(e)}),this),this.$modified=!0},this.expandFold=function(e){this.removeFold(e),e.subFolds.forEach((function(t){e.restoreRange(t),this.addFold(t)}),this),e.collapseChildren>0&&this.foldAll(e.start.row+1,e.end.row,e.collapseChildren-1),e.subFolds=[]},this.expandFolds=function(e){e.forEach((function(e){this.expandFold(e)}),this)},this.unfold=function(e,t){var n,r;if(null==e?(n=new i(0,0,this.getLength(),0),null==t&&(t=!0)):n="number"==typeof e?new i(e,0,e,this.getLine(e).length):"row"in e?i.fromPoints(e,e):e,r=this.getFoldsInRangeList(n),0!=t?this.removeFolds(r):this.expandFolds(r),r.length)return r},this.isRowFolded=function(e,t){return!!this.getFoldLine(e,t)},this.getRowFoldEnd=function(e,t){var n=this.getFoldLine(e,t);return n?n.end.row:e},this.getRowFoldStart=function(e,t){var n=this.getFoldLine(e,t);return n?n.start.row:e},this.getFoldDisplayLine=function(e,t,n,i,r){null==i&&(i=e.start.row),null==r&&(r=0),null==t&&(t=e.end.row),null==n&&(n=this.getLine(t).length);var o=this.doc,s="";return e.walk((function(e,t,n,a){if(!(t<i)){if(t==i){if(n<r)return;a=Math.max(r,a)}s+=null!=e?e:o.getLine(t).substring(a,n)}}),t,n),s},this.getDisplayLine=function(e,t,n,i){var r,o=this.getFoldLine(e);return o?this.getFoldDisplayLine(o,e,t,n,i):(r=this.doc.getLine(e)).substring(i||0,t||r.length)},this.$cloneFoldData=function(){var e=[];return e=this.$foldData.map((function(t){var n=t.folds.map((function(e){return e.clone()}));return new r(e,n)}))},this.toggleFold=function(e){var t,n,i=this.selection.getRange();if(i.isEmpty()){var r=i.start;if(t=this.getFoldAt(r.row,r.column))return void this.expandFold(t);(n=this.findMatchingBracket(r))?1==i.comparePoint(n)?i.end=n:(i.start=n,i.start.column++,i.end.column--):(n=this.findMatchingBracket({row:r.row,column:r.column+1}))?(1==i.comparePoint(n)?i.end=n:i.start=n,i.start.column++):i=this.getCommentFoldRange(r.row,r.column)||i}else{var o=this.getFoldsInRange(i);if(e&&o.length)return void this.expandFolds(o);1==o.length&&(t=o[0])}if(t||(t=this.getFoldAt(i.start.row,i.start.column)),t&&t.range.toString()==i.toString())this.expandFold(t);else{var s="...";if(!i.isMultiLine()){if((s=this.getTextRange(i)).length<4)return;s=s.trim().substring(0,2)+".."}this.addFold(s,i)}},this.getCommentFoldRange=function(e,t,n){var r=new s(this,e,t),o=r.getCurrentToken(),a=o&&o.type;if(o&&/^comment|string/.test(a)){"comment"==(a=a.match(/comment|string/)[0])&&(a+="|doc-start");var l=new RegExp(a),c=new i;if(1!=n){do{o=r.stepBackward()}while(o&&l.test(o.type));r.stepForward()}if(c.start.row=r.getCurrentTokenRow(),c.start.column=r.getCurrentTokenColumn()+2,r=new s(this,e,t),-1!=n){var u=-1;do{if(o=r.stepForward(),-1==u){var h=this.getState(r.$row);l.test(h)||(u=r.$row)}else if(r.$row>u)break}while(o&&l.test(o.type));o=r.stepBackward()}else o=r.getCurrentToken();return c.end.row=r.getCurrentTokenRow(),c.end.column=r.getCurrentTokenColumn()+o.value.length-2,c}},this.foldAll=function(e,t,n,i){null==n&&(n=1e5);var r=this.foldWidgets;if(r){t=t||this.getLength();for(var o=e=e||0;o<t;o++)if(null==r[o]&&(r[o]=this.getFoldWidget(o)),"start"==r[o]&&(!i||i(o))){var s=this.getFoldWidgetRange(o);s&&s.isMultiLine()&&s.end.row<=t&&s.start.row>=e&&(o=s.end.row,s.collapseChildren=n,this.addFold("...",s))}}},this.foldToLevel=function(e){for(this.foldAll();e-- >0;)this.unfold(null,!1)},this.foldAllComments=function(){var e=this;this.foldAll(null,null,null,(function(t){for(var n=e.getTokens(t),i=0;i<n.length;i++){var r=n[i];if("text"!=r.type||!/^\s+$/.test(r.value))return!!/comment/.test(r.type)}}))},this.$foldStyles={manual:1,markbegin:1,markbeginend:1},this.$foldStyle="markbegin",this.setFoldStyle=function(e){if(!this.$foldStyles[e])throw new Error("invalid fold style: "+e+"["+Object.keys(this.$foldStyles).join(", ")+"]");if(this.$foldStyle!=e){this.$foldStyle=e,"manual"==e&&this.unfold();var t=this.$foldMode;this.$setFolding(null),this.$setFolding(t)}},this.$setFolding=function(e){this.$foldMode!=e&&(this.$foldMode=e,this.off("change",this.$updateFoldWidgets),this.off("tokenizerUpdate",this.$tokenizerUpdateFoldWidgets),this._signal("changeAnnotation"),e&&"manual"!=this.$foldStyle?(this.foldWidgets=[],this.getFoldWidget=e.getFoldWidget.bind(e,this,this.$foldStyle),this.getFoldWidgetRange=e.getFoldWidgetRange.bind(e,this,this.$foldStyle),this.$updateFoldWidgets=this.updateFoldWidgets.bind(this),this.$tokenizerUpdateFoldWidgets=this.tokenizerUpdateFoldWidgets.bind(this),this.on("change",this.$updateFoldWidgets),this.on("tokenizerUpdate",this.$tokenizerUpdateFoldWidgets)):this.foldWidgets=null)},this.getParentFoldRangeData=function(e,t){var n=this.foldWidgets;if(!n||t&&n[e])return{};for(var i,r=e-1;r>=0;){var o=n[r];if(null==o&&(o=n[r]=this.getFoldWidget(r)),"start"==o){var s=this.getFoldWidgetRange(r);if(i||(i=s),s&&s.end.row>=e)break}r--}return{range:-1!==r&&s,firstRange:i}},this.onFoldWidgetClick=function(e,t){var n={children:(t=t.domEvent).shiftKey,all:t.ctrlKey||t.metaKey,siblings:t.altKey};if(!this.$toggleFoldWidget(e,n)){var i=t.target||t.srcElement;i&&/ace_fold-widget/.test(i.className)&&(i.className+=" ace_invalid")}},this.$toggleFoldWidget=function(e,t){if(this.getFoldWidget){var n=this.getFoldWidget(e),i=this.getLine(e),r="end"===n?-1:1,o=this.getFoldAt(e,-1===r?0:i.length,r);if(o)return t.children||t.all?this.removeFold(o):this.expandFold(o),o;var s=this.getFoldWidgetRange(e,!0);if(s&&!s.isMultiLine()&&(o=this.getFoldAt(s.start.row,s.start.column,1))&&s.isEqual(o.range))return this.removeFold(o),o;if(t.siblings){var a=this.getParentFoldRangeData(e);if(a.range)var l=a.range.start.row+1,c=a.range.end.row;this.foldAll(l,c,t.all?1e4:0)}else t.children?(c=s?s.end.row:this.getLength(),this.foldAll(e+1,c,t.all?1e4:0)):s&&(t.all&&(s.collapseChildren=1e4),this.addFold("...",s));return s}},this.toggleFoldWidget=function(e){var t=this.selection.getCursor().row;t=this.getRowFoldStart(t);var n=this.$toggleFoldWidget(t,{});if(!n){var i=this.getParentFoldRangeData(t,!0);if(n=i.range||i.firstRange){t=n.start.row;var r=this.getFoldAt(t,this.getLine(t).length,1);r?this.removeFold(r):this.addFold("...",n)}}},this.updateFoldWidgets=function(e){var t=e.start.row,n=e.end.row-t;if(0===n)this.foldWidgets[t]=null;else if("remove"==e.action)this.foldWidgets.splice(t,n+1,null);else{var i=Array(n+1);i.unshift(t,1),this.foldWidgets.splice.apply(this.foldWidgets,i)}},this.tokenizerUpdateFoldWidgets=function(e){var t=e.data;t.first!=t.last&&this.foldWidgets.length>t.first&&this.foldWidgets.splice(t.first,this.foldWidgets.length)}}})),ace.define("ace/edit_session/bracket_match",["require","exports","module","ace/token_iterator","ace/range"],(function(e,t,n){"use strict";var i=e("../token_iterator").TokenIterator,r=e("../range").Range;t.BracketMatch=function(){this.findMatchingBracket=function(e,t){if(0==e.column)return null;var n=t||this.getLine(e.row).charAt(e.column-1);if(""==n)return null;var i=n.match(/([\(\[\{])|([\)\]\}])/);return i?i[1]?this.$findClosingBracket(i[1],e):this.$findOpeningBracket(i[2],e):null},this.getBracketRange=function(e){var t,n=this.getLine(e.row),i=!0,o=n.charAt(e.column-1),s=o&&o.match(/([\(\[\{])|([\)\]\}])/);if(s||(o=n.charAt(e.column),e={row:e.row,column:e.column+1},s=o&&o.match(/([\(\[\{])|([\)\]\}])/),i=!1),!s)return null;if(s[1]){if(!(a=this.$findClosingBracket(s[1],e)))return null;t=r.fromPoints(e,a),i||(t.end.column++,t.start.column--),t.cursor=t.end}else{var a;if(!(a=this.$findOpeningBracket(s[2],e)))return null;t=r.fromPoints(a,e),i||(t.start.column++,t.end.column--),t.cursor=t.start}return t},this.getMatchingBracketRanges=function(e){var t=this.getLine(e.row),n=t.charAt(e.column-1),i=n&&n.match(/([\(\[\{])|([\)\]\}])/);if(i||(n=t.charAt(e.column),e={row:e.row,column:e.column+1},i=n&&n.match(/([\(\[\{])|([\)\]\}])/)),!i)return null;var o=new r(e.row,e.column-1,e.row,e.column),s=i[1]?this.$findClosingBracket(i[1],e):this.$findOpeningBracket(i[2],e);return s?[o,new r(s.row,s.column,s.row,s.column+1)]:[o]},this.$brackets={")":"(","(":")","]":"[","[":"]","{":"}","}":"{","<":">",">":"<"},this.$findOpeningBracket=function(e,t,n){var r=this.$brackets[e],o=1,s=new i(this,t.row,t.column),a=s.getCurrentToken();if(a||(a=s.stepForward()),a){n||(n=new RegExp("(\\.?"+a.type.replace(".","\\.").replace("rparen",".paren").replace(/\b(?:end)\b/,"(?:start|begin|end)")+")+"));for(var l=t.column-s.getCurrentTokenColumn()-2,c=a.value;;){for(;l>=0;){var u=c.charAt(l);if(u==r){if(0==(o-=1))return{row:s.getCurrentTokenRow(),column:l+s.getCurrentTokenColumn()}}else u==e&&(o+=1);l-=1}do{a=s.stepBackward()}while(a&&!n.test(a.type));if(null==a)break;l=(c=a.value).length-1}return null}},this.$findClosingBracket=function(e,t,n){var r=this.$brackets[e],o=1,s=new i(this,t.row,t.column),a=s.getCurrentToken();if(a||(a=s.stepForward()),a){n||(n=new RegExp("(\\.?"+a.type.replace(".","\\.").replace("lparen",".paren").replace(/\b(?:start|begin)\b/,"(?:start|begin|end)")+")+"));for(var l=t.column-s.getCurrentTokenColumn();;){for(var c=a.value,u=c.length;l<u;){var h=c.charAt(l);if(h==r){if(0==(o-=1))return{row:s.getCurrentTokenRow(),column:l+s.getCurrentTokenColumn()}}else h==e&&(o+=1);l+=1}do{a=s.stepForward()}while(a&&!n.test(a.type));if(null==a)break;l=0}return null}}}})),ace.define("ace/edit_session",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/bidihandler","ace/config","ace/lib/event_emitter","ace/selection","ace/mode/text","ace/range","ace/document","ace/background_tokenizer","ace/search_highlight","ace/edit_session/folding","ace/edit_session/bracket_match"],(function(e,t,n){"use strict";var i=e("./lib/oop"),r=e("./lib/lang"),o=e("./bidihandler").BidiHandler,s=e("./config"),a=e("./lib/event_emitter").EventEmitter,l=e("./selection").Selection,c=e("./mode/text").Mode,u=e("./range").Range,h=e("./document").Document,d=e("./background_tokenizer").BackgroundTokenizer,f=e("./search_highlight").SearchHighlight,p=function(e,t){this.$breakpoints=[],this.$decorations=[],this.$frontMarkers={},this.$backMarkers={},this.$markerId=1,this.$undoSelect=!0,this.$foldData=[],this.id="session"+ ++p.$uid,this.$foldData.toString=function(){return this.join("\n")},this.on("changeFold",this.onChangeFold.bind(this)),this.$onChange=this.onChange.bind(this),"object"==typeof e&&e.getLine||(e=new h(e)),this.setDocument(e),this.selection=new l(this),this.$bidiHandler=new o(this),s.resetOptions(this),this.setMode(t),s._signal("session",this)};p.$uid=0,function(){i.implement(this,a),this.setDocument=function(e){this.doc&&this.doc.removeListener("change",this.$onChange),this.doc=e,e.on("change",this.$onChange),this.bgTokenizer&&this.bgTokenizer.setDocument(this.getDocument()),this.resetCaches()},this.getDocument=function(){return this.doc},this.$resetRowCache=function(e){if(!e)return this.$docRowCache=[],void(this.$screenRowCache=[]);var t=this.$docRowCache.length,n=this.$getRowCacheIndex(this.$docRowCache,e)+1;t>n&&(this.$docRowCache.splice(n,t),this.$screenRowCache.splice(n,t))},this.$getRowCacheIndex=function(e,t){for(var n=0,i=e.length-1;n<=i;){var r=n+i>>1,o=e[r];if(t>o)n=r+1;else{if(!(t<o))return r;i=r-1}}return n-1},this.resetCaches=function(){this.$modified=!0,this.$wrapData=[],this.$rowLengthCache=[],this.$resetRowCache(0),this.bgTokenizer&&this.bgTokenizer.start(0)},this.onChangeFold=function(e){var t=e.data;this.$resetRowCache(t.start.row)},this.onChange=function(e){this.$modified=!0,this.$bidiHandler.onChange(e),this.$resetRowCache(e.start.row);var t=this.$updateInternalDataOnChange(e);!this.$fromUndo&&this.$undoManager&&(t&&t.length&&(this.$undoManager.add({action:"removeFolds",folds:t},this.mergeUndoDeltas),this.mergeUndoDeltas=!0),this.$undoManager.add(e,this.mergeUndoDeltas),this.mergeUndoDeltas=!0,this.$informUndoManager.schedule()),this.bgTokenizer&&this.bgTokenizer.$updateOnChange(e),this._signal("change",e)},this.setValue=function(e){this.doc.setValue(e),this.selection.moveTo(0,0),this.$resetRowCache(0),this.setUndoManager(this.$undoManager),this.getUndoManager().reset()},this.getValue=this.toString=function(){return this.doc.getValue()},this.getSelection=function(){return this.selection},this.getState=function(e){return this.bgTokenizer.getState(e)},this.getTokens=function(e){return this.bgTokenizer.getTokens(e)},this.getTokenAt=function(e,t){var n,i=this.bgTokenizer.getTokens(e),r=0;if(null==t){var o=i.length-1;r=this.getLine(e).length}else for(o=0;o<i.length&&!((r+=i[o].value.length)>=t);o++);return(n=i[o])?(n.index=o,n.start=r-n.value.length,n):null},this.setUndoManager=function(e){if(this.$undoManager=e,this.$informUndoManager&&this.$informUndoManager.cancel(),e){var t=this;e.addSession(this),this.$syncInformUndoManager=function(){t.$informUndoManager.cancel(),t.mergeUndoDeltas=!1},this.$informUndoManager=r.delayedCall(this.$syncInformUndoManager)}else this.$syncInformUndoManager=function(){}},this.markUndoGroup=function(){this.$syncInformUndoManager&&this.$syncInformUndoManager()},this.$defaultUndoManager={undo:function(){},redo:function(){},hasUndo:function(){},hasRedo:function(){},reset:function(){},add:function(){},addSelection:function(){},startNewGroup:function(){},addSession:function(){}},this.getUndoManager=function(){return this.$undoManager||this.$defaultUndoManager},this.getTabString=function(){return this.getUseSoftTabs()?r.stringRepeat(" ",this.getTabSize()):"\t"},this.setUseSoftTabs=function(e){this.setOption("useSoftTabs",e)},this.getUseSoftTabs=function(){return this.$useSoftTabs&&!this.$mode.$indentWithTabs},this.setTabSize=function(e){this.setOption("tabSize",e)},this.getTabSize=function(){return this.$tabSize},this.isTabStop=function(e){return this.$useSoftTabs&&e.column%this.$tabSize==0},this.setNavigateWithinSoftTabs=function(e){this.setOption("navigateWithinSoftTabs",e)},this.getNavigateWithinSoftTabs=function(){return this.$navigateWithinSoftTabs},this.$overwrite=!1,this.setOverwrite=function(e){this.setOption("overwrite",e)},this.getOverwrite=function(){return this.$overwrite},this.toggleOverwrite=function(){this.setOverwrite(!this.$overwrite)},this.addGutterDecoration=function(e,t){this.$decorations[e]||(this.$decorations[e]=""),this.$decorations[e]+=" "+t,this._signal("changeBreakpoint",{})},this.removeGutterDecoration=function(e,t){this.$decorations[e]=(this.$decorations[e]||"").replace(" "+t,""),this._signal("changeBreakpoint",{})},this.getBreakpoints=function(){return this.$breakpoints},this.setBreakpoints=function(e){this.$breakpoints=[];for(var t=0;t<e.length;t++)this.$breakpoints[e[t]]="ace_breakpoint";this._signal("changeBreakpoint",{})},this.clearBreakpoints=function(){this.$breakpoints=[],this._signal("changeBreakpoint",{})},this.setBreakpoint=function(e,t){void 0===t&&(t="ace_breakpoint"),t?this.$breakpoints[e]=t:delete this.$breakpoints[e],this._signal("changeBreakpoint",{})},this.clearBreakpoint=function(e){delete this.$breakpoints[e],this._signal("changeBreakpoint",{})},this.addMarker=function(e,t,n,i){var r=this.$markerId++,o={range:e,type:n||"line",renderer:"function"==typeof n?n:null,clazz:t,inFront:!!i,id:r};return i?(this.$frontMarkers[r]=o,this._signal("changeFrontMarker")):(this.$backMarkers[r]=o,this._signal("changeBackMarker")),r},this.addDynamicMarker=function(e,t){if(e.update){var n=this.$markerId++;return e.id=n,e.inFront=!!t,t?(this.$frontMarkers[n]=e,this._signal("changeFrontMarker")):(this.$backMarkers[n]=e,this._signal("changeBackMarker")),e}},this.removeMarker=function(e){var t=this.$frontMarkers[e]||this.$backMarkers[e];t&&(delete(t.inFront?this.$frontMarkers:this.$backMarkers)[e],this._signal(t.inFront?"changeFrontMarker":"changeBackMarker"))},this.getMarkers=function(e){return e?this.$frontMarkers:this.$backMarkers},this.highlight=function(e){if(!this.$searchHighlight){var t=new f(null,"ace_selected-word","text");this.$searchHighlight=this.addDynamicMarker(t)}this.$searchHighlight.setRegexp(e)},this.highlightLines=function(e,t,n,i){"number"!=typeof t&&(n=t,t=e),n||(n="ace_step");var r=new u(e,0,t,1/0);return r.id=this.addMarker(r,n,"fullLine",i),r},this.setAnnotations=function(e){this.$annotations=e,this._signal("changeAnnotation",{})},this.getAnnotations=function(){return this.$annotations||[]},this.clearAnnotations=function(){this.setAnnotations([])},this.$detectNewLine=function(e){var t=e.match(/^.*?(\r?\n)/m);this.$autoNewLine=t?t[1]:"\n"},this.getWordRange=function(e,t){var n=this.getLine(e),i=!1;if(t>0&&(i=!!n.charAt(t-1).match(this.tokenRe)),i||(i=!!n.charAt(t).match(this.tokenRe)),i)var r=this.tokenRe;else if(/^\s+$/.test(n.slice(t-1,t+1)))r=/\s/;else r=this.nonTokenRe;var o=t;if(o>0){do{o--}while(o>=0&&n.charAt(o).match(r));o++}for(var s=t;s<n.length&&n.charAt(s).match(r);)s++;return new u(e,o,e,s)},this.getAWordRange=function(e,t){for(var n=this.getWordRange(e,t),i=this.getLine(n.end.row);i.charAt(n.end.column).match(/[ \t]/);)n.end.column+=1;return n},this.setNewLineMode=function(e){this.doc.setNewLineMode(e)},this.getNewLineMode=function(){return this.doc.getNewLineMode()},this.setUseWorker=function(e){this.setOption("useWorker",e)},this.getUseWorker=function(){return this.$useWorker},this.onReloadTokenizer=function(e){var t=e.data;this.bgTokenizer.start(t.first),this._signal("tokenizerUpdate",e)},this.$modes=s.$modes,this.$mode=null,this.$modeId=null,this.setMode=function(e,t){if(e&&"object"==typeof e){if(e.getTokenizer)return this.$onChangeMode(e);var n=e,i=n.path}else i=e||"ace/mode/text";if(this.$modes["ace/mode/text"]||(this.$modes["ace/mode/text"]=new c),this.$modes[i]&&!n)return this.$onChangeMode(this.$modes[i]),void(t&&t());this.$modeId=i,s.loadModule(["mode",i],function(e){if(this.$modeId!==i)return t&&t();this.$modes[i]&&!n?this.$onChangeMode(this.$modes[i]):e&&e.Mode&&(e=new e.Mode(n),n||(this.$modes[i]=e,e.$id=i),this.$onChangeMode(e)),t&&t()}.bind(this)),this.$mode||this.$onChangeMode(this.$modes["ace/mode/text"],!0)},this.$onChangeMode=function(e,t){if(t||(this.$modeId=e.$id),this.$mode!==e){var n=this.$mode;this.$mode=e,this.$stopWorker(),this.$useWorker&&this.$startWorker();var i=e.getTokenizer();if(void 0!==i.on){var r=this.onReloadTokenizer.bind(this);i.on("update",r)}if(this.bgTokenizer)this.bgTokenizer.setTokenizer(i);else{this.bgTokenizer=new d(i);var o=this;this.bgTokenizer.on("update",(function(e){o._signal("tokenizerUpdate",e)}))}this.bgTokenizer.setDocument(this.getDocument()),this.tokenRe=e.tokenRe,this.nonTokenRe=e.nonTokenRe,t||(e.attachToSession&&e.attachToSession(this),this.$options.wrapMethod.set.call(this,this.$wrapMethod),this.$setFolding(e.foldingRules),this.bgTokenizer.start(0),this._emit("changeMode",{oldMode:n,mode:e}))}},this.$stopWorker=function(){this.$worker&&(this.$worker.terminate(),this.$worker=null)},this.$startWorker=function(){try{this.$worker=this.$mode.createWorker(this)}catch(e){s.warn("Could not load worker",e),this.$worker=null}},this.getMode=function(){return this.$mode},this.$scrollTop=0,this.setScrollTop=function(e){this.$scrollTop===e||isNaN(e)||(this.$scrollTop=e,this._signal("changeScrollTop",e))},this.getScrollTop=function(){return this.$scrollTop},this.$scrollLeft=0,this.setScrollLeft=function(e){this.$scrollLeft===e||isNaN(e)||(this.$scrollLeft=e,this._signal("changeScrollLeft",e))},this.getScrollLeft=function(){return this.$scrollLeft},this.getScreenWidth=function(){return this.$computeWidth(),this.lineWidgets?Math.max(this.getLineWidgetMaxWidth(),this.screenWidth):this.screenWidth},this.getLineWidgetMaxWidth=function(){if(null!=this.lineWidgetsWidth)return this.lineWidgetsWidth;var e=0;return this.lineWidgets.forEach((function(t){t&&t.screenWidth>e&&(e=t.screenWidth)})),this.lineWidgetWidth=e},this.$computeWidth=function(e){if(this.$modified||e){if(this.$modified=!1,this.$useWrapMode)return this.screenWidth=this.$wrapLimit;for(var t=this.doc.getAllLines(),n=this.$rowLengthCache,i=0,r=0,o=this.$foldData[r],s=o?o.start.row:1/0,a=t.length,l=0;l<a;l++){if(l>s){if((l=o.end.row+1)>=a)break;s=(o=this.$foldData[r++])?o.start.row:1/0}null==n[l]&&(n[l]=this.$getStringScreenWidth(t[l])[0]),n[l]>i&&(i=n[l])}this.screenWidth=i}},this.getLine=function(e){return this.doc.getLine(e)},this.getLines=function(e,t){return this.doc.getLines(e,t)},this.getLength=function(){return this.doc.getLength()},this.getTextRange=function(e){return this.doc.getTextRange(e||this.selection.getRange())},this.insert=function(e,t){return this.doc.insert(e,t)},this.remove=function(e){return this.doc.remove(e)},this.removeFullLines=function(e,t){return this.doc.removeFullLines(e,t)},this.undoChanges=function(e,t){if(e.length){this.$fromUndo=!0;for(var n=e.length-1;-1!=n;n--){var i=e[n];"insert"==i.action||"remove"==i.action?this.doc.revertDelta(i):i.folds&&this.addFolds(i.folds)}!t&&this.$undoSelect&&(e.selectionBefore?this.selection.fromJSON(e.selectionBefore):this.selection.setRange(this.$getUndoSelection(e,!0))),this.$fromUndo=!1}},this.redoChanges=function(e,t){if(e.length){this.$fromUndo=!0;for(var n=0;n<e.length;n++){var i=e[n];"insert"!=i.action&&"remove"!=i.action||this.doc.$safeApplyDelta(i)}!t&&this.$undoSelect&&(e.selectionAfter?this.selection.fromJSON(e.selectionAfter):this.selection.setRange(this.$getUndoSelection(e,!1))),this.$fromUndo=!1}},this.setUndoSelect=function(e){this.$undoSelect=e},this.$getUndoSelection=function(e,t){function n(e){return t?"insert"!==e.action:"insert"===e.action}for(var i,r,o=0;o<e.length;o++){var s=e[o];s.start&&(i?n(s)?(r=s.start,-1==i.compare(r.row,r.column)&&i.setStart(r),r=s.end,1==i.compare(r.row,r.column)&&i.setEnd(r)):(r=s.start,-1==i.compare(r.row,r.column)&&(i=u.fromPoints(s.start,s.start))):i=n(s)?u.fromPoints(s.start,s.end):u.fromPoints(s.start,s.start))}return i},this.replace=function(e,t){return this.doc.replace(e,t)},this.moveText=function(e,t,n){var i=this.getTextRange(e),r=this.getFoldsInRange(e),o=u.fromPoints(t,t);if(!n){this.remove(e);var s=e.start.row-e.end.row;(c=s?-e.end.column:e.start.column-e.end.column)&&(o.start.row==e.end.row&&o.start.column>e.end.column&&(o.start.column+=c),o.end.row==e.end.row&&o.end.column>e.end.column&&(o.end.column+=c)),s&&o.start.row>=e.end.row&&(o.start.row+=s,o.end.row+=s)}if(o.end=this.insert(o.start,i),r.length){var a=e.start,l=o.start,c=(s=l.row-a.row,l.column-a.column);this.addFolds(r.map((function(e){return(e=e.clone()).start.row==a.row&&(e.start.column+=c),e.end.row==a.row&&(e.end.column+=c),e.start.row+=s,e.end.row+=s,e})))}return o},this.indentRows=function(e,t,n){n=n.replace(/\t/g,this.getTabString());for(var i=e;i<=t;i++)this.doc.insertInLine({row:i,column:0},n)},this.outdentRows=function(e){for(var t=e.collapseRows(),n=new u(0,0,0,0),i=this.getTabSize(),r=t.start.row;r<=t.end.row;++r){var o=this.getLine(r);n.start.row=r,n.end.row=r;for(var s=0;s<i&&" "==o.charAt(s);++s);s<i&&"\t"==o.charAt(s)?(n.start.column=s,n.end.column=s+1):(n.start.column=0,n.end.column=s),this.remove(n)}},this.$moveLines=function(e,t,n){if(e=this.getRowFoldStart(e),t=this.getRowFoldEnd(t),n<0){if((r=this.getRowFoldStart(e+n))<0)return 0;var i=r-e}else if(n>0){var r;if((r=this.getRowFoldEnd(t+n))>this.doc.getLength()-1)return 0;i=r-t}else{e=this.$clipRowToDocument(e);i=(t=this.$clipRowToDocument(t))-e+1}var o=new u(e,0,t,Number.MAX_VALUE),s=this.getFoldsInRange(o).map((function(e){return(e=e.clone()).start.row+=i,e.end.row+=i,e})),a=0==n?this.doc.getLines(e,t):this.doc.removeFullLines(e,t);return this.doc.insertFullLines(e+i,a),s.length&&this.addFolds(s),i},this.moveLinesUp=function(e,t){return this.$moveLines(e,t,-1)},this.moveLinesDown=function(e,t){return this.$moveLines(e,t,1)},this.duplicateLines=function(e,t){return this.$moveLines(e,t,0)},this.$clipRowToDocument=function(e){return Math.max(0,Math.min(e,this.doc.getLength()-1))},this.$clipColumnToRow=function(e,t){return t<0?0:Math.min(this.doc.getLine(e).length,t)},this.$clipPositionToDocument=function(e,t){if(t=Math.max(0,t),e<0)e=0,t=0;else{var n=this.doc.getLength();e>=n?(e=n-1,t=this.doc.getLine(n-1).length):t=Math.min(this.doc.getLine(e).length,t)}return{row:e,column:t}},this.$clipRangeToDocument=function(e){e.start.row<0?(e.start.row=0,e.start.column=0):e.start.column=this.$clipColumnToRow(e.start.row,e.start.column);var t=this.doc.getLength()-1;return e.end.row>t?(e.end.row=t,e.end.column=this.doc.getLine(t).length):e.end.column=this.$clipColumnToRow(e.end.row,e.end.column),e},this.$wrapLimit=80,this.$useWrapMode=!1,this.$wrapLimitRange={min:null,max:null},this.setUseWrapMode=function(e){if(e!=this.$useWrapMode){if(this.$useWrapMode=e,this.$modified=!0,this.$resetRowCache(0),e){var t=this.getLength();this.$wrapData=Array(t),this.$updateWrapData(0,t-1)}this._signal("changeWrapMode")}},this.getUseWrapMode=function(){return this.$useWrapMode},this.setWrapLimitRange=function(e,t){this.$wrapLimitRange.min===e&&this.$wrapLimitRange.max===t||(this.$wrapLimitRange={min:e,max:t},this.$modified=!0,this.$bidiHandler.markAsDirty(),this.$useWrapMode&&this._signal("changeWrapMode"))},this.adjustWrapLimit=function(e,t){var n=this.$wrapLimitRange;n.max<0&&(n={min:t,max:t});var i=this.$constrainWrapLimit(e,n.min,n.max);return i!=this.$wrapLimit&&i>1&&(this.$wrapLimit=i,this.$modified=!0,this.$useWrapMode&&(this.$updateWrapData(0,this.getLength()-1),this.$resetRowCache(0),this._signal("changeWrapLimit")),!0)},this.$constrainWrapLimit=function(e,t,n){return t&&(e=Math.max(t,e)),n&&(e=Math.min(n,e)),e},this.getWrapLimit=function(){return this.$wrapLimit},this.setWrapLimit=function(e){this.setWrapLimitRange(e,e)},this.getWrapLimitRange=function(){return{min:this.$wrapLimitRange.min,max:this.$wrapLimitRange.max}},this.$updateInternalDataOnChange=function(e){var t=this.$useWrapMode,n=e.action,i=e.start,r=e.end,o=i.row,s=r.row,a=s-o,l=null;if(this.$updating=!0,0!=a)if("remove"===n){this[t?"$wrapData":"$rowLengthCache"].splice(o,a);var c=this.$foldData;l=this.getFoldsInRange(e),this.removeFolds(l);var u=0;if(g=this.getFoldLine(r.row)){g.addRemoveChars(r.row,r.column,i.column-r.column),g.shiftRow(-a);var h=this.getFoldLine(o);h&&h!==g&&(h.merge(g),g=h),u=c.indexOf(g)+1}for(;u<c.length;u++){(g=c[u]).start.row>=r.row&&g.shiftRow(-a)}s=o}else{var d=Array(a);d.unshift(o,0);var f=t?this.$wrapData:this.$rowLengthCache;f.splice.apply(f,d);c=this.$foldData,u=0;if(g=this.getFoldLine(o)){var p=g.range.compareInside(i.row,i.column);0==p?(g=g.split(i.row,i.column))&&(g.shiftRow(a),g.addRemoveChars(s,0,r.column-i.column)):-1==p&&(g.addRemoveChars(o,0,r.column-i.column),g.shiftRow(a)),u=c.indexOf(g)+1}for(;u<c.length;u++){var g;(g=c[u]).start.row>=o&&g.shiftRow(a)}}else a=Math.abs(e.start.column-e.end.column),"remove"===n&&(l=this.getFoldsInRange(e),this.removeFolds(l),a=-a),(g=this.getFoldLine(o))&&g.addRemoveChars(o,i.column,a);return t&&this.$wrapData.length!=this.doc.getLength()&&console.error("doc.getLength() and $wrapData.length have to be the same!"),this.$updating=!1,t?this.$updateWrapData(o,s):this.$updateRowLengthCache(o,s),l},this.$updateRowLengthCache=function(e,t,n){this.$rowLengthCache[e]=null,this.$rowLengthCache[t]=null},this.$updateWrapData=function(n,i){var r,o,s=this.doc.getAllLines(),a=this.getTabSize(),l=this.$wrapData,c=this.$wrapLimit,u=n;for(i=Math.min(i,s.length-1);u<=i;)(o=this.getFoldLine(u,o))?(r=[],o.walk(function(n,i,o,a){var l;if(null!=n){(l=this.$getDisplayTokens(n,r.length))[0]=e;for(var c=1;c<l.length;c++)l[c]=t}else l=this.$getDisplayTokens(s[i].substring(a,o),r.length);r=r.concat(l)}.bind(this),o.end.row,s[o.end.row].length+1),l[o.start.row]=this.$computeWrapSplits(r,c,a),u=o.end.row+1):(r=this.$getDisplayTokens(s[u]),l[u]=this.$computeWrapSplits(r,c,a),u++)};var e=3,t=4;function n(e){return!(e<4352)&&(e>=4352&&e<=4447||e>=4515&&e<=4519||e>=4602&&e<=4607||e>=9001&&e<=9002||e>=11904&&e<=11929||e>=11931&&e<=12019||e>=12032&&e<=12245||e>=12272&&e<=12283||e>=12288&&e<=12350||e>=12353&&e<=12438||e>=12441&&e<=12543||e>=12549&&e<=12589||e>=12593&&e<=12686||e>=12688&&e<=12730||e>=12736&&e<=12771||e>=12784&&e<=12830||e>=12832&&e<=12871||e>=12880&&e<=13054||e>=13056&&e<=19903||e>=19968&&e<=42124||e>=42128&&e<=42182||e>=43360&&e<=43388||e>=44032&&e<=55203||e>=55216&&e<=55238||e>=55243&&e<=55291||e>=63744&&e<=64255||e>=65040&&e<=65049||e>=65072&&e<=65106||e>=65108&&e<=65126||e>=65128&&e<=65131||e>=65281&&e<=65376||e>=65504&&e<=65510)}this.$computeWrapSplits=function(n,i,r){if(0==n.length)return[];var o=[],s=n.length,a=0,l=0,c=this.$wrapAsCode,u=this.$indentedSoftWrap,h=i<=Math.max(2*r,8)||!1===u?0:Math.floor(i/2);function d(e){for(var t=e-a,i=a;i<e;i++){var s=n[i];12!==s&&2!==s||(t-=1)}o.length||(f=function(){var e=0;if(0===h)return e;if(u)for(var t=0;t<n.length;t++){var i=n[t];if(10==i)e+=1;else{if(11!=i){if(12==i)continue;break}e+=r}}return c&&!1!==u&&(e+=r),Math.min(e,h)}(),o.indent=f),l+=t,o.push(l),a=e}for(var f=0;s-a>i-f;){var p=a+i-f;if(n[p-1]>=10&&n[p]>=10)d(p);else if(n[p]!=e&&n[p]!=t){for(var g=Math.max(p-(i-(i>>2)),a-1);p>g&&n[p]<e;)p--;if(c){for(;p>g&&n[p]<e;)p--;for(;p>g&&9==n[p];)p--}else for(;p>g&&n[p]<10;)p--;p>g?d(++p):(2==n[p=a+i]&&p--,d(p-f))}else{for(;p!=a-1&&n[p]!=e;p--);if(p>a){d(p);continue}for(p=a+i;p<n.length&&n[p]==t;p++);if(p==n.length)break;d(p)}}return o},this.$getDisplayTokens=function(e,t){var i,r=[];t=t||0;for(var o=0;o<e.length;o++){var s=e.charCodeAt(o);if(9==s){i=this.getScreenTabSize(r.length+t),r.push(11);for(var a=1;a<i;a++)r.push(12)}else 32==s?r.push(10):s>39&&s<48||s>57&&s<64?r.push(9):s>=4352&&n(s)?r.push(1,2):r.push(1)}return r},this.$getStringScreenWidth=function(e,t,i){if(0==t)return[0,0];var r,o;for(null==t&&(t=1/0),i=i||0,o=0;o<e.length&&(9==(r=e.charCodeAt(o))?i+=this.getScreenTabSize(i):r>=4352&&n(r)?i+=2:i+=1,!(i>t));o++);return[i,o]},this.lineWidgets=null,this.getRowLength=function(e){var t=1;return this.lineWidgets&&(t+=this.lineWidgets[e]&&this.lineWidgets[e].rowCount||0),this.$useWrapMode&&this.$wrapData[e]?this.$wrapData[e].length+t:t},this.getRowLineCount=function(e){return this.$useWrapMode&&this.$wrapData[e]?this.$wrapData[e].length+1:1},this.getRowWrapIndent=function(e){if(this.$useWrapMode){var t=this.screenToDocumentPosition(e,Number.MAX_VALUE),n=this.$wrapData[t.row];return n.length&&n[0]<t.column?n.indent:0}return 0},this.getScreenLastRowColumn=function(e){var t=this.screenToDocumentPosition(e,Number.MAX_VALUE);return this.documentToScreenColumn(t.row,t.column)},this.getDocumentLastRowColumn=function(e,t){var n=this.documentToScreenRow(e,t);return this.getScreenLastRowColumn(n)},this.getDocumentLastRowColumnPosition=function(e,t){var n=this.documentToScreenRow(e,t);return this.screenToDocumentPosition(n,Number.MAX_VALUE/10)},this.getRowSplitData=function(e){return this.$useWrapMode?this.$wrapData[e]:void 0},this.getScreenTabSize=function(e){return this.$tabSize-(e%this.$tabSize|0)},this.screenToDocumentRow=function(e,t){return this.screenToDocumentPosition(e,t).row},this.screenToDocumentColumn=function(e,t){return this.screenToDocumentPosition(e,t).column},this.screenToDocumentPosition=function(e,t,n){if(e<0)return{row:0,column:0};var i,r,o=0,s=0,a=0,l=0,c=this.$screenRowCache,u=this.$getRowCacheIndex(c,e),h=c.length;if(h&&u>=0){a=c[u],o=this.$docRowCache[u];var d=e>c[h-1]}else d=!h;for(var f=this.getLength()-1,p=this.getNextFoldLine(o),g=p?p.start.row:1/0;a<=e&&!(a+(l=this.getRowLength(o))>e||o>=f);)a+=l,++o>g&&(o=p.end.row+1,g=(p=this.getNextFoldLine(o,p))?p.start.row:1/0),d&&(this.$docRowCache.push(o),this.$screenRowCache.push(a));if(p&&p.start.row<=o)i=this.getFoldDisplayLine(p),o=p.start.row;else{if(a+l<=e||o>f)return{row:f,column:this.getLine(f).length};i=this.getLine(o),p=null}var m=0,v=Math.floor(e-a);if(this.$useWrapMode){var b=this.$wrapData[o];b&&(r=b[v],v>0&&b.length&&(m=b.indent,s=b[v-1]||b[b.length-1],i=i.substring(s)))}return void 0!==n&&this.$bidiHandler.isBidiRow(a+v,o,v)&&(t=this.$bidiHandler.offsetToCol(n)),s+=this.$getStringScreenWidth(i,t-m)[1],this.$useWrapMode&&s>=r&&(s=r-1),p?p.idxToPosition(s):{row:o,column:s}},this.documentToScreenPosition=function(e,t){if(void 0===t)var n=this.$clipPositionToDocument(e.row,e.column);else n=this.$clipPositionToDocument(e,t);e=n.row,t=n.column;var i,r=0,o=null;(i=this.getFoldAt(e,t,1))&&(e=i.start.row,t=i.start.column);var s,a=0,l=this.$docRowCache,c=this.$getRowCacheIndex(l,e),u=l.length;if(u&&c>=0){a=l[c],r=this.$screenRowCache[c];var h=e>l[u-1]}else h=!u;for(var d=this.getNextFoldLine(a),f=d?d.start.row:1/0;a<e;){if(a>=f){if((s=d.end.row+1)>e)break;f=(d=this.getNextFoldLine(s,d))?d.start.row:1/0}else s=a+1;r+=this.getRowLength(a),a=s,h&&(this.$docRowCache.push(a),this.$screenRowCache.push(r))}var p="";d&&a>=f?(p=this.getFoldDisplayLine(d,e,t),o=d.start.row):(p=this.getLine(e).substring(0,t),o=e);var g=0;if(this.$useWrapMode){var m=this.$wrapData[o];if(m){for(var v=0;p.length>=m[v];)r++,v++;p=p.substring(m[v-1]||0,p.length),g=v>0?m.indent:0}}return this.lineWidgets&&this.lineWidgets[a]&&this.lineWidgets[a].rowsAbove&&(r+=this.lineWidgets[a].rowsAbove),{row:r,column:g+this.$getStringScreenWidth(p)[0]}},this.documentToScreenColumn=function(e,t){return this.documentToScreenPosition(e,t).column},this.documentToScreenRow=function(e,t){return this.documentToScreenPosition(e,t).row},this.getScreenLength=function(){var e=0,t=null;if(this.$useWrapMode)for(var n=this.$wrapData.length,i=0,r=(a=0,(t=this.$foldData[a++])?t.start.row:1/0);i<n;){var o=this.$wrapData[i];e+=o?o.length+1:1,++i>r&&(i=t.end.row+1,r=(t=this.$foldData[a++])?t.start.row:1/0)}else{e=this.getLength();for(var s=this.$foldData,a=0;a<s.length;a++)e-=(t=s[a]).end.row-t.start.row}return this.lineWidgets&&(e+=this.$getWidgetScreenLength()),e},this.$setFontMetrics=function(e){this.$enableVarChar&&(this.$getStringScreenWidth=function(t,n,i){if(0===n)return[0,0];var r,o;for(n||(n=1/0),i=i||0,o=0;o<t.length&&!((i+="\t"===(r=t.charAt(o))?this.getScreenTabSize(i):e.getCharacterWidth(r))>n);o++);return[i,o]})},this.destroy=function(){this.bgTokenizer&&(this.bgTokenizer.setDocument(null),this.bgTokenizer=null),this.$stopWorker(),this.removeAllListeners(),this.selection.detach()},this.isFullWidth=n}.call(p.prototype),e("./edit_session/folding").Folding.call(p.prototype),e("./edit_session/bracket_match").BracketMatch.call(p.prototype),s.defineOptions(p.prototype,"session",{wrap:{set:function(e){if(e&&"off"!=e?"free"==e?e=!0:"printMargin"==e?e=-1:"string"==typeof e&&(e=parseInt(e,10)||!1):e=!1,this.$wrap!=e)if(this.$wrap=e,e){var t="number"==typeof e?e:null;this.setWrapLimitRange(t,t),this.setUseWrapMode(!0)}else this.setUseWrapMode(!1)},get:function(){return this.getUseWrapMode()?-1==this.$wrap?"printMargin":this.getWrapLimitRange().min?this.$wrap:"free":"off"},handlesSet:!0},wrapMethod:{set:function(e){(e="auto"==e?"text"!=this.$mode.type:"text"!=e)!=this.$wrapAsCode&&(this.$wrapAsCode=e,this.$useWrapMode&&(this.$useWrapMode=!1,this.setUseWrapMode(!0)))},initialValue:"auto"},indentedSoftWrap:{set:function(){this.$useWrapMode&&(this.$useWrapMode=!1,this.setUseWrapMode(!0))},initialValue:!0},firstLineNumber:{set:function(){this._signal("changeBreakpoint")},initialValue:1},useWorker:{set:function(e){this.$useWorker=e,this.$stopWorker(),e&&this.$startWorker()},initialValue:!0},useSoftTabs:{initialValue:!0},tabSize:{set:function(e){(e=parseInt(e))>0&&this.$tabSize!==e&&(this.$modified=!0,this.$rowLengthCache=[],this.$tabSize=e,this._signal("changeTabSize"))},initialValue:4,handlesSet:!0},navigateWithinSoftTabs:{initialValue:!1},foldStyle:{set:function(e){this.setFoldStyle(e)},handlesSet:!0},overwrite:{set:function(e){this._signal("changeOverwrite")},initialValue:!1},newLineMode:{set:function(e){this.doc.setNewLineMode(e)},get:function(){return this.doc.getNewLineMode()},handlesSet:!0},mode:{set:function(e){this.setMode(e)},get:function(){return this.$modeId},handlesSet:!0}}),t.EditSession=p})),ace.define("ace/search",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/range"],(function(e,t,n){"use strict";var i=e("./lib/lang"),r=e("./lib/oop"),o=e("./range").Range,s=function(){this.$options={}};(function(){this.set=function(e){return r.mixin(this.$options,e),this},this.getOptions=function(){return i.copyObject(this.$options)},this.setOptions=function(e){this.$options=e},this.find=function(e){var t=this.$options,n=this.$matchIterator(e,t);if(!n)return!1;var i=null;return n.forEach((function(e,n,r,s){return i=new o(e,n,r,s),!(n==s&&t.start&&t.start.start&&0!=t.skipCurrent&&i.isEqual(t.start))||(i=null,!1)})),i},this.findAll=function(e){var t=this.$options;if(!t.needle)return[];this.$assembleRegExp(t);var n=t.range,r=n?e.getLines(n.start.row,n.end.row):e.doc.getAllLines(),s=[],a=t.re;if(t.$isMultiLine){var l,c=a.length,u=r.length-c;e:for(var h=a.offset||0;h<=u;h++){for(var d=0;d<c;d++)if(-1==r[h+d].search(a[d]))continue e;var f=r[h],p=r[h+c-1],g=f.length-f.match(a[0])[0].length,m=p.match(a[c-1])[0].length;l&&l.end.row===h&&l.end.column>g||(s.push(l=new o(h,g,h+c-1,m)),c>2&&(h=h+c-2))}}else for(var v=0;v<r.length;v++){var b=i.getMatchOffsets(r[v],a);for(d=0;d<b.length;d++){var y=b[d];s.push(new o(v,y.offset,v,y.offset+y.length))}}if(n){var w=n.start.column,x=n.start.column;for(v=0,d=s.length-1;v<d&&s[v].start.column<w&&s[v].start.row==n.start.row;)v++;for(;v<d&&s[d].end.column>x&&s[d].end.row==n.end.row;)d--;for(s=s.slice(v,d+1),v=0,d=s.length;v<d;v++)s[v].start.row+=n.start.row,s[v].end.row+=n.start.row}return s},this.replace=function(e,t){var n=this.$options,i=this.$assembleRegExp(n);if(n.$isMultiLine)return t;if(i){var r=i.exec(e);if(!r||r[0].length!=e.length)return null;if(t=e.replace(i,t),n.preserveCase){t=t.split("");for(var o=Math.min(e.length,e.length);o--;){var s=e[o];s&&s.toLowerCase()!=s?t[o]=t[o].toUpperCase():t[o]=t[o].toLowerCase()}t=t.join("")}return t}},this.$assembleRegExp=function(e,t){if(e.needle instanceof RegExp)return e.re=e.needle;var n=e.needle;if(!e.needle)return e.re=!1;e.regExp||(n=i.escapeRegExp(n)),e.wholeWord&&(n=function(e,t){function n(e){return/\w/.test(e)||t.regExp?"\\b":""}return n(e[0])+e+n(e[e.length-1])}(n,e));var r=e.caseSensitive?"gm":"gmi";if(e.$isMultiLine=!t&&/[\n\r]/.test(n),e.$isMultiLine)return e.re=this.$assembleMultilineRegExp(n,r);try{var o=new RegExp(n,r)}catch(e){o=!1}return e.re=o},this.$assembleMultilineRegExp=function(e,t){for(var n=e.replace(/\r\n|\r|\n/g,"$\n^").split("\n"),i=[],r=0;r<n.length;r++)try{i.push(new RegExp(n[r],t))}catch(e){return!1}return i},this.$matchIterator=function(e,t){var n=this.$assembleRegExp(t);if(!n)return!1;var i=1==t.backwards,r=0!=t.skipCurrent,o=t.range,s=t.start;s||(s=o?o[i?"end":"start"]:e.selection.getRange()),s.start&&(s=s[r!=i?"end":"start"]);var a=o?o.start.row:0,l=o?o.end.row:e.getLength()-1;if(i)var c=function(e){var n=s.row;if(!h(n,s.column,e)){for(n--;n>=a;n--)if(h(n,Number.MAX_VALUE,e))return;if(0!=t.wrap)for(n=l,a=s.row;n>=a;n--)if(h(n,Number.MAX_VALUE,e))return}};else c=function(e){var n=s.row;if(!h(n,s.column,e)){for(n+=1;n<=l;n++)if(h(n,0,e))return;if(0!=t.wrap)for(n=a,l=s.row;n<=l;n++)if(h(n,0,e))return}};if(t.$isMultiLine)var u=n.length,h=function(t,r,o){var s=i?t-u+1:t;if(!(s<0)){var a=e.getLine(s),l=a.search(n[0]);if(!(!i&&l<r||-1===l)){for(var c=1;c<u;c++)if(-1==(a=e.getLine(s+c)).search(n[c]))return;var h=a.match(n[u-1])[0].length;if(!(i&&h>r))return!!o(s,l,s+u-1,h)||void 0}}};else if(i)h=function(t,i,r){var o,s=e.getLine(t),a=[],l=0;for(n.lastIndex=0;o=n.exec(s);){var c=o[0].length;if(l=o.index,!c){if(l>=s.length)break;n.lastIndex=l+=1}if(o.index+c>i)break;a.push(o.index,c)}for(var u=a.length-1;u>=0;u-=2){var h=a[u-1];if(r(t,h,t,h+(c=a[u])))return!0}};else h=function(t,i,r){var o,s,a=e.getLine(t);for(n.lastIndex=i;s=n.exec(a);){var l=s[0].length;if(r(t,o=s.index,t,o+l))return!0;if(!l&&(n.lastIndex=o+=1,o>=a.length))return!1}};return{forEach:c}}}).call(s.prototype),t.Search=s})),ace.define("ace/keyboard/hash_handler",["require","exports","module","ace/lib/keys","ace/lib/useragent"],(function(e,t,n){"use strict";var i=e("../lib/keys"),r=e("../lib/useragent"),o=i.KEY_MODS;function s(e,t){this.platform=t||(r.isMac?"mac":"win"),this.commands={},this.commandKeyBinding={},this.addCommands(e),this.$singleCommand=!0}function a(e,t){s.call(this,e,t),this.$singleCommand=!1}a.prototype=s.prototype,function(){function e(e){return"object"==typeof e&&e.bindKey&&e.bindKey.position||(e.isDefault?-100:0)}this.addCommand=function(e){this.commands[e.name]&&this.removeCommand(e),this.commands[e.name]=e,e.bindKey&&this._buildKeyHash(e)},this.removeCommand=function(e,t){var n=e&&("string"==typeof e?e:e.name);e=this.commands[n],t||delete this.commands[n];var i=this.commandKeyBinding;for(var r in i){var o=i[r];if(o==e)delete i[r];else if(Array.isArray(o)){var s=o.indexOf(e);-1!=s&&(o.splice(s,1),1==o.length&&(i[r]=o[0]))}}},this.bindKey=function(e,t,n){if("object"==typeof e&&e&&(null==n&&(n=e.position),e=e[this.platform]),e)return"function"==typeof t?this.addCommand({exec:t,bindKey:e,name:t.name||e}):void e.split("|").forEach((function(e){var i="";if(-1!=e.indexOf(" ")){var r=e.split(/\s+/);e=r.pop(),r.forEach((function(e){var t=this.parseKeys(e),n=o[t.hashId]+t.key;i+=(i?" ":"")+n,this._addCommandToBinding(i,"chainKeys")}),this),i+=" "}var s=this.parseKeys(e),a=o[s.hashId]+s.key;this._addCommandToBinding(i+a,t,n)}),this)},this._addCommandToBinding=function(t,n,i){var r,o=this.commandKeyBinding;if(n)if(!o[t]||this.$singleCommand)o[t]=n;else{Array.isArray(o[t])?-1!=(r=o[t].indexOf(n))&&o[t].splice(r,1):o[t]=[o[t]],"number"!=typeof i&&(i=e(n));var s=o[t];for(r=0;r<s.length;r++){if(e(s[r])>i)break}s.splice(r,0,n)}else delete o[t]},this.addCommands=function(e){e&&Object.keys(e).forEach((function(t){var n=e[t];if(n){if("string"==typeof n)return this.bindKey(n,t);"function"==typeof n&&(n={exec:n}),"object"==typeof n&&(n.name||(n.name=t),this.addCommand(n))}}),this)},this.removeCommands=function(e){Object.keys(e).forEach((function(t){this.removeCommand(e[t])}),this)},this.bindKeys=function(e){Object.keys(e).forEach((function(t){this.bindKey(t,e[t])}),this)},this._buildKeyHash=function(e){this.bindKey(e.bindKey,e)},this.parseKeys=function(e){var t=e.toLowerCase().split(/[\-\+]([\-\+])?/).filter((function(e){return e})),n=t.pop(),r=i[n];if(i.FUNCTION_KEYS[r])n=i.FUNCTION_KEYS[r].toLowerCase();else{if(!t.length)return{key:n,hashId:-1};if(1==t.length&&"shift"==t[0])return{key:n.toUpperCase(),hashId:-1}}for(var o=0,s=t.length;s--;){var a=i.KEY_MODS[t[s]];if(null==a)return"undefined"!=typeof console&&console.error("invalid modifier "+t[s]+" in "+e),!1;o|=a}return{key:n,hashId:o}},this.findKeyCommand=function(e,t){var n=o[e]+t;return this.commandKeyBinding[n]},this.handleKeyboard=function(e,t,n,i){if(!(i<0)){var r=o[t]+n,s=this.commandKeyBinding[r];return e.$keyChain&&(e.$keyChain+=" "+r,s=this.commandKeyBinding[e.$keyChain]||s),!s||"chainKeys"!=s&&"chainKeys"!=s[s.length-1]?(e.$keyChain&&(t&&4!=t||1!=n.length?(-1==t||i>0)&&(e.$keyChain=""):e.$keyChain=e.$keyChain.slice(0,-r.length-1)),{command:s}):(e.$keyChain=e.$keyChain||r,{command:"null"})}},this.getStatusText=function(e,t){return t.$keyChain||""}}.call(s.prototype),t.HashHandler=s,t.MultiHashHandler=a})),ace.define("ace/commands/command_manager",["require","exports","module","ace/lib/oop","ace/keyboard/hash_handler","ace/lib/event_emitter"],(function(e,t,n){"use strict";var i=e("../lib/oop"),r=e("../keyboard/hash_handler").MultiHashHandler,o=e("../lib/event_emitter").EventEmitter,s=function(e,t){r.call(this,t,e),this.byName=this.commands,this.setDefaultHandler("exec",(function(e){return e.command.exec(e.editor,e.args||{})}))};i.inherits(s,r),function(){i.implement(this,o),this.exec=function(e,t,n){if(Array.isArray(e)){for(var i=e.length;i--;)if(this.exec(e[i],t,n))return!0;return!1}if("string"==typeof e&&(e=this.commands[e]),!e)return!1;if(t&&t.$readOnly&&!e.readOnly)return!1;if(0!=this.$checkCommandState&&e.isAvailable&&!e.isAvailable(t))return!1;var r={editor:t,command:e,args:n};return r.returnValue=this._emit("exec",r),this._signal("afterExec",r),!1!==r.returnValue},this.toggleRecording=function(e){if(!this.$inReplay)return e&&e._emit("changeStatus"),this.recording?(this.macro.pop(),this.off("exec",this.$addCommandToMacro),this.macro.length||(this.macro=this.oldMacro),this.recording=!1):(this.$addCommandToMacro||(this.$addCommandToMacro=function(e){this.macro.push([e.command,e.args])}.bind(this)),this.oldMacro=this.macro,this.macro=[],this.on("exec",this.$addCommandToMacro),this.recording=!0)},this.replay=function(e){if(!this.$inReplay&&this.macro){if(this.recording)return this.toggleRecording(e);try{this.$inReplay=!0,this.macro.forEach((function(t){"string"==typeof t?this.exec(t,e):this.exec(t[0],e,t[1])}),this)}finally{this.$inReplay=!1}}},this.trimMacro=function(e){return e.map((function(e){return"string"!=typeof e[0]&&(e[0]=e[0].name),e[1]||(e=e[0]),e}))}}.call(s.prototype),t.CommandManager=s})),ace.define("ace/commands/default_commands",["require","exports","module","ace/lib/lang","ace/config","ace/range"],(function(e,t,n){"use strict";var i=e("../lib/lang"),r=e("../config"),o=e("../range").Range;function s(e,t){return{win:e,mac:t}}t.commands=[{name:"showSettingsMenu",bindKey:s("Ctrl-,","Command-,"),exec:function(e){r.loadModule("ace/ext/settings_menu",(function(t){t.init(e),e.showSettingsMenu()}))},readOnly:!0},{name:"goToNextError",bindKey:s("Alt-E","F4"),exec:function(e){r.loadModule("./ext/error_marker",(function(t){t.showErrorMarker(e,1)}))},scrollIntoView:"animate",readOnly:!0},{name:"goToPreviousError",bindKey:s("Alt-Shift-E","Shift-F4"),exec:function(e){r.loadModule("./ext/error_marker",(function(t){t.showErrorMarker(e,-1)}))},scrollIntoView:"animate",readOnly:!0},{name:"selectall",description:"Select all",bindKey:s("Ctrl-A","Command-A"),exec:function(e){e.selectAll()},readOnly:!0},{name:"centerselection",description:"Center selection",bindKey:s(null,"Ctrl-L"),exec:function(e){e.centerSelection()},readOnly:!0},{name:"gotoline",description:"Go to line...",bindKey:s("Ctrl-L","Command-L"),exec:function(e,t){"number"!=typeof t||isNaN(t)||e.gotoLine(t),e.prompt({$type:"gotoLine"})},readOnly:!0},{name:"fold",bindKey:s("Alt-L|Ctrl-F1","Command-Alt-L|Command-F1"),exec:function(e){e.session.toggleFold(!1)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"unfold",bindKey:s("Alt-Shift-L|Ctrl-Shift-F1","Command-Alt-Shift-L|Command-Shift-F1"),exec:function(e){e.session.toggleFold(!0)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"toggleFoldWidget",bindKey:s("F2","F2"),exec:function(e){e.session.toggleFoldWidget()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"toggleParentFoldWidget",bindKey:s("Alt-F2","Alt-F2"),exec:function(e){e.session.toggleFoldWidget(!0)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"foldall",description:"Fold all",bindKey:s(null,"Ctrl-Command-Option-0"),exec:function(e){e.session.foldAll()},scrollIntoView:"center",readOnly:!0},{name:"foldAllComments",description:"Fold all comments",bindKey:s(null,"Ctrl-Command-Option-0"),exec:function(e){e.session.foldAllComments()},scrollIntoView:"center",readOnly:!0},{name:"foldOther",description:"Fold other",bindKey:s("Alt-0","Command-Option-0"),exec:function(e){e.session.foldAll(),e.session.unfold(e.selection.getAllRanges())},scrollIntoView:"center",readOnly:!0},{name:"unfoldall",description:"Unfold all",bindKey:s("Alt-Shift-0","Command-Option-Shift-0"),exec:function(e){e.session.unfold()},scrollIntoView:"center",readOnly:!0},{name:"findnext",description:"Find next",bindKey:s("Ctrl-K","Command-G"),exec:function(e){e.findNext()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"findprevious",description:"Find previous",bindKey:s("Ctrl-Shift-K","Command-Shift-G"),exec:function(e){e.findPrevious()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"selectOrFindNext",description:"Select or find next",bindKey:s("Alt-K","Ctrl-G"),exec:function(e){e.selection.isEmpty()?e.selection.selectWord():e.findNext()},readOnly:!0},{name:"selectOrFindPrevious",description:"Select or find previous",bindKey:s("Alt-Shift-K","Ctrl-Shift-G"),exec:function(e){e.selection.isEmpty()?e.selection.selectWord():e.findPrevious()},readOnly:!0},{name:"find",description:"Find",bindKey:s("Ctrl-F","Command-F"),exec:function(e){r.loadModule("ace/ext/searchbox",(function(t){t.Search(e)}))},readOnly:!0},{name:"overwrite",description:"Overwrite",bindKey:"Insert",exec:function(e){e.toggleOverwrite()},readOnly:!0},{name:"selecttostart",description:"Select to start",bindKey:s("Ctrl-Shift-Home","Command-Shift-Home|Command-Shift-Up"),exec:function(e){e.getSelection().selectFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotostart",description:"Go to start",bindKey:s("Ctrl-Home","Command-Home|Command-Up"),exec:function(e){e.navigateFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectup",description:"Select up",bindKey:s("Shift-Up","Shift-Up|Ctrl-Shift-P"),exec:function(e){e.getSelection().selectUp()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golineup",description:"Go line up",bindKey:s("Up","Up|Ctrl-P"),exec:function(e,t){e.navigateUp(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttoend",description:"Select to end",bindKey:s("Ctrl-Shift-End","Command-Shift-End|Command-Shift-Down"),exec:function(e){e.getSelection().selectFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotoend",description:"Go to end",bindKey:s("Ctrl-End","Command-End|Command-Down"),exec:function(e){e.navigateFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectdown",description:"Select down",bindKey:s("Shift-Down","Shift-Down|Ctrl-Shift-N"),exec:function(e){e.getSelection().selectDown()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golinedown",description:"Go line down",bindKey:s("Down","Down|Ctrl-N"),exec:function(e,t){e.navigateDown(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordleft",description:"Select word left",bindKey:s("Ctrl-Shift-Left","Option-Shift-Left"),exec:function(e){e.getSelection().selectWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordleft",description:"Go to word left",bindKey:s("Ctrl-Left","Option-Left"),exec:function(e){e.navigateWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolinestart",description:"Select to line start",bindKey:s("Alt-Shift-Left","Command-Shift-Left|Ctrl-Shift-A"),exec:function(e){e.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolinestart",description:"Go to line start",bindKey:s("Alt-Left|Home","Command-Left|Home|Ctrl-A"),exec:function(e){e.navigateLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectleft",description:"Select left",bindKey:s("Shift-Left","Shift-Left|Ctrl-Shift-B"),exec:function(e){e.getSelection().selectLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoleft",description:"Go to left",bindKey:s("Left","Left|Ctrl-B"),exec:function(e,t){e.navigateLeft(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordright",description:"Select word right",bindKey:s("Ctrl-Shift-Right","Option-Shift-Right"),exec:function(e){e.getSelection().selectWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordright",description:"Go to word right",bindKey:s("Ctrl-Right","Option-Right"),exec:function(e){e.navigateWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolineend",description:"Select to line end",bindKey:s("Alt-Shift-Right","Command-Shift-Right|Shift-End|Ctrl-Shift-E"),exec:function(e){e.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolineend",description:"Go to line end",bindKey:s("Alt-Right|End","Command-Right|End|Ctrl-E"),exec:function(e){e.navigateLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectright",description:"Select right",bindKey:s("Shift-Right","Shift-Right"),exec:function(e){e.getSelection().selectRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoright",description:"Go to right",bindKey:s("Right","Right|Ctrl-F"),exec:function(e,t){e.navigateRight(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectpagedown",description:"Select page down",bindKey:"Shift-PageDown",exec:function(e){e.selectPageDown()},readOnly:!0},{name:"pagedown",description:"Page down",bindKey:s(null,"Option-PageDown"),exec:function(e){e.scrollPageDown()},readOnly:!0},{name:"gotopagedown",description:"Go to page down",bindKey:s("PageDown","PageDown|Ctrl-V"),exec:function(e){e.gotoPageDown()},readOnly:!0},{name:"selectpageup",description:"Select page up",bindKey:"Shift-PageUp",exec:function(e){e.selectPageUp()},readOnly:!0},{name:"pageup",description:"Page up",bindKey:s(null,"Option-PageUp"),exec:function(e){e.scrollPageUp()},readOnly:!0},{name:"gotopageup",description:"Go to page up",bindKey:"PageUp",exec:function(e){e.gotoPageUp()},readOnly:!0},{name:"scrollup",description:"Scroll up",bindKey:s("Ctrl-Up",null),exec:function(e){e.renderer.scrollBy(0,-2*e.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"scrolldown",description:"Scroll down",bindKey:s("Ctrl-Down",null),exec:function(e){e.renderer.scrollBy(0,2*e.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"selectlinestart",description:"Select line start",bindKey:"Shift-Home",exec:function(e){e.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectlineend",description:"Select line end",bindKey:"Shift-End",exec:function(e){e.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"togglerecording",description:"Toggle recording",bindKey:s("Ctrl-Alt-E","Command-Option-E"),exec:function(e){e.commands.toggleRecording(e)},readOnly:!0},{name:"replaymacro",description:"Replay macro",bindKey:s("Ctrl-Shift-E","Command-Shift-E"),exec:function(e){e.commands.replay(e)},readOnly:!0},{name:"jumptomatching",description:"Jump to matching",bindKey:s("Ctrl-\\|Ctrl-P","Command-\\"),exec:function(e){e.jumpToMatching()},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"selecttomatching",description:"Select to matching",bindKey:s("Ctrl-Shift-\\|Ctrl-Shift-P","Command-Shift-\\"),exec:function(e){e.jumpToMatching(!0)},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"expandToMatching",description:"Expand to matching",bindKey:s("Ctrl-Shift-M","Ctrl-Shift-M"),exec:function(e){e.jumpToMatching(!0,!0)},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"passKeysToBrowser",description:"Pass keys to browser",bindKey:s(null,null),exec:function(){},passEvent:!0,readOnly:!0},{name:"copy",description:"Copy",exec:function(e){},readOnly:!0},{name:"cut",description:"Cut",exec:function(e){var t=e.$copyWithEmptySelection&&e.selection.isEmpty()?e.selection.getLineRange():e.selection.getRange();e._emit("cut",t),t.isEmpty()||e.session.remove(t),e.clearSelection()},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"paste",description:"Paste",exec:function(e,t){e.$handlePaste(t)},scrollIntoView:"cursor"},{name:"removeline",description:"Remove line",bindKey:s("Ctrl-D","Command-D"),exec:function(e){e.removeLines()},scrollIntoView:"cursor",multiSelectAction:"forEachLine"},{name:"duplicateSelection",description:"Duplicate selection",bindKey:s("Ctrl-Shift-D","Command-Shift-D"),exec:function(e){e.duplicateSelection()},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"sortlines",description:"Sort lines",bindKey:s("Ctrl-Alt-S","Command-Alt-S"),exec:function(e){e.sortLines()},scrollIntoView:"selection",multiSelectAction:"forEachLine"},{name:"togglecomment",description:"Toggle comment",bindKey:s("Ctrl-/","Command-/"),exec:function(e){e.toggleCommentLines()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"toggleBlockComment",description:"Toggle block comment",bindKey:s("Ctrl-Shift-/","Command-Shift-/"),exec:function(e){e.toggleBlockComment()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"modifyNumberUp",description:"Modify number up",bindKey:s("Ctrl-Shift-Up","Alt-Shift-Up"),exec:function(e){e.modifyNumber(1)},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"modifyNumberDown",description:"Modify number down",bindKey:s("Ctrl-Shift-Down","Alt-Shift-Down"),exec:function(e){e.modifyNumber(-1)},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"replace",description:"Replace",bindKey:s("Ctrl-H","Command-Option-F"),exec:function(e){r.loadModule("ace/ext/searchbox",(function(t){t.Search(e,!0)}))}},{name:"undo",description:"Undo",bindKey:s("Ctrl-Z","Command-Z"),exec:function(e){e.undo()}},{name:"redo",description:"Redo",bindKey:s("Ctrl-Shift-Z|Ctrl-Y","Command-Shift-Z|Command-Y"),exec:function(e){e.redo()}},{name:"copylinesup",description:"Copy lines up",bindKey:s("Alt-Shift-Up","Command-Option-Up"),exec:function(e){e.copyLinesUp()},scrollIntoView:"cursor"},{name:"movelinesup",description:"Move lines up",bindKey:s("Alt-Up","Option-Up"),exec:function(e){e.moveLinesUp()},scrollIntoView:"cursor"},{name:"copylinesdown",description:"Copy lines down",bindKey:s("Alt-Shift-Down","Command-Option-Down"),exec:function(e){e.copyLinesDown()},scrollIntoView:"cursor"},{name:"movelinesdown",description:"Move lines down",bindKey:s("Alt-Down","Option-Down"),exec:function(e){e.moveLinesDown()},scrollIntoView:"cursor"},{name:"del",description:"Delete",bindKey:s("Delete","Delete|Ctrl-D|Shift-Delete"),exec:function(e){e.remove("right")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"backspace",description:"Backspace",bindKey:s("Shift-Backspace|Backspace","Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"),exec:function(e){e.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"cut_or_delete",description:"Cut or delete",bindKey:s("Shift-Delete",null),exec:function(e){if(!e.selection.isEmpty())return!1;e.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestart",description:"Remove to line start",bindKey:s("Alt-Backspace","Command-Backspace"),exec:function(e){e.removeToLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineend",description:"Remove to line end",bindKey:s("Alt-Delete","Ctrl-K|Command-Delete"),exec:function(e){e.removeToLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestarthard",description:"Remove to line start hard",bindKey:s("Ctrl-Shift-Backspace",null),exec:function(e){var t=e.selection.getRange();t.start.column=0,e.session.remove(t)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineendhard",description:"Remove to line end hard",bindKey:s("Ctrl-Shift-Delete",null),exec:function(e){var t=e.selection.getRange();t.end.column=Number.MAX_VALUE,e.session.remove(t)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordleft",description:"Remove word left",bindKey:s("Ctrl-Backspace","Alt-Backspace|Ctrl-Alt-Backspace"),exec:function(e){e.removeWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordright",description:"Remove word right",bindKey:s("Ctrl-Delete","Alt-Delete"),exec:function(e){e.removeWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"outdent",description:"Outdent",bindKey:s("Shift-Tab","Shift-Tab"),exec:function(e){e.blockOutdent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"indent",description:"Indent",bindKey:s("Tab","Tab"),exec:function(e){e.indent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"blockoutdent",description:"Block outdent",bindKey:s("Ctrl-[","Ctrl-["),exec:function(e){e.blockOutdent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"blockindent",description:"Block indent",bindKey:s("Ctrl-]","Ctrl-]"),exec:function(e){e.blockIndent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"insertstring",description:"Insert string",exec:function(e,t){e.insert(t)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"inserttext",description:"Insert text",exec:function(e,t){e.insert(i.stringRepeat(t.text||"",t.times||1))},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"splitline",description:"Split line",bindKey:s(null,"Ctrl-O"),exec:function(e){e.splitLine()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"transposeletters",description:"Transpose letters",bindKey:s("Alt-Shift-X","Ctrl-T"),exec:function(e){e.transposeLetters()},multiSelectAction:function(e){e.transposeSelections(1)},scrollIntoView:"cursor"},{name:"touppercase",description:"To uppercase",bindKey:s("Ctrl-U","Ctrl-U"),exec:function(e){e.toUpperCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"tolowercase",description:"To lowercase",bindKey:s("Ctrl-Shift-U","Ctrl-Shift-U"),exec:function(e){e.toLowerCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"autoindent",description:"Auto Indent",bindKey:s(null,null),exec:function(e){e.autoIndent()},multiSelectAction:"forEachLine",scrollIntoView:"animate"},{name:"expandtoline",description:"Expand to line",bindKey:s("Ctrl-Shift-L","Command-Shift-L"),exec:function(e){var t=e.selection.getRange();t.start.column=t.end.column=0,t.end.row++,e.selection.setRange(t,!1)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"joinlines",description:"Join lines",bindKey:s(null,null),exec:function(e){for(var t=e.selection.isBackwards(),n=t?e.selection.getSelectionLead():e.selection.getSelectionAnchor(),r=t?e.selection.getSelectionAnchor():e.selection.getSelectionLead(),s=e.session.doc.getLine(n.row).length,a=e.session.doc.getTextRange(e.selection.getRange()).replace(/\n\s*/," ").length,l=e.session.doc.getLine(n.row),c=n.row+1;c<=r.row+1;c++){var u=i.stringTrimLeft(i.stringTrimRight(e.session.doc.getLine(c)));0!==u.length&&(u=" "+u),l+=u}r.row+1<e.session.doc.getLength()-1&&(l+=e.session.doc.getNewLineCharacter()),e.clearSelection(),e.session.doc.replace(new o(n.row,0,r.row+2,0),l),a>0?(e.selection.moveCursorTo(n.row,n.column),e.selection.selectTo(n.row,n.column+a)):(s=e.session.doc.getLine(n.row).length>s?s+1:s,e.selection.moveCursorTo(n.row,s))},multiSelectAction:"forEach",readOnly:!0},{name:"invertSelection",description:"Invert selection",bindKey:s(null,null),exec:function(e){var t=e.session.doc.getLength()-1,n=e.session.doc.getLine(t).length,i=e.selection.rangeList.ranges,r=[];i.length<1&&(i=[e.selection.getRange()]);for(var s=0;s<i.length;s++)s==i.length-1&&(i[s].end.row===t&&i[s].end.column===n||r.push(new o(i[s].end.row,i[s].end.column,t,n))),0===s?0===i[s].start.row&&0===i[s].start.column||r.push(new o(0,0,i[s].start.row,i[s].start.column)):r.push(new o(i[s-1].end.row,i[s-1].end.column,i[s].start.row,i[s].start.column));e.exitMultiSelectMode(),e.clearSelection();for(s=0;s<r.length;s++)e.selection.addRange(r[s],!1)},readOnly:!0,scrollIntoView:"none"},{name:"addLineAfter",exec:function(e){e.selection.clearSelection(),e.navigateLineEnd(),e.insert("\n")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"addLineBefore",exec:function(e){e.selection.clearSelection();var t=e.getCursorPosition();e.selection.moveTo(t.row-1,Number.MAX_VALUE),e.insert("\n"),0===t.row&&e.navigateUp()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"openCommandPallete",description:"Open command pallete",bindKey:s("F1","F1"),exec:function(e){e.prompt({$type:"commands"})},readOnly:!0},{name:"modeSelect",description:"Change language mode...",bindKey:s(null,null),exec:function(e){e.prompt({$type:"modes"})},readOnly:!0}];for(var a=1;a<9;a++)t.commands.push({name:"foldToLevel"+a,description:"Fold To Level "+a,level:a,exec:function(e){e.session.foldToLevel(this.level)},scrollIntoView:"center",readOnly:!0})})),ace.define("ace/editor",["require","exports","module","ace/lib/fixoldbrowsers","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/useragent","ace/keyboard/textinput","ace/mouse/mouse_handler","ace/mouse/fold_handler","ace/keyboard/keybinding","ace/edit_session","ace/search","ace/range","ace/lib/event_emitter","ace/commands/command_manager","ace/commands/default_commands","ace/config","ace/token_iterator","ace/clipboard"],(function(e,t,n){"use strict";e("./lib/fixoldbrowsers");var i=e("./lib/oop"),r=e("./lib/dom"),o=e("./lib/lang"),s=e("./lib/useragent"),a=e("./keyboard/textinput").TextInput,l=e("./mouse/mouse_handler").MouseHandler,c=e("./mouse/fold_handler").FoldHandler,u=e("./keyboard/keybinding").KeyBinding,h=e("./edit_session").EditSession,d=e("./search").Search,f=e("./range").Range,p=e("./lib/event_emitter").EventEmitter,g=e("./commands/command_manager").CommandManager,m=e("./commands/default_commands").commands,v=e("./config"),b=e("./token_iterator").TokenIterator,y=e("./clipboard"),w=function(e,t,n){this.$toDestroy=[];var i=e.getContainerElement();this.container=i,this.renderer=e,this.id="editor"+ ++w.$uid,this.commands=new g(s.isMac?"mac":"win",m),"object"==typeof document&&(this.textInput=new a(e.getTextAreaContainer(),this),this.renderer.textarea=this.textInput.getElement(),this.$mouseHandler=new l(this),new c(this)),this.keyBinding=new u(this),this.$search=(new d).set({wrap:!0}),this.$historyTracker=this.$historyTracker.bind(this),this.commands.on("exec",this.$historyTracker),this.$initOperationListeners(),this._$emitInputEvent=o.delayedCall(function(){this._signal("input",{}),this.session&&this.session.bgTokenizer&&this.session.bgTokenizer.scheduleStart()}.bind(this)),this.on("change",(function(e,t){t._$emitInputEvent.schedule(31)})),this.setSession(t||n&&n.session||new h("")),v.resetOptions(this),n&&this.setOptions(n),v._signal("editor",this)};w.$uid=0,function(){i.implement(this,p),this.$initOperationListeners=function(){this.commands.on("exec",this.startOperation.bind(this),!0),this.commands.on("afterExec",this.endOperation.bind(this),!0),this.$opResetTimer=o.delayedCall(this.endOperation.bind(this,!0)),this.on("change",function(){this.curOp||(this.startOperation(),this.curOp.selectionBefore=this.$lastSel),this.curOp.docChanged=!0}.bind(this),!0),this.on("changeSelection",function(){this.curOp||(this.startOperation(),this.curOp.selectionBefore=this.$lastSel),this.curOp.selectionChanged=!0}.bind(this),!0)},this.curOp=null,this.prevOp={},this.startOperation=function(e){if(this.curOp){if(!e||this.curOp.command)return;this.prevOp=this.curOp}e||(this.previousCommand=null,e={}),this.$opResetTimer.schedule(),this.curOp=this.session.curOp={command:e.command||{},args:e.args,scrollTop:this.renderer.scrollTop},this.curOp.selectionBefore=this.selection.toJSON()},this.endOperation=function(e){if(this.curOp&&this.session){if(e&&!1===e.returnValue||!this.session)return this.curOp=null;if(1==e&&this.curOp.command&&"mouse"==this.curOp.command.name)return;if(this._signal("beforeEndOperation"),!this.curOp)return;var t=this.curOp.command,n=t&&t.scrollIntoView;if(n){switch(n){case"center-animate":n="animate";case"center":this.renderer.scrollCursorIntoView(null,.5);break;case"animate":case"cursor":this.renderer.scrollCursorIntoView();break;case"selectionPart":var i=this.selection.getRange(),r=this.renderer.layerConfig;(i.start.row>=r.lastRow||i.end.row<=r.firstRow)&&this.renderer.scrollSelectionIntoView(this.selection.anchor,this.selection.lead)}"animate"==n&&this.renderer.animateScrolling(this.curOp.scrollTop)}var o=this.selection.toJSON();this.curOp.selectionAfter=o,this.$lastSel=this.selection.toJSON(),this.session.getUndoManager().addSelection(o),this.prevOp=this.curOp,this.curOp=null}},this.$mergeableCommands=["backspace","del","insertstring"],this.$historyTracker=function(e){if(this.$mergeUndoDeltas){var t=this.prevOp,n=this.$mergeableCommands,i=t.command&&e.command.name==t.command.name;if("insertstring"==e.command.name){var r=e.args;void 0===this.mergeNextCommand&&(this.mergeNextCommand=!0),i=i&&this.mergeNextCommand&&(!/\s/.test(r)||/\s/.test(t.args)),this.mergeNextCommand=!0}else i=i&&-1!==n.indexOf(e.command.name);"always"!=this.$mergeUndoDeltas&&Date.now()-this.sequenceStartTime>2e3&&(i=!1),i?this.session.mergeUndoDeltas=!0:-1!==n.indexOf(e.command.name)&&(this.sequenceStartTime=Date.now())}},this.setKeyboardHandler=function(e,t){if(e&&"string"==typeof e&&"ace"!=e){this.$keybindingId=e;var n=this;v.loadModule(["keybinding",e],(function(i){n.$keybindingId==e&&n.keyBinding.setKeyboardHandler(i&&i.handler),t&&t()}))}else this.$keybindingId=null,this.keyBinding.setKeyboardHandler(e),t&&t()},this.getKeyboardHandler=function(){return this.keyBinding.getKeyboardHandler()},this.setSession=function(e){if(this.session!=e){this.curOp&&this.endOperation(),this.curOp={};var t=this.session;if(t){this.session.off("change",this.$onDocumentChange),this.session.off("changeMode",this.$onChangeMode),this.session.off("tokenizerUpdate",this.$onTokenizerUpdate),this.session.off("changeTabSize",this.$onChangeTabSize),this.session.off("changeWrapLimit",this.$onChangeWrapLimit),this.session.off("changeWrapMode",this.$onChangeWrapMode),this.session.off("changeFold",this.$onChangeFold),this.session.off("changeFrontMarker",this.$onChangeFrontMarker),this.session.off("changeBackMarker",this.$onChangeBackMarker),this.session.off("changeBreakpoint",this.$onChangeBreakpoint),this.session.off("changeAnnotation",this.$onChangeAnnotation),this.session.off("changeOverwrite",this.$onCursorChange),this.session.off("changeScrollTop",this.$onScrollTopChange),this.session.off("changeScrollLeft",this.$onScrollLeftChange);var n=this.session.getSelection();n.off("changeCursor",this.$onCursorChange),n.off("changeSelection",this.$onSelectionChange)}this.session=e,e?(this.$onDocumentChange=this.onDocumentChange.bind(this),e.on("change",this.$onDocumentChange),this.renderer.setSession(e),this.$onChangeMode=this.onChangeMode.bind(this),e.on("changeMode",this.$onChangeMode),this.$onTokenizerUpdate=this.onTokenizerUpdate.bind(this),e.on("tokenizerUpdate",this.$onTokenizerUpdate),this.$onChangeTabSize=this.renderer.onChangeTabSize.bind(this.renderer),e.on("changeTabSize",this.$onChangeTabSize),this.$onChangeWrapLimit=this.onChangeWrapLimit.bind(this),e.on("changeWrapLimit",this.$onChangeWrapLimit),this.$onChangeWrapMode=this.onChangeWrapMode.bind(this),e.on("changeWrapMode",this.$onChangeWrapMode),this.$onChangeFold=this.onChangeFold.bind(this),e.on("changeFold",this.$onChangeFold),this.$onChangeFrontMarker=this.onChangeFrontMarker.bind(this),this.session.on("changeFrontMarker",this.$onChangeFrontMarker),this.$onChangeBackMarker=this.onChangeBackMarker.bind(this),this.session.on("changeBackMarker",this.$onChangeBackMarker),this.$onChangeBreakpoint=this.onChangeBreakpoint.bind(this),this.session.on("changeBreakpoint",this.$onChangeBreakpoint),this.$onChangeAnnotation=this.onChangeAnnotation.bind(this),this.session.on("changeAnnotation",this.$onChangeAnnotation),this.$onCursorChange=this.onCursorChange.bind(this),this.session.on("changeOverwrite",this.$onCursorChange),this.$onScrollTopChange=this.onScrollTopChange.bind(this),this.session.on("changeScrollTop",this.$onScrollTopChange),this.$onScrollLeftChange=this.onScrollLeftChange.bind(this),this.session.on("changeScrollLeft",this.$onScrollLeftChange),this.selection=e.getSelection(),this.selection.on("changeCursor",this.$onCursorChange),this.$onSelectionChange=this.onSelectionChange.bind(this),this.selection.on("changeSelection",this.$onSelectionChange),this.onChangeMode(),this.onCursorChange(),this.onScrollTopChange(),this.onScrollLeftChange(),this.onSelectionChange(),this.onChangeFrontMarker(),this.onChangeBackMarker(),this.onChangeBreakpoint(),this.onChangeAnnotation(),this.session.getUseWrapMode()&&this.renderer.adjustWrapLimit(),this.renderer.updateFull()):(this.selection=null,this.renderer.setSession(e)),this._signal("changeSession",{session:e,oldSession:t}),this.curOp=null,t&&t._signal("changeEditor",{oldEditor:this}),e&&e._signal("changeEditor",{editor:this}),e&&e.bgTokenizer&&e.bgTokenizer.scheduleStart()}},this.getSession=function(){return this.session},this.setValue=function(e,t){return this.session.doc.setValue(e),t?1==t?this.navigateFileEnd():-1==t&&this.navigateFileStart():this.selectAll(),e},this.getValue=function(){return this.session.getValue()},this.getSelection=function(){return this.selection},this.resize=function(e){this.renderer.onResize(e)},this.setTheme=function(e,t){this.renderer.setTheme(e,t)},this.getTheme=function(){return this.renderer.getTheme()},this.setStyle=function(e){this.renderer.setStyle(e)},this.unsetStyle=function(e){this.renderer.unsetStyle(e)},this.getFontSize=function(){return this.getOption("fontSize")||r.computedStyle(this.container).fontSize},this.setFontSize=function(e){this.setOption("fontSize",e)},this.$highlightBrackets=function(){if(!this.$highlightPending){var e=this;this.$highlightPending=!0,setTimeout((function(){e.$highlightPending=!1;var t=e.session;if(t&&t.bgTokenizer){t.$bracketHighlight&&(t.$bracketHighlight.markerIds.forEach((function(e){t.removeMarker(e)})),t.$bracketHighlight=null);var n=t.getMatchingBracketRanges(e.getCursorPosition());if(!n&&t.$mode.getMatching&&(n=t.$mode.getMatching(e.session)),n){var i="ace_bracket";Array.isArray(n)?1==n.length&&(i="ace_error_bracket"):n=[n],2==n.length&&(0==f.comparePoints(n[0].end,n[1].start)?n=[f.fromPoints(n[0].start,n[1].end)]:0==f.comparePoints(n[0].start,n[1].end)&&(n=[f.fromPoints(n[1].start,n[0].end)])),t.$bracketHighlight={ranges:n,markerIds:n.map((function(e){return t.addMarker(e,i,"text")}))}}}}),50)}},this.$highlightTags=function(){if(!this.$highlightTagPending){var e=this;this.$highlightTagPending=!0,setTimeout((function(){e.$highlightTagPending=!1;var t=e.session;if(t&&t.bgTokenizer){var n=e.getCursorPosition(),i=new b(e.session,n.row,n.column),r=i.getCurrentToken();if(!r||!/\b(?:tag-open|tag-name)/.test(r.type))return t.removeMarker(t.$tagHighlight),void(t.$tagHighlight=null);if(-1===r.type.indexOf("tag-open")||(r=i.stepForward())){var o=r.value,s=r.value,a=0,l=i.stepBackward();if("<"===l.value)do{l=r,(r=i.stepForward())&&(-1!==r.type.indexOf("tag-name")?o===(s=r.value)&&("<"===l.value?a++:"</"===l.value&&a--):o===s&&"/>"===r.value&&a--)}while(r&&a>=0);else{do{if(r=l,l=i.stepBackward(),r)if(-1!==r.type.indexOf("tag-name"))o===r.value&&("<"===l.value?a++:"</"===l.value&&a--);else if("/>"===r.value){for(var c=0,u=l;u;){if(-1!==u.type.indexOf("tag-name")&&u.value===o){a--;break}if("<"===u.value)break;u=i.stepBackward(),c++}for(var h=0;h<c;h++)i.stepForward()}}while(l&&a<=0);i.stepForward()}if(!r)return t.removeMarker(t.$tagHighlight),void(t.$tagHighlight=null);var d=i.getCurrentTokenRow(),p=i.getCurrentTokenColumn(),g=new f(d,p,d,p+r.value.length),m=t.$backMarkers[t.$tagHighlight];t.$tagHighlight&&null!=m&&0!==g.compareRange(m.range)&&(t.removeMarker(t.$tagHighlight),t.$tagHighlight=null),t.$tagHighlight||(t.$tagHighlight=t.addMarker(g,"ace_bracket","text"))}}}),50)}},this.focus=function(){var e=this;setTimeout((function(){e.isFocused()||e.textInput.focus()})),this.textInput.focus()},this.isFocused=function(){return this.textInput.isFocused()},this.blur=function(){this.textInput.blur()},this.onFocus=function(e){this.$isFocused||(this.$isFocused=!0,this.renderer.showCursor(),this.renderer.visualizeFocus(),this._emit("focus",e))},this.onBlur=function(e){this.$isFocused&&(this.$isFocused=!1,this.renderer.hideCursor(),this.renderer.visualizeBlur(),this._emit("blur",e))},this.$cursorChange=function(){this.renderer.updateCursor(),this.$highlightBrackets(),this.$highlightTags(),this.$updateHighlightActiveLine()},this.onDocumentChange=function(e){var t=this.session.$useWrapMode,n=e.start.row==e.end.row?e.end.row:1/0;this.renderer.updateLines(e.start.row,n,t),this._signal("change",e),this.$cursorChange()},this.onTokenizerUpdate=function(e){var t=e.data;this.renderer.updateLines(t.first,t.last)},this.onScrollTopChange=function(){this.renderer.scrollToY(this.session.getScrollTop())},this.onScrollLeftChange=function(){this.renderer.scrollToX(this.session.getScrollLeft())},this.onCursorChange=function(){this.$cursorChange(),this._signal("changeSelection")},this.$updateHighlightActiveLine=function(){var e,t=this.getSession();if(this.$highlightActiveLine&&("line"==this.$selectionStyle&&this.selection.isMultiLine()||(e=this.getCursorPosition()),this.renderer.theme&&this.renderer.theme.$selectionColorConflict&&!this.selection.isEmpty()&&(e=!1),!this.renderer.$maxLines||1!==this.session.getLength()||this.renderer.$minLines>1||(e=!1)),t.$highlightLineMarker&&!e)t.removeMarker(t.$highlightLineMarker.id),t.$highlightLineMarker=null;else if(!t.$highlightLineMarker&&e){var n=new f(e.row,e.column,e.row,1/0);n.id=t.addMarker(n,"ace_active-line","screenLine"),t.$highlightLineMarker=n}else e&&(t.$highlightLineMarker.start.row=e.row,t.$highlightLineMarker.end.row=e.row,t.$highlightLineMarker.start.column=e.column,t._signal("changeBackMarker"))},this.onSelectionChange=function(e){var t=this.session;if(t.$selectionMarker&&t.removeMarker(t.$selectionMarker),t.$selectionMarker=null,this.selection.isEmpty())this.$updateHighlightActiveLine();else{var n=this.selection.getRange(),i=this.getSelectionStyle();t.$selectionMarker=t.addMarker(n,"ace_selection",i)}var r=this.$highlightSelectedWord&&this.$getSelectionHighLightRegexp();this.session.highlight(r),this._signal("changeSelection")},this.$getSelectionHighLightRegexp=function(){var e=this.session,t=this.getSelectionRange();if(!t.isEmpty()&&!t.isMultiLine()){var n=t.start.column,i=t.end.column,r=e.getLine(t.start.row),o=r.substring(n,i);if(!(o.length>5e3)&&/[\w\d]/.test(o)){var s=this.$search.$assembleRegExp({wholeWord:!0,caseSensitive:!0,needle:o}),a=r.substring(n-1,i+1);if(s.test(a))return s}}},this.onChangeFrontMarker=function(){this.renderer.updateFrontMarkers()},this.onChangeBackMarker=function(){this.renderer.updateBackMarkers()},this.onChangeBreakpoint=function(){this.renderer.updateBreakpoints()},this.onChangeAnnotation=function(){this.renderer.setAnnotations(this.session.getAnnotations())},this.onChangeMode=function(e){this.renderer.updateText(),this._emit("changeMode",e)},this.onChangeWrapLimit=function(){this.renderer.updateFull()},this.onChangeWrapMode=function(){this.renderer.onResize(!0)},this.onChangeFold=function(){this.$updateHighlightActiveLine(),this.renderer.updateFull()},this.getSelectedText=function(){return this.session.getTextRange(this.getSelectionRange())},this.getCopyText=function(){var e=this.getSelectedText(),t=this.session.doc.getNewLineCharacter(),n=!1;if(!e&&this.$copyWithEmptySelection){n=!0;for(var i=this.selection.getAllRanges(),r=0;r<i.length;r++){var o=i[r];r&&i[r-1].start.row==o.start.row||(e+=this.session.getLine(o.start.row)+t)}}var s={text:e};return this._signal("copy",s),y.lineMode=n?s.text:"",s.text},this.onCopy=function(){this.commands.exec("copy",this)},this.onCut=function(){this.commands.exec("cut",this)},this.onPaste=function(e,t){var n={text:e,event:t};this.commands.exec("paste",this,n)},this.$handlePaste=function(e){"string"==typeof e&&(e={text:e}),this._signal("paste",e);var t=e.text,n=t==y.lineMode,i=this.session;if(!this.inMultiSelectMode||this.inVirtualSelectionMode)n?i.insert({row:this.selection.lead.row,column:0},t):this.insert(t);else if(n)this.selection.rangeList.ranges.forEach((function(e){i.insert({row:e.start.row,column:0},t)}));else{var r=t.split(/\r\n|\r|\n/),o=this.selection.rangeList.ranges,s=!(2!=r.length||r[0]&&r[1]);if(r.length!=o.length||s)return this.commands.exec("insertstring",this,t);for(var a=o.length;a--;){var l=o[a];l.isEmpty()||i.remove(l),i.insert(l.start,r[a])}}},this.execCommand=function(e,t){return this.commands.exec(e,this,t)},this.insert=function(e,t){var n=this.session,i=n.getMode(),r=this.getCursorPosition();if(this.getBehavioursEnabled()&&!t){var o=i.transformAction(n.getState(r.row),"insertion",this,n,e);o&&(e!==o.text&&(this.inVirtualSelectionMode||(this.session.mergeUndoDeltas=!1,this.mergeNextCommand=!1)),e=o.text)}if("\t"==e&&(e=this.session.getTabString()),this.selection.isEmpty()){if(this.session.getOverwrite()&&-1==e.indexOf("\n")){(s=new f.fromPoints(r,r)).end.column+=e.length,this.session.remove(s)}}else{var s=this.getSelectionRange();r=this.session.remove(s),this.clearSelection()}if("\n"==e||"\r\n"==e){var a=n.getLine(r.row);if(r.column>a.search(/\S|$/)){var l=a.substr(r.column).search(/\S|$/);n.doc.removeInLine(r.row,r.column,r.column+l)}}this.clearSelection();var c=r.column,u=n.getState(r.row),h=(a=n.getLine(r.row),i.checkOutdent(u,a,e));if(n.insert(r,e),o&&o.selection&&(2==o.selection.length?this.selection.setSelectionRange(new f(r.row,c+o.selection[0],r.row,c+o.selection[1])):this.selection.setSelectionRange(new f(r.row+o.selection[0],o.selection[1],r.row+o.selection[2],o.selection[3]))),this.$enableAutoIndent){if(n.getDocument().isNewLine(e)){var d=i.getNextLineIndent(u,a.slice(0,r.column),n.getTabString());n.insert({row:r.row+1,column:0},d)}h&&i.autoOutdent(u,n,r.row)}},this.autoIndent=function(){var e,t,n=this.session,i=n.getMode();if(this.selection.isEmpty())e=0,t=n.doc.getLength()-1;else{var r=this.getSelectionRange();e=r.start.row,t=r.end.row}for(var o,s,a,l="",c="",u="",h=n.getTabString(),d=e;d<=t;d++)d>0&&(l=n.getState(d-1),c=n.getLine(d-1),u=i.getNextLineIndent(l,c,h)),o=n.getLine(d),u!==(s=i.$getIndent(o))&&(s.length>0&&(a=new f(d,0,d,s.length),n.remove(a)),u.length>0&&n.insert({row:d,column:0},u)),i.autoOutdent(l,n,d)},this.onTextInput=function(e,t){if(!t)return this.keyBinding.onTextInput(e);this.startOperation({command:{name:"insertstring"}});var n=this.applyComposition.bind(this,e,t);this.selection.rangeCount?this.forEachSelection(n):n(),this.endOperation()},this.applyComposition=function(e,t){var n;(t.extendLeft||t.extendRight)&&((n=this.selection.getRange()).start.column-=t.extendLeft,n.end.column+=t.extendRight,n.start.column<0&&(n.start.row--,n.start.column+=this.session.getLine(n.start.row).length+1),this.selection.setRange(n),e||n.isEmpty()||this.remove());(!e&&this.selection.isEmpty()||this.insert(e,!0),t.restoreStart||t.restoreEnd)&&((n=this.selection.getRange()).start.column-=t.restoreStart,n.end.column-=t.restoreEnd,this.selection.setRange(n))},this.onCommandKey=function(e,t,n){return this.keyBinding.onCommandKey(e,t,n)},this.setOverwrite=function(e){this.session.setOverwrite(e)},this.getOverwrite=function(){return this.session.getOverwrite()},this.toggleOverwrite=function(){this.session.toggleOverwrite()},this.setScrollSpeed=function(e){this.setOption("scrollSpeed",e)},this.getScrollSpeed=function(){return this.getOption("scrollSpeed")},this.setDragDelay=function(e){this.setOption("dragDelay",e)},this.getDragDelay=function(){return this.getOption("dragDelay")},this.setSelectionStyle=function(e){this.setOption("selectionStyle",e)},this.getSelectionStyle=function(){return this.getOption("selectionStyle")},this.setHighlightActiveLine=function(e){this.setOption("highlightActiveLine",e)},this.getHighlightActiveLine=function(){return this.getOption("highlightActiveLine")},this.setHighlightGutterLine=function(e){this.setOption("highlightGutterLine",e)},this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},this.setHighlightSelectedWord=function(e){this.setOption("highlightSelectedWord",e)},this.getHighlightSelectedWord=function(){return this.$highlightSelectedWord},this.setAnimatedScroll=function(e){this.renderer.setAnimatedScroll(e)},this.getAnimatedScroll=function(){return this.renderer.getAnimatedScroll()},this.setShowInvisibles=function(e){this.renderer.setShowInvisibles(e)},this.getShowInvisibles=function(){return this.renderer.getShowInvisibles()},this.setDisplayIndentGuides=function(e){this.renderer.setDisplayIndentGuides(e)},this.getDisplayIndentGuides=function(){return this.renderer.getDisplayIndentGuides()},this.setShowPrintMargin=function(e){this.renderer.setShowPrintMargin(e)},this.getShowPrintMargin=function(){return this.renderer.getShowPrintMargin()},this.setPrintMarginColumn=function(e){this.renderer.setPrintMarginColumn(e)},this.getPrintMarginColumn=function(){return this.renderer.getPrintMarginColumn()},this.setReadOnly=function(e){this.setOption("readOnly",e)},this.getReadOnly=function(){return this.getOption("readOnly")},this.setBehavioursEnabled=function(e){this.setOption("behavioursEnabled",e)},this.getBehavioursEnabled=function(){return this.getOption("behavioursEnabled")},this.setWrapBehavioursEnabled=function(e){this.setOption("wrapBehavioursEnabled",e)},this.getWrapBehavioursEnabled=function(){return this.getOption("wrapBehavioursEnabled")},this.setShowFoldWidgets=function(e){this.setOption("showFoldWidgets",e)},this.getShowFoldWidgets=function(){return this.getOption("showFoldWidgets")},this.setFadeFoldWidgets=function(e){this.setOption("fadeFoldWidgets",e)},this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},this.remove=function(e){this.selection.isEmpty()&&("left"==e?this.selection.selectLeft():this.selection.selectRight());var t=this.getSelectionRange();if(this.getBehavioursEnabled()){var n=this.session,i=n.getState(t.start.row),r=n.getMode().transformAction(i,"deletion",this,n,t);if(0===t.end.column){var o=n.getTextRange(t);if("\n"==o[o.length-1]){var s=n.getLine(t.end.row);/^\s+$/.test(s)&&(t.end.column=s.length)}}r&&(t=r)}this.session.remove(t),this.clearSelection()},this.removeWordRight=function(){this.selection.isEmpty()&&this.selection.selectWordRight(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeWordLeft=function(){this.selection.isEmpty()&&this.selection.selectWordLeft(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeToLineStart=function(){this.selection.isEmpty()&&this.selection.selectLineStart(),this.selection.isEmpty()&&this.selection.selectLeft(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeToLineEnd=function(){this.selection.isEmpty()&&this.selection.selectLineEnd();var e=this.getSelectionRange();e.start.column==e.end.column&&e.start.row==e.end.row&&(e.end.column=0,e.end.row++),this.session.remove(e),this.clearSelection()},this.splitLine=function(){this.selection.isEmpty()||(this.session.remove(this.getSelectionRange()),this.clearSelection());var e=this.getCursorPosition();this.insert("\n"),this.moveCursorToPosition(e)},this.transposeLetters=function(){if(this.selection.isEmpty()){var e=this.getCursorPosition(),t=e.column;if(0!==t){var n,i,r=this.session.getLine(e.row);t<r.length?(n=r.charAt(t)+r.charAt(t-1),i=new f(e.row,t-1,e.row,t+1)):(n=r.charAt(t-1)+r.charAt(t-2),i=new f(e.row,t-2,e.row,t)),this.session.replace(i,n),this.session.selection.moveToPosition(i.end)}}},this.toLowerCase=function(){var e=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var t=this.getSelectionRange(),n=this.session.getTextRange(t);this.session.replace(t,n.toLowerCase()),this.selection.setSelectionRange(e)},this.toUpperCase=function(){var e=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var t=this.getSelectionRange(),n=this.session.getTextRange(t);this.session.replace(t,n.toUpperCase()),this.selection.setSelectionRange(e)},this.indent=function(){var e=this.session,t=this.getSelectionRange();if(!(t.start.row<t.end.row)){if(t.start.column<t.end.column){var n=e.getTextRange(t);if(!/^\s+$/.test(n)){u=this.$getSelectedRows();return void e.indentRows(u.first,u.last,"\t")}}var i=e.getLine(t.start.row),r=t.start,s=e.getTabSize(),a=e.documentToScreenColumn(r.row,r.column);if(this.session.getUseSoftTabs())var l=s-a%s,c=o.stringRepeat(" ",l);else{for(l=a%s;" "==i[t.start.column-1]&&l;)t.start.column--,l--;this.selection.setSelectionRange(t),c="\t"}return this.insert(c)}var u=this.$getSelectedRows();e.indentRows(u.first,u.last,"\t")},this.blockIndent=function(){var e=this.$getSelectedRows();this.session.indentRows(e.first,e.last,"\t")},this.blockOutdent=function(){var e=this.session.getSelection();this.session.outdentRows(e.getRange())},this.sortLines=function(){for(var e=this.$getSelectedRows(),t=this.session,n=[],i=e.first;i<=e.last;i++)n.push(t.getLine(i));n.sort((function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0}));var r=new f(0,0,0,0);for(i=e.first;i<=e.last;i++){var o=t.getLine(i);r.start.row=i,r.end.row=i,r.end.column=o.length,t.replace(r,n[i-e.first])}},this.toggleCommentLines=function(){var e=this.session.getState(this.getCursorPosition().row),t=this.$getSelectedRows();this.session.getMode().toggleCommentLines(e,this.session,t.first,t.last)},this.toggleBlockComment=function(){var e=this.getCursorPosition(),t=this.session.getState(e.row),n=this.getSelectionRange();this.session.getMode().toggleBlockComment(t,this.session,n,e)},this.getNumberAt=function(e,t){var n=/[\-]?[0-9]+(?:\.[0-9]+)?/g;n.lastIndex=0;for(var i=this.session.getLine(e);n.lastIndex<t;){var r=n.exec(i);if(r.index<=t&&r.index+r[0].length>=t)return{value:r[0],start:r.index,end:r.index+r[0].length}}return null},this.modifyNumber=function(e){var t=this.selection.getCursor().row,n=this.selection.getCursor().column,i=new f(t,n-1,t,n),r=this.session.getTextRange(i);if(!isNaN(parseFloat(r))&&isFinite(r)){var o=this.getNumberAt(t,n);if(o){var s=o.value.indexOf(".")>=0?o.start+o.value.indexOf(".")+1:o.end,a=o.start+o.value.length-s,l=parseFloat(o.value);l*=Math.pow(10,a),s!==o.end&&n<s?e*=Math.pow(10,o.end-n-1):e*=Math.pow(10,o.end-n),l+=e;var c=(l/=Math.pow(10,a)).toFixed(a),u=new f(t,o.start,t,o.end);this.session.replace(u,c),this.moveCursorTo(t,Math.max(o.start+1,n+c.length-o.value.length))}}else this.toggleWord()},this.$toggleWordPairs=[["first","last"],["true","false"],["yes","no"],["width","height"],["top","bottom"],["right","left"],["on","off"],["x","y"],["get","set"],["max","min"],["horizontal","vertical"],["show","hide"],["add","remove"],["up","down"],["before","after"],["even","odd"],["in","out"],["inside","outside"],["next","previous"],["increase","decrease"],["attach","detach"],["&&","||"],["==","!="]],this.toggleWord=function(){var e=this.selection.getCursor().row,t=this.selection.getCursor().column;this.selection.selectWord();var n=this.getSelectedText(),i=this.selection.getWordRange().start.column,r=n.replace(/([a-z]+|[A-Z]+)(?=[A-Z_]|$)/g,"$1 ").split(/\s/),s=t-i-1;s<0&&(s=0);var a=0,l=0,c=this;n.match(/[A-Za-z0-9_]+/)&&r.forEach((function(t,r){l=a+t.length,s>=a&&s<=l&&(n=t,c.selection.clearSelection(),c.moveCursorTo(e,a+i),c.selection.selectTo(e,l+i)),a=l}));for(var u,h=this.$toggleWordPairs,d=0;d<h.length;d++)for(var f=h[d],p=0;p<=1;p++){var g=+!p,m=n.match(new RegExp("^\\s?_?("+o.escapeRegExp(f[p])+")\\s?$","i"));if(m)n.match(new RegExp("([_]|^|\\s)("+o.escapeRegExp(m[1])+")($|\\s)","g"))&&(u=n.replace(new RegExp(o.escapeRegExp(f[p]),"i"),(function(e){var t=f[g];return e.toUpperCase()==e?t=t.toUpperCase():e.charAt(0).toUpperCase()==e.charAt(0)&&(t=t.substr(0,0)+f[g].charAt(0).toUpperCase()+t.substr(1)),t})),this.insert(u),u="")}},this.removeLines=function(){var e=this.$getSelectedRows();this.session.removeFullLines(e.first,e.last),this.clearSelection()},this.duplicateSelection=function(){var e=this.selection,t=this.session,n=e.getRange(),i=e.isBackwards();if(n.isEmpty()){var r=n.start.row;t.duplicateLines(r,r)}else{var o=i?n.start:n.end,s=t.insert(o,t.getTextRange(n),!1);n.start=o,n.end=s,e.setSelectionRange(n,i)}},this.moveLinesDown=function(){this.$moveLines(1,!1)},this.moveLinesUp=function(){this.$moveLines(-1,!1)},this.moveText=function(e,t,n){return this.session.moveText(e,t,n)},this.copyLinesUp=function(){this.$moveLines(-1,!0)},this.copyLinesDown=function(){this.$moveLines(1,!0)},this.$moveLines=function(e,t){var n,i,r=this.selection;if(!r.inMultiSelectMode||this.inVirtualSelectionMode){var o=r.toOrientedRange();n=this.$getSelectedRows(o),i=this.session.$moveLines(n.first,n.last,t?0:e),t&&-1==e&&(i=0),o.moveBy(i,0),r.fromOrientedRange(o)}else{var s=r.rangeList.ranges;r.rangeList.detach(this.session),this.inVirtualSelectionMode=!0;for(var a=0,l=0,c=s.length,u=0;u<c;u++){var h=u;s[u].moveBy(a,0);for(var d=(n=this.$getSelectedRows(s[u])).first,f=n.last;++u<c;){l&&s[u].moveBy(l,0);var p=this.$getSelectedRows(s[u]);if(t&&p.first!=f)break;if(!t&&p.first>f+1)break;f=p.last}for(u--,a=this.session.$moveLines(d,f,t?0:e),t&&-1==e&&(h=u+1);h<=u;)s[h].moveBy(a,0),h++;t||(a=0),l+=a}r.fromOrientedRange(r.ranges[0]),r.rangeList.attach(this.session),this.inVirtualSelectionMode=!1}},this.$getSelectedRows=function(e){return e=(e||this.getSelectionRange()).collapseRows(),{first:this.session.getRowFoldStart(e.start.row),last:this.session.getRowFoldEnd(e.end.row)}},this.onCompositionStart=function(e){this.renderer.showComposition(e)},this.onCompositionUpdate=function(e){this.renderer.setCompositionText(e)},this.onCompositionEnd=function(){this.renderer.hideComposition()},this.getFirstVisibleRow=function(){return this.renderer.getFirstVisibleRow()},this.getLastVisibleRow=function(){return this.renderer.getLastVisibleRow()},this.isRowVisible=function(e){return e>=this.getFirstVisibleRow()&&e<=this.getLastVisibleRow()},this.isRowFullyVisible=function(e){return e>=this.renderer.getFirstFullyVisibleRow()&&e<=this.renderer.getLastFullyVisibleRow()},this.$getVisibleRowCount=function(){return this.renderer.getScrollBottomRow()-this.renderer.getScrollTopRow()+1},this.$moveByPage=function(e,t){var n=this.renderer,i=this.renderer.layerConfig,r=e*Math.floor(i.height/i.lineHeight);!0===t?this.selection.$moveSelection((function(){this.moveCursorBy(r,0)})):!1===t&&(this.selection.moveCursorBy(r,0),this.selection.clearSelection());var o=n.scrollTop;n.scrollBy(0,r*i.lineHeight),null!=t&&n.scrollCursorIntoView(null,.5),n.animateScrolling(o)},this.selectPageDown=function(){this.$moveByPage(1,!0)},this.selectPageUp=function(){this.$moveByPage(-1,!0)},this.gotoPageDown=function(){this.$moveByPage(1,!1)},this.gotoPageUp=function(){this.$moveByPage(-1,!1)},this.scrollPageDown=function(){this.$moveByPage(1)},this.scrollPageUp=function(){this.$moveByPage(-1)},this.scrollToRow=function(e){this.renderer.scrollToRow(e)},this.scrollToLine=function(e,t,n,i){this.renderer.scrollToLine(e,t,n,i)},this.centerSelection=function(){var e=this.getSelectionRange(),t={row:Math.floor(e.start.row+(e.end.row-e.start.row)/2),column:Math.floor(e.start.column+(e.end.column-e.start.column)/2)};this.renderer.alignCursor(t,.5)},this.getCursorPosition=function(){return this.selection.getCursor()},this.getCursorPositionScreen=function(){return this.session.documentToScreenPosition(this.getCursorPosition())},this.getSelectionRange=function(){return this.selection.getRange()},this.selectAll=function(){this.selection.selectAll()},this.clearSelection=function(){this.selection.clearSelection()},this.moveCursorTo=function(e,t){this.selection.moveCursorTo(e,t)},this.moveCursorToPosition=function(e){this.selection.moveCursorToPosition(e)},this.jumpToMatching=function(e,t){var n=this.getCursorPosition(),i=new b(this.session,n.row,n.column),r=i.getCurrentToken(),o=r||i.stepForward();if(o){var s,a,l=!1,c={},u=n.column-o.start,h={")":"(","(":"(","]":"[","[":"[","{":"{","}":"{"};do{if(o.value.match(/[{}()\[\]]/g)){for(;u<o.value.length&&!l;u++)if(h[o.value[u]])switch(a=h[o.value[u]]+"."+o.type.replace("rparen","lparen"),isNaN(c[a])&&(c[a]=0),o.value[u]){case"(":case"[":case"{":c[a]++;break;case")":case"]":case"}":c[a]--,-1===c[a]&&(s="bracket",l=!0)}}else-1!==o.type.indexOf("tag-name")&&(isNaN(c[o.value])&&(c[o.value]=0),"<"===r.value?c[o.value]++:"</"===r.value&&c[o.value]--,-1===c[o.value]&&(s="tag",l=!0));l||(r=o,o=i.stepForward(),u=0)}while(o&&!l);if(s){var d,p;if("bracket"===s)(d=this.session.getBracketRange(n))||(p=(d=new f(i.getCurrentTokenRow(),i.getCurrentTokenColumn()+u-1,i.getCurrentTokenRow(),i.getCurrentTokenColumn()+u-1)).start,(t||p.row===n.row&&Math.abs(p.column-n.column)<2)&&(d=this.session.getBracketRange(p)));else if("tag"===s){if(!o||-1===o.type.indexOf("tag-name"))return;var g=o.value;if(0===(d=new f(i.getCurrentTokenRow(),i.getCurrentTokenColumn()-2,i.getCurrentTokenRow(),i.getCurrentTokenColumn()-2)).compare(n.row,n.column)){l=!1;do{o=r,(r=i.stepBackward())&&(-1!==r.type.indexOf("tag-close")&&d.setEnd(i.getCurrentTokenRow(),i.getCurrentTokenColumn()+1),o.value===g&&-1!==o.type.indexOf("tag-name")&&("<"===r.value?c[g]++:"</"===r.value&&c[g]--,0===c[g]&&(l=!0)))}while(r&&!l)}o&&o.type.indexOf("tag-name")&&(p=d.start).row==n.row&&Math.abs(p.column-n.column)<2&&(p=d.end)}(p=d&&d.cursor||p)&&(e?d&&t?this.selection.setRange(d):d&&d.isEqual(this.getSelectionRange())?this.clearSelection():this.selection.selectTo(p.row,p.column):this.selection.moveTo(p.row,p.column))}}},this.gotoLine=function(e,t,n){this.selection.clearSelection(),this.session.unfold({row:e-1,column:t||0}),this.exitMultiSelectMode&&this.exitMultiSelectMode(),this.moveCursorTo(e-1,t||0),this.isRowFullyVisible(e-1)||this.scrollToLine(e-1,!0,n)},this.navigateTo=function(e,t){this.selection.moveTo(e,t)},this.navigateUp=function(e){if(this.selection.isMultiLine()&&!this.selection.isBackwards()){var t=this.selection.anchor.getPosition();return this.moveCursorToPosition(t)}this.selection.clearSelection(),this.selection.moveCursorBy(-e||-1,0)},this.navigateDown=function(e){if(this.selection.isMultiLine()&&this.selection.isBackwards()){var t=this.selection.anchor.getPosition();return this.moveCursorToPosition(t)}this.selection.clearSelection(),this.selection.moveCursorBy(e||1,0)},this.navigateLeft=function(e){if(this.selection.isEmpty())for(e=e||1;e--;)this.selection.moveCursorLeft();else{var t=this.getSelectionRange().start;this.moveCursorToPosition(t)}this.clearSelection()},this.navigateRight=function(e){if(this.selection.isEmpty())for(e=e||1;e--;)this.selection.moveCursorRight();else{var t=this.getSelectionRange().end;this.moveCursorToPosition(t)}this.clearSelection()},this.navigateLineStart=function(){this.selection.moveCursorLineStart(),this.clearSelection()},this.navigateLineEnd=function(){this.selection.moveCursorLineEnd(),this.clearSelection()},this.navigateFileEnd=function(){this.selection.moveCursorFileEnd(),this.clearSelection()},this.navigateFileStart=function(){this.selection.moveCursorFileStart(),this.clearSelection()},this.navigateWordRight=function(){this.selection.moveCursorWordRight(),this.clearSelection()},this.navigateWordLeft=function(){this.selection.moveCursorWordLeft(),this.clearSelection()},this.replace=function(e,t){t&&this.$search.set(t);var n=this.$search.find(this.session),i=0;return n?(this.$tryReplace(n,e)&&(i=1),this.selection.setSelectionRange(n),this.renderer.scrollSelectionIntoView(n.start,n.end),i):i},this.replaceAll=function(e,t){t&&this.$search.set(t);var n=this.$search.findAll(this.session),i=0;if(!n.length)return i;var r=this.getSelectionRange();this.selection.moveTo(0,0);for(var o=n.length-1;o>=0;--o)this.$tryReplace(n[o],e)&&i++;return this.selection.setSelectionRange(r),i},this.$tryReplace=function(e,t){var n=this.session.getTextRange(e);return null!==(t=this.$search.replace(n,t))?(e.end=this.session.replace(e,t),e):null},this.getLastSearchOptions=function(){return this.$search.getOptions()},this.find=function(e,t,n){t||(t={}),"string"==typeof e||e instanceof RegExp?t.needle=e:"object"==typeof e&&i.mixin(t,e);var r=this.selection.getRange();null==t.needle&&((e=this.session.getTextRange(r)||this.$search.$options.needle)||(r=this.session.getWordRange(r.start.row,r.start.column),e=this.session.getTextRange(r)),this.$search.set({needle:e})),this.$search.set(t),t.start||this.$search.set({start:r});var o=this.$search.find(this.session);return t.preventScroll?o:o?(this.revealRange(o,n),o):(t.backwards?r.start=r.end:r.end=r.start,void this.selection.setRange(r))},this.findNext=function(e,t){this.find({skipCurrent:!0,backwards:!1},e,t)},this.findPrevious=function(e,t){this.find(e,{skipCurrent:!0,backwards:!0},t)},this.revealRange=function(e,t){this.session.unfold(e),this.selection.setSelectionRange(e);var n=this.renderer.scrollTop;this.renderer.scrollSelectionIntoView(e.start,e.end,.5),!1!==t&&this.renderer.animateScrolling(n)},this.undo=function(){this.session.getUndoManager().undo(this.session),this.renderer.scrollCursorIntoView(null,.5)},this.redo=function(){this.session.getUndoManager().redo(this.session),this.renderer.scrollCursorIntoView(null,.5)},this.destroy=function(){this.$toDestroy&&(this.$toDestroy.forEach((function(e){e.destroy()})),this.$toDestroy=null),this.$mouseHandler&&this.$mouseHandler.destroy(),this.renderer.destroy(),this._signal("destroy",this),this.session&&this.session.destroy(),this._$emitInputEvent&&this._$emitInputEvent.cancel(),this.removeAllListeners()},this.setAutoScrollEditorIntoView=function(e){if(e){var t,n=this,i=!1;this.$scrollAnchor||(this.$scrollAnchor=document.createElement("div"));var r=this.$scrollAnchor;r.style.cssText="position:absolute",this.container.insertBefore(r,this.container.firstChild);var o=this.on("changeSelection",(function(){i=!0})),s=this.renderer.on("beforeRender",(function(){i&&(t=n.renderer.container.getBoundingClientRect())})),a=this.renderer.on("afterRender",(function(){if(i&&t&&(n.isFocused()||n.searchBox&&n.searchBox.isFocused())){var e=n.renderer,o=e.$cursorLayer.$pixelPos,s=e.layerConfig,a=o.top-s.offset;null!=(i=o.top>=0&&a+t.top<0||!(o.top<s.height&&o.top+t.top+s.lineHeight>window.innerHeight)&&null)&&(r.style.top=a+"px",r.style.left=o.left+"px",r.style.height=s.lineHeight+"px",r.scrollIntoView(i)),i=t=null}}));this.setAutoScrollEditorIntoView=function(e){e||(delete this.setAutoScrollEditorIntoView,this.off("changeSelection",o),this.renderer.off("afterRender",a),this.renderer.off("beforeRender",s))}}},this.$resetCursorStyle=function(){var e=this.$cursorStyle||"ace",t=this.renderer.$cursorLayer;t&&(t.setSmoothBlinking(/smooth/.test(e)),t.isBlinking=!this.$readOnly&&"wide"!=e,r.setCssClass(t.element,"ace_slim-cursors",/slim/.test(e)))},this.prompt=function(e,t,n){var i=this;v.loadModule("./ext/prompt",(function(r){r.prompt(i,e,t,n)}))}}.call(w.prototype),v.defineOptions(w.prototype,"editor",{selectionStyle:{set:function(e){this.onSelectionChange(),this._signal("changeSelectionStyle",{data:e})},initialValue:"line"},highlightActiveLine:{set:function(){this.$updateHighlightActiveLine()},initialValue:!0},highlightSelectedWord:{set:function(e){this.$onSelectionChange()},initialValue:!0},readOnly:{set:function(e){this.textInput.setReadOnly(e),this.$resetCursorStyle()},initialValue:!1},copyWithEmptySelection:{set:function(e){this.textInput.setCopyWithEmptySelection(e)},initialValue:!1},cursorStyle:{set:function(e){this.$resetCursorStyle()},values:["ace","slim","smooth","wide"],initialValue:"ace"},mergeUndoDeltas:{values:[!1,!0,"always"],initialValue:!0},behavioursEnabled:{initialValue:!0},wrapBehavioursEnabled:{initialValue:!0},enableAutoIndent:{initialValue:!0},autoScrollEditorIntoView:{set:function(e){this.setAutoScrollEditorIntoView(e)}},keyboardHandler:{set:function(e){this.setKeyboardHandler(e)},get:function(){return this.$keybindingId},handlesSet:!0},value:{set:function(e){this.session.setValue(e)},get:function(){return this.getValue()},handlesSet:!0,hidden:!0},session:{set:function(e){this.setSession(e)},get:function(){return this.session},handlesSet:!0,hidden:!0},showLineNumbers:{set:function(e){this.renderer.$gutterLayer.setShowLineNumbers(e),this.renderer.$loop.schedule(this.renderer.CHANGE_GUTTER),e&&this.$relativeLineNumbers?x.attach(this):x.detach(this)},initialValue:!0},relativeLineNumbers:{set:function(e){this.$showLineNumbers&&e?x.attach(this):x.detach(this)}},placeholder:{set:function(e){this.$updatePlaceholder||(this.$updatePlaceholder=function(){var e=this.session&&(this.renderer.$composition||this.getValue());if(e&&this.renderer.placeholderNode)this.renderer.off("afterRender",this.$updatePlaceholder),r.removeCssClass(this.container,"ace_hasPlaceholder"),this.renderer.placeholderNode.remove(),this.renderer.placeholderNode=null;else if(e||this.renderer.placeholderNode)!e&&this.renderer.placeholderNode&&(this.renderer.placeholderNode.textContent=this.$placeholder||"");else{this.renderer.on("afterRender",this.$updatePlaceholder),r.addCssClass(this.container,"ace_hasPlaceholder");var t=r.createElement("div");t.className="ace_placeholder",t.textContent=this.$placeholder||"",this.renderer.placeholderNode=t,this.renderer.content.appendChild(this.renderer.placeholderNode)}}.bind(this),this.on("input",this.$updatePlaceholder)),this.$updatePlaceholder()}},hScrollBarAlwaysVisible:"renderer",vScrollBarAlwaysVisible:"renderer",highlightGutterLine:"renderer",animatedScroll:"renderer",showInvisibles:"renderer",showPrintMargin:"renderer",printMarginColumn:"renderer",printMargin:"renderer",fadeFoldWidgets:"renderer",showFoldWidgets:"renderer",displayIndentGuides:"renderer",showGutter:"renderer",fontSize:"renderer",fontFamily:"renderer",maxLines:"renderer",minLines:"renderer",scrollPastEnd:"renderer",fixedWidthGutter:"renderer",theme:"renderer",hasCssTransforms:"renderer",maxPixelHeight:"renderer",useTextareaForIME:"renderer",scrollSpeed:"$mouseHandler",dragDelay:"$mouseHandler",dragEnabled:"$mouseHandler",focusTimeout:"$mouseHandler",tooltipFollowsMouse:"$mouseHandler",firstLineNumber:"session",overwrite:"session",newLineMode:"session",useWorker:"session",useSoftTabs:"session",navigateWithinSoftTabs:"session",tabSize:"session",wrap:"session",indentedSoftWrap:"session",foldStyle:"session",mode:"session"});var x={getText:function(e,t){return(Math.abs(e.selection.lead.row-t)||t+1+(t<9?"Â·":""))+""},getWidth:function(e,t,n){return Math.max(t.toString().length,(n.lastRow+1).toString().length,2)*n.characterWidth},update:function(e,t){t.renderer.$loop.schedule(t.renderer.CHANGE_GUTTER)},attach:function(e){e.renderer.$gutterLayer.$renderer=this,e.on("changeSelection",this.update),this.update(null,e)},detach:function(e){e.renderer.$gutterLayer.$renderer==this&&(e.renderer.$gutterLayer.$renderer=null),e.off("changeSelection",this.update),this.update(null,e)}};t.Editor=w})),ace.define("ace/undomanager",["require","exports","module","ace/range"],(function(e,t,n){"use strict";var i=function(){this.$maxRev=0,this.$fromUndo=!1,this.reset()};(function(){this.addSession=function(e){this.$session=e},this.add=function(e,t,n){this.$fromUndo||e!=this.$lastDelta&&(this.$keepRedoStack||(this.$redoStack.length=0),!1!==t&&this.lastDeltas||(this.lastDeltas=[],this.$undoStack.push(this.lastDeltas),e.id=this.$rev=++this.$maxRev),"remove"!=e.action&&"insert"!=e.action||(this.$lastDelta=e),this.lastDeltas.push(e))},this.addSelection=function(e,t){this.selections.push({value:e,rev:t||this.$rev})},this.startNewGroup=function(){return this.lastDeltas=null,this.$rev},this.markIgnored=function(e,t){null==t&&(t=this.$rev+1);for(var n=this.$undoStack,i=n.length;i--;){var r=n[i][0];if(r.id<=e)break;r.id<t&&(r.ignore=!0)}this.lastDeltas=null},this.getSelection=function(e,t){for(var n=this.selections,i=n.length;i--;){var r=n[i];if(r.rev<e)return t&&(r=n[i+1]),r}},this.getRevision=function(){return this.$rev},this.getDeltas=function(e,t){null==t&&(t=this.$rev+1);for(var n=this.$undoStack,i=null,r=0,o=n.length;o--;){var s=n[o][0];if(s.id<t&&!i&&(i=o+1),s.id<=e){r=o+1;break}}return n.slice(r,i)},this.getChangedRanges=function(e,t){null==t&&(t=this.$rev+1)},this.getChangedLines=function(e,t){null==t&&(t=this.$rev+1)},this.undo=function(e,t){this.lastDeltas=null;var n=this.$undoStack;if(function(e,t){for(var n=t;n--;){var i=e[n];if(i&&!i[0].ignore){for(;n<t-1;){var r=u(e[n],e[n+1]);e[n]=r[0],e[n+1]=r[1],n++}return!0}}}(n,n.length)){e||(e=this.$session),this.$redoStackBaseRev!==this.$rev&&this.$redoStack.length&&(this.$redoStack=[]),this.$fromUndo=!0;var i=n.pop(),r=null;return i&&(r=e.undoChanges(i,t),this.$redoStack.push(i),this.$syncRev()),this.$fromUndo=!1,r}},this.redo=function(e,t){if(this.lastDeltas=null,e||(e=this.$session),this.$fromUndo=!0,this.$redoStackBaseRev!=this.$rev){var n=this.getDeltas(this.$redoStackBaseRev,this.$rev+1);!function(e,t){for(var n=0;n<t.length;n++)for(var i=t[n],r=0;r<i.length;r++)g(e,i[r])}(this.$redoStack,n),this.$redoStackBaseRev=this.$rev,this.$redoStack.forEach((function(e){e[0].id=++this.$maxRev}),this)}var i=this.$redoStack.pop(),r=null;return i&&(r=e.redoChanges(i,t),this.$undoStack.push(i),this.$syncRev()),this.$fromUndo=!1,r},this.$syncRev=function(){var e=this.$undoStack,t=e[e.length-1],n=t&&t[0].id||0;this.$redoStackBaseRev=n,this.$rev=n},this.reset=function(){this.lastDeltas=null,this.$lastDelta=null,this.$undoStack=[],this.$redoStack=[],this.$rev=0,this.mark=0,this.$redoStackBaseRev=this.$rev,this.selections=[]},this.canUndo=function(){return this.$undoStack.length>0},this.canRedo=function(){return this.$redoStack.length>0},this.bookmark=function(e){null==e&&(e=this.$rev),this.mark=e},this.isAtBookmark=function(){return this.$rev===this.mark},this.toJSON=function(){},this.fromJSON=function(){},this.hasUndo=this.canUndo,this.hasRedo=this.canRedo,this.isClean=this.isAtBookmark,this.markClean=this.bookmark,this.$prettyPrint=function(e){return e?a(e):a(this.$undoStack)+"\n---\n"+a(this.$redoStack)}}).call(i.prototype);var r=e("./range").Range,o=r.comparePoints;r.comparePoints;function s(e){return{row:e.row,column:e.column}}function a(e){if(e=e||this,Array.isArray(e))return e.map(a).join("\n");var t="";return e.action?(t="insert"==e.action?"+":"-",t+="["+e.lines+"]"):e.value&&(t=Array.isArray(e.value)?e.value.map(l).join("\n"):l(e.value)),e.start&&(t+=l(e)),(e.id||e.rev)&&(t+="\t("+(e.id||e.rev)+")"),t}function l(e){return e.start.row+":"+e.start.column+"=>"+e.end.row+":"+e.end.column}function c(e,t){var n="insert"==e.action,i="insert"==t.action;if(n&&i)if(o(t.start,e.end)>=0)d(t,e,-1);else{if(!(o(t.start,e.start)<=0))return null;d(e,t,1)}else if(n&&!i)if(o(t.start,e.end)>=0)d(t,e,-1);else{if(!(o(t.end,e.start)<=0))return null;d(e,t,-1)}else if(!n&&i)if(o(t.start,e.start)>=0)d(t,e,1);else{if(!(o(t.start,e.start)<=0))return null;d(e,t,1)}else if(!n&&!i)if(o(t.start,e.start)>=0)d(t,e,1);else{if(!(o(t.end,e.start)<=0))return null;d(e,t,-1)}return[t,e]}function u(e,t){for(var n=e.length;n--;)for(var i=0;i<t.length;i++)if(!c(e[n],t[i])){for(;n<e.length;){for(;i--;)c(t[i],e[n]);i=t.length,n++}return[e,t]}return e.selectionBefore=t.selectionBefore=e.selectionAfter=t.selectionAfter=null,[t,e]}function h(e,t){var n="insert"==e.action,i="insert"==t.action;if(n&&i)o(e.start,t.start)<0?d(t,e,1):d(e,t,1);else if(n&&!i)o(e.start,t.end)>=0?d(e,t,-1):(o(e.start,t.start)<=0||d(e,r.fromPoints(t.start,e.start),-1),d(t,e,1));else if(!n&&i)o(t.start,e.end)>=0?d(t,e,-1):(o(t.start,e.start)<=0||d(t,r.fromPoints(e.start,t.start),-1),d(e,t,1));else if(!n&&!i)if(o(t.start,e.end)>=0)d(t,e,-1);else{var s,a;if(!(o(t.end,e.start)<=0))return o(e.start,t.start)<0&&(s=e,e=p(e,t.start)),o(e.end,t.end)>0&&(a=p(e,t.end)),f(t.end,e.start,e.end,-1),a&&!s&&(e.lines=a.lines,e.start=a.start,e.end=a.end,a=e),[t,s,a].filter(Boolean);d(e,t,-1)}return[t,e]}function d(e,t,n){f(e.start,t.start,t.end,n),f(e.end,t.start,t.end,n)}function f(e,t,n,i){e.row==(1==i?t:n).row&&(e.column+=i*(n.column-t.column)),e.row+=i*(n.row-t.row)}function p(e,t){var n=e.lines,i=e.end;e.end=s(t);var r=e.end.row-e.start.row,o=n.splice(r,n.length),a=r?t.column:t.column-e.start.column;return n.push(o[0].substring(0,a)),o[0]=o[0].substr(a),{start:s(t),end:i,lines:o,action:e.action}}function g(e,t){t=function(e){return{start:s(e.start),end:s(e.end),action:e.action,lines:e.lines.slice()}}(t);for(var n=e.length;n--;){for(var i=e[n],r=0;r<i.length;r++){var o=h(i[r],t);t=o[0],2!=o.length&&(o[2]?(i.splice(r+1,1,o[1],o[2]),r++):o[1]||(i.splice(r,1),r--))}i.length||e.splice(n,1)}return e}t.UndoManager=i})),ace.define("ace/layer/lines",["require","exports","module","ace/lib/dom"],(function(e,t,n){"use strict";var i=e("../lib/dom"),r=function(e,t){this.element=e,this.canvasHeight=t||5e5,this.element.style.height=2*this.canvasHeight+"px",this.cells=[],this.cellCache=[],this.$offsetCoefficient=0};(function(){this.moveContainer=function(e){i.translate(this.element,0,-e.firstRowScreen*e.lineHeight%this.canvasHeight-e.offset*this.$offsetCoefficient)},this.pageChanged=function(e,t){return Math.floor(e.firstRowScreen*e.lineHeight/this.canvasHeight)!==Math.floor(t.firstRowScreen*t.lineHeight/this.canvasHeight)},this.computeLineTop=function(e,t,n){var i=t.firstRowScreen*t.lineHeight,r=Math.floor(i/this.canvasHeight);return n.documentToScreenRow(e,0)*t.lineHeight-r*this.canvasHeight},this.computeLineHeight=function(e,t,n){return t.lineHeight*n.getRowLineCount(e)},this.getLength=function(){return this.cells.length},this.get=function(e){return this.cells[e]},this.shift=function(){this.$cacheCell(this.cells.shift())},this.pop=function(){this.$cacheCell(this.cells.pop())},this.push=function(e){if(Array.isArray(e)){this.cells.push.apply(this.cells,e);for(var t=i.createFragment(this.element),n=0;n<e.length;n++)t.appendChild(e[n].element);this.element.appendChild(t)}else this.cells.push(e),this.element.appendChild(e.element)},this.unshift=function(e){if(Array.isArray(e)){this.cells.unshift.apply(this.cells,e);for(var t=i.createFragment(this.element),n=0;n<e.length;n++)t.appendChild(e[n].element);this.element.firstChild?this.element.insertBefore(t,this.element.firstChild):this.element.appendChild(t)}else this.cells.unshift(e),this.element.insertAdjacentElement("afterbegin",e.element)},this.last=function(){return this.cells.length?this.cells[this.cells.length-1]:null},this.$cacheCell=function(e){e&&(e.element.remove(),this.cellCache.push(e))},this.createCell=function(e,t,n,r){var o=this.cellCache.pop();if(!o){var s=i.createElement("div");r&&r(s),this.element.appendChild(s),o={element:s,text:"",row:e}}return o.row=e,o}}).call(r.prototype),t.Lines=r})),ace.define("ace/layer/gutter",["require","exports","module","ace/lib/dom","ace/lib/oop","ace/lib/lang","ace/lib/event_emitter","ace/layer/lines"],(function(e,t,n){"use strict";var i=e("../lib/dom"),r=e("../lib/oop"),o=e("../lib/lang"),s=e("../lib/event_emitter").EventEmitter,a=e("./lines").Lines,l=function(e){this.element=i.createElement("div"),this.element.className="ace_layer ace_gutter-layer",e.appendChild(this.element),this.setShowFoldWidgets(this.$showFoldWidgets),this.gutterWidth=0,this.$annotations=[],this.$updateAnnotations=this.$updateAnnotations.bind(this),this.$lines=new a(this.element),this.$lines.$offsetCoefficient=1};function c(e){var t=document.createTextNode("");e.appendChild(t);var n=i.createElement("span");return e.appendChild(n),e}(function(){r.implement(this,s),this.setSession=function(e){this.session&&this.session.off("change",this.$updateAnnotations),this.session=e,e&&e.on("change",this.$updateAnnotations)},this.addGutterDecoration=function(e,t){window.console&&console.warn&&console.warn("deprecated use session.addGutterDecoration"),this.session.addGutterDecoration(e,t)},this.removeGutterDecoration=function(e,t){window.console&&console.warn&&console.warn("deprecated use session.removeGutterDecoration"),this.session.removeGutterDecoration(e,t)},this.setAnnotations=function(e){this.$annotations=[];for(var t=0;t<e.length;t++){var n=e[t],i=n.row,r=this.$annotations[i];r||(r=this.$annotations[i]={text:[]});var s=n.text;s=s?o.escapeHTML(s):n.html||"",-1===r.text.indexOf(s)&&r.text.push(s);var a=n.type;"error"==a?r.className=" ace_error":"warning"==a&&" ace_error"!=r.className?r.className=" ace_warning":"info"!=a||r.className||(r.className=" ace_info")}},this.$updateAnnotations=function(e){if(this.$annotations.length){var t=e.start.row,n=e.end.row-t;if(0===n);else if("remove"==e.action)this.$annotations.splice(t,n+1,null);else{var i=new Array(n+1);i.unshift(t,1),this.$annotations.splice.apply(this.$annotations,i)}}},this.update=function(e){this.config=e;var t=this.session,n=e.firstRow,i=Math.min(e.lastRow+e.gutterOffset,t.getLength()-1);this.oldLastRow=i,this.config=e,this.$lines.moveContainer(e),this.$updateCursorRow();for(var r=t.getNextFoldLine(n),o=r?r.start.row:1/0,s=null,a=-1,l=n;;){if(l>o&&(l=r.end.row+1,o=(r=t.getNextFoldLine(l,r))?r.start.row:1/0),l>i){for(;this.$lines.getLength()>a+1;)this.$lines.pop();break}(s=this.$lines.get(++a))?s.row=l:(s=this.$lines.createCell(l,e,this.session,c),this.$lines.push(s)),this.$renderCell(s,e,r,l),l++}this._signal("afterRender"),this.$updateGutterWidth(e)},this.$updateGutterWidth=function(e){var t=this.session,n=t.gutterRenderer||this.$renderer,i=t.$firstLineNumber,r=this.$lines.last()?this.$lines.last().text:"";(this.$fixedWidth||t.$useWrapMode)&&(r=t.getLength()+i-1);var o=n?n.getWidth(t,r,e):r.toString().length*e.characterWidth,s=this.$padding||this.$computePadding();(o+=s.left+s.right)===this.gutterWidth||isNaN(o)||(this.gutterWidth=o,this.element.parentNode.style.width=this.element.style.width=Math.ceil(this.gutterWidth)+"px",this._signal("changeGutterWidth",o))},this.$updateCursorRow=function(){if(this.$highlightGutterLine){var e=this.session.selection.getCursor();this.$cursorRow!==e.row&&(this.$cursorRow=e.row)}},this.updateLineHighlight=function(){if(this.$highlightGutterLine){var e=this.session.selection.cursor.row;if(this.$cursorRow=e,!this.$cursorCell||this.$cursorCell.row!=e){this.$cursorCell&&(this.$cursorCell.element.className=this.$cursorCell.element.className.replace("ace_gutter-active-line ",""));var t=this.$lines.cells;this.$cursorCell=null;for(var n=0;n<t.length;n++){var i=t[n];if(i.row>=this.$cursorRow){if(i.row>this.$cursorRow){var r=this.session.getFoldLine(this.$cursorRow);if(!(n>0&&r&&r.start.row==t[n-1].row))break;i=t[n-1]}i.element.className="ace_gutter-active-line "+i.element.className,this.$cursorCell=i;break}}}}},this.scrollLines=function(e){var t=this.config;if(this.config=e,this.$updateCursorRow(),this.$lines.pageChanged(t,e))return this.update(e);this.$lines.moveContainer(e);var n=Math.min(e.lastRow+e.gutterOffset,this.session.getLength()-1),i=this.oldLastRow;if(this.oldLastRow=n,!t||i<e.firstRow)return this.update(e);if(n<t.firstRow)return this.update(e);if(t.firstRow<e.firstRow)for(var r=this.session.getFoldedRowCount(t.firstRow,e.firstRow-1);r>0;r--)this.$lines.shift();if(i>n)for(r=this.session.getFoldedRowCount(n+1,i);r>0;r--)this.$lines.pop();e.firstRow<t.firstRow&&this.$lines.unshift(this.$renderLines(e,e.firstRow,t.firstRow-1)),n>i&&this.$lines.push(this.$renderLines(e,i+1,n)),this.updateLineHighlight(),this._signal("afterRender"),this.$updateGutterWidth(e)},this.$renderLines=function(e,t,n){for(var i=[],r=t,o=this.session.getNextFoldLine(r),s=o?o.start.row:1/0;r>s&&(r=o.end.row+1,s=(o=this.session.getNextFoldLine(r,o))?o.start.row:1/0),!(r>n);){var a=this.$lines.createCell(r,e,this.session,c);this.$renderCell(a,e,o,r),i.push(a),r++}return i},this.$renderCell=function(e,t,n,r){var o=e.element,s=this.session,a=o.childNodes[0],l=o.childNodes[1],c=s.$firstLineNumber,u=s.$breakpoints,h=s.$decorations,d=s.gutterRenderer||this.$renderer,f=this.$showFoldWidgets&&s.foldWidgets,p=n?n.start.row:Number.MAX_VALUE,g="ace_gutter-cell ";if(this.$highlightGutterLine&&(r==this.$cursorRow||n&&r<this.$cursorRow&&r>=p&&this.$cursorRow<=n.end.row)&&(g+="ace_gutter-active-line ",this.$cursorCell!=e&&(this.$cursorCell&&(this.$cursorCell.element.className=this.$cursorCell.element.className.replace("ace_gutter-active-line ","")),this.$cursorCell=e)),u[r]&&(g+=u[r]),h[r]&&(g+=h[r]),this.$annotations[r]&&(g+=this.$annotations[r].className),o.className!=g&&(o.className=g),f){var m=f[r];null==m&&(m=f[r]=s.getFoldWidget(r))}if(m){g="ace_fold-widget ace_"+m;"start"==m&&r==p&&r<n.end.row?g+=" ace_closed":g+=" ace_open",l.className!=g&&(l.className=g);var v=t.lineHeight+"px";i.setStyle(l.style,"height",v),i.setStyle(l.style,"display","inline-block")}else l&&i.setStyle(l.style,"display","none");var b=(d?d.getText(s,r):r+c).toString();return b!==a.data&&(a.data=b),i.setStyle(e.element.style,"height",this.$lines.computeLineHeight(r,t,s)+"px"),i.setStyle(e.element.style,"top",this.$lines.computeLineTop(r,t,s)+"px"),e.text=b,e},this.$fixedWidth=!1,this.$highlightGutterLine=!0,this.$renderer="",this.setHighlightGutterLine=function(e){this.$highlightGutterLine=e},this.$showLineNumbers=!0,this.$renderer="",this.setShowLineNumbers=function(e){this.$renderer=!e&&{getWidth:function(){return 0},getText:function(){return""}}},this.getShowLineNumbers=function(){return this.$showLineNumbers},this.$showFoldWidgets=!0,this.setShowFoldWidgets=function(e){e?i.addCssClass(this.element,"ace_folding-enabled"):i.removeCssClass(this.element,"ace_folding-enabled"),this.$showFoldWidgets=e,this.$padding=null},this.getShowFoldWidgets=function(){return this.$showFoldWidgets},this.$computePadding=function(){if(!this.element.firstChild)return{left:0,right:0};var e=i.computedStyle(this.element.firstChild);return this.$padding={},this.$padding.left=(parseInt(e.borderLeftWidth)||0)+(parseInt(e.paddingLeft)||0)+1,this.$padding.right=(parseInt(e.borderRightWidth)||0)+(parseInt(e.paddingRight)||0),this.$padding},this.getRegion=function(e){var t=this.$padding||this.$computePadding(),n=this.element.getBoundingClientRect();return e.x<t.left+n.left?"markers":this.$showFoldWidgets&&e.x>n.right-t.right?"foldWidgets":void 0}}).call(l.prototype),t.Gutter=l})),ace.define("ace/layer/marker",["require","exports","module","ace/range","ace/lib/dom"],(function(e,t,n){"use strict";var i=e("../range").Range,r=e("../lib/dom"),o=function(e){this.element=r.createElement("div"),this.element.className="ace_layer ace_marker-layer",e.appendChild(this.element)};(function(){this.$padding=0,this.setPadding=function(e){this.$padding=e},this.setSession=function(e){this.session=e},this.setMarkers=function(e){this.markers=e},this.elt=function(e,t){var n=-1!=this.i&&this.element.childNodes[this.i];n?this.i++:(n=document.createElement("div"),this.element.appendChild(n),this.i=-1),n.style.cssText=t,n.className=e},this.update=function(e){if(e){var t;for(var n in this.config=e,this.i=0,this.markers){var i=this.markers[n];if(i.range){var r=i.range.clipRows(e.firstRow,e.lastRow);if(!r.isEmpty())if(r=r.toScreenRange(this.session),i.renderer){var o=this.$getTop(r.start.row,e),s=this.$padding+r.start.column*e.characterWidth;i.renderer(t,r,s,o,e)}else"fullLine"==i.type?this.drawFullLineMarker(t,r,i.clazz,e):"screenLine"==i.type?this.drawScreenLineMarker(t,r,i.clazz,e):r.isMultiLine()?"text"==i.type?this.drawTextMarker(t,r,i.clazz,e):this.drawMultiLineMarker(t,r,i.clazz,e):this.drawSingleLineMarker(t,r,i.clazz+" ace_start ace_br15",e)}else i.update(t,this,this.session,e)}if(-1!=this.i)for(;this.i<this.element.childElementCount;)this.element.removeChild(this.element.lastChild)}},this.$getTop=function(e,t){return(e-t.firstRowScreen)*t.lineHeight},this.drawTextMarker=function(e,t,n,r,o){for(var s=this.session,a=t.start.row,l=t.end.row,c=a,u=0,h=0,d=s.getScreenLastRowColumn(c),f=new i(c,t.start.column,c,h);c<=l;c++)f.start.row=f.end.row=c,f.start.column=c==a?t.start.column:s.getRowWrapIndent(c),f.end.column=d,u=h,h=d,d=c+1<l?s.getScreenLastRowColumn(c+1):c==l?0:t.end.column,this.drawSingleLineMarker(e,f,n+(c==a?" ace_start":"")+" ace_br"+((c==a||c==a+1&&t.start.column?1:0)|(u<h?2:0)|(h>d?4:0)|(c==l?8:0)),r,c==l?0:1,o)},this.drawMultiLineMarker=function(e,t,n,i,r){var o=this.$padding,s=i.lineHeight,a=this.$getTop(t.start.row,i),l=o+t.start.column*i.characterWidth;(r=r||"",this.session.$bidiHandler.isBidiRow(t.start.row))?((c=t.clone()).end.row=c.start.row,c.end.column=this.session.getLine(c.start.row).length,this.drawBidiSingleLineMarker(e,c,n+" ace_br1 ace_start",i,null,r)):this.elt(n+" ace_br1 ace_start","height:"+s+"px;right:0;top:"+a+"px;left:"+l+"px;"+(r||""));if(this.session.$bidiHandler.isBidiRow(t.end.row)){var c;(c=t.clone()).start.row=c.end.row,c.start.column=0,this.drawBidiSingleLineMarker(e,c,n+" ace_br12",i,null,r)}else{a=this.$getTop(t.end.row,i);var u=t.end.column*i.characterWidth;this.elt(n+" ace_br12","height:"+s+"px;width:"+u+"px;top:"+a+"px;left:"+o+"px;"+(r||""))}if(!((s=(t.end.row-t.start.row-1)*i.lineHeight)<=0)){a=this.$getTop(t.start.row+1,i);var h=(t.start.column?1:0)|(t.end.column?0:8);this.elt(n+(h?" ace_br"+h:""),"height:"+s+"px;right:0;top:"+a+"px;left:"+o+"px;"+(r||""))}},this.drawSingleLineMarker=function(e,t,n,i,r,o){if(this.session.$bidiHandler.isBidiRow(t.start.row))return this.drawBidiSingleLineMarker(e,t,n,i,r,o);var s=i.lineHeight,a=(t.end.column+(r||0)-t.start.column)*i.characterWidth,l=this.$getTop(t.start.row,i),c=this.$padding+t.start.column*i.characterWidth;this.elt(n,"height:"+s+"px;width:"+a+"px;top:"+l+"px;left:"+c+"px;"+(o||""))},this.drawBidiSingleLineMarker=function(e,t,n,i,r,o){var s=i.lineHeight,a=this.$getTop(t.start.row,i),l=this.$padding;this.session.$bidiHandler.getSelections(t.start.column,t.end.column).forEach((function(e){this.elt(n,"height:"+s+"px;width:"+e.width+(r||0)+"px;top:"+a+"px;left:"+(l+e.left)+"px;"+(o||""))}),this)},this.drawFullLineMarker=function(e,t,n,i,r){var o=this.$getTop(t.start.row,i),s=i.lineHeight;t.start.row!=t.end.row&&(s+=this.$getTop(t.end.row,i)-o),this.elt(n,"height:"+s+"px;top:"+o+"px;left:0;right:0;"+(r||""))},this.drawScreenLineMarker=function(e,t,n,i,r){var o=this.$getTop(t.start.row,i),s=i.lineHeight;this.elt(n,"height:"+s+"px;top:"+o+"px;left:0;right:0;"+(r||""))}}).call(o.prototype),t.Marker=o})),ace.define("ace/layer/text",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/layer/lines","ace/lib/event_emitter"],(function(e,t,n){"use strict";var i=e("../lib/oop"),r=e("../lib/dom"),o=e("../lib/lang"),s=e("./lines").Lines,a=e("../lib/event_emitter").EventEmitter,l=function(e){this.dom=r,this.element=this.dom.createElement("div"),this.element.className="ace_layer ace_text-layer",e.appendChild(this.element),this.$updateEolChar=this.$updateEolChar.bind(this),this.$lines=new s(this.element)};(function(){i.implement(this,a),this.EOF_CHAR="Â¶",this.EOL_CHAR_LF="Â¬",this.EOL_CHAR_CRLF="Â¤",this.EOL_CHAR=this.EOL_CHAR_LF,this.TAB_CHAR="â€”",this.SPACE_CHAR="Â·",this.$padding=0,this.MAX_LINE_LENGTH=1e4,this.$updateEolChar=function(){var e=this.session.doc,t="\n"==e.getNewLineCharacter()&&"windows"!=e.getNewLineMode()?this.EOL_CHAR_LF:this.EOL_CHAR_CRLF;if(this.EOL_CHAR!=t)return this.EOL_CHAR=t,!0},this.setPadding=function(e){this.$padding=e,this.element.style.margin="0 "+e+"px"},this.getLineHeight=function(){return this.$fontMetrics.$characterSize.height||0},this.getCharacterWidth=function(){return this.$fontMetrics.$characterSize.width||0},this.$setFontMetrics=function(e){this.$fontMetrics=e,this.$fontMetrics.on("changeCharacterSize",function(e){this._signal("changeCharacterSize",e)}.bind(this)),this.$pollSizeChanges()},this.checkForSizeChanges=function(){this.$fontMetrics.checkForSizeChanges()},this.$pollSizeChanges=function(){return this.$pollSizeChangesTimer=this.$fontMetrics.$pollSizeChanges()},this.setSession=function(e){this.session=e,e&&this.$computeTabString()},this.showInvisibles=!1,this.showSpaces=!1,this.showTabs=!1,this.showEOL=!1,this.setShowInvisibles=function(e){return this.showInvisibles!=e&&(this.showInvisibles=e,"string"==typeof e?(this.showSpaces=/tab/i.test(e),this.showTabs=/space/i.test(e),this.showEOL=/eol/i.test(e)):this.showSpaces=this.showTabs=this.showEOL=e,this.$computeTabString(),!0)},this.displayIndentGuides=!0,this.setDisplayIndentGuides=function(e){return this.displayIndentGuides!=e&&(this.displayIndentGuides=e,this.$computeTabString(),!0)},this.$tabStrings=[],this.onChangeTabSize=this.$computeTabString=function(){var e=this.session.getTabSize();this.tabSize=e;for(var t=this.$tabStrings=[0],n=1;n<e+1;n++){if(this.showTabs)(i=this.dom.createElement("span")).className="ace_invisible ace_invisible_tab",i.textContent=o.stringRepeat(this.TAB_CHAR,n),t.push(i);else t.push(this.dom.createTextNode(o.stringRepeat(" ",n),this.element))}if(this.displayIndentGuides){this.$indentGuideRe=/\s\S| \t|\t |\s$/;var i,r=this.showSpaces?" ace_invisible ace_invisible_space":"",s=this.showSpaces?o.stringRepeat(this.SPACE_CHAR,this.tabSize):o.stringRepeat(" ",this.tabSize),a=this.showTabs?" ace_invisible ace_invisible_tab":"",l=this.showTabs?o.stringRepeat(this.TAB_CHAR,this.tabSize):s;(i=this.dom.createElement("span")).className="ace_indent-guide"+r,i.textContent=s,this.$tabStrings[" "]=i,(i=this.dom.createElement("span")).className="ace_indent-guide"+a,i.textContent=l,this.$tabStrings["\t"]=i}},this.updateLines=function(e,t,n){if(this.config.lastRow!=e.lastRow||this.config.firstRow!=e.firstRow)return this.update(e);this.config=e;for(var i=Math.max(t,e.firstRow),r=Math.min(n,e.lastRow),o=this.element.childNodes,s=0,a=e.firstRow;a<i;a++){if(l=this.session.getFoldLine(a)){if(l.containsRow(i)){i=l.start.row;break}a=l.end.row}s++}for(var l,c=!1,u=(a=i,(l=this.session.getNextFoldLine(a))?l.start.row:1/0);a>u&&(a=l.end.row+1,u=(l=this.session.getNextFoldLine(a,l))?l.start.row:1/0),!(a>r);){var h=o[s++];if(h){this.dom.removeChildren(h),this.$renderLine(h,a,a==u&&l),c&&(h.style.top=this.$lines.computeLineTop(a,e,this.session)+"px");var d=e.lineHeight*this.session.getRowLength(a)+"px";h.style.height!=d&&(c=!0,h.style.height=d)}a++}if(c)for(;s<this.$lines.cells.length;){var f=this.$lines.cells[s++];f.element.style.top=this.$lines.computeLineTop(f.row,e,this.session)+"px"}},this.scrollLines=function(e){var t=this.config;if(this.config=e,this.$lines.pageChanged(t,e))return this.update(e);this.$lines.moveContainer(e);var n=e.lastRow,i=t?t.lastRow:-1;if(!t||i<e.firstRow)return this.update(e);if(n<t.firstRow)return this.update(e);if(!t||t.lastRow<e.firstRow)return this.update(e);if(e.lastRow<t.firstRow)return this.update(e);if(t.firstRow<e.firstRow)for(var r=this.session.getFoldedRowCount(t.firstRow,e.firstRow-1);r>0;r--)this.$lines.shift();if(t.lastRow>e.lastRow)for(r=this.session.getFoldedRowCount(e.lastRow+1,t.lastRow);r>0;r--)this.$lines.pop();e.firstRow<t.firstRow&&this.$lines.unshift(this.$renderLinesFragment(e,e.firstRow,t.firstRow-1)),e.lastRow>t.lastRow&&this.$lines.push(this.$renderLinesFragment(e,t.lastRow+1,e.lastRow))},this.$renderLinesFragment=function(e,t,n){for(var i=[],o=t,s=this.session.getNextFoldLine(o),a=s?s.start.row:1/0;o>a&&(o=s.end.row+1,a=(s=this.session.getNextFoldLine(o,s))?s.start.row:1/0),!(o>n);){var l=this.$lines.createCell(o,e,this.session),c=l.element;this.dom.removeChildren(c),r.setStyle(c.style,"height",this.$lines.computeLineHeight(o,e,this.session)+"px"),r.setStyle(c.style,"top",this.$lines.computeLineTop(o,e,this.session)+"px"),this.$renderLine(c,o,o==a&&s),this.$useLineGroups()?c.className="ace_line_group":c.className="ace_line",i.push(l),o++}return i},this.update=function(e){this.$lines.moveContainer(e),this.config=e;for(var t=e.firstRow,n=e.lastRow,i=this.$lines;i.getLength();)i.pop();i.push(this.$renderLinesFragment(e,t,n))},this.$textToken={text:!0,rparen:!0,lparen:!0},this.$renderToken=function(e,t,n,i){for(var r,s=/(\t)|( +)|([\x00-\x1f\x80-\xa0\xad\u1680\u180E\u2000-\u200f\u2028\u2029\u202F\u205F\uFEFF\uFFF9-\uFFFC]+)|(\u3000)|([\u1100-\u115F\u11A3-\u11A7\u11FA-\u11FF\u2329-\u232A\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3001-\u303E\u3041-\u3096\u3099-\u30FF\u3105-\u312D\u3131-\u318E\u3190-\u31BA\u31C0-\u31E3\u31F0-\u321E\u3220-\u3247\u3250-\u32FE\u3300-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFAFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFF01-\uFF60\uFFE0-\uFFE6]|[\uD800-\uDBFF][\uDC00-\uDFFF])/g,a=this.dom.createFragment(this.element),l=0;r=s.exec(i);){var c=r[1],u=r[2],h=r[3],d=r[4],f=r[5];if(this.showSpaces||!u){var p=l!=r.index?i.slice(l,r.index):"";if(l=r.index+r[0].length,p&&a.appendChild(this.dom.createTextNode(p,this.element)),c){var g=this.session.getScreenTabSize(t+r.index);a.appendChild(this.$tabStrings[g].cloneNode(!0)),t+=g-1}else if(u){if(this.showSpaces)(v=this.dom.createElement("span")).className="ace_invisible ace_invisible_space",v.textContent=o.stringRepeat(this.SPACE_CHAR,u.length),a.appendChild(v);else a.appendChild(this.com.createTextNode(u,this.element))}else if(h){(v=this.dom.createElement("span")).className="ace_invisible ace_invisible_space ace_invalid",v.textContent=o.stringRepeat(this.SPACE_CHAR,h.length),a.appendChild(v)}else if(d){t+=1,(v=this.dom.createElement("span")).style.width=2*this.config.characterWidth+"px",v.className=this.showSpaces?"ace_cjk ace_invisible ace_invisible_space":"ace_cjk",v.textContent=this.showSpaces?this.SPACE_CHAR:d,a.appendChild(v)}else if(f){t+=1,(v=this.dom.createElement("span")).style.width=2*this.config.characterWidth+"px",v.className="ace_cjk",v.textContent=f,a.appendChild(v)}}}if(a.appendChild(this.dom.createTextNode(l?i.slice(l):i,this.element)),this.$textToken[n.type])e.appendChild(a);else{var m="ace_"+n.type.replace(/\./g," ace_"),v=this.dom.createElement("span");"fold"==n.type&&(v.style.width=n.value.length*this.config.characterWidth+"px"),v.className=m,v.appendChild(a),e.appendChild(v)}return t+i.length},this.renderIndentGuide=function(e,t,n){var i=t.search(this.$indentGuideRe);if(i<=0||i>=n)return t;if(" "==t[0]){for(var r=(i-=i%this.tabSize)/this.tabSize,o=0;o<r;o++)e.appendChild(this.$tabStrings[" "].cloneNode(!0));return t.substr(i)}if("\t"==t[0]){for(o=0;o<i;o++)e.appendChild(this.$tabStrings["\t"].cloneNode(!0));return t.substr(i)}return t},this.$createLineElement=function(e){var t=this.dom.createElement("div");return t.className="ace_line",t.style.height=this.config.lineHeight+"px",t},this.$renderWrappedLine=function(e,t,n){var i=0,r=0,s=n[0],a=0,l=this.$createLineElement();e.appendChild(l);for(var c=0;c<t.length;c++){var u=t[c],h=u.value;if(0==c&&this.displayIndentGuides){if(i=h.length,!(h=this.renderIndentGuide(l,h,s)))continue;i-=h.length}if(i+h.length<s)a=this.$renderToken(l,a,u,h),i+=h.length;else{for(;i+h.length>=s;)a=this.$renderToken(l,a,u,h.substring(0,s-i)),h=h.substring(s-i),i=s,l=this.$createLineElement(),e.appendChild(l),l.appendChild(this.dom.createTextNode(o.stringRepeat("Â ",n.indent),this.element)),a=0,s=n[++r]||Number.MAX_VALUE;0!=h.length&&(i+=h.length,a=this.$renderToken(l,a,u,h))}}n[n.length-1]>this.MAX_LINE_LENGTH&&this.$renderOverflowMessage(l,a,null,"",!0)},this.$renderSimpleLine=function(e,t){var n=0,i=t[0],r=i.value;this.displayIndentGuides&&(r=this.renderIndentGuide(e,r)),r&&(n=this.$renderToken(e,n,i,r));for(var o=1;o<t.length;o++){if(n+(r=(i=t[o]).value).length>this.MAX_LINE_LENGTH)return this.$renderOverflowMessage(e,n,i,r);n=this.$renderToken(e,n,i,r)}},this.$renderOverflowMessage=function(e,t,n,i,r){n&&this.$renderToken(e,t,n,i.slice(0,this.MAX_LINE_LENGTH-t));var o=this.dom.createElement("span");o.className="ace_inline_button ace_keyword ace_toggle_wrap",o.textContent=r?"<hide>":"<click to see more...>",e.appendChild(o)},this.$renderLine=function(e,t,n){if(n||0==n||(n=this.session.getFoldLine(t)),n)var i=this.$getFoldLineTokens(t,n);else i=this.session.getTokens(t);var r=e;if(i.length){var o=this.session.getRowSplitData(t);if(o&&o.length){this.$renderWrappedLine(e,i,o);r=e.lastChild}else{r=e;this.$useLineGroups()&&(r=this.$createLineElement(),e.appendChild(r)),this.$renderSimpleLine(r,i)}}else this.$useLineGroups()&&(r=this.$createLineElement(),e.appendChild(r));if(this.showEOL&&r){n&&(t=n.end.row);var s=this.dom.createElement("span");s.className="ace_invisible ace_invisible_eol",s.textContent=t==this.session.getLength()-1?this.EOF_CHAR:this.EOL_CHAR,r.appendChild(s)}},this.$getFoldLineTokens=function(e,t){var n=this.session,i=[];var r=n.getTokens(e);return t.walk((function(e,t,o,s,a){null!=e?i.push({type:"fold",value:e}):(a&&(r=n.getTokens(t)),r.length&&function(e,t,n){for(var r=0,o=0;o+e[r].value.length<t;)if(o+=e[r].value.length,++r==e.length)return;for(o!=t&&((s=e[r].value.substring(t-o)).length>n-t&&(s=s.substring(0,n-t)),i.push({type:e[r].type,value:s}),o=t+s.length,r+=1);o<n&&r<e.length;){var s;(s=e[r].value).length+o>n?i.push({type:e[r].type,value:s.substring(0,n-o)}):i.push(e[r]),o+=s.length,r+=1}}(r,s,o))}),t.end.row,this.session.getLine(t.end.row).length),i},this.$useLineGroups=function(){return this.session.getUseWrapMode()},this.destroy=function(){}}).call(l.prototype),t.Text=l})),ace.define("ace/layer/cursor",["require","exports","module","ace/lib/dom"],(function(e,t,n){"use strict";var i=e("../lib/dom"),r=function(e){this.element=i.createElement("div"),this.element.className="ace_layer ace_cursor-layer",e.appendChild(this.element),this.isVisible=!1,this.isBlinking=!0,this.blinkInterval=1e3,this.smoothBlinking=!1,this.cursors=[],this.cursor=this.addCursor(),i.addCssClass(this.element,"ace_hidden-cursors"),this.$updateCursors=this.$updateOpacity.bind(this)};(function(){this.$updateOpacity=function(e){for(var t=this.cursors,n=t.length;n--;)i.setStyle(t[n].style,"opacity",e?"":"0")},this.$startCssAnimation=function(){for(var e=this.cursors,t=e.length;t--;)e[t].style.animationDuration=this.blinkInterval+"ms";setTimeout(function(){i.addCssClass(this.element,"ace_animate-blinking")}.bind(this))},this.$stopCssAnimation=function(){i.removeCssClass(this.element,"ace_animate-blinking")},this.$padding=0,this.setPadding=function(e){this.$padding=e},this.setSession=function(e){this.session=e},this.setBlinking=function(e){e!=this.isBlinking&&(this.isBlinking=e,this.restartTimer())},this.setBlinkInterval=function(e){e!=this.blinkInterval&&(this.blinkInterval=e,this.restartTimer())},this.setSmoothBlinking=function(e){e!=this.smoothBlinking&&(this.smoothBlinking=e,i.setCssClass(this.element,"ace_smooth-blinking",e),this.$updateCursors(!0),this.restartTimer())},this.addCursor=function(){var e=i.createElement("div");return e.className="ace_cursor",this.element.appendChild(e),this.cursors.push(e),e},this.removeCursor=function(){if(this.cursors.length>1){var e=this.cursors.pop();return e.parentNode.removeChild(e),e}},this.hideCursor=function(){this.isVisible=!1,i.addCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},this.showCursor=function(){this.isVisible=!0,i.removeCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},this.restartTimer=function(){var e=this.$updateCursors;if(clearInterval(this.intervalId),clearTimeout(this.timeoutId),this.$stopCssAnimation(),this.smoothBlinking&&i.removeCssClass(this.element,"ace_smooth-blinking"),e(!0),this.isBlinking&&this.blinkInterval&&this.isVisible)if(this.smoothBlinking&&setTimeout(function(){i.addCssClass(this.element,"ace_smooth-blinking")}.bind(this)),i.HAS_CSS_ANIMATION)this.$startCssAnimation();else{var t=function(){this.timeoutId=setTimeout((function(){e(!1)}),.6*this.blinkInterval)}.bind(this);this.intervalId=setInterval((function(){e(!0),t()}),this.blinkInterval),t()}else this.$stopCssAnimation()},this.getPixelPosition=function(e,t){if(!this.config||!this.session)return{left:0,top:0};e||(e=this.session.selection.getCursor());var n=this.session.documentToScreenPosition(e);return{left:this.$padding+(this.session.$bidiHandler.isBidiRow(n.row,e.row)?this.session.$bidiHandler.getPosLeft(n.column):n.column*this.config.characterWidth),top:(n.row-(t?this.config.firstRowScreen:0))*this.config.lineHeight}},this.isCursorInView=function(e,t){return e.top>=0&&e.top<t.maxHeight},this.update=function(e){this.config=e;var t=this.session.$selectionMarkers,n=0,r=0;void 0!==t&&0!==t.length||(t=[{cursor:null}]);n=0;for(var o=t.length;n<o;n++){var s=this.getPixelPosition(t[n].cursor,!0);if(!((s.top>e.height+e.offset||s.top<0)&&n>1)){var a=this.cursors[r++]||this.addCursor(),l=a.style;this.drawCursor?this.drawCursor(a,s,e,t[n],this.session):this.isCursorInView(s,e)?(i.setStyle(l,"display","block"),i.translate(a,s.left,s.top),i.setStyle(l,"width",Math.round(e.characterWidth)+"px"),i.setStyle(l,"height",e.lineHeight+"px")):i.setStyle(l,"display","none")}}for(;this.cursors.length>r;)this.removeCursor();var c=this.session.getOverwrite();this.$setOverwrite(c),this.$pixelPos=s,this.restartTimer()},this.drawCursor=null,this.$setOverwrite=function(e){e!=this.overwrite&&(this.overwrite=e,e?i.addCssClass(this.element,"ace_overwrite-cursors"):i.removeCssClass(this.element,"ace_overwrite-cursors"))},this.destroy=function(){clearInterval(this.intervalId),clearTimeout(this.timeoutId)}}).call(r.prototype),t.Cursor=r})),ace.define("ace/scrollbar",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/event","ace/lib/event_emitter"],(function(e,t,n){"use strict";var i=e("./lib/oop"),r=e("./lib/dom"),o=e("./lib/event"),s=e("./lib/event_emitter").EventEmitter,a=function(e){this.element=r.createElement("div"),this.element.className="ace_scrollbar ace_scrollbar"+this.classSuffix,this.inner=r.createElement("div"),this.inner.className="ace_scrollbar-inner",this.inner.textContent="Â ",this.element.appendChild(this.inner),e.appendChild(this.element),this.setVisible(!1),this.skipEvent=!1,o.addListener(this.element,"scroll",this.onScroll.bind(this)),o.addListener(this.element,"mousedown",o.preventDefault)};(function(){i.implement(this,s),this.setVisible=function(e){this.element.style.display=e?"":"none",this.isVisible=e,this.coeff=1}}).call(a.prototype);var l=function(e,t){a.call(this,e),this.scrollTop=0,this.scrollHeight=0,t.$scrollbarWidth=this.width=r.scrollbarWidth(e.ownerDocument),this.inner.style.width=this.element.style.width=(this.width||15)+5+"px",this.$minWidth=0};i.inherits(l,a),function(){this.classSuffix="-v",this.onScroll=function(){if(!this.skipEvent){if(this.scrollTop=this.element.scrollTop,1!=this.coeff){var e=this.element.clientHeight/this.scrollHeight;this.scrollTop=this.scrollTop*(1-e)/(this.coeff-e)}this._emit("scroll",{data:this.scrollTop})}this.skipEvent=!1},this.getWidth=function(){return Math.max(this.isVisible?this.width:0,this.$minWidth||0)},this.setHeight=function(e){this.element.style.height=e+"px"},this.setInnerHeight=this.setScrollHeight=function(e){this.scrollHeight=e,e>32768?(this.coeff=32768/e,e=32768):1!=this.coeff&&(this.coeff=1),this.inner.style.height=e+"px"},this.setScrollTop=function(e){this.scrollTop!=e&&(this.skipEvent=!0,this.scrollTop=e,this.element.scrollTop=e*this.coeff)}}.call(l.prototype);var c=function(e,t){a.call(this,e),this.scrollLeft=0,this.height=t.$scrollbarWidth,this.inner.style.height=this.element.style.height=(this.height||15)+5+"px"};i.inherits(c,a),function(){this.classSuffix="-h",this.onScroll=function(){this.skipEvent||(this.scrollLeft=this.element.scrollLeft,this._emit("scroll",{data:this.scrollLeft})),this.skipEvent=!1},this.getHeight=function(){return this.isVisible?this.height:0},this.setWidth=function(e){this.element.style.width=e+"px"},this.setInnerWidth=function(e){this.inner.style.width=e+"px"},this.setScrollWidth=function(e){this.inner.style.width=e+"px"},this.setScrollLeft=function(e){this.scrollLeft!=e&&(this.skipEvent=!0,this.scrollLeft=this.element.scrollLeft=e)}}.call(c.prototype),t.ScrollBar=l,t.ScrollBarV=l,t.ScrollBarH=c,t.VScrollBar=l,t.HScrollBar=c})),ace.define("ace/renderloop",["require","exports","module","ace/lib/event"],(function(e,t,n){"use strict";var i=e("./lib/event"),r=function(e,t){this.onRender=e,this.pending=!1,this.changes=0,this.$recursionLimit=2,this.window=t||window;var n=this;this._flush=function(e){n.pending=!1;var t=n.changes;if(t&&(i.blockIdle(100),n.changes=0,n.onRender(t)),n.changes){if(n.$recursionLimit--<0)return;n.schedule()}else n.$recursionLimit=2}};(function(){this.schedule=function(e){this.changes=this.changes|e,this.changes&&!this.pending&&(i.nextFrame(this._flush),this.pending=!0)},this.clear=function(e){var t=this.changes;return this.changes=0,t}}).call(r.prototype),t.RenderLoop=r})),ace.define("ace/layer/font_metrics",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/event","ace/lib/useragent","ace/lib/event_emitter"],(function(e,t,n){var i=e("../lib/oop"),r=e("../lib/dom"),o=e("../lib/lang"),s=e("../lib/event"),a=e("../lib/useragent"),l=e("../lib/event_emitter").EventEmitter,c="function"==typeof ResizeObserver,u=200,h=t.FontMetrics=function(e){this.el=r.createElement("div"),this.$setMeasureNodeStyles(this.el.style,!0),this.$main=r.createElement("div"),this.$setMeasureNodeStyles(this.$main.style),this.$measureNode=r.createElement("div"),this.$setMeasureNodeStyles(this.$measureNode.style),this.el.appendChild(this.$main),this.el.appendChild(this.$measureNode),e.appendChild(this.el),this.$measureNode.textContent=o.stringRepeat("X",256),this.$characterSize={width:0,height:0},c?this.$addObserver():this.checkForSizeChanges()};(function(){i.implement(this,l),this.$characterSize={width:0,height:0},this.$setMeasureNodeStyles=function(e,t){e.width=e.height="auto",e.left=e.top="0px",e.visibility="hidden",e.position="absolute",e.whiteSpace="pre",a.isIE<8?e["font-family"]="inherit":e.font="inherit",e.overflow=t?"hidden":"visible"},this.checkForSizeChanges=function(e){if(void 0===e&&(e=this.$measureSizes()),e&&(this.$characterSize.width!==e.width||this.$characterSize.height!==e.height)){this.$measureNode.style.fontWeight="bold";var t=this.$measureSizes();this.$measureNode.style.fontWeight="",this.$characterSize=e,this.charSizes=Object.create(null),this.allowBoldFonts=t&&t.width===e.width&&t.height===e.height,this._emit("changeCharacterSize",{data:e})}},this.$addObserver=function(){var e=this;this.$observer=new window.ResizeObserver((function(t){e.checkForSizeChanges()})),this.$observer.observe(this.$measureNode)},this.$pollSizeChanges=function(){if(this.$pollSizeChangesTimer||this.$observer)return this.$pollSizeChangesTimer;var e=this;return this.$pollSizeChangesTimer=s.onIdle((function t(){e.checkForSizeChanges(),s.onIdle(t,500)}),500)},this.setPolling=function(e){e?this.$pollSizeChanges():this.$pollSizeChangesTimer&&(clearInterval(this.$pollSizeChangesTimer),this.$pollSizeChangesTimer=0)},this.$measureSizes=function(e){var t={height:(e||this.$measureNode).clientHeight,width:(e||this.$measureNode).clientWidth/256};return 0===t.width||0===t.height?null:t},this.$measureCharWidth=function(e){return this.$main.textContent=o.stringRepeat(e,256),this.$main.getBoundingClientRect().width/256},this.getCharacterWidth=function(e){var t=this.charSizes[e];return void 0===t&&(t=this.charSizes[e]=this.$measureCharWidth(e)/this.$characterSize.width),t},this.destroy=function(){clearInterval(this.$pollSizeChangesTimer),this.$observer&&this.$observer.disconnect(),this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el)},this.$getZoom=function e(t){return t&&t.parentElement?(window.getComputedStyle(t).zoom||1)*e(t.parentElement):1},this.$initTransformMeasureNodes=function(){var e=function(e,t){return["div",{style:"position: absolute;top:"+e+"px;left:"+t+"px;"}]};this.els=r.buildDom([e(0,0),e(u,0),e(0,u),e(u,u)],this.el)},this.transformCoordinates=function(e,t){e&&(e=o(1/this.$getZoom(this.el),e));function n(e,t,n){var i=e[1]*t[0]-e[0]*t[1];return[(-t[1]*n[0]+t[0]*n[1])/i,(+e[1]*n[0]-e[0]*n[1])/i]}function i(e,t){return[e[0]-t[0],e[1]-t[1]]}function r(e,t){return[e[0]+t[0],e[1]+t[1]]}function o(e,t){return[e*t[0],e*t[1]]}function s(e){var t=e.getBoundingClientRect();return[t.left,t.top]}this.els||this.$initTransformMeasureNodes();var a=s(this.els[0]),l=s(this.els[1]),c=s(this.els[2]),h=s(this.els[3]),d=n(i(h,l),i(h,c),i(r(l,c),r(h,a))),f=o(1+d[0],i(l,a)),p=o(1+d[1],i(c,a));if(t){var g=t,m=d[0]*g[0]/u+d[1]*g[1]/u+1,v=r(o(g[0],f),o(g[1],p));return r(o(1/m/u,v),a)}var b=i(e,a),y=n(i(f,o(d[0],b)),i(p,o(d[1],b)),b);return o(u,y)}}).call(h.prototype)})),ace.define("ace/virtual_renderer",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/config","ace/layer/gutter","ace/layer/marker","ace/layer/text","ace/layer/cursor","ace/scrollbar","ace/scrollbar","ace/renderloop","ace/layer/font_metrics","ace/lib/event_emitter","ace/lib/useragent"],(function(e,t,n){"use strict";var i=e("./lib/oop"),r=e("./lib/dom"),o=e("./config"),s=e("./layer/gutter").Gutter,a=e("./layer/marker").Marker,l=e("./layer/text").Text,c=e("./layer/cursor").Cursor,u=e("./scrollbar").HScrollBar,h=e("./scrollbar").VScrollBar,d=e("./renderloop").RenderLoop,f=e("./layer/font_metrics").FontMetrics,p=e("./lib/event_emitter").EventEmitter,g='.ace_br1 {border-top-left-radius    : 3px;}.ace_br2 {border-top-right-radius   : 3px;}.ace_br3 {border-top-left-radius    : 3px; border-top-right-radius:    3px;}.ace_br4 {border-bottom-right-radius: 3px;}.ace_br5 {border-top-left-radius    : 3px; border-bottom-right-radius: 3px;}.ace_br6 {border-top-right-radius   : 3px; border-bottom-right-radius: 3px;}.ace_br7 {border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px;}.ace_br8 {border-bottom-left-radius : 3px;}.ace_br9 {border-top-left-radius    : 3px; border-bottom-left-radius:  3px;}.ace_br10{border-top-right-radius   : 3px; border-bottom-left-radius:  3px;}.ace_br11{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-left-radius:  3px;}.ace_br12{border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br13{border-top-left-radius    : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br14{border-top-right-radius   : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br15{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}.ace_editor {position: relative;overflow: hidden;padding: 0;font: 12px/normal \'Monaco\', \'Menlo\', \'Ubuntu Mono\', \'Consolas\', \'source-code-pro\', monospace;direction: ltr;text-align: left;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);}.ace_scroller {position: absolute;overflow: hidden;top: 0;bottom: 0;background-color: inherit;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;cursor: text;}.ace_content {position: absolute;box-sizing: border-box;min-width: 100%;contain: style size layout;font-variant-ligatures: no-common-ligatures;}.ace_dragging .ace_scroller:before{position: absolute;top: 0;left: 0;right: 0;bottom: 0;content: \'\';background: rgba(250, 250, 250, 0.01);z-index: 1000;}.ace_dragging.ace_dark .ace_scroller:before{background: rgba(0, 0, 0, 0.01);}.ace_selecting, .ace_selecting * {cursor: text !important;}.ace_gutter {position: absolute;overflow : hidden;width: auto;top: 0;bottom: 0;left: 0;cursor: default;z-index: 4;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;contain: style size layout;}.ace_gutter-active-line {position: absolute;left: 0;right: 0;}.ace_scroller.ace_scroll-left {box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;}.ace_gutter-cell {position: absolute;top: 0;left: 0;right: 0;padding-left: 19px;padding-right: 6px;background-repeat: no-repeat;}.ace_gutter-cell.ace_error {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: 2px center;}.ace_gutter-cell.ace_warning {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");background-position: 2px center;}.ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");background-position: 2px center;}.ace_dark .ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");}.ace_scrollbar {contain: strict;position: absolute;right: 0;bottom: 0;z-index: 6;}.ace_scrollbar-inner {position: absolute;cursor: text;left: 0;top: 0;}.ace_scrollbar-v{overflow-x: hidden;overflow-y: scroll;top: 0;}.ace_scrollbar-h {overflow-x: scroll;overflow-y: hidden;left: 0;}.ace_print-margin {position: absolute;height: 100%;}.ace_text-input {position: absolute;z-index: 0;width: 0.5em;height: 1em;opacity: 0;background: transparent;-moz-appearance: none;appearance: none;border: none;resize: none;outline: none;overflow: hidden;font: inherit;padding: 0 1px;margin: 0 -1px;contain: strict;-ms-user-select: text;-moz-user-select: text;-webkit-user-select: text;user-select: text;white-space: pre!important;}.ace_text-input.ace_composition {background: transparent;color: inherit;z-index: 1000;opacity: 1;}.ace_composition_placeholder { color: transparent }.ace_composition_marker { border-bottom: 1px solid;position: absolute;border-radius: 0;margin-top: 1px;}[ace_nocontext=true] {transform: none!important;filter: none!important;clip-path: none!important;mask : none!important;contain: none!important;perspective: none!important;mix-blend-mode: initial!important;z-index: auto;}.ace_layer {z-index: 1;position: absolute;overflow: hidden;word-wrap: normal;white-space: pre;height: 100%;width: 100%;box-sizing: border-box;pointer-events: none;}.ace_gutter-layer {position: relative;width: auto;text-align: right;pointer-events: auto;height: 1000000px;contain: style size layout;}.ace_text-layer {font: inherit !important;position: absolute;height: 1000000px;width: 1000000px;contain: style size layout;}.ace_text-layer > .ace_line, .ace_text-layer > .ace_line_group {contain: style size layout;position: absolute;top: 0;left: 0;right: 0;}.ace_hidpi .ace_text-layer,.ace_hidpi .ace_gutter-layer,.ace_hidpi .ace_content,.ace_hidpi .ace_gutter {contain: strict;will-change: transform;}.ace_hidpi .ace_text-layer > .ace_line, .ace_hidpi .ace_text-layer > .ace_line_group {contain: strict;}.ace_cjk {display: inline-block;text-align: center;}.ace_cursor-layer {z-index: 4;}.ace_cursor {z-index: 4;position: absolute;box-sizing: border-box;border-left: 2px solid;transform: translatez(0);}.ace_multiselect .ace_cursor {border-left-width: 1px;}.ace_slim-cursors .ace_cursor {border-left-width: 1px;}.ace_overwrite-cursors .ace_cursor {border-left-width: 0;border-bottom: 1px solid;}.ace_hidden-cursors .ace_cursor {opacity: 0.2;}.ace_hasPlaceholder .ace_hidden-cursors .ace_cursor {opacity: 0;}.ace_smooth-blinking .ace_cursor {transition: opacity 0.18s;}.ace_animate-blinking .ace_cursor {animation-duration: 1000ms;animation-timing-function: step-end;animation-name: blink-ace-animate;animation-iteration-count: infinite;}.ace_animate-blinking.ace_smooth-blinking .ace_cursor {animation-duration: 1000ms;animation-timing-function: ease-in-out;animation-name: blink-ace-animate-smooth;}@keyframes blink-ace-animate {from, to { opacity: 1; }60% { opacity: 0; }}@keyframes blink-ace-animate-smooth {from, to { opacity: 1; }45% { opacity: 1; }60% { opacity: 0; }85% { opacity: 0; }}.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {position: absolute;z-index: 3;}.ace_marker-layer .ace_selection {position: absolute;z-index: 5;}.ace_marker-layer .ace_bracket {position: absolute;z-index: 6;}.ace_marker-layer .ace_error_bracket {position: absolute;border-bottom: 1px solid #DE5555;border-radius: 0;}.ace_marker-layer .ace_active-line {position: absolute;z-index: 2;}.ace_marker-layer .ace_selected-word {position: absolute;z-index: 4;box-sizing: border-box;}.ace_line .ace_fold {box-sizing: border-box;display: inline-block;height: 11px;margin-top: -2px;vertical-align: middle;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");background-repeat: no-repeat, repeat-x;background-position: center center, top left;color: transparent;border: 1px solid black;border-radius: 2px;cursor: pointer;pointer-events: auto;}.ace_dark .ace_fold {}.ace_fold:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");}.ace_tooltip {background-color: #FFF;background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));border: 1px solid gray;border-radius: 1px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);color: black;max-width: 100%;padding: 3px 4px;position: fixed;z-index: 999999;box-sizing: border-box;cursor: default;white-space: pre;word-wrap: break-word;line-height: normal;font-style: normal;font-weight: normal;letter-spacing: normal;pointer-events: none;}.ace_folding-enabled > .ace_gutter-cell {padding-right: 13px;}.ace_fold-widget {box-sizing: border-box;margin: 0 -12px 0 1px;display: none;width: 11px;vertical-align: top;background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: center;border-radius: 3px;border: 1px solid transparent;cursor: pointer;}.ace_folding-enabled .ace_fold-widget {display: inline-block;   }.ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");}.ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");}.ace_fold-widget:hover {border: 1px solid rgba(0, 0, 0, 0.3);background-color: rgba(255, 255, 255, 0.2);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);}.ace_fold-widget:active {border: 1px solid rgba(0, 0, 0, 0.4);background-color: rgba(0, 0, 0, 0.05);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);}.ace_dark .ace_fold-widget {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");}.ace_dark .ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget:hover {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);background-color: rgba(255, 255, 255, 0.1);}.ace_dark .ace_fold-widget:active {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);}.ace_inline_button {border: 1px solid lightgray;display: inline-block;margin: -1px 8px;padding: 0 5px;pointer-events: auto;cursor: pointer;}.ace_inline_button:hover {border-color: gray;background: rgba(200,200,200,0.2);display: inline-block;pointer-events: auto;}.ace_fold-widget.ace_invalid {background-color: #FFB4B4;border-color: #DE5555;}.ace_fade-fold-widgets .ace_fold-widget {transition: opacity 0.4s ease 0.05s;opacity: 0;}.ace_fade-fold-widgets:hover .ace_fold-widget {transition: opacity 0.05s ease 0.05s;opacity:1;}.ace_underline {text-decoration: underline;}.ace_bold {font-weight: bold;}.ace_nobold .ace_bold {font-weight: normal;}.ace_italic {font-style: italic;}.ace_error-marker {background-color: rgba(255, 0, 0,0.2);position: absolute;z-index: 9;}.ace_highlight-marker {background-color: rgba(255, 255, 0,0.2);position: absolute;z-index: 8;}.ace_mobile-menu {position: absolute;line-height: 1.5;border-radius: 4px;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;background: white;box-shadow: 1px 3px 2px grey;border: 1px solid #dcdcdc;color: black;}.ace_dark > .ace_mobile-menu {background: #333;color: #ccc;box-shadow: 1px 3px 2px grey;border: 1px solid #444;}.ace_mobile-button {padding: 2px;cursor: pointer;overflow: hidden;}.ace_mobile-button:hover {background-color: #eee;opacity:1;}.ace_mobile-button:active {background-color: #ddd;}.ace_placeholder {font-family: arial;transform: scale(0.9);transform-origin: left;white-space: pre;opacity: 0.7;margin: 0 10px;}',m=e("./lib/useragent"),v=m.isIE;r.importCssString(g,"ace_editor.css");var b=function(e,t){var n=this;this.container=e||r.createElement("div"),r.addCssClass(this.container,"ace_editor"),r.HI_DPI&&r.addCssClass(this.container,"ace_hidpi"),this.setTheme(t),this.$gutter=r.createElement("div"),this.$gutter.className="ace_gutter",this.container.appendChild(this.$gutter),this.$gutter.setAttribute("aria-hidden",!0),this.scroller=r.createElement("div"),this.scroller.className="ace_scroller",this.container.appendChild(this.scroller),this.content=r.createElement("div"),this.content.className="ace_content",this.scroller.appendChild(this.content),this.$gutterLayer=new s(this.$gutter),this.$gutterLayer.on("changeGutterWidth",this.onGutterResize.bind(this)),this.$markerBack=new a(this.content);var i=this.$textLayer=new l(this.content);this.canvas=i.element,this.$markerFront=new a(this.content),this.$cursorLayer=new c(this.content),this.$horizScroll=!1,this.$vScroll=!1,this.scrollBar=this.scrollBarV=new h(this.container,this),this.scrollBarH=new u(this.container,this),this.scrollBarV.on("scroll",(function(e){n.$scrollAnimation||n.session.setScrollTop(e.data-n.scrollMargin.top)})),this.scrollBarH.on("scroll",(function(e){n.$scrollAnimation||n.session.setScrollLeft(e.data-n.scrollMargin.left)})),this.scrollTop=0,this.scrollLeft=0,this.cursorPos={row:0,column:0},this.$fontMetrics=new f(this.container),this.$textLayer.$setFontMetrics(this.$fontMetrics),this.$textLayer.on("changeCharacterSize",(function(e){n.updateCharacterSize(),n.onResize(!0,n.gutterWidth,n.$size.width,n.$size.height),n._signal("changeCharacterSize",e)})),this.$size={width:0,height:0,scrollerHeight:0,scrollerWidth:0,$dirty:!0},this.layerConfig={width:1,padding:0,firstRow:0,firstRowScreen:0,lastRow:0,lineHeight:0,characterWidth:0,minHeight:1,maxHeight:1,offset:0,height:1,gutterOffset:1},this.scrollMargin={left:0,right:0,top:0,bottom:0,v:0,h:0},this.margin={left:0,right:0,top:0,bottom:0,v:0,h:0},this.$keepTextAreaAtCursor=!m.isIOS,this.$loop=new d(this.$renderChanges.bind(this),this.container.ownerDocument.defaultView),this.$loop.schedule(this.CHANGE_FULL),this.updateCharacterSize(),this.setPadding(4),o.resetOptions(this),o._signal("renderer",this)};(function(){this.CHANGE_CURSOR=1,this.CHANGE_MARKER=2,this.CHANGE_GUTTER=4,this.CHANGE_SCROLL=8,this.CHANGE_LINES=16,this.CHANGE_TEXT=32,this.CHANGE_SIZE=64,this.CHANGE_MARKER_BACK=128,this.CHANGE_MARKER_FRONT=256,this.CHANGE_FULL=512,this.CHANGE_H_SCROLL=1024,i.implement(this,p),this.updateCharacterSize=function(){this.$textLayer.allowBoldFonts!=this.$allowBoldFonts&&(this.$allowBoldFonts=this.$textLayer.allowBoldFonts,this.setStyle("ace_nobold",!this.$allowBoldFonts)),this.layerConfig.characterWidth=this.characterWidth=this.$textLayer.getCharacterWidth(),this.layerConfig.lineHeight=this.lineHeight=this.$textLayer.getLineHeight(),this.$updatePrintMargin(),r.setStyle(this.scroller.style,"line-height",this.lineHeight+"px")},this.setSession=function(e){this.session&&this.session.doc.off("changeNewLineMode",this.onChangeNewLineMode),this.session=e,e&&this.scrollMargin.top&&e.getScrollTop()<=0&&e.setScrollTop(-this.scrollMargin.top),this.$cursorLayer.setSession(e),this.$markerBack.setSession(e),this.$markerFront.setSession(e),this.$gutterLayer.setSession(e),this.$textLayer.setSession(e),e&&(this.$loop.schedule(this.CHANGE_FULL),this.session.$setFontMetrics(this.$fontMetrics),this.scrollBarH.scrollLeft=this.scrollBarV.scrollTop=null,this.onChangeNewLineMode=this.onChangeNewLineMode.bind(this),this.onChangeNewLineMode(),this.session.doc.on("changeNewLineMode",this.onChangeNewLineMode))},this.updateLines=function(e,t,n){if(void 0===t&&(t=1/0),this.$changedLines?(this.$changedLines.firstRow>e&&(this.$changedLines.firstRow=e),this.$changedLines.lastRow<t&&(this.$changedLines.lastRow=t)):this.$changedLines={firstRow:e,lastRow:t},this.$changedLines.lastRow<this.layerConfig.firstRow){if(!n)return;this.$changedLines.lastRow=this.layerConfig.lastRow}this.$changedLines.firstRow>this.layerConfig.lastRow||this.$loop.schedule(this.CHANGE_LINES)},this.onChangeNewLineMode=function(){this.$loop.schedule(this.CHANGE_TEXT),this.$textLayer.$updateEolChar(),this.session.$bidiHandler.setEolChar(this.$textLayer.EOL_CHAR)},this.onChangeTabSize=function(){this.$loop.schedule(this.CHANGE_TEXT|this.CHANGE_MARKER),this.$textLayer.onChangeTabSize()},this.updateText=function(){this.$loop.schedule(this.CHANGE_TEXT)},this.updateFull=function(e){e?this.$renderChanges(this.CHANGE_FULL,!0):this.$loop.schedule(this.CHANGE_FULL)},this.updateFontSize=function(){this.$textLayer.checkForSizeChanges()},this.$changes=0,this.$updateSizeAsync=function(){this.$loop.pending?this.$size.$dirty=!0:this.onResize()},this.onResize=function(e,t,n,i){if(!(this.resizing>2)){this.resizing>0?this.resizing++:this.resizing=e?1:0;var r=this.container;i||(i=r.clientHeight||r.scrollHeight),n||(n=r.clientWidth||r.scrollWidth);var o=this.$updateCachedSize(e,t,n,i);if(!this.$size.scrollerHeight||!n&&!i)return this.resizing=0;e&&(this.$gutterLayer.$padding=null),e?this.$renderChanges(o|this.$changes,!0):this.$loop.schedule(o|this.$changes),this.resizing&&(this.resizing=0),this.scrollBarV.scrollLeft=this.scrollBarV.scrollTop=null}},this.$updateCachedSize=function(e,t,n,i){i-=this.$extraHeight||0;var o=0,s=this.$size,a={width:s.width,height:s.height,scrollerHeight:s.scrollerHeight,scrollerWidth:s.scrollerWidth};if(i&&(e||s.height!=i)&&(s.height=i,o|=this.CHANGE_SIZE,s.scrollerHeight=s.height,this.$horizScroll&&(s.scrollerHeight-=this.scrollBarH.getHeight()),this.scrollBarV.element.style.bottom=this.scrollBarH.getHeight()+"px",o|=this.CHANGE_SCROLL),n&&(e||s.width!=n)){o|=this.CHANGE_SIZE,s.width=n,null==t&&(t=this.$showGutter?this.$gutter.offsetWidth:0),this.gutterWidth=t,r.setStyle(this.scrollBarH.element.style,"left",t+"px"),r.setStyle(this.scroller.style,"left",t+this.margin.left+"px"),s.scrollerWidth=Math.max(0,n-t-this.scrollBarV.getWidth()-this.margin.h),r.setStyle(this.$gutter.style,"left",this.margin.left+"px");var l=this.scrollBarV.getWidth()+"px";r.setStyle(this.scrollBarH.element.style,"right",l),r.setStyle(this.scroller.style,"right",l),r.setStyle(this.scroller.style,"bottom",this.scrollBarH.getHeight()),(this.session&&this.session.getUseWrapMode()&&this.adjustWrapLimit()||e)&&(o|=this.CHANGE_FULL)}return s.$dirty=!n||!i,o&&this._signal("resize",a),o},this.onGutterResize=function(e){var t=this.$showGutter?e:0;t!=this.gutterWidth&&(this.$changes|=this.$updateCachedSize(!0,t,this.$size.width,this.$size.height)),this.session.getUseWrapMode()&&this.adjustWrapLimit()||this.$size.$dirty?this.$loop.schedule(this.CHANGE_FULL):this.$computeLayerConfig()},this.adjustWrapLimit=function(){var e=this.$size.scrollerWidth-2*this.$padding,t=Math.floor(e/this.characterWidth);return this.session.adjustWrapLimit(t,this.$showPrintMargin&&this.$printMarginColumn)},this.setAnimatedScroll=function(e){this.setOption("animatedScroll",e)},this.getAnimatedScroll=function(){return this.$animatedScroll},this.setShowInvisibles=function(e){this.setOption("showInvisibles",e),this.session.$bidiHandler.setShowInvisibles(e)},this.getShowInvisibles=function(){return this.getOption("showInvisibles")},this.getDisplayIndentGuides=function(){return this.getOption("displayIndentGuides")},this.setDisplayIndentGuides=function(e){this.setOption("displayIndentGuides",e)},this.setShowPrintMargin=function(e){this.setOption("showPrintMargin",e)},this.getShowPrintMargin=function(){return this.getOption("showPrintMargin")},this.setPrintMarginColumn=function(e){this.setOption("printMarginColumn",e)},this.getPrintMarginColumn=function(){return this.getOption("printMarginColumn")},this.getShowGutter=function(){return this.getOption("showGutter")},this.setShowGutter=function(e){return this.setOption("showGutter",e)},this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},this.setFadeFoldWidgets=function(e){this.setOption("fadeFoldWidgets",e)},this.setHighlightGutterLine=function(e){this.setOption("highlightGutterLine",e)},this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},this.$updatePrintMargin=function(){if(this.$showPrintMargin||this.$printMarginEl){if(!this.$printMarginEl){var e=r.createElement("div");e.className="ace_layer ace_print-margin-layer",this.$printMarginEl=r.createElement("div"),this.$printMarginEl.className="ace_print-margin",e.appendChild(this.$printMarginEl),this.content.insertBefore(e,this.content.firstChild)}var t=this.$printMarginEl.style;t.left=Math.round(this.characterWidth*this.$printMarginColumn+this.$padding)+"px",t.visibility=this.$showPrintMargin?"visible":"hidden",this.session&&-1==this.session.$wrap&&this.adjustWrapLimit()}},this.getContainerElement=function(){return this.container},this.getMouseEventTarget=function(){return this.scroller},this.getTextAreaContainer=function(){return this.container},this.$moveTextAreaToCursor=function(){if(!this.$isMousePressed){var e=this.textarea.style,t=this.$composition;if(this.$keepTextAreaAtCursor||t){var n=this.$cursorLayer.$pixelPos;if(n){t&&t.markerRange&&(n=this.$cursorLayer.getPixelPosition(t.markerRange.start,!0));var i=this.layerConfig,o=n.top,s=n.left;o-=i.offset;var a=t&&t.useTextareaForIME?this.lineHeight:v?0:1;if(o<0||o>i.height-a)r.translate(this.textarea,0,0);else{var l=1,c=this.$size.height-a;if(t)if(t.useTextareaForIME){var u=this.textarea.value;l=this.characterWidth*this.session.$getStringScreenWidth(u)[0]}else o+=this.lineHeight+2;else o+=this.lineHeight;(s-=this.scrollLeft)>this.$size.scrollerWidth-l&&(s=this.$size.scrollerWidth-l),s+=this.gutterWidth+this.margin.left,r.setStyle(e,"height",a+"px"),r.setStyle(e,"width",l+"px"),r.translate(this.textarea,Math.min(s,this.$size.scrollerWidth-l),Math.min(o,c))}}}else r.translate(this.textarea,-100,0)}},this.getFirstVisibleRow=function(){return this.layerConfig.firstRow},this.getFirstFullyVisibleRow=function(){return this.layerConfig.firstRow+(0===this.layerConfig.offset?0:1)},this.getLastFullyVisibleRow=function(){var e=this.layerConfig,t=e.lastRow;return this.session.documentToScreenRow(t,0)*e.lineHeight-this.session.getScrollTop()>e.height-e.lineHeight?t-1:t},this.getLastVisibleRow=function(){return this.layerConfig.lastRow},this.$padding=null,this.setPadding=function(e){this.$padding=e,this.$textLayer.setPadding(e),this.$cursorLayer.setPadding(e),this.$markerFront.setPadding(e),this.$markerBack.setPadding(e),this.$loop.schedule(this.CHANGE_FULL),this.$updatePrintMargin()},this.setScrollMargin=function(e,t,n,i){var r=this.scrollMargin;r.top=0|e,r.bottom=0|t,r.right=0|i,r.left=0|n,r.v=r.top+r.bottom,r.h=r.left+r.right,r.top&&this.scrollTop<=0&&this.session&&this.session.setScrollTop(-r.top),this.updateFull()},this.setMargin=function(e,t,n,i){var r=this.margin;r.top=0|e,r.bottom=0|t,r.right=0|i,r.left=0|n,r.v=r.top+r.bottom,r.h=r.left+r.right,this.$updateCachedSize(!0,this.gutterWidth,this.$size.width,this.$size.height),this.updateFull()},this.getHScrollBarAlwaysVisible=function(){return this.$hScrollBarAlwaysVisible},this.setHScrollBarAlwaysVisible=function(e){this.setOption("hScrollBarAlwaysVisible",e)},this.getVScrollBarAlwaysVisible=function(){return this.$vScrollBarAlwaysVisible},this.setVScrollBarAlwaysVisible=function(e){this.setOption("vScrollBarAlwaysVisible",e)},this.$updateScrollBarV=function(){var e=this.layerConfig.maxHeight,t=this.$size.scrollerHeight;!this.$maxLines&&this.$scrollPastEnd&&(e-=(t-this.lineHeight)*this.$scrollPastEnd,this.scrollTop>e-t&&(e=this.scrollTop+t,this.scrollBarV.scrollTop=null)),this.scrollBarV.setScrollHeight(e+this.scrollMargin.v),this.scrollBarV.setScrollTop(this.scrollTop+this.scrollMargin.top)},this.$updateScrollBarH=function(){this.scrollBarH.setScrollWidth(this.layerConfig.width+2*this.$padding+this.scrollMargin.h),this.scrollBarH.setScrollLeft(this.scrollLeft+this.scrollMargin.left)},this.$frozen=!1,this.freeze=function(){this.$frozen=!0},this.unfreeze=function(){this.$frozen=!1},this.$renderChanges=function(e,t){if(this.$changes&&(e|=this.$changes,this.$changes=0),this.session&&this.container.offsetWidth&&!this.$frozen&&(e||t)){if(this.$size.$dirty)return this.$changes|=e,this.onResize(!0);this.lineHeight||this.$textLayer.checkForSizeChanges(),this._signal("beforeRender",e),this.session&&this.session.$bidiHandler&&this.session.$bidiHandler.updateCharacterWidths(this.$fontMetrics);var n=this.layerConfig;if(e&this.CHANGE_FULL||e&this.CHANGE_SIZE||e&this.CHANGE_TEXT||e&this.CHANGE_LINES||e&this.CHANGE_SCROLL||e&this.CHANGE_H_SCROLL){if(e|=this.$computeLayerConfig()|this.$loop.clear(),n.firstRow!=this.layerConfig.firstRow&&n.firstRowScreen==this.layerConfig.firstRowScreen){var i=this.scrollTop+(n.firstRow-this.layerConfig.firstRow)*this.lineHeight;i>0&&(this.scrollTop=i,e|=this.CHANGE_SCROLL,e|=this.$computeLayerConfig()|this.$loop.clear())}n=this.layerConfig,this.$updateScrollBarV(),e&this.CHANGE_H_SCROLL&&this.$updateScrollBarH(),r.translate(this.content,-this.scrollLeft,-n.offset);var o=n.width+2*this.$padding+"px",s=n.minHeight+"px";r.setStyle(this.content.style,"width",o),r.setStyle(this.content.style,"height",s)}if(e&this.CHANGE_H_SCROLL&&(r.translate(this.content,-this.scrollLeft,-n.offset),this.scroller.className=this.scrollLeft<=0?"ace_scroller":"ace_scroller ace_scroll-left"),e&this.CHANGE_FULL)return this.$changedLines=null,this.$textLayer.update(n),this.$showGutter&&this.$gutterLayer.update(n),this.$markerBack.update(n),this.$markerFront.update(n),this.$cursorLayer.update(n),this.$moveTextAreaToCursor(),void this._signal("afterRender",e);if(e&this.CHANGE_SCROLL)return this.$changedLines=null,e&this.CHANGE_TEXT||e&this.CHANGE_LINES?this.$textLayer.update(n):this.$textLayer.scrollLines(n),this.$showGutter&&(e&this.CHANGE_GUTTER||e&this.CHANGE_LINES?this.$gutterLayer.update(n):this.$gutterLayer.scrollLines(n)),this.$markerBack.update(n),this.$markerFront.update(n),this.$cursorLayer.update(n),this.$moveTextAreaToCursor(),void this._signal("afterRender",e);e&this.CHANGE_TEXT?(this.$changedLines=null,this.$textLayer.update(n),this.$showGutter&&this.$gutterLayer.update(n)):e&this.CHANGE_LINES?(this.$updateLines()||e&this.CHANGE_GUTTER&&this.$showGutter)&&this.$gutterLayer.update(n):e&this.CHANGE_TEXT||e&this.CHANGE_GUTTER?this.$showGutter&&this.$gutterLayer.update(n):e&this.CHANGE_CURSOR&&this.$highlightGutterLine&&this.$gutterLayer.updateLineHighlight(n),e&this.CHANGE_CURSOR&&(this.$cursorLayer.update(n),this.$moveTextAreaToCursor()),e&(this.CHANGE_MARKER|this.CHANGE_MARKER_FRONT)&&this.$markerFront.update(n),e&(this.CHANGE_MARKER|this.CHANGE_MARKER_BACK)&&this.$markerBack.update(n),this._signal("afterRender",e)}else this.$changes|=e},this.$autosize=function(){var e=this.session.getScreenLength()*this.lineHeight,t=this.$maxLines*this.lineHeight,n=Math.min(t,Math.max((this.$minLines||1)*this.lineHeight,e))+this.scrollMargin.v+(this.$extraHeight||0);this.$horizScroll&&(n+=this.scrollBarH.getHeight()),this.$maxPixelHeight&&n>this.$maxPixelHeight&&(n=this.$maxPixelHeight);var i=!(n<=2*this.lineHeight)&&e>t;if(n!=this.desiredHeight||this.$size.height!=this.desiredHeight||i!=this.$vScroll){i!=this.$vScroll&&(this.$vScroll=i,this.scrollBarV.setVisible(i));var r=this.container.clientWidth;this.container.style.height=n+"px",this.$updateCachedSize(!0,this.$gutterWidth,r,n),this.desiredHeight=n,this._signal("autosize")}},this.$computeLayerConfig=function(){var e=this.session,t=this.$size,n=t.height<=2*this.lineHeight,i=this.session.getScreenLength()*this.lineHeight,r=this.$getLongestLine(),o=!n&&(this.$hScrollBarAlwaysVisible||t.scrollerWidth-r-2*this.$padding<0),s=this.$horizScroll!==o;s&&(this.$horizScroll=o,this.scrollBarH.setVisible(o));var a=this.$vScroll;this.$maxLines&&this.lineHeight>1&&this.$autosize();var l=t.scrollerHeight+this.lineHeight,c=!this.$maxLines&&this.$scrollPastEnd?(t.scrollerHeight-this.lineHeight)*this.$scrollPastEnd:0;i+=c;var u=this.scrollMargin;this.session.setScrollTop(Math.max(-u.top,Math.min(this.scrollTop,i-t.scrollerHeight+u.bottom))),this.session.setScrollLeft(Math.max(-u.left,Math.min(this.scrollLeft,r+2*this.$padding-t.scrollerWidth+u.right)));var h=!n&&(this.$vScrollBarAlwaysVisible||t.scrollerHeight-i+c<0||this.scrollTop>u.top),d=a!==h;d&&(this.$vScroll=h,this.scrollBarV.setVisible(h));var f,p,g=this.scrollTop%this.lineHeight,m=Math.ceil(l/this.lineHeight)-1,v=Math.max(0,Math.round((this.scrollTop-g)/this.lineHeight)),b=v+m,y=this.lineHeight;v=e.screenToDocumentRow(v,0);var w=e.getFoldLine(v);w&&(v=w.start.row),f=e.documentToScreenRow(v,0),p=e.getRowLength(v)*y,b=Math.min(e.screenToDocumentRow(b,0),e.getLength()-1),l=t.scrollerHeight+e.getRowLength(b)*y+p,g=this.scrollTop-f*y;var x=0;return(this.layerConfig.width!=r||s)&&(x=this.CHANGE_H_SCROLL),(s||d)&&(x|=this.$updateCachedSize(!0,this.gutterWidth,t.width,t.height),this._signal("scrollbarVisibilityChanged"),d&&(r=this.$getLongestLine())),this.layerConfig={width:r,padding:this.$padding,firstRow:v,firstRowScreen:f,lastRow:b,lineHeight:y,characterWidth:this.characterWidth,minHeight:l,maxHeight:i,offset:g,gutterOffset:y?Math.max(0,Math.ceil((g+t.height-t.scrollerHeight)/y)):0,height:this.$size.scrollerHeight},this.session.$bidiHandler&&this.session.$bidiHandler.setContentWidth(r-this.$padding),x},this.$updateLines=function(){if(this.$changedLines){var e=this.$changedLines.firstRow,t=this.$changedLines.lastRow;this.$changedLines=null;var n=this.layerConfig;if(!(e>n.lastRow+1||t<n.firstRow))return t===1/0?(this.$showGutter&&this.$gutterLayer.update(n),void this.$textLayer.update(n)):(this.$textLayer.updateLines(n,e,t),!0)}},this.$getLongestLine=function(){var e=this.session.getScreenWidth();return this.showInvisibles&&!this.session.$useWrapMode&&(e+=1),this.$textLayer&&e>this.$textLayer.MAX_LINE_LENGTH&&(e=this.$textLayer.MAX_LINE_LENGTH+30),Math.max(this.$size.scrollerWidth-2*this.$padding,Math.round(e*this.characterWidth))},this.updateFrontMarkers=function(){this.$markerFront.setMarkers(this.session.getMarkers(!0)),this.$loop.schedule(this.CHANGE_MARKER_FRONT)},this.updateBackMarkers=function(){this.$markerBack.setMarkers(this.session.getMarkers()),this.$loop.schedule(this.CHANGE_MARKER_BACK)},this.addGutterDecoration=function(e,t){this.$gutterLayer.addGutterDecoration(e,t)},this.removeGutterDecoration=function(e,t){this.$gutterLayer.removeGutterDecoration(e,t)},this.updateBreakpoints=function(e){this.$loop.schedule(this.CHANGE_GUTTER)},this.setAnnotations=function(e){this.$gutterLayer.setAnnotations(e),this.$loop.schedule(this.CHANGE_GUTTER)},this.updateCursor=function(){this.$loop.schedule(this.CHANGE_CURSOR)},this.hideCursor=function(){this.$cursorLayer.hideCursor()},this.showCursor=function(){this.$cursorLayer.showCursor()},this.scrollSelectionIntoView=function(e,t,n){this.scrollCursorIntoView(e,n),this.scrollCursorIntoView(t,n)},this.scrollCursorIntoView=function(e,t,n){if(0!==this.$size.scrollerHeight){var i=this.$cursorLayer.getPixelPosition(e),r=i.left,o=i.top,s=n&&n.top||0,a=n&&n.bottom||0,l=this.$scrollAnimation?this.session.getScrollTop():this.scrollTop;l+s>o?(t&&l+s>o+this.lineHeight&&(o-=t*this.$size.scrollerHeight),0===o&&(o=-this.scrollMargin.top),this.session.setScrollTop(o)):l+this.$size.scrollerHeight-a<o+this.lineHeight&&(t&&l+this.$size.scrollerHeight-a<o-this.lineHeight&&(o+=t*this.$size.scrollerHeight),this.session.setScrollTop(o+this.lineHeight+a-this.$size.scrollerHeight));var c=this.scrollLeft;c>r?(r<this.$padding+2*this.layerConfig.characterWidth&&(r=-this.scrollMargin.left),this.session.setScrollLeft(r)):c+this.$size.scrollerWidth<r+this.characterWidth?this.session.setScrollLeft(Math.round(r+this.characterWidth-this.$size.scrollerWidth)):c<=this.$padding&&r-c<this.characterWidth&&this.session.setScrollLeft(0)}},this.getScrollTop=function(){return this.session.getScrollTop()},this.getScrollLeft=function(){return this.session.getScrollLeft()},this.getScrollTopRow=function(){return this.scrollTop/this.lineHeight},this.getScrollBottomRow=function(){return Math.max(0,Math.floor((this.scrollTop+this.$size.scrollerHeight)/this.lineHeight)-1)},this.scrollToRow=function(e){this.session.setScrollTop(e*this.lineHeight)},this.alignCursor=function(e,t){"number"==typeof e&&(e={row:e,column:0});var n=this.$cursorLayer.getPixelPosition(e),i=this.$size.scrollerHeight-this.lineHeight,r=n.top-i*(t||0);return this.session.setScrollTop(r),r},this.STEPS=8,this.$calcSteps=function(e,t){var n,i,r=0,o=this.STEPS,s=[];for(r=0;r<o;++r)s.push((n=r/this.STEPS,i=e,(t-e)*(Math.pow(n-1,3)+1)+i));return s},this.scrollToLine=function(e,t,n,i){var r=this.$cursorLayer.getPixelPosition({row:e,column:0}).top;t&&(r-=this.$size.scrollerHeight/2);var o=this.scrollTop;this.session.setScrollTop(r),!1!==n&&this.animateScrolling(o,i)},this.animateScrolling=function(e,t){var n=this.scrollTop;if(this.$animatedScroll){var i=this;if(e!=n){if(this.$scrollAnimation){var r=this.$scrollAnimation.steps;if(r.length&&(e=r[0])==n)return}var o=i.$calcSteps(e,n);this.$scrollAnimation={from:e,to:n,steps:o},clearInterval(this.$timer),i.session.setScrollTop(o.shift()),i.session.$scrollTop=n,this.$timer=setInterval((function(){if(!i.session)return clearInterval(i.$timer);o.length?(i.session.setScrollTop(o.shift()),i.session.$scrollTop=n):null!=n?(i.session.$scrollTop=-1,i.session.setScrollTop(n),n=null):(i.$timer=clearInterval(i.$timer),i.$scrollAnimation=null,t&&t())}),10)}}},this.scrollToY=function(e){this.scrollTop!==e&&(this.$loop.schedule(this.CHANGE_SCROLL),this.scrollTop=e)},this.scrollToX=function(e){this.scrollLeft!==e&&(this.scrollLeft=e),this.$loop.schedule(this.CHANGE_H_SCROLL)},this.scrollTo=function(e,t){this.session.setScrollTop(t),this.session.setScrollLeft(t)},this.scrollBy=function(e,t){t&&this.session.setScrollTop(this.session.getScrollTop()+t),e&&this.session.setScrollLeft(this.session.getScrollLeft()+e)},this.isScrollableBy=function(e,t){return t<0&&this.session.getScrollTop()>=1-this.scrollMargin.top||(t>0&&this.session.getScrollTop()+this.$size.scrollerHeight-this.layerConfig.maxHeight<-1+this.scrollMargin.bottom||(e<0&&this.session.getScrollLeft()>=1-this.scrollMargin.left||(e>0&&this.session.getScrollLeft()+this.$size.scrollerWidth-this.layerConfig.width<-1+this.scrollMargin.right||void 0)))},this.pixelToScreenCoordinates=function(e,t){var n;if(this.$hasCssTransforms){n={top:0,left:0};var i=this.$fontMetrics.transformCoordinates([e,t]);e=i[1]-this.gutterWidth-this.margin.left,t=i[0]}else n=this.scroller.getBoundingClientRect();var r=e+this.scrollLeft-n.left-this.$padding,o=r/this.characterWidth,s=Math.floor((t+this.scrollTop-n.top)/this.lineHeight),a=this.$blockCursor?Math.floor(o):Math.round(o);return{row:s,column:a,side:o-a>0?1:-1,offsetX:r}},this.screenToTextCoordinates=function(e,t){var n;if(this.$hasCssTransforms){n={top:0,left:0};var i=this.$fontMetrics.transformCoordinates([e,t]);e=i[1]-this.gutterWidth-this.margin.left,t=i[0]}else n=this.scroller.getBoundingClientRect();var r=e+this.scrollLeft-n.left-this.$padding,o=r/this.characterWidth,s=this.$blockCursor?Math.floor(o):Math.round(o),a=Math.floor((t+this.scrollTop-n.top)/this.lineHeight);return this.session.screenToDocumentPosition(a,Math.max(s,0),r)},this.textToScreenCoordinates=function(e,t){var n=this.scroller.getBoundingClientRect(),i=this.session.documentToScreenPosition(e,t),r=this.$padding+(this.session.$bidiHandler.isBidiRow(i.row,e)?this.session.$bidiHandler.getPosLeft(i.column):Math.round(i.column*this.characterWidth)),o=i.row*this.lineHeight;return{pageX:n.left+r-this.scrollLeft,pageY:n.top+o-this.scrollTop}},this.visualizeFocus=function(){r.addCssClass(this.container,"ace_focus")},this.visualizeBlur=function(){r.removeCssClass(this.container,"ace_focus")},this.showComposition=function(e){this.$composition=e,e.cssText||(e.cssText=this.textarea.style.cssText),null==e.useTextareaForIME&&(e.useTextareaForIME=this.$useTextareaForIME),this.$useTextareaForIME?(r.addCssClass(this.textarea,"ace_composition"),this.textarea.style.cssText="",this.$moveTextAreaToCursor(),this.$cursorLayer.element.style.display="none"):e.markerId=this.session.addMarker(e.markerRange,"ace_composition_marker","text")},this.setCompositionText=function(e){var t=this.session.selection.cursor;this.addToken(e,"composition_placeholder",t.row,t.column),this.$moveTextAreaToCursor()},this.hideComposition=function(){if(this.$composition){this.$composition.markerId&&this.session.removeMarker(this.$composition.markerId),r.removeCssClass(this.textarea,"ace_composition"),this.textarea.style.cssText=this.$composition.cssText;var e=this.session.selection.cursor;this.removeExtraToken(e.row,e.column),this.$composition=null,this.$cursorLayer.element.style.display=""}},this.addToken=function(e,t,n,i){var r=this.session;r.bgTokenizer.lines[n]=null;var o={type:t,value:e},s=r.getTokens(n);if(null==i)s.push(o);else for(var a=0,l=0;l<s.length;l++){var c=s[l];if(i<=(a+=c.value.length)){var u=c.value.length-(a-i),h=c.value.slice(0,u),d=c.value.slice(u);s.splice(l,1,{type:c.type,value:h},o,{type:c.type,value:d});break}}this.updateLines(n,n)},this.removeExtraToken=function(e,t){this.updateLines(e,e)},this.setTheme=function(e,t){var n=this;if(this.$themeId=e,n._dispatchEvent("themeChange",{theme:e}),e&&"string"!=typeof e)s(e);else{var i=e||this.$options.theme.initialValue;o.loadModule(["theme",i],s)}function s(i){if(n.$themeId!=e)return t&&t();if(!i||!i.cssClass)throw new Error("couldn't load module "+e+" or it didn't call define");i.$id&&(n.$themeId=i.$id),r.importCssString(i.cssText,i.cssClass,n.container),n.theme&&r.removeCssClass(n.container,n.theme.cssClass);var o="padding"in i?i.padding:"padding"in(n.theme||{})?4:n.$padding;n.$padding&&o!=n.$padding&&n.setPadding(o),n.$theme=i.cssClass,n.theme=i,r.addCssClass(n.container,i.cssClass),r.setCssClass(n.container,"ace_dark",i.isDark),n.$size&&(n.$size.width=0,n.$updateSizeAsync()),n._dispatchEvent("themeLoaded",{theme:i}),t&&t()}},this.getTheme=function(){return this.$themeId},this.setStyle=function(e,t){r.setCssClass(this.container,e,!1!==t)},this.unsetStyle=function(e){r.removeCssClass(this.container,e)},this.setCursorStyle=function(e){r.setStyle(this.scroller.style,"cursor",e)},this.setMouseCursor=function(e){r.setStyle(this.scroller.style,"cursor",e)},this.attachToShadowRoot=function(){r.importCssString(g,"ace_editor.css",this.container)},this.destroy=function(){this.freeze(),this.$fontMetrics.destroy(),this.$cursorLayer.destroy(),this.removeAllListeners(),this.container.textContent=""}}).call(b.prototype),o.defineOptions(b.prototype,"renderer",{animatedScroll:{initialValue:!1},showInvisibles:{set:function(e){this.$textLayer.setShowInvisibles(e)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!1},showPrintMargin:{set:function(){this.$updatePrintMargin()},initialValue:!0},printMarginColumn:{set:function(){this.$updatePrintMargin()},initialValue:80},printMargin:{set:function(e){"number"==typeof e&&(this.$printMarginColumn=e),this.$showPrintMargin=!!e,this.$updatePrintMargin()},get:function(){return this.$showPrintMargin&&this.$printMarginColumn}},showGutter:{set:function(e){this.$gutter.style.display=e?"block":"none",this.$loop.schedule(this.CHANGE_FULL),this.onGutterResize()},initialValue:!0},fadeFoldWidgets:{set:function(e){r.setCssClass(this.$gutter,"ace_fade-fold-widgets",e)},initialValue:!1},showFoldWidgets:{set:function(e){this.$gutterLayer.setShowFoldWidgets(e),this.$loop.schedule(this.CHANGE_GUTTER)},initialValue:!0},displayIndentGuides:{set:function(e){this.$textLayer.setDisplayIndentGuides(e)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!0},highlightGutterLine:{set:function(e){this.$gutterLayer.setHighlightGutterLine(e),this.$loop.schedule(this.CHANGE_GUTTER)},initialValue:!0},hScrollBarAlwaysVisible:{set:function(e){this.$hScrollBarAlwaysVisible&&this.$horizScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},vScrollBarAlwaysVisible:{set:function(e){this.$vScrollBarAlwaysVisible&&this.$vScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},fontSize:{set:function(e){"number"==typeof e&&(e+="px"),this.container.style.fontSize=e,this.updateFontSize()},initialValue:12},fontFamily:{set:function(e){this.container.style.fontFamily=e,this.updateFontSize()}},maxLines:{set:function(e){this.updateFull()}},minLines:{set:function(e){this.$minLines<562949953421311||(this.$minLines=0),this.updateFull()}},maxPixelHeight:{set:function(e){this.updateFull()},initialValue:0},scrollPastEnd:{set:function(e){e=+e||0,this.$scrollPastEnd!=e&&(this.$scrollPastEnd=e,this.$loop.schedule(this.CHANGE_SCROLL))},initialValue:0,handlesSet:!0},fixedWidthGutter:{set:function(e){this.$gutterLayer.$fixedWidth=!!e,this.$loop.schedule(this.CHANGE_GUTTER)}},theme:{set:function(e){this.setTheme(e)},get:function(){return this.$themeId||this.theme},initialValue:"./theme/textmate",handlesSet:!0},hasCssTransforms:{},useTextareaForIME:{initialValue:!m.isMobile&&!m.isIE}}),t.VirtualRenderer=b})),ace.define("ace/worker/worker_client",["require","exports","module","ace/lib/oop","ace/lib/net","ace/lib/event_emitter","ace/config"],(function(e,t,n){"use strict";var i=e("../lib/oop"),r=e("../lib/net"),o=e("../lib/event_emitter").EventEmitter,s=e("../config");function a(e){if("undefined"==typeof Worker)return{postMessage:function(){},terminate:function(){}};if(s.get("loadWorkerFromBlob")){var t=function(e){var t="importScripts('"+r.qualifyURL(e)+"');";try{return new Blob([t],{type:"application/javascript"})}catch(e){var n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder);return n.append(t),n.getBlob("application/javascript")}}(e),n=(window.URL||window.webkitURL).createObjectURL(t);return new Worker(n)}return new Worker(e)}var l=function(e){e.postMessage||(e=this.$createWorkerFromOldConfig.apply(this,arguments)),this.$worker=e,this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this),this.changeListener=this.changeListener.bind(this),this.onMessage=this.onMessage.bind(this),this.callbackId=1,this.callbacks={},this.$worker.onmessage=this.onMessage};(function(){i.implement(this,o),this.$createWorkerFromOldConfig=function(t,n,i,r,o){if(e.nameToUrl&&!e.toUrl&&(e.toUrl=e.nameToUrl),s.get("packaged")||!e.toUrl)r=r||s.moduleUrl(n,"worker");else{var l=this.$normalizePath;r=r||l(e.toUrl("ace/worker/worker.js",null,"_"));var c={};t.forEach((function(t){c[t]=l(e.toUrl(t,null,"_").replace(/(\.js)?(\?.*)?$/,""))}))}return this.$worker=a(r),o&&this.send("importScripts",o),this.$worker.postMessage({init:!0,tlns:c,module:n,classname:i}),this.$worker},this.onMessage=function(e){var t=e.data;switch(t.type){case"event":this._signal(t.name,{data:t.data});break;case"call":var n=this.callbacks[t.id];n&&(n(t.data),delete this.callbacks[t.id]);break;case"error":this.reportError(t.data);break;case"log":window.console&&console.log&&console.log.apply(console,t.data)}},this.reportError=function(e){window.console&&console.error&&console.error(e)},this.$normalizePath=function(e){return r.qualifyURL(e)},this.terminate=function(){this._signal("terminate",{}),this.deltaQueue=null,this.$worker.terminate(),this.$worker=null,this.$doc&&this.$doc.off("change",this.changeListener),this.$doc=null},this.send=function(e,t){this.$worker.postMessage({command:e,args:t})},this.call=function(e,t,n){if(n){var i=this.callbackId++;this.callbacks[i]=n,t.push(i)}this.send(e,t)},this.emit=function(e,t){try{t.data&&t.data.err&&(t.data.err={message:t.data.err.message,stack:t.data.err.stack,code:t.data.err.code}),this.$worker.postMessage({event:e,data:{data:t.data}})}catch(e){console.error(e.stack)}},this.attachToDocument=function(e){this.$doc&&this.terminate(),this.$doc=e,this.call("setValue",[e.getValue()]),e.on("change",this.changeListener)},this.changeListener=function(e){this.deltaQueue||(this.deltaQueue=[],setTimeout(this.$sendDeltaQueue,0)),"insert"==e.action?this.deltaQueue.push(e.start,e.lines):this.deltaQueue.push(e.start,e.end)},this.$sendDeltaQueue=function(){var e=this.deltaQueue;e&&(this.deltaQueue=null,e.length>50&&e.length>this.$doc.getLength()>>1?this.call("setValue",[this.$doc.getValue()]):this.emit("change",{data:e}))}}).call(l.prototype);t.UIWorkerClient=function(e,t,n){var i=null,r=!1,a=Object.create(o),c=[],u=new l({messageBuffer:c,terminate:function(){},postMessage:function(e){c.push(e),i&&(r?setTimeout(h):h())}});u.setEmitSync=function(e){r=e};var h=function(){var e=c.shift();e.command?i[e.command].apply(i,e.args):e.event&&a._signal(e.event,e.data)};return a.postMessage=function(e){u.onMessage({data:e})},a.callback=function(e,t){this.postMessage({type:"call",id:t,data:e})},a.emit=function(e,t){this.postMessage({type:"event",name:e,data:t})},s.loadModule(["worker",t],(function(e){for(i=new e[n](a);c.length;)h()})),u},t.WorkerClient=l,t.createWorker=a})),ace.define("ace/placeholder",["require","exports","module","ace/range","ace/lib/event_emitter","ace/lib/oop"],(function(e,t,n){"use strict";var i=e("./range").Range,r=e("./lib/event_emitter").EventEmitter,o=e("./lib/oop"),s=function(e,t,n,i,r,o){var s=this;this.length=t,this.session=e,this.doc=e.getDocument(),this.mainClass=r,this.othersClass=o,this.$onUpdate=this.onUpdate.bind(this),this.doc.on("change",this.$onUpdate),this.$others=i,this.$onCursorChange=function(){setTimeout((function(){s.onCursorChange()}))},this.$pos=n;var a=e.getUndoManager().$undoStack||e.getUndoManager().$undostack||{length:-1};this.$undoStackDepth=a.length,this.setup(),e.selection.on("changeCursor",this.$onCursorChange)};(function(){o.implement(this,r),this.setup=function(){var e=this,t=this.doc,n=this.session;this.selectionBefore=n.selection.toJSON(),n.selection.inMultiSelectMode&&n.selection.toSingleRange(),this.pos=t.createAnchor(this.$pos.row,this.$pos.column);var r=this.pos;r.$insertRight=!0,r.detach(),r.markerId=n.addMarker(new i(r.row,r.column,r.row,r.column+this.length),this.mainClass,null,!1),this.others=[],this.$others.forEach((function(n){var i=t.createAnchor(n.row,n.column);i.$insertRight=!0,i.detach(),e.others.push(i)})),n.setUndoSelect(!1)},this.showOtherMarkers=function(){if(!this.othersActive){var e=this.session,t=this;this.othersActive=!0,this.others.forEach((function(n){n.markerId=e.addMarker(new i(n.row,n.column,n.row,n.column+t.length),t.othersClass,null,!1)}))}},this.hideOtherMarkers=function(){if(this.othersActive){this.othersActive=!1;for(var e=0;e<this.others.length;e++)this.session.removeMarker(this.others[e].markerId)}},this.onUpdate=function(e){if(this.$updating)return this.updateAnchors(e);var t=e;if(t.start.row===t.end.row&&t.start.row===this.pos.row){this.$updating=!0;var n="insert"===e.action?t.end.column-t.start.column:t.start.column-t.end.column,r=t.start.column>=this.pos.column&&t.start.column<=this.pos.column+this.length+1,o=t.start.column-this.pos.column;if(this.updateAnchors(e),r&&(this.length+=n),r&&!this.session.$fromUndo)if("insert"===e.action)for(var s=this.others.length-1;s>=0;s--){var a={row:(l=this.others[s]).row,column:l.column+o};this.doc.insertMergedLines(a,e.lines)}else if("remove"===e.action)for(s=this.others.length-1;s>=0;s--){var l;a={row:(l=this.others[s]).row,column:l.column+o};this.doc.remove(new i(a.row,a.column,a.row,a.column-n))}this.$updating=!1,this.updateMarkers()}},this.updateAnchors=function(e){this.pos.onChange(e);for(var t=this.others.length;t--;)this.others[t].onChange(e);this.updateMarkers()},this.updateMarkers=function(){if(!this.$updating){var e=this,t=this.session,n=function(n,r){t.removeMarker(n.markerId),n.markerId=t.addMarker(new i(n.row,n.column,n.row,n.column+e.length),r,null,!1)};n(this.pos,this.mainClass);for(var r=this.others.length;r--;)n(this.others[r],this.othersClass)}},this.onCursorChange=function(e){if(!this.$updating&&this.session){var t=this.session.selection.getCursor();t.row===this.pos.row&&t.column>=this.pos.column&&t.column<=this.pos.column+this.length?(this.showOtherMarkers(),this._emit("cursorEnter",e)):(this.hideOtherMarkers(),this._emit("cursorLeave",e))}},this.detach=function(){this.session.removeMarker(this.pos&&this.pos.markerId),this.hideOtherMarkers(),this.doc.off("change",this.$onUpdate),this.session.selection.off("changeCursor",this.$onCursorChange),this.session.setUndoSelect(!0),this.session=null},this.cancel=function(){if(-1!==this.$undoStackDepth){for(var e=this.session.getUndoManager(),t=(e.$undoStack||e.$undostack).length-this.$undoStackDepth,n=0;n<t;n++)e.undo(this.session,!0);this.selectionBefore&&this.session.selection.fromJSON(this.selectionBefore)}}}).call(s.prototype),t.PlaceHolder=s})),ace.define("ace/mouse/multi_select_handler",["require","exports","module","ace/lib/event","ace/lib/useragent"],(function(e,t,n){var i=e("../lib/event"),r=e("../lib/useragent");function o(e,t){return e.row==t.row&&e.column==t.column}t.onMouseDown=function(e){var t=e.domEvent,n=t.altKey,s=t.shiftKey,a=t.ctrlKey,l=e.getAccelKey(),c=e.getButton();if(a&&r.isMac&&(c=t.button),e.editor.inMultiSelectMode&&2==c)e.editor.textInput.onContextMenu(e.domEvent);else if(a||n||l){if(0===c){var u,h=e.editor,d=h.selection,f=h.inMultiSelectMode,p=e.getDocumentPosition(),g=d.getCursor(),m=e.inSelection()||d.isEmpty()&&o(p,g),v=e.x,b=e.y,y=h.session,w=h.renderer.pixelToScreenCoordinates(v,b),x=w;if(h.$mouseHandler.$enableJumpToDef)a&&n||l&&n?u=s?"block":"add":n&&h.$blockSelectEnabled&&(u="block");else if(l&&!n){if(u="add",!f&&s)return}else n&&h.$blockSelectEnabled&&(u="block");if(u&&r.isMac&&t.ctrlKey&&h.$mouseHandler.cancelContextMenu(),"add"==u){if(!f&&m)return;if(!f){var _=d.toOrientedRange();h.addSelectionMarker(_)}var k=d.rangeList.rangeAtPoint(p);h.inVirtualSelectionMode=!0,s&&(k=null,_=d.ranges[0]||_,h.removeSelectionMarker(_)),h.once("mouseup",(function(){var e=d.toOrientedRange();k&&e.isEmpty()&&o(k.cursor,e.cursor)?d.substractPoint(e.cursor):(s?d.substractPoint(_.cursor):_&&(h.removeSelectionMarker(_),d.addRange(_)),d.addRange(e)),h.inVirtualSelectionMode=!1}))}else if("block"==u){var S;e.stop(),h.inVirtualSelectionMode=!0;var O=[],C=function(){var e=h.renderer.pixelToScreenCoordinates(v,b),t=y.screenToDocumentPosition(e.row,e.column,e.offsetX);o(x,e)&&o(t,d.lead)||(x=e,h.selection.moveToPosition(t),h.renderer.scrollCursorIntoView(),h.removeSelectionMarkers(O),O=d.rectangularRangeBlock(x,w),h.$mouseHandler.$clickSelection&&1==O.length&&O[0].isEmpty()&&(O[0]=h.$mouseHandler.$clickSelection.clone()),O.forEach(h.addSelectionMarker,h),h.updateSelectionMarkers())};f&&!l?d.toSingleRange():!f&&l&&(S=d.toOrientedRange(),h.addSelectionMarker(S)),s?w=y.documentToScreenPosition(d.lead):d.moveToPosition(p),x={row:-1,column:-1};var A=C;i.capture(h.container,(function(e){v=e.clientX,b=e.clientY}),(function(e){C(),clearInterval($),h.removeSelectionMarkers(O),O.length||(O=[d.toOrientedRange()]),S&&(h.removeSelectionMarker(S),d.toSingleRange(S));for(var t=0;t<O.length;t++)d.addRange(O[t]);h.inVirtualSelectionMode=!1,h.$mouseHandler.$clickSelection=null}));var $=setInterval((function(){A()}),20);return e.preventDefault()}}}else 0===c&&e.editor.inMultiSelectMode&&e.editor.exitMultiSelectMode()}})),ace.define("ace/commands/multi_select_commands",["require","exports","module","ace/keyboard/hash_handler"],(function(e,t,n){t.defaultCommands=[{name:"addCursorAbove",description:"Add cursor above",exec:function(e){e.selectMoreLines(-1)},bindKey:{win:"Ctrl-Alt-Up",mac:"Ctrl-Alt-Up"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorBelow",description:"Add cursor below",exec:function(e){e.selectMoreLines(1)},bindKey:{win:"Ctrl-Alt-Down",mac:"Ctrl-Alt-Down"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorAboveSkipCurrent",description:"Add cursor above (skip current)",exec:function(e){e.selectMoreLines(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Up",mac:"Ctrl-Alt-Shift-Up"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorBelowSkipCurrent",description:"Add cursor below (skip current)",exec:function(e){e.selectMoreLines(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Down",mac:"Ctrl-Alt-Shift-Down"},scrollIntoView:"cursor",readOnly:!0},{name:"selectMoreBefore",description:"Select more before",exec:function(e){e.selectMore(-1)},bindKey:{win:"Ctrl-Alt-Left",mac:"Ctrl-Alt-Left"},scrollIntoView:"cursor",readOnly:!0},{name:"selectMoreAfter",description:"Select more after",exec:function(e){e.selectMore(1)},bindKey:{win:"Ctrl-Alt-Right",mac:"Ctrl-Alt-Right"},scrollIntoView:"cursor",readOnly:!0},{name:"selectNextBefore",description:"Select next before",exec:function(e){e.selectMore(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Left",mac:"Ctrl-Alt-Shift-Left"},scrollIntoView:"cursor",readOnly:!0},{name:"selectNextAfter",description:"Select next after",exec:function(e){e.selectMore(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Right",mac:"Ctrl-Alt-Shift-Right"},scrollIntoView:"cursor",readOnly:!0},{name:"toggleSplitSelectionIntoLines",description:"Split into lines",exec:function(e){e.multiSelect.rangeCount>1?e.multiSelect.joinSelections():e.multiSelect.splitIntoLines()},bindKey:{win:"Ctrl-Alt-L",mac:"Ctrl-Alt-L"},readOnly:!0},{name:"splitSelectionIntoLines",description:"Split into lines",exec:function(e){e.multiSelect.splitIntoLines()},readOnly:!0},{name:"alignCursors",description:"Align cursors",exec:function(e){e.alignCursors()},bindKey:{win:"Ctrl-Alt-A",mac:"Ctrl-Alt-A"},scrollIntoView:"cursor"},{name:"findAll",description:"Find all",exec:function(e){e.findAll()},bindKey:{win:"Ctrl-Alt-K",mac:"Ctrl-Alt-G"},scrollIntoView:"cursor",readOnly:!0}],t.multiSelectCommands=[{name:"singleSelection",description:"Single selection",bindKey:"esc",exec:function(e){e.exitMultiSelectMode()},scrollIntoView:"cursor",readOnly:!0,isAvailable:function(e){return e&&e.inMultiSelectMode}}];var i=e("../keyboard/hash_handler").HashHandler;t.keyboardHandler=new i(t.multiSelectCommands)})),ace.define("ace/multi_select",["require","exports","module","ace/range_list","ace/range","ace/selection","ace/mouse/multi_select_handler","ace/lib/event","ace/lib/lang","ace/commands/multi_select_commands","ace/search","ace/edit_session","ace/editor","ace/config"],(function(e,t,n){var i=e("./range_list").RangeList,r=e("./range").Range,o=e("./selection").Selection,s=e("./mouse/multi_select_handler").onMouseDown,a=e("./lib/event"),l=e("./lib/lang"),c=e("./commands/multi_select_commands");t.commands=c.defaultCommands.concat(c.multiSelectCommands);var u=new(0,e("./search").Search);var h=e("./edit_session").EditSession;(function(){this.getSelectionMarkers=function(){return this.$selectionMarkers}}).call(h.prototype),function(){this.ranges=null,this.rangeList=null,this.addRange=function(e,t){if(e){if(!this.inMultiSelectMode&&0===this.rangeCount){var n=this.toOrientedRange();if(this.rangeList.add(n),this.rangeList.add(e),2!=this.rangeList.ranges.length)return this.rangeList.removeAll(),t||this.fromOrientedRange(e);this.rangeList.removeAll(),this.rangeList.add(n),this.$onAddRange(n)}e.cursor||(e.cursor=e.end);var i=this.rangeList.add(e);return this.$onAddRange(e),i.length&&this.$onRemoveRange(i),this.rangeCount>1&&!this.inMultiSelectMode&&(this._signal("multiSelect"),this.inMultiSelectMode=!0,this.session.$undoSelect=!1,this.rangeList.attach(this.session)),t||this.fromOrientedRange(e)}},this.toSingleRange=function(e){e=e||this.ranges[0];var t=this.rangeList.removeAll();t.length&&this.$onRemoveRange(t),e&&this.fromOrientedRange(e)},this.substractPoint=function(e){var t=this.rangeList.substractPoint(e);if(t)return this.$onRemoveRange(t),t[0]},this.mergeOverlappingRanges=function(){var e=this.rangeList.merge();e.length&&this.$onRemoveRange(e)},this.$onAddRange=function(e){this.rangeCount=this.rangeList.ranges.length,this.ranges.unshift(e),this._signal("addRange",{range:e})},this.$onRemoveRange=function(e){if(this.rangeCount=this.rangeList.ranges.length,1==this.rangeCount&&this.inMultiSelectMode){var t=this.rangeList.ranges.pop();e.push(t),this.rangeCount=0}for(var n=e.length;n--;){var i=this.ranges.indexOf(e[n]);this.ranges.splice(i,1)}this._signal("removeRange",{ranges:e}),0===this.rangeCount&&this.inMultiSelectMode&&(this.inMultiSelectMode=!1,this._signal("singleSelect"),this.session.$undoSelect=!0,this.rangeList.detach(this.session)),(t=t||this.ranges[0])&&!t.isEqual(this.getRange())&&this.fromOrientedRange(t)},this.$initRangeList=function(){this.rangeList||(this.rangeList=new i,this.ranges=[],this.rangeCount=0)},this.getAllRanges=function(){return this.rangeCount?this.rangeList.ranges.concat():[this.getRange()]},this.splitIntoLines=function(){for(var e=this.ranges.length?this.ranges:[this.getRange()],t=[],n=0;n<e.length;n++){var i=e[n],o=i.start.row,s=i.end.row;if(o===s)t.push(i.clone());else{for(t.push(new r(o,i.start.column,o,this.session.getLine(o).length));++o<s;)t.push(this.getLineRange(o,!0));t.push(new r(s,0,s,i.end.column))}0!=n||this.isBackwards()||(t=t.reverse())}this.toSingleRange();for(n=t.length;n--;)this.addRange(t[n])},this.joinSelections=function(){var e=this.rangeList.ranges,t=e[e.length-1],n=r.fromPoints(e[0].start,t.end);this.toSingleRange(),this.setSelectionRange(n,t.cursor==t.start)},this.toggleBlockSelection=function(){if(this.rangeCount>1){var e=this.rangeList.ranges,t=e[e.length-1],n=r.fromPoints(e[0].start,t.end);this.toSingleRange(),this.setSelectionRange(n,t.cursor==t.start)}else{var i=this.session.documentToScreenPosition(this.cursor),o=this.session.documentToScreenPosition(this.anchor);this.rectangularRangeBlock(i,o).forEach(this.addRange,this)}},this.rectangularRangeBlock=function(e,t,n){var i=[],o=e.column<t.column;if(o)var s=e.column,a=t.column,l=e.offsetX,c=t.offsetX;else s=t.column,a=e.column,l=t.offsetX,c=e.offsetX;var u,h,d,f=e.row<t.row;if(f)var p=e.row,g=t.row;else p=t.row,g=e.row;s<0&&(s=0),p<0&&(p=0),p==g&&(n=!0);for(var m=p;m<=g;m++){var v=r.fromPoints(this.session.screenToDocumentPosition(m,s,l),this.session.screenToDocumentPosition(m,a,c));if(v.isEmpty()){if(u&&(h=v.end,d=u,h.row==d.row&&h.column==d.column))break;u=v.end}v.cursor=o?v.start:v.end,i.push(v)}if(f&&i.reverse(),!n){for(var b=i.length-1;i[b].isEmpty()&&b>0;)b--;if(b>0)for(var y=0;i[y].isEmpty();)y++;for(var w=b;w>=y;w--)i[w].isEmpty()&&i.splice(w,1)}return i}}.call(o.prototype);var d=e("./editor").Editor;function f(e){e.$multiselectOnSessionChange||(e.$onAddRange=e.$onAddRange.bind(e),e.$onRemoveRange=e.$onRemoveRange.bind(e),e.$onMultiSelect=e.$onMultiSelect.bind(e),e.$onSingleSelect=e.$onSingleSelect.bind(e),e.$multiselectOnSessionChange=t.onSessionChange.bind(e),e.$checkMultiselectChange=e.$checkMultiselectChange.bind(e),e.$multiselectOnSessionChange(e),e.on("changeSession",e.$multiselectOnSessionChange),e.on("mousedown",s),e.commands.addCommands(c.defaultCommands),function(e){if(!e.textInput)return;var t=e.textInput.getElement(),n=!1;function i(t){n&&(e.renderer.setMouseCursor(""),n=!1)}a.addListener(t,"keydown",(function(t){var r=18==t.keyCode&&!(t.ctrlKey||t.shiftKey||t.metaKey);e.$blockSelectEnabled&&r?n||(e.renderer.setMouseCursor("crosshair"),n=!0):n&&i()}),e),a.addListener(t,"keyup",i,e),a.addListener(t,"blur",i,e)}(e))}(function(){this.updateSelectionMarkers=function(){this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.addSelectionMarker=function(e){e.cursor||(e.cursor=e.end);var t=this.getSelectionStyle();return e.marker=this.session.addMarker(e,"ace_selection",t),this.session.$selectionMarkers.push(e),this.session.selectionMarkerCount=this.session.$selectionMarkers.length,e},this.removeSelectionMarker=function(e){if(e.marker){this.session.removeMarker(e.marker);var t=this.session.$selectionMarkers.indexOf(e);-1!=t&&this.session.$selectionMarkers.splice(t,1),this.session.selectionMarkerCount=this.session.$selectionMarkers.length}},this.removeSelectionMarkers=function(e){for(var t=this.session.$selectionMarkers,n=e.length;n--;){var i=e[n];if(i.marker){this.session.removeMarker(i.marker);var r=t.indexOf(i);-1!=r&&t.splice(r,1)}}this.session.selectionMarkerCount=t.length},this.$onAddRange=function(e){this.addSelectionMarker(e.range),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onRemoveRange=function(e){this.removeSelectionMarkers(e.ranges),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onMultiSelect=function(e){this.inMultiSelectMode||(this.inMultiSelectMode=!0,this.setStyle("ace_multiselect"),this.keyBinding.addKeyboardHandler(c.keyboardHandler),this.commands.setDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers())},this.$onSingleSelect=function(e){this.session.multiSelect.inVirtualMode||(this.inMultiSelectMode=!1,this.unsetStyle("ace_multiselect"),this.keyBinding.removeKeyboardHandler(c.keyboardHandler),this.commands.removeDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers(),this._emit("changeSelection"))},this.$onMultiSelectExec=function(e){var t=e.command,n=e.editor;if(n.multiSelect){if(t.multiSelectAction)"forEach"==t.multiSelectAction?i=n.forEachSelection(t,e.args):"forEachLine"==t.multiSelectAction?i=n.forEachSelection(t,e.args,!0):"single"==t.multiSelectAction?(n.exitMultiSelectMode(),i=t.exec(n,e.args||{})):i=t.multiSelectAction(n,e.args||{});else{var i=t.exec(n,e.args||{});n.multiSelect.addRange(n.multiSelect.toOrientedRange()),n.multiSelect.mergeOverlappingRanges()}return i}},this.forEachSelection=function(e,t,n){if(!this.inVirtualSelectionMode){var i,r=n&&n.keepOrder,s=1==n||n&&n.$byLines,a=this.session,l=this.selection,c=l.rangeList,u=(r?l:c).ranges;if(!u.length)return e.exec?e.exec(this,t||{}):e(this,t||{});var h=l._eventRegistry;l._eventRegistry={};var d=new o(a);this.inVirtualSelectionMode=!0;for(var f=u.length;f--;){if(s)for(;f>0&&u[f].start.row==u[f-1].end.row;)f--;d.fromOrientedRange(u[f]),d.index=f,this.selection=a.selection=d;var p=e.exec?e.exec(this,t||{}):e(this,t||{});i||void 0===p||(i=p),d.toOrientedRange(u[f])}d.detach(),this.selection=a.selection=l,this.inVirtualSelectionMode=!1,l._eventRegistry=h,l.mergeOverlappingRanges(),l.ranges[0]&&l.fromOrientedRange(l.ranges[0]);var g=this.renderer.$scrollAnimation;return this.onCursorChange(),this.onSelectionChange(),g&&g.from==g.to&&this.renderer.animateScrolling(g.from),i}},this.exitMultiSelectMode=function(){this.inMultiSelectMode&&!this.inVirtualSelectionMode&&this.multiSelect.toSingleRange()},this.getSelectedText=function(){var e="";if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){for(var t=this.multiSelect.rangeList.ranges,n=[],i=0;i<t.length;i++)n.push(this.session.getTextRange(t[i]));var r=this.session.getDocument().getNewLineCharacter();(e=n.join(r)).length==(n.length-1)*r.length&&(e="")}else this.selection.isEmpty()||(e=this.session.getTextRange(this.getSelectionRange()));return e},this.$checkMultiselectChange=function(e,t){if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){var n=this.multiSelect.ranges[0];if(this.multiSelect.isEmpty()&&t==this.multiSelect.anchor)return;var i=t==this.multiSelect.anchor?n.cursor==n.start?n.end:n.start:n.cursor;i.row!=t.row||this.session.$clipPositionToDocument(i.row,i.column).column!=t.column?this.multiSelect.toSingleRange(this.multiSelect.toOrientedRange()):this.multiSelect.mergeOverlappingRanges()}},this.findAll=function(e,t,n){if((t=t||{}).needle=e||t.needle,null==t.needle){var i=this.selection.isEmpty()?this.selection.getWordRange():this.selection.getRange();t.needle=this.session.getTextRange(i)}this.$search.set(t);var r=this.$search.findAll(this.session);if(!r.length)return 0;var o=this.multiSelect;n||o.toSingleRange(r[0]);for(var s=r.length;s--;)o.addRange(r[s],!0);return i&&o.rangeList.rangeAtPoint(i.start)&&o.addRange(i,!0),r.length},this.selectMoreLines=function(e,t){var n=this.selection.toOrientedRange(),i=n.cursor==n.end,o=this.session.documentToScreenPosition(n.cursor);this.selection.$desiredColumn&&(o.column=this.selection.$desiredColumn);var s,a=this.session.screenToDocumentPosition(o.row+e,o.column);if(n.isEmpty())c=a;else var l=this.session.documentToScreenPosition(i?n.end:n.start),c=this.session.screenToDocumentPosition(l.row+e,l.column);i?(s=r.fromPoints(a,c)).cursor=s.start:(s=r.fromPoints(c,a)).cursor=s.end;if(s.desiredColumn=o.column,this.selection.inMultiSelectMode){if(t)var u=n.cursor}else this.selection.addRange(n);this.selection.addRange(s),u&&this.selection.substractPoint(u)},this.transposeSelections=function(e){for(var t=this.session,n=t.multiSelect,i=n.ranges,r=i.length;r--;){if((a=i[r]).isEmpty()){var o=t.getWordRange(a.start.row,a.start.column);a.start.row=o.start.row,a.start.column=o.start.column,a.end.row=o.end.row,a.end.column=o.end.column}}n.mergeOverlappingRanges();var s=[];for(r=i.length;r--;){var a=i[r];s.unshift(t.getTextRange(a))}e<0?s.unshift(s.pop()):s.push(s.shift());for(r=i.length;r--;){o=(a=i[r]).clone();t.replace(a,s[r]),a.start.row=o.start.row,a.start.column=o.start.column}n.fromOrientedRange(n.ranges[0])},this.selectMore=function(e,t,n){var i=this.session,r=i.multiSelect.toOrientedRange();if(!r.isEmpty()||((r=i.getWordRange(r.start.row,r.start.column)).cursor=-1==e?r.start:r.end,this.multiSelect.addRange(r),!n)){var o=i.getTextRange(r),s=function(e,t,n){return u.$options.wrap=!0,u.$options.needle=t,u.$options.backwards=-1==n,u.find(e)}(i,o,e);s&&(s.cursor=-1==e?s.start:s.end,this.session.unfold(s),this.multiSelect.addRange(s),this.renderer.scrollCursorIntoView(null,.5)),t&&this.multiSelect.substractPoint(r.cursor)}},this.alignCursors=function(){var e=this.session,t=e.multiSelect,n=t.ranges,i=-1,o=n.filter((function(e){if(e.cursor.row==i)return!0;i=e.cursor.row}));if(n.length&&o.length!=n.length-1){o.forEach((function(e){t.substractPoint(e.cursor)}));var s=0,a=1/0,c=n.map((function(t){var n=t.cursor,i=e.getLine(n.row).substr(n.column).search(/\S/g);return-1==i&&(i=0),n.column>s&&(s=n.column),i<a&&(a=i),i}));n.forEach((function(t,n){var i=t.cursor,o=s-i.column,u=c[n]-a;o>u?e.insert(i,l.stringRepeat(" ",o-u)):e.remove(new r(i.row,i.column,i.row,i.column-o+u)),t.start.column=t.end.column=s,t.start.row=t.end.row=i.row,t.cursor=t.end})),t.fromOrientedRange(n[0]),this.renderer.updateCursor(),this.renderer.updateBackMarkers()}else{var u=this.selection.getRange(),h=u.start.row,d=u.end.row,f=h==d;if(f){var p,g=this.session.getLength();do{p=this.session.getLine(d)}while(/[=:]/.test(p)&&++d<g);do{p=this.session.getLine(h)}while(/[=:]/.test(p)&&--h>0);h<0&&(h=0),d>=g&&(d=g-1)}var m=this.session.removeFullLines(h,d);m=this.$reAlignText(m,f),this.session.insert({row:h,column:0},m.join("\n")+"\n"),f||(u.start.column=0,u.end.column=m[m.length-1].length),this.selection.setRange(u)}},this.$reAlignText=function(e,t){var n,i,r,o=!0,s=!0;return e.map((function(e){var t=e.match(/(\s*)(.*?)(\s*)([=:].*)/);return t?null==n?(n=t[1].length,i=t[2].length,r=t[3].length,t):(n+i+r!=t[1].length+t[2].length+t[3].length&&(s=!1),n!=t[1].length&&(o=!1),n>t[1].length&&(n=t[1].length),i<t[2].length&&(i=t[2].length),r>t[3].length&&(r=t[3].length),t):[e]})).map(t?c:o?s?function(e){return e[2]?a(n+i-e[2].length)+e[2]+a(r)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]}:c:function(e){return e[2]?a(n)+e[2]+a(r)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]});function a(e){return l.stringRepeat(" ",e)}function c(e){return e[2]?a(n)+e[2]+a(i-e[2].length+r)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]}}}).call(d.prototype),t.onSessionChange=function(e){var t=e.session;t&&!t.multiSelect&&(t.$selectionMarkers=[],t.selection.$initRangeList(),t.multiSelect=t.selection),this.multiSelect=t&&t.multiSelect;var n=e.oldSession;n&&(n.multiSelect.off("addRange",this.$onAddRange),n.multiSelect.off("removeRange",this.$onRemoveRange),n.multiSelect.off("multiSelect",this.$onMultiSelect),n.multiSelect.off("singleSelect",this.$onSingleSelect),n.multiSelect.lead.off("change",this.$checkMultiselectChange),n.multiSelect.anchor.off("change",this.$checkMultiselectChange)),t&&(t.multiSelect.on("addRange",this.$onAddRange),t.multiSelect.on("removeRange",this.$onRemoveRange),t.multiSelect.on("multiSelect",this.$onMultiSelect),t.multiSelect.on("singleSelect",this.$onSingleSelect),t.multiSelect.lead.on("change",this.$checkMultiselectChange),t.multiSelect.anchor.on("change",this.$checkMultiselectChange)),t&&this.inMultiSelectMode!=t.selection.inMultiSelectMode&&(t.selection.inMultiSelectMode?this.$onMultiSelect():this.$onSingleSelect())},t.MultiSelect=f,e("./config").defineOptions(d.prototype,"editor",{enableMultiselect:{set:function(e){f(this),e?(this.on("changeSession",this.$multiselectOnSessionChange),this.on("mousedown",s)):(this.off("changeSession",this.$multiselectOnSessionChange),this.off("mousedown",s))},value:!0},enableBlockSelect:{set:function(e){this.$blockSelectEnabled=e},value:!0}})})),ace.define("ace/mode/folding/fold_mode",["require","exports","module","ace/range"],(function(e,t,n){"use strict";var i=e("../../range").Range,r=t.FoldMode=function(){};(function(){this.foldingStartMarker=null,this.foldingStopMarker=null,this.getFoldWidget=function(e,t,n){var i=e.getLine(n);return this.foldingStartMarker.test(i)?"start":"markbeginend"==t&&this.foldingStopMarker&&this.foldingStopMarker.test(i)?"end":""},this.getFoldWidgetRange=function(e,t,n){return null},this.indentationBlock=function(e,t,n){var r=/\S/,o=e.getLine(t),s=o.search(r);if(-1!=s){for(var a=n||o.length,l=e.getLength(),c=t,u=t;++t<l;){var h=e.getLine(t).search(r);if(-1!=h){if(h<=s){var d=e.getTokenAt(t,0);if(!d||"string"!==d.type)break}u=t}}if(u>c){var f=e.getLine(u).length;return new i(c,a,u,f)}}},this.openingBracketBlock=function(e,t,n,r,o){var s={row:n,column:r+1},a=e.$findClosingBracket(t,s,o);if(a){var l=e.foldWidgets[a.row];return null==l&&(l=e.getFoldWidget(a.row)),"start"==l&&a.row>s.row&&(a.row--,a.column=e.getLine(a.row).length),i.fromPoints(s,a)}},this.closingBracketBlock=function(e,t,n,r,o){var s={row:n,column:r},a=e.$findOpeningBracket(t,s);if(a)return a.column++,s.column--,i.fromPoints(a,s)}}).call(r.prototype)})),ace.define("ace/theme/textmate",["require","exports","module","ace/lib/dom"],(function(e,t,n){"use strict";t.isDark=!1,t.cssClass="ace-tm",t.cssText='.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}',t.$id="ace/theme/textmate",e("../lib/dom").importCssString(t.cssText,t.cssClass)})),ace.define("ace/line_widgets",["require","exports","module","ace/lib/dom"],(function(e,t,n){"use strict";var i=e("./lib/dom");function r(e){this.session=e,this.session.widgetManager=this,this.session.getRowLength=this.getRowLength,this.session.$getWidgetScreenLength=this.$getWidgetScreenLength,this.updateOnChange=this.updateOnChange.bind(this),this.renderWidgets=this.renderWidgets.bind(this),this.measureWidgets=this.measureWidgets.bind(this),this.session._changedWidgets=[],this.$onChangeEditor=this.$onChangeEditor.bind(this),this.session.on("change",this.updateOnChange),this.session.on("changeFold",this.updateOnFold),this.session.on("changeEditor",this.$onChangeEditor)}(function(){this.getRowLength=function(e){var t;return t=this.lineWidgets&&this.lineWidgets[e]&&this.lineWidgets[e].rowCount||0,this.$useWrapMode&&this.$wrapData[e]?this.$wrapData[e].length+1+t:1+t},this.$getWidgetScreenLength=function(){var e=0;return this.lineWidgets.forEach((function(t){t&&t.rowCount&&!t.hidden&&(e+=t.rowCount)})),e},this.$onChangeEditor=function(e){this.attach(e.editor)},this.attach=function(e){e&&e.widgetManager&&e.widgetManager!=this&&e.widgetManager.detach(),this.editor!=e&&(this.detach(),this.editor=e,e&&(e.widgetManager=this,e.renderer.on("beforeRender",this.measureWidgets),e.renderer.on("afterRender",this.renderWidgets)))},this.detach=function(e){var t=this.editor;if(t){this.editor=null,t.widgetManager=null,t.renderer.off("beforeRender",this.measureWidgets),t.renderer.off("afterRender",this.renderWidgets);var n=this.session.lineWidgets;n&&n.forEach((function(e){e&&e.el&&e.el.parentNode&&(e._inDocument=!1,e.el.parentNode.removeChild(e.el))}))}},this.updateOnFold=function(e,t){var n=t.lineWidgets;if(n&&e.action){for(var i=e.data,r=i.start.row,o=i.end.row,s="add"==e.action,a=r+1;a<o;a++)n[a]&&(n[a].hidden=s);n[o]&&(s?n[r]?n[o].hidden=s:n[r]=n[o]:(n[r]==n[o]&&(n[r]=void 0),n[o].hidden=s))}},this.updateOnChange=function(e){var t=this.session.lineWidgets;if(t){var n=e.start.row,i=e.end.row-n;if(0===i);else if("remove"==e.action){var r=t.splice(n+1,i);!t[n]&&r[r.length-1]&&(t[n]=r.pop()),r.forEach((function(e){e&&this.removeLineWidget(e)}),this),this.$updateRows()}else{var o=new Array(i);t[n]&&null!=t[n].column&&e.start.column>t[n].column&&n++,o.unshift(n,0),t.splice.apply(t,o),this.$updateRows()}}},this.$updateRows=function(){var e=this.session.lineWidgets;if(e){var t=!0;e.forEach((function(e,n){if(e)for(t=!1,e.row=n;e.$oldWidget;)e.$oldWidget.row=n,e=e.$oldWidget})),t&&(this.session.lineWidgets=null)}},this.$registerLineWidget=function(e){this.session.lineWidgets||(this.session.lineWidgets=new Array(this.session.getLength()));var t=this.session.lineWidgets[e.row];return t&&(e.$oldWidget=t,t.el&&t.el.parentNode&&(t.el.parentNode.removeChild(t.el),t._inDocument=!1)),this.session.lineWidgets[e.row]=e,e},this.addLineWidget=function(e){if(this.$registerLineWidget(e),e.session=this.session,!this.editor)return e;var t=this.editor.renderer;e.html&&!e.el&&(e.el=i.createElement("div"),e.el.innerHTML=e.html),e.el&&(i.addCssClass(e.el,"ace_lineWidgetContainer"),e.el.style.position="absolute",e.el.style.zIndex=5,t.container.appendChild(e.el),e._inDocument=!0,e.coverGutter||(e.el.style.zIndex=3),null==e.pixelHeight&&(e.pixelHeight=e.el.offsetHeight)),null==e.rowCount&&(e.rowCount=e.pixelHeight/t.layerConfig.lineHeight);var n=this.session.getFoldAt(e.row,0);if(e.$fold=n,n){var r=this.session.lineWidgets;e.row!=n.end.row||r[n.start.row]?e.hidden=!0:r[n.start.row]=e}return this.session._emit("changeFold",{data:{start:{row:e.row}}}),this.$updateRows(),this.renderWidgets(null,t),this.onWidgetChanged(e),e},this.removeLineWidget=function(e){if(e._inDocument=!1,e.session=null,e.el&&e.el.parentNode&&e.el.parentNode.removeChild(e.el),e.editor&&e.editor.destroy)try{e.editor.destroy()}catch(e){}if(this.session.lineWidgets){var t=this.session.lineWidgets[e.row];if(t==e)this.session.lineWidgets[e.row]=e.$oldWidget,e.$oldWidget&&this.onWidgetChanged(e.$oldWidget);else for(;t;){if(t.$oldWidget==e){t.$oldWidget=e.$oldWidget;break}t=t.$oldWidget}}this.session._emit("changeFold",{data:{start:{row:e.row}}}),this.$updateRows()},this.getWidgetsAtRow=function(e){for(var t=this.session.lineWidgets,n=t&&t[e],i=[];n;)i.push(n),n=n.$oldWidget;return i},this.onWidgetChanged=function(e){this.session._changedWidgets.push(e),this.editor&&this.editor.renderer.updateFull()},this.measureWidgets=function(e,t){var n=this.session._changedWidgets,i=t.layerConfig;if(n&&n.length){for(var r=1/0,o=0;o<n.length;o++){var s=n[o];if(s&&s.el&&s.session==this.session){if(!s._inDocument){if(this.session.lineWidgets[s.row]!=s)continue;s._inDocument=!0,t.container.appendChild(s.el)}s.h=s.el.offsetHeight,s.fixedWidth||(s.w=s.el.offsetWidth,s.screenWidth=Math.ceil(s.w/i.characterWidth));var a=s.h/i.lineHeight;s.coverLine&&(a-=this.session.getRowLineCount(s.row))<0&&(a=0),s.rowCount!=a&&(s.rowCount=a,s.row<r&&(r=s.row))}}r!=1/0&&(this.session._emit("changeFold",{data:{start:{row:r}}}),this.session.lineWidgetWidth=null),this.session._changedWidgets=[]}},this.renderWidgets=function(e,t){var n=t.layerConfig,i=this.session.lineWidgets;if(i){for(var r=Math.min(this.firstRow,n.firstRow),o=Math.max(this.lastRow,n.lastRow,i.length);r>0&&!i[r];)r--;this.firstRow=n.firstRow,this.lastRow=n.lastRow,t.$cursorLayer.config=n;for(var s=r;s<=o;s++){var a=i[s];if(a&&a.el)if(a.hidden)a.el.style.top=-100-(a.pixelHeight||0)+"px";else{a._inDocument||(a._inDocument=!0,t.container.appendChild(a.el));var l=t.$cursorLayer.getPixelPosition({row:s,column:0},!0).top;a.coverLine||(l+=n.lineHeight*this.session.getRowLineCount(a.row)),a.el.style.top=l-n.offset+"px";var c=a.coverGutter?0:t.gutterWidth;a.fixedWidth||(c-=t.scrollLeft),a.el.style.left=c+"px",a.fullWidth&&a.screenWidth&&(a.el.style.minWidth=n.width+2*n.padding+"px"),a.fixedWidth?a.el.style.right=t.scrollBar.getWidth()+"px":a.el.style.right=""}}}}}).call(r.prototype),t.LineWidgets=r})),ace.define("ace/ext/error_marker",["require","exports","module","ace/line_widgets","ace/lib/dom","ace/range"],(function(e,t,n){"use strict";var i=e("../line_widgets").LineWidgets,r=e("../lib/dom"),o=e("../range").Range;t.showErrorMarker=function(e,t){var n=e.session;n.widgetManager||(n.widgetManager=new i(n),n.widgetManager.attach(e));var s=e.getCursorPosition(),a=s.row,l=n.widgetManager.getWidgetsAtRow(a).filter((function(e){return"errorMarker"==e.type}))[0];l?l.destroy():a-=t;var c,u=function(e,t,n){var i=e.getAnnotations().sort(o.comparePoints);if(i.length){var r=function(e,t,n){for(var i=0,r=e.length-1;i<=r;){var o=i+r>>1,s=n(t,e[o]);if(s>0)i=o+1;else{if(!(s<0))return o;r=o-1}}return-(i+1)}(i,{row:t,column:-1},o.comparePoints);r<0&&(r=-r-1),r>=i.length?r=n>0?0:i.length-1:0===r&&n<0&&(r=i.length-1);var s=i[r];if(s&&n){if(s.row===t){do{s=i[r+=n]}while(s&&s.row===t);if(!s)return i.slice()}var a=[];t=s.row;do{a[n<0?"unshift":"push"](s),s=i[r+=n]}while(s&&s.row==t);return a.length&&a}}}(n,a,t);if(u){var h=u[0];s.column=(h.pos&&"number"!=typeof h.column?h.pos.sc:h.column)||0,s.row=h.row,c=e.renderer.$gutterLayer.$annotations[s.row]}else{if(l)return;c={text:["Looks good!"],className:"ace_ok"}}e.session.unfold(s.row),e.selection.moveToPosition(s);var d={row:s.row,fixedWidth:!0,coverGutter:!0,el:r.createElement("div"),type:"errorMarker"},f=d.el.appendChild(r.createElement("div")),p=d.el.appendChild(r.createElement("div"));p.className="error_widget_arrow "+c.className;var g=e.renderer.$cursorLayer.getPixelPosition(s).left;p.style.left=g+e.renderer.gutterWidth-5+"px",d.el.className="error_widget_wrapper",f.className="error_widget "+c.className,f.innerHTML=c.text.join("<br>"),f.appendChild(r.createElement("div"));var m=function(e,t,n){if(0===t&&("esc"===n||"return"===n))return d.destroy(),{command:"null"}};d.destroy=function(){e.$mouseHandler.isMousePressed||(e.keyBinding.removeKeyboardHandler(m),n.widgetManager.removeLineWidget(d),e.off("changeSelection",d.destroy),e.off("changeSession",d.destroy),e.off("mouseup",d.destroy),e.off("change",d.destroy))},e.keyBinding.addKeyboardHandler(m),e.on("changeSelection",d.destroy),e.on("changeSession",d.destroy),e.on("mouseup",d.destroy),e.on("change",d.destroy),e.session.widgetManager.addLineWidget(d),d.el.onmousedown=e.focus.bind(e),e.renderer.scrollCursorIntoView(null,.5,{bottom:d.el.offsetHeight})},r.importCssString("    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }","")})),ace.define("ace/ace",["require","exports","module","ace/lib/fixoldbrowsers","ace/lib/dom","ace/lib/event","ace/range","ace/editor","ace/edit_session","ace/undomanager","ace/virtual_renderer","ace/worker/worker_client","ace/keyboard/hash_handler","ace/placeholder","ace/multi_select","ace/mode/folding/fold_mode","ace/theme/textmate","ace/ext/error_marker","ace/config"],(function(e,t,i){"use strict";e("./lib/fixoldbrowsers");var r=e("./lib/dom"),o=e("./lib/event"),s=e("./range").Range,a=e("./editor").Editor,l=e("./edit_session").EditSession,c=e("./undomanager").UndoManager,u=e("./virtual_renderer").VirtualRenderer;e("./worker/worker_client"),e("./keyboard/hash_handler"),e("./placeholder"),e("./multi_select"),e("./mode/folding/fold_mode"),e("./theme/textmate"),e("./ext/error_marker"),t.config=e("./config"),t.require=e,t.define=n(57),t.edit=function(e,n){if("string"==typeof e){var i=e;if(!(e=document.getElementById(i)))throw new Error("ace.edit can't find div #"+i)}if(e&&e.env&&e.env.editor instanceof a)return e.env.editor;var s="";if(e&&/input|textarea/i.test(e.tagName)){var l=e;s=l.value,e=r.createElement("pre"),l.parentNode.replaceChild(e,l)}else e&&(s=e.textContent,e.innerHTML="");var c=t.createEditSession(s),h=new a(new u(e),c,n),d={document:c,editor:h,onResize:h.resize.bind(h,null)};return l&&(d.textarea=l),o.addListener(window,"resize",d.onResize),h.on("destroy",(function(){o.removeListener(window,"resize",d.onResize),d.editor.container.env=null})),h.container.env=h.env=d,h},t.createEditSession=function(e,t){var n=new l(e,t);return n.setUndoManager(new c),n},t.Range=s,t.Editor=a,t.EditSession=l,t.UndoManager=c,t.VirtualRenderer=u,t.version=t.config.version})),ace.require(["ace/ace"],(function(t){for(var n in t&&(t.config.init(!0),t.define=ace.define),window.ace||(window.ace=t),t)t.hasOwnProperty(n)&&(window.ace[n]=t[n]);window.ace.default=window.ace,e&&(e.exports=window.ace)}))}).call(this,n(42)(e))},function(e,t,n){const i=n(13);e.exports={re:i.re,src:i.src,tokens:i.t,SEMVER_SPEC_VERSION:n(18).SEMVER_SPEC_VERSION,SemVer:n(5),compareIdentifiers:n(35).compareIdentifiers,rcompareIdentifiers:n(35).rcompareIdentifiers,parse:n(14),valid:n(77),clean:n(78),inc:n(79),diff:n(80),major:n(81),minor:n(82),patch:n(83),prerelease:n(84),compare:n(7),rcompare:n(85),compareLoose:n(86),compareBuild:n(37),sort:n(87),rsort:n(88),gt:n(20),lt:n(38),eq:n(36),neq:n(50),gte:n(39),lte:n(40),cmp:n(51),coerce:n(89),Comparator:n(21),Range:n(8),satisfies:n(22),toComparators:n(90),maxSatisfying:n(91),minSatisfying:n(92),minVersion:n(93),validRange:n(94),outside:n(41),gtr:n(95),ltr:n(96),intersects:n(97),simplifyRange:n(98),subset:n(99)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=/\/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t[0],version:t[1]}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(29);function r(e,...t){for(const n of t)o(e,n);return e}function o(e,t){for(const n of Object.keys(t))Object(i.writeConfig)(e,n,t[n],!0)}String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e})},,,,function(e,t,n){const i=n(7);e.exports=(e,t,n)=>0!==i(e,t,n)},function(e,t,n){const i=n(36),r=n(50),o=n(20),s=n(39),a=n(38),l=n(40);e.exports=(e,t,n,c)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return i(e,n,c);case"!=":return r(e,n,c);case">":return o(e,n,c);case">=":return s(e,n,c);case"<":return a(e,n,c);case"<=":return l(e,n,c);default:throw new TypeError("Invalid operator: "+t)}}},function(e){e.exports=JSON.parse('{"a":"5.14.0"}')},function(e){e.exports=JSON.parse('{"a":"4.14.1"}')},function(e,t){},function(e,t,n){(function(e,n){var i="[object Arguments]",r="[object Map]",o="[object Object]",s="[object Set]",a=/^\[object .+?Constructor\]$/,l=/^(?:0|[1-9]\d*)$/,c={};c["[object Float32Array]"]=c["[object Float64Array]"]=c["[object Int8Array]"]=c["[object Int16Array]"]=c["[object Int32Array]"]=c["[object Uint8Array]"]=c["[object Uint8ClampedArray]"]=c["[object Uint16Array]"]=c["[object Uint32Array]"]=!0,c[i]=c["[object Array]"]=c["[object ArrayBuffer]"]=c["[object Boolean]"]=c["[object DataView]"]=c["[object Date]"]=c["[object Error]"]=c["[object Function]"]=c[r]=c["[object Number]"]=c[o]=c["[object RegExp]"]=c[s]=c["[object String]"]=c["[object WeakMap]"]=!1;var u="object"==typeof e&&e&&e.Object===Object&&e,h="object"==typeof self&&self&&self.Object===Object&&self,d=u||h||Function("return this")(),f=t&&!t.nodeType&&t,p=f&&"object"==typeof n&&n&&!n.nodeType&&n,g=p&&p.exports===f,m=g&&u.process,v=function(){try{return m&&m.binding&&m.binding("util")}catch(e){}}(),b=v&&v.isTypedArray;function y(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}function w(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}function x(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var _,k,S,O=Array.prototype,C=Function.prototype,A=Object.prototype,$=d["__core-js_shared__"],E=C.toString,M=A.hasOwnProperty,j=(_=/[^.]+$/.exec($&&$.keys&&$.keys.IE_PROTO||""))?"Symbol(src)_1."+_:"",R=A.toString,D=RegExp("^"+E.call(M).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),T=g?d.Buffer:void 0,L=d.Symbol,F=d.Uint8Array,N=A.propertyIsEnumerable,P=O.splice,z=L?L.toStringTag:void 0,I=Object.getOwnPropertySymbols,B=T?T.isBuffer:void 0,W=(k=Object.keys,S=Object,function(e){return k(S(e))}),U=ve(d,"DataView"),H=ve(d,"Map"),q=ve(d,"Promise"),V=ve(d,"Set"),G=ve(d,"WeakMap"),K=ve(Object,"create"),Y=xe(U),X=xe(H),J=xe(q),Q=xe(V),Z=xe(G),ee=L?L.prototype:void 0,te=ee?ee.valueOf:void 0;function ne(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function ie(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function re(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function oe(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new re;++t<n;)this.add(e[t])}function se(e){var t=this.__data__=new ie(e);this.size=t.size}function ae(e,t){var n=Se(e),i=!n&&ke(e),r=!n&&!i&&Oe(e),o=!n&&!i&&!r&&Me(e),s=n||i||r||o,a=s?function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}(e.length,String):[],l=a.length;for(var c in e)!t&&!M.call(e,c)||s&&("length"==c||r&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||we(c,l))||a.push(c);return a}function le(e,t){for(var n=e.length;n--;)if(_e(e[n][0],t))return n;return-1}function ce(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":z&&z in Object(e)?function(e){var t=M.call(e,z),n=e[z];try{e[z]=void 0;var i=!0}catch(e){}var r=R.call(e);i&&(t?e[z]=n:delete e[z]);return r}(e):function(e){return R.call(e)}(e)}function ue(e){return Ee(e)&&ce(e)==i}function he(e,t,n,a,l){return e===t||(null==e||null==t||!Ee(e)&&!Ee(t)?e!=e&&t!=t:function(e,t,n,a,l,c){var u=Se(e),h=Se(t),d=u?"[object Array]":ye(e),f=h?"[object Array]":ye(t),p=(d=d==i?o:d)==o,g=(f=f==i?o:f)==o,m=d==f;if(m&&Oe(e)){if(!Oe(t))return!1;u=!0,p=!1}if(m&&!p)return c||(c=new se),u||Me(e)?pe(e,t,n,a,l,c):function(e,t,n,i,o,a,l){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!a(new F(e),new F(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return _e(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case r:var c=w;case s:var u=1&i;if(c||(c=x),e.size!=t.size&&!u)return!1;var h=l.get(e);if(h)return h==t;i|=2,l.set(e,t);var d=pe(c(e),c(t),i,o,a,l);return l.delete(e),d;case"[object Symbol]":if(te)return te.call(e)==te.call(t)}return!1}(e,t,d,n,a,l,c);if(!(1&n)){var v=p&&M.call(e,"__wrapped__"),b=g&&M.call(t,"__wrapped__");if(v||b){var y=v?e.value():e,_=b?t.value():t;return c||(c=new se),l(y,_,n,a,c)}}if(!m)return!1;return c||(c=new se),function(e,t,n,i,r,o){var s=1&n,a=ge(e),l=a.length,c=ge(t).length;if(l!=c&&!s)return!1;var u=l;for(;u--;){var h=a[u];if(!(s?h in t:M.call(t,h)))return!1}var d=o.get(e);if(d&&o.get(t))return d==t;var f=!0;o.set(e,t),o.set(t,e);var p=s;for(;++u<l;){h=a[u];var g=e[h],m=t[h];if(i)var v=s?i(m,g,h,t,e,o):i(g,m,h,e,t,o);if(!(void 0===v?g===m||r(g,m,n,i,o):v)){f=!1;break}p||(p="constructor"==h)}if(f&&!p){var b=e.constructor,y=t.constructor;b==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof y&&y instanceof y||(f=!1)}return o.delete(e),o.delete(t),f}(e,t,n,a,l,c)}(e,t,n,a,he,l))}function de(e){return!(!$e(e)||function(e){return!!j&&j in e}(e))&&(Ce(e)?D:a).test(xe(e))}function fe(e){if(n=(t=e)&&t.constructor,i="function"==typeof n&&n.prototype||A,t!==i)return W(e);var t,n,i,r=[];for(var o in Object(e))M.call(e,o)&&"constructor"!=o&&r.push(o);return r}function pe(e,t,n,i,r,o){var s=1&n,a=e.length,l=t.length;if(a!=l&&!(s&&l>a))return!1;var c=o.get(e);if(c&&o.get(t))return c==t;var u=-1,h=!0,d=2&n?new oe:void 0;for(o.set(e,t),o.set(t,e);++u<a;){var f=e[u],p=t[u];if(i)var g=s?i(p,f,u,t,e,o):i(f,p,u,e,t,o);if(void 0!==g){if(g)continue;h=!1;break}if(d){if(!y(t,(function(e,t){if(s=t,!d.has(s)&&(f===e||r(f,e,n,i,o)))return d.push(t);var s}))){h=!1;break}}else if(f!==p&&!r(f,p,n,i,o)){h=!1;break}}return o.delete(e),o.delete(t),h}function ge(e){return function(e,t,n){var i=t(e);return Se(e)?i:function(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e}(i,n(e))}(e,je,be)}function me(e,t){var n,i,r=e.__data__;return("string"==(i=typeof(n=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof t?"string":"hash"]:r.map}function ve(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return de(n)?n:void 0}ne.prototype.clear=function(){this.__data__=K?K(null):{},this.size=0},ne.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ne.prototype.get=function(e){var t=this.__data__;if(K){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return M.call(t,e)?t[e]:void 0},ne.prototype.has=function(e){var t=this.__data__;return K?void 0!==t[e]:M.call(t,e)},ne.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=K&&void 0===t?"__lodash_hash_undefined__":t,this},ie.prototype.clear=function(){this.__data__=[],this.size=0},ie.prototype.delete=function(e){var t=this.__data__,n=le(t,e);return!(n<0)&&(n==t.length-1?t.pop():P.call(t,n,1),--this.size,!0)},ie.prototype.get=function(e){var t=this.__data__,n=le(t,e);return n<0?void 0:t[n][1]},ie.prototype.has=function(e){return le(this.__data__,e)>-1},ie.prototype.set=function(e,t){var n=this.__data__,i=le(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this},re.prototype.clear=function(){this.size=0,this.__data__={hash:new ne,map:new(H||ie),string:new ne}},re.prototype.delete=function(e){var t=me(this,e).delete(e);return this.size-=t?1:0,t},re.prototype.get=function(e){return me(this,e).get(e)},re.prototype.has=function(e){return me(this,e).has(e)},re.prototype.set=function(e,t){var n=me(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this},oe.prototype.add=oe.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},oe.prototype.has=function(e){return this.__data__.has(e)},se.prototype.clear=function(){this.__data__=new ie,this.size=0},se.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},se.prototype.get=function(e){return this.__data__.get(e)},se.prototype.has=function(e){return this.__data__.has(e)},se.prototype.set=function(e,t){var n=this.__data__;if(n instanceof ie){var i=n.__data__;if(!H||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new re(i)}return n.set(e,t),this.size=n.size,this};var be=I?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,i=null==e?0:e.length,r=0,o=[];++n<i;){var s=e[n];t(s,n,e)&&(o[r++]=s)}return o}(I(e),(function(t){return N.call(e,t)})))}:function(){return[]},ye=ce;function we(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||l.test(e))&&e>-1&&e%1==0&&e<t}function xe(e){if(null!=e){try{return E.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function _e(e,t){return e===t||e!=e&&t!=t}(U&&"[object DataView]"!=ye(new U(new ArrayBuffer(1)))||H&&ye(new H)!=r||q&&"[object Promise]"!=ye(q.resolve())||V&&ye(new V)!=s||G&&"[object WeakMap]"!=ye(new G))&&(ye=function(e){var t=ce(e),n=t==o?e.constructor:void 0,i=n?xe(n):"";if(i)switch(i){case Y:return"[object DataView]";case X:return r;case J:return"[object Promise]";case Q:return s;case Z:return"[object WeakMap]"}return t});var ke=ue(function(){return arguments}())?ue:function(e){return Ee(e)&&M.call(e,"callee")&&!N.call(e,"callee")},Se=Array.isArray;var Oe=B||function(){return!1};function Ce(e){if(!$e(e))return!1;var t=ce(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Ae(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function $e(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ee(e){return null!=e&&"object"==typeof e}var Me=b?function(e){return function(t){return e(t)}}(b):function(e){return Ee(e)&&Ae(e.length)&&!!c[ce(e)]};function je(e){return null!=(t=e)&&Ae(t.length)&&!Ce(t)?ae(e):fe(e);var t}n.exports=function(e,t){return he(e,t)}}).call(this,n(24),n(42)(e))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});t.editorOptions=["minLines","maxLines","readOnly","highlightActiveLine","tabSize","enableBasicAutocompletion","enableLiveAutocompletion","enableSnippets"];t.editorEvents=["onChange","onFocus","onInput","onBlur","onCopy","onPaste","onSelectionChange","onCursorChange","onScroll","handleOptions","updateRef"];t.getAceInstance=function(){var t;return"undefined"==typeof window?(e.window={},t=n(43),delete e.window):window.ace?(t=window.ace).acequire=window.ace.require||window.ace.acequire:t=n(43),t};t.debounce=function(e,t){var n=null;return function(){var i=this,r=arguments;clearTimeout(n),n=setTimeout((function(){e.apply(i,r)}),t)}}}).call(this,n(24))},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(56),a=s.getAceInstance(),l=n(43),c=n(105),u=n(11),h=n(2),d=n(55),f=n(106),p=function(e){function t(t){var n=e.call(this,t)||this;return s.editorEvents.forEach((function(e){n[e]=n[e].bind(n)})),n.debounce=s.debounce,n}return r(t,e),t.prototype.isInShadow=function(e){for(var t=e&&e.parentNode;t;){if("[object ShadowRoot]"===t.toString())return!0;t=t.parentNode}return!1},t.prototype.componentDidMount=function(){var e=this,t=this.props,n=t.className,i=t.onBeforeLoad,r=t.mode,o=t.focus,l=t.theme,u=t.fontSize,h=t.value,d=t.defaultValue,p=t.cursorStart,g=t.showGutter,m=t.wrapEnabled,v=t.showPrintMargin,b=t.scrollMargin,y=void 0===b?[0,0,0,0]:b,w=t.keyboardHandler,x=t.onLoad,_=t.commands,k=t.annotations,S=t.markers,O=t.splits;this.editor=a.edit(this.refEditor),this.isInShadow(this.refEditor)&&this.editor.renderer.attachToShadowRoot(),this.editor.setTheme("ace/theme/"+l),i&&i(a);var C=Object.keys(this.props.editorProps),A=new c.Split(this.editor.container,"ace/theme/"+l,O);this.editor.env.split=A,this.splitEditor=A.getEditor(0),this.split=A,this.editor.setShowPrintMargin(!1),this.editor.renderer.setShowGutter(!1);var $=this.splitEditor.$options;this.props.debounceChangePeriod&&(this.onChange=this.debounce(this.onChange,this.props.debounceChangePeriod)),A.forEach((function(t,n){for(var i=0;i<C.length;i++)t[C[i]]=e.props.editorProps[C[i]];var o=f(d,n),c=f(h,n,"");t.session.setUndoManager(new a.UndoManager),t.setTheme("ace/theme/"+l),t.renderer.setScrollMargin(y[0],y[1],y[2],y[3]),t.getSession().setMode("ace/mode/"+r),t.setFontSize(u),t.renderer.setShowGutter(g),t.getSession().setUseWrapMode(m),t.setShowPrintMargin(v),t.on("focus",e.onFocus),t.on("blur",e.onBlur),t.on("input",e.onInput),t.on("copy",e.onCopy),t.on("paste",e.onPaste),t.on("change",e.onChange),t.getSession().selection.on("changeSelection",e.onSelectionChange),t.getSession().selection.on("changeCursor",e.onCursorChange),t.session.on("changeScrollTop",e.onScroll),t.setValue(void 0===o?c:o,p);var b=f(k,n,[]),x=f(S,n,[]);t.getSession().setAnnotations(b),x&&x.length>0&&e.handleMarkers(x,t);for(i=0;i<s.editorOptions.length;i++){var O=s.editorOptions[i];$.hasOwnProperty(O)?t.setOption(O,e.props[O]):e.props[O]&&console.warn("ReaceAce: editor option "+O+" was activated but not found. Did you need to import a related tool or did you possibly mispell the option?")}e.handleOptions(e.props,t),Array.isArray(_)&&_.forEach((function(e){"string"==typeof e.exec?t.commands.bindKey(e.bindKey,e.exec):t.commands.addCommand(e)})),w&&t.setKeyboardHandler("ace/keyboard/"+w)})),n&&(this.refEditor.className+=" "+n),o&&this.splitEditor.focus();var E=this.editor.env.split;E.setOrientation("below"===this.props.orientation?E.BELOW:E.BESIDE),E.resize(!0),x&&x(E)},t.prototype.componentDidUpdate=function(e){var t=this,n=e,i=this.props,r=this.editor.env.split;if(i.splits!==n.splits&&r.setSplits(i.splits),i.orientation!==n.orientation&&r.setOrientation("below"===i.orientation?r.BELOW:r.BESIDE),r.forEach((function(e,r){i.mode!==n.mode&&e.getSession().setMode("ace/mode/"+i.mode),i.keyboardHandler!==n.keyboardHandler&&(i.keyboardHandler?e.setKeyboardHandler("ace/keyboard/"+i.keyboardHandler):e.setKeyboardHandler(null)),i.fontSize!==n.fontSize&&e.setFontSize(i.fontSize),i.wrapEnabled!==n.wrapEnabled&&e.getSession().setUseWrapMode(i.wrapEnabled),i.showPrintMargin!==n.showPrintMargin&&e.setShowPrintMargin(i.showPrintMargin),i.showGutter!==n.showGutter&&e.renderer.setShowGutter(i.showGutter);for(var o=0;o<s.editorOptions.length;o++){var a=s.editorOptions[o];i[a]!==n[a]&&e.setOption(a,i[a])}d(i.setOptions,n.setOptions)||t.handleOptions(i,e);var l=f(i.value,r,"");if(e.getValue()!==l){t.silent=!0;var c=e.session.selection.toJSON();e.setValue(l,i.cursorStart),e.session.selection.fromJSON(c),t.silent=!1}var u=f(i.annotations,r,[]),h=f(n.annotations,r,[]);d(u,h)||e.getSession().setAnnotations(u);var p=f(i.markers,r,[]),g=f(n.markers,r,[]);!d(p,g)&&Array.isArray(p)&&t.handleMarkers(p,e)})),i.className!==n.className){var o=this.refEditor.className.trim().split(" ");n.className.trim().split(" ").forEach((function(e){var t=o.indexOf(e);o.splice(t,1)})),this.refEditor.className=" "+i.className+" "+o.join(" ")}i.theme!==n.theme&&r.setTheme("ace/theme/"+i.theme),i.focus&&!n.focus&&this.splitEditor.focus(),i.height===this.props.height&&i.width===this.props.width||this.editor.resize()},t.prototype.componentWillUnmount=function(){this.editor.destroy(),this.editor=null},t.prototype.onChange=function(e){if(this.props.onChange&&!this.silent){var t=[];this.editor.env.split.forEach((function(e){t.push(e.getValue())})),this.props.onChange(t,e)}},t.prototype.onSelectionChange=function(e){if(this.props.onSelectionChange){var t=[];this.editor.env.split.forEach((function(e){t.push(e.getSelection())})),this.props.onSelectionChange(t,e)}},t.prototype.onCursorChange=function(e){if(this.props.onCursorChange){var t=[];this.editor.env.split.forEach((function(e){t.push(e.getSelection())})),this.props.onCursorChange(t,e)}},t.prototype.onFocus=function(e){this.props.onFocus&&this.props.onFocus(e)},t.prototype.onInput=function(e){this.props.onInput&&this.props.onInput(e)},t.prototype.onBlur=function(e){this.props.onBlur&&this.props.onBlur(e)},t.prototype.onCopy=function(e){this.props.onCopy&&this.props.onCopy(e)},t.prototype.onPaste=function(e){this.props.onPaste&&this.props.onPaste(e)},t.prototype.onScroll=function(){this.props.onScroll&&this.props.onScroll(this.editor)},t.prototype.handleOptions=function(e,t){for(var n=Object.keys(e.setOptions),i=0;i<n.length;i++)t.setOption(n[i],e.setOptions[n[i]])},t.prototype.handleMarkers=function(e,t){var n=t.getSession().getMarkers(!0);for(var i in n)n.hasOwnProperty(i)&&t.getSession().removeMarker(n[i].id);for(var i in n=t.getSession().getMarkers(!1))n.hasOwnProperty(i)&&t.getSession().removeMarker(n[i].id);e.forEach((function(e){var n=e.startRow,i=e.startCol,r=e.endRow,o=e.endCol,s=e.className,a=e.type,c=e.inFront,u=void 0!==c&&c,h=new l.Range(n,i,r,o);t.getSession().addMarker(h,s,a,u)}))},t.prototype.updateRef=function(e){this.refEditor=e},t.prototype.render=function(){var e=this.props,t=e.name,n=e.width,i=e.height,r=e.style,s=o({width:n,height:i},r);return h.createElement("div",{ref:this.updateRef,id:t,style:s})},t.propTypes={className:u.string,debounceChangePeriod:u.number,defaultValue:u.arrayOf(u.string),focus:u.bool,fontSize:u.oneOfType([u.number,u.string]),height:u.string,mode:u.string,name:u.string,onBlur:u.func,onChange:u.func,onCopy:u.func,onFocus:u.func,onInput:u.func,onLoad:u.func,onPaste:u.func,onScroll:u.func,orientation:u.string,showGutter:u.bool,splits:u.number,theme:u.string,value:u.arrayOf(u.string),width:u.string,onSelectionChange:u.func,onCursorChange:u.func,onBeforeLoad:u.func,minLines:u.number,maxLines:u.number,readOnly:u.bool,highlightActiveLine:u.bool,tabSize:u.number,showPrintMargin:u.bool,cursorStart:u.number,editorProps:u.object,setOptions:u.object,style:u.object,scrollMargin:u.array,annotations:u.array,markers:u.array,keyboardHandler:u.string,wrapEnabled:u.bool,enableBasicAutocompletion:u.oneOfType([u.bool,u.array]),enableLiveAutocompletion:u.oneOfType([u.bool,u.array]),commands:u.array},t.defaultProps={name:"ace-editor",focus:!1,orientation:"beside",splits:2,mode:"",theme:"",height:"500px",width:"500px",value:[],fontSize:12,showGutter:!0,onChange:null,onPaste:null,onLoad:null,onScroll:null,minLines:null,maxLines:null,readOnly:!1,highlightActiveLine:!0,showPrintMargin:!0,tabSize:4,cursorStart:1,editorProps:{},style:{},scrollMargin:[0,0,0,0],setOptions:{},wrapEnabled:!1,enableBasicAutocompletion:!1,enableLiveAutocompletion:!1},t}(h.Component);t.default=p},function(e,t){e.exports=n},function(e,t){e.exports=i},function(e,t,n){(function(t){var n=function(){"use strict";function e(e,t){return null!=t&&e instanceof t}var n,i,r;try{n=Map}catch(e){n=function(){}}try{i=Set}catch(e){i=function(){}}try{r=Promise}catch(e){r=function(){}}function o(s,l,c,u,h){"object"==typeof l&&(c=l.depth,u=l.prototype,h=l.includeNonEnumerable,l=l.circular);var d=[],f=[],p=void 0!==t;return void 0===l&&(l=!0),void 0===c&&(c=1/0),function s(c,g){if(null===c)return null;if(0===g)return c;var m,v;if("object"!=typeof c)return c;if(e(c,n))m=new n;else if(e(c,i))m=new i;else if(e(c,r))m=new r((function(e,t){c.then((function(t){e(s(t,g-1))}),(function(e){t(s(e,g-1))}))}));else if(o.__isArray(c))m=[];else if(o.__isRegExp(c))m=new RegExp(c.source,a(c)),c.lastIndex&&(m.lastIndex=c.lastIndex);else if(o.__isDate(c))m=new Date(c.getTime());else{if(p&&t.isBuffer(c))return m=t.allocUnsafe?t.allocUnsafe(c.length):new t(c.length),c.copy(m),m;e(c,Error)?m=Object.create(c):void 0===u?(v=Object.getPrototypeOf(c),m=Object.create(v)):(m=Object.create(u),v=u)}if(l){var b=d.indexOf(c);if(-1!=b)return f[b];d.push(c),f.push(m)}for(var y in e(c,n)&&c.forEach((function(e,t){var n=s(t,g-1),i=s(e,g-1);m.set(n,i)})),e(c,i)&&c.forEach((function(e){var t=s(e,g-1);m.add(t)})),c){var w;v&&(w=Object.getOwnPropertyDescriptor(v,y)),w&&null==w.set||(m[y]=s(c[y],g-1))}if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(c);for(y=0;y<x.length;y++){var _=x[y];(!(S=Object.getOwnPropertyDescriptor(c,_))||S.enumerable||h)&&(m[_]=s(c[_],g-1),S.enumerable||Object.defineProperty(m,_,{enumerable:!1}))}}if(h){var k=Object.getOwnPropertyNames(c);for(y=0;y<k.length;y++){var S,O=k[y];(S=Object.getOwnPropertyDescriptor(c,O))&&S.enumerable||(m[O]=s(c[O],g-1),Object.defineProperty(m,O,{enumerable:!1}))}}return m}(s,c)}function s(e){return Object.prototype.toString.call(e)}function a(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return o.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},o.__objToStr=s,o.__isDate=function(e){return"object"==typeof e&&"[object Date]"===s(e)},o.__isArray=function(e){return"object"==typeof e&&"[object Array]"===s(e)},o.__isRegExp=function(e){return"object"==typeof e&&"[object RegExp]"===s(e)},o.__getRegExpFlags=a,o}();e.exports&&(e.exports=n)}).call(this,n(23).Buffer)},function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var i,r,o;if(Array.isArray(t)){if((i=t.length)!=n.length)return!1;for(r=i;0!=r--;)if(!e(t[r],n[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((i=(o=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(r=i;0!=r--;)if(!Object.prototype.hasOwnProperty.call(n,o[r]))return!1;for(r=i;0!=r--;){var s=o[r];if(!e(t[s],n[s]))return!1}return!0}return t!=t&&n!=n}},function(e){e.exports=JSON.parse('{"name":"vega-themes","version":"2.8.5","description":"Themes for stylized Vega and Vega-Lite visualizations.","keywords":["vega","vega-lite","themes","style"],"license":"BSD-3-Clause","author":{"name":"UW Interactive Data Lab","url":"https://idl.cs.washington.edu"},"contributors":[{"name":"Emily Gu","url":"https://github.com/emilygu"},{"name":"Arvind Satyanarayan","url":"http://arvindsatya.com"},{"name":"Jeffrey Heer","url":"https://idl.cs.washington.edu"},{"name":"Dominik Moritz","url":"https://www.domoritz.de"}],"main":"build/vega-themes.js","module":"build/src/index.js","unpkg":"build/vega-themes.min.js","jsdelivr":"build/vega-themes.min.js","typings":"build/src/index.d.ts","repository":{"type":"git","url":"https://github.com/vega/vega-themes.git"},"scripts":{"prepare":"beemo create-config --silent","clean":"rm -rf build examples/build","prettierbase":"beemo prettier \'examples/*.{html,scss,css}\'","eslintbase":"beemo eslint .","format":"yarn eslintbase --fix && yarn prettierbase --write","lint":"yarn eslintbase && yarn prettierbase --check","prebuild":"mkdir -p build","build":"tsc && rollup -c","postbuild":"terser build/vega-themes.js -cm > build/vega-themes.min.js","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples","prepublishOnly":"yarn clean && yarn build","preversion":"yarn lint","serve":"browser-sync start -s -f build examples --serveStatic examples","start":"yarn build && concurrently --kill-others -n Server,Typescript,Rollup \'yarn serve\' \'tsc -w\' \'rollup -c -w\'"},"devDependencies":{"@rollup/plugin-json":"^4.1.0","browser-sync":"^2.26.7","concurrently":"^5.2.0","gh-pages":"^3.1.0","rollup":"^2.21.0","terser":"^4.8.0","typescript":"^3.9.6","vega":"^5.10.0","vega-lite":"^4.8.1","vega-lite-dev-config":"^0.11.8"},"peerDependencies":{"vega":"*","vega-lite":"*"},"beemo":{"module":"vega-lite-dev-config","drivers":["prettier","eslint"]}}')},function(e){e.exports=JSON.parse('{"name":"vega-tooltip","version":"0.23.2","description":"A tooltip plugin for Vega-Lite and Vega visualizations.","main":"build/vega-tooltip.js","module":"build/src/index.js","unpkg":"build/vega-tooltip.min.js","jsdelivr":"build/vega-tooltip.min.js","typings":"build/src/index.d.ts","repository":{"type":"git","url":"https://github.com/vega/vega-tooltip.git"},"keywords":["vega-lite","vega","tooltip"],"author":{"name":"UW Interactive Data Lab","url":"https://idl.cs.washington.edu"},"collaborators":["Dominik Moritz","Sira Horradarn","Zening Qu","Kanit Wongsuphasawat","Yuri Astrakhan","Jeffrey Heer"],"license":"BSD-3-Clause","bugs":{"url":"https://github.com/vega/vega-tooltip/issues"},"homepage":"https://github.com/vega/vega-tooltip#readme","scripts":{"prepare":"beemo create-config --silent","tsc:src":"tsc -b tsconfig.src.json","build":"yarn tsc:src && rollup -c","clean":"rm -rf build examples/data && rm -f src/style.ts","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && yarn copy:build && gh-pages -d examples && yarn clean","prettierbase":"beemo prettier \'examples/*.{html,scss,css}\'","eslintbase":"beemo eslint .","format":"yarn eslintbase --fix && yarn prettierbase --write","lint":"yarn eslintbase && yarn prettierbase --check","postbuild":"terser build/vega-tooltip.js -c -m -o build/vega-tooltip.min.js","prebuild":"mkdir -p build && yarn copy:data && ./build-style.sh","prepublishOnly":"yarn clean && yarn build","preversion":"yarn lint","start":"yarn build && concurrently --kill-others -n Server,Typescript,Rollup \'browser-sync start -s -f build examples --serveStatic examples\' \'yarn tsc:src -w\' \'rollup -c -w\'","pretest":"./build-style.sh","test":"jest"},"devDependencies":{"@rollup/plugin-commonjs":"13.0.0","@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^8.1.0","@types/jest":"^26.0.4","browser-sync":"^2.26.7","codecov":"^3.7.0","concurrently":"^5.2.0","gh-pages":"^3.1.0","jest":"^26.1.0","node-sass":"^4.14.1","path":"^0.12.7","rollup":"^2.21.0","terser":"^4.8.0","ts-jest":"^26.1.1","typescript":"^3.9.6","vega-datasets":"^2.1.0","vega-lite-dev-config":"^0.11.8","vega-typings":"^0.18.0"},"dependencies":{"vega-util":"^1.14.1"},"beemo":{"module":"vega-lite-dev-config","drivers":["prettier","eslint"]},"jest":{"testURL":"http://localhost/","transform":{"^.+\\\\.tsx?$":"ts-jest"},"testRegex":"(/__tests__/.*|(\\\\.|/)(test|spec))\\\\.(jsx?|tsx?)$","moduleFileExtensions":["ts","tsx","js","jsx","json","node"],"testPathIgnorePatterns":["node_modules","<rootDir>/build","src"]}}')},function(e,t,n){"use strict";t.a=function(e,t,n){const i=e.open(t),{origin:r}=new URL(t);let o=40;e.addEventListener("message",(function t(n){n.source===i&&(o=0,e.removeEventListener("message",t,!1))}),!1),setTimeout((function e(){o<=0||(i.postMessage(n,r),setTimeout(e,250),o-=1)}),250)}},function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var i,r,o;if(Array.isArray(t)){if((i=t.length)!=n.length)return!1;for(r=i;0!=r--;)if(!e(t[r],n[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((i=(o=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(r=i;0!=r--;)if(!Object.prototype.hasOwnProperty.call(n,o[r]))return!1;for(r=i;0!=r--;){var s=o[r];if(!e(t[s],n[s]))return!1}return!0}return t!=t&&n!=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(103),r=n(104);t.diff=r.default;var o=n(58);t.split=o.default,t.default=i.default},function(e,t,n){"use strict";n.r(t);var i={};n.r(i),n.d(i,"invalidSpec",(function(){return zn})),n.d(i,"FIT_NON_SINGLE",(function(){return In})),n.d(i,"containerSizeNonSingle",(function(){return Bn})),n.d(i,"containerSizeNotCompatibleWithAutosize",(function(){return Wn})),n.d(i,"droppingFit",(function(){return Un})),n.d(i,"unknownField",(function(){return Hn})),n.d(i,"cannotProjectOnChannelWithoutField",(function(){return qn})),n.d(i,"cannotProjectAggregate",(function(){return Vn})),n.d(i,"nearestNotSupportForContinuous",(function(){return Gn})),n.d(i,"selectionNotSupported",(function(){return Kn})),n.d(i,"selectionNotFound",(function(){return Yn})),n.d(i,"SCALE_BINDINGS_CONTINUOUS",(function(){return Xn})),n.d(i,"LEGEND_BINDINGS_MUST_HAVE_PROJECTION",(function(){return Jn})),n.d(i,"noSameUnitLookup",(function(){return Qn})),n.d(i,"NEEDS_SAME_SELECTION",(function(){return Zn})),n.d(i,"INTERVAL_INITIALIZED_WITH_X_Y",(function(){return ei})),n.d(i,"noSuchRepeatedValue",(function(){return ti})),n.d(i,"columnsNotSupportByRowCol",(function(){return ni})),n.d(i,"CONCAT_CANNOT_SHARE_AXIS",(function(){return ii})),n.d(i,"unrecognizedParse",(function(){return ri})),n.d(i,"differentParse",(function(){return oi})),n.d(i,"ADD_SAME_CHILD_TWICE",(function(){return si})),n.d(i,"invalidTransformIgnored",(function(){return ai})),n.d(i,"NO_FIELDS_NEEDS_AS",(function(){return li})),n.d(i,"customFormatTypeNotAllowed",(function(){return ci})),n.d(i,"projectionOverridden",(function(){return ui})),n.d(i,"REPLACE_ANGLE_WITH_THETA",(function(){return hi})),n.d(i,"primitiveChannelDef",(function(){return di})),n.d(i,"invalidFieldType",(function(){return fi})),n.d(i,"invalidFieldTypeForCountAggregate",(function(){return pi})),n.d(i,"invalidAggregate",(function(){return gi})),n.d(i,"missingFieldType",(function(){return mi})),n.d(i,"droppingColor",(function(){return vi})),n.d(i,"emptyFieldDef",(function(){return bi})),n.d(i,"latLongDeprecated",(function(){return yi})),n.d(i,"LINE_WITH_VARYING_SIZE",(function(){return wi})),n.d(i,"incompatibleChannel",(function(){return xi})),n.d(i,"invalidEncodingChannel",(function(){return _i})),n.d(i,"facetChannelShouldBeDiscrete",(function(){return ki})),n.d(i,"facetChannelDropped",(function(){return Si})),n.d(i,"discreteChannelCannotEncode",(function(){return Oi})),n.d(i,"lineWithRange",(function(){return Ci})),n.d(i,"orientOverridden",(function(){return Ai})),n.d(i,"CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN",(function(){return $i})),n.d(i,"RANGE_STEP_DEPRECATED",(function(){return Ei})),n.d(i,"cannotUseScalePropertyWithNonColor",(function(){return Mi})),n.d(i,"unaggregateDomainHasNoEffectForRawField",(function(){return ji})),n.d(i,"unaggregateDomainWithNonSharedDomainOp",(function(){return Ri})),n.d(i,"unaggregatedDomainWithLogScale",(function(){return Di})),n.d(i,"cannotApplySizeToNonOrientedMark",(function(){return Ti})),n.d(i,"scaleTypeNotWorkWithChannel",(function(){return Li})),n.d(i,"scaleTypeNotWorkWithFieldDef",(function(){return Fi})),n.d(i,"scalePropertyNotWorkWithScaleType",(function(){return Ni})),n.d(i,"scaleTypeNotWorkWithMark",(function(){return Pi})),n.d(i,"stepDropped",(function(){return zi})),n.d(i,"mergeConflictingProperty",(function(){return Ii})),n.d(i,"mergeConflictingDomainProperty",(function(){return Bi})),n.d(i,"independentScaleMeansIndependentGuide",(function(){return Wi})),n.d(i,"domainSortDropped",(function(){return Ui})),n.d(i,"MORE_THAN_ONE_SORT",(function(){return Hi})),n.d(i,"FACETED_INDEPENDENT_DIFFERENT_SOURCES",(function(){return qi})),n.d(i,"FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES",(function(){return Vi})),n.d(i,"FACETED_INDEPENDENT_SAME_SOURCE",(function(){return Gi})),n.d(i,"INVALID_CHANNEL_FOR_AXIS",(function(){return Ki})),n.d(i,"cannotStackRangedMark",(function(){return Yi})),n.d(i,"cannotStackNonLinearScale",(function(){return Xi})),n.d(i,"stackNonSummativeAggregate",(function(){return Ji})),n.d(i,"invalidTimeUnit",(function(){return Qi})),n.d(i,"droppedDay",(function(){return Zi})),n.d(i,"errorBarCenterAndExtentAreNotNeeded",(function(){return er})),n.d(i,"errorBarCenterIsUsedWithWrongExtent",(function(){return tr})),n.d(i,"errorBarContinuousAxisHasCustomizedAggregate",(function(){return nr})),n.d(i,"errorBand1DNotSupport",(function(){return ir})),n.d(i,"channelRequiredForBinned",(function(){return rr})),n.d(i,"channelShouldNotBeUsedForBinned",(function(){return or})),n.d(i,"domainRequiredForThresholdScale",(function(){return sr}));var r=n(53),o=function(e,t,n){return e.fields=t||[],e.fname=n,e};var s=function(e){return 1===e.length?a(e[0]):l(e)};const a=e=>function(t){return t[e]},l=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};var c=function(e){throw Error(e)},u=function(e){var t,n,i,r=[],o=null,s=0,a=e.length,l="";function u(){r.push(l+e.substring(t,n)),l="",t=n+1}for(e+="",t=n=0;n<a;++n)if("\\"===(i=e[n]))l+=e.substring(t,n),l+=e.substring(++n,++n),t=n;else if(i===o)u(),o=null,s=-1;else{if(o)continue;t===s&&'"'===i||t===s&&"'"===i?(t=n+1,o=i):"."!==i||s?"["===i?(n>t&&u(),s=t=n+1):"]"===i&&(s||c("Access path missing open bracket: "+e),s>0&&u(),s=0,t=n+1):n>t?u():t=n+1}return s&&c("Access path missing closing bracket: "+e),o&&c("Access path missing closing quote: "+e),n>t&&(n++,u()),r},h=function(e,t,n){const i=u(e);return e=1===i.length?i[0]:e,o((n&&n.get||s)(i),[e],t||e)},d=[],f=(h("id"),o((function(e){return e}),d,"identity"));o((function(){return 0}),d,"zero"),o((function(){return 1}),d,"one"),o((function(){return!0}),d,"true"),o((function(){return!1}),d,"false");function p(e,t,n){var i=[t].concat([].slice.call(n));console[e].apply(console,i)}var g=Array.isArray,m=function(e){return e===Object(e)};const v=e=>"__proto__"!==e;function b(...e){return e.reduce((e,t)=>{for(var n in t)if("signals"===n)e.signals=w(e.signals,t.signals);else{var i="legend"===n?{layout:1}:"style"===n||null;y(e,n,t[n],i)}return e},{})}function y(e,t,n,i){var r,o;if(v(t))if(m(n)&&!g(n))for(r in o=m(e[t])?e[t]:e[t]={},n)i&&(!0===i||i[r])?y(o,r,n[r]):v(r)&&(o[r]=n[r]);else e[t]=n}function w(e,t){if(null==e)return t;const n={},i=[];function r(e){n[e.name]||(n[e.name]=1,i.push(e))}return t.forEach(r),e.forEach(r),i}var x=function(e){return null!=e?g(e)?e:[e]:[]},_=function(e){return"function"==typeof e};const k=Object.prototype.hasOwnProperty;var S=function(e,t){return k.call(e,t)},O=function(e){return"boolean"==typeof e},C=function(e){return"number"==typeof e},A=function(e){return"string"==typeof e};function $(e){return g(e)?"["+e.map($)+"]":m(e)||A(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}var E=function(e){for(var t={},n=0,i=e.length;n<i;++n)t[e[n]]=!0;return t};function M(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}Object.create;Object.create;Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,(function(n,i){return Array.isArray(i)?n.push.apply(n,e.call(i,t-1)):n.push(i),n}),[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var j=n(61),R=n.n(j),D=n(62),T=n.n(D),L=n(12),F=n.n(L);function N(e){return!!e.or}function P(e){return!!e.and}function z(e){return!!e.not}function I(e,t){return z(e)?{not:I(e.not,t)}:P(e)?{and:e.and.map(e=>I(e,t))}:N(e)?{or:e.or.map(e=>I(e,t))}:t(e)}const B=T.a,W=R.a;function U(e,t){const n={};for(const i of t)S(e,i)&&(n[i]=e[i]);return n}function H(e,t){const n=Object.assign({},e);for(const e of t)delete n[e];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>F()(e)).join(",")})`};const q=F.a;function V(e){if(C(e))return e;const t=A(e)?e:F()(e);if(t.length<250)return t;let n=0;for(let e=0;e<t.length;e++){n=(n<<5)-n+t.charCodeAt(e),n&=n}return n}function G(e){return!1===e||null===e}function K(e,t){return e.indexOf(t)>-1}function Y(e,t){let n=0;for(const[i,r]of e.entries())if(t(r,i,n++))return!0;return!1}function X(e,t){let n=0;for(const[i,r]of e.entries())if(!t(r,i,n++))return!1;return!0}function J(e,t){for(const n of ie(t))y(e,n,t[n],!0)}function Q(e,t){const n=[],i={};let r;for(const o of e)r=t(o),r in i||(i[r]=1,n.push(o));return n}function Z(e,t){for(const n of e)if(t.has(n))return!0;return!1}function ee(e){const t=new Set;for(const n of e){const e=u(n).map((e,t)=>0===t?e:`[${e}]`),i=e.map((t,n)=>e.slice(0,n+1).join(""));for(const e of i)t.add(e)}return t}function te(e,t){return void 0===e||void 0===t||Z(ee(e),ee(t))}function ne(e){return 0===ie(e).length}const ie=Object.keys,re=Object.values;function oe(e){const t=[];for(const n in e)S(e,n)&&t.push({key:n,value:e[n]});return t}function se(e){return!0===e||!1===e}function ae(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function le(e,t){return z(e)?"!("+le(e.not,t)+")":P(e)?"("+e.and.map(e=>le(e,t)).join(") && (")+")":N(e)?"("+e.or.map(e=>le(e,t)).join(") || (")+")":t(e)}function ce(e,t){if(0===t.length)return!0;const n=t.shift();return n in e&&ce(e[n],t)&&delete e[n],ne(e)}function ue(e){return e.charAt(0).toUpperCase()+e.substr(1)}function he(e,t="datum"){const n=u(e),i=[];for(let e=1;e<=n.length;e++){const r=`[${n.slice(0,e).map($).join("][")}]`;i.push(`${t}${r}`)}return i.join(" && ")}function de(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function fe(e){return""+u(e).map(de).join("\\.")}function pe(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function ge(e){return""+u(e).join(".")}function me(e){return e?u(e).length:0}function ve(...e){for(const t of e)if(void 0!==t)return t}let be=42;function ye(e){if(void 0!==e)return(e%360+360)%360}function we(e){return!!C(e)||!isNaN(e)&&!isNaN(parseFloat(e))}const xe={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function _e(e){return e&&e.condition}const ke=["domain","grid","labels","ticks","title"],Se={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},Oe={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},Ce=Object.assign(Object.assign({},Oe),{style:1,labelExpr:1,encoding:1});function Ae(e){return!!Ce[e]}ie(Ce);const $e={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},Ee=$e.arc,Me=$e.area,je=$e.bar,Re=$e.image,De=$e.line,Te=$e.point,Le=$e.rect,Fe=$e.rule,Ne=$e.text,Pe=$e.tick,ze=$e.trail,Ie=$e.circle,Be=$e.square,We=$e.geoshape;function Ue(e){return K(["line","area","trail"],e)}function He(e){return K(["rect","bar","image","arc"],e)}const qe=ie($e);function Ve(e){return e.type}E(qe);const Ge=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit","fill","fillOpacity"],Ke=ie({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1}),Ye={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},Xe={binSpacing:1,continuousBandSize:5,timeUnitBandPosition:.5},Je={binSpacing:0,continuousBandSize:5,timeUnitBandPosition:.5};function Qe(e){return"mark"in e}class Ze{constructor(e,t){this.name=e,this.run=t}hasMatchingType(e){return!!Qe(e)&&(Ve(t=e.mark)?t.type:t)===this.name;var t}}const et={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},tt={count:1,min:1,max:1};function nt(e){return!!e&&!!e.argmin}function it(e){return!!e&&!!e.argmax}ie(et);function rt(e){return A(e)&&!!et[e]}const ot=["count","valid","missing","distinct"];function st(e){return A(e)&&K(ot,e)}const at=["count","sum","distinct","valid","missing"],lt=E(["mean","average","median","q1","q3","min","max"]),ct="row",ut="column",ht="x",dt="y",ft="x2",pt="y2",gt="radius",mt="theta",vt="theta2",bt="color",yt="fill",wt="stroke",xt="shape",_t="size",kt={theta:1,theta2:1,radius:1,radius2:1};function St(e){return e in kt}const Ot={longitude:1,longitude2:1,latitude:1,latitude2:1};const Ct=ie(Ot),At=Object.assign(Object.assign(Object.assign(Object.assign({},{x:1,y:1,x2:1,y2:1}),kt),Ot),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function $t(e){return e===bt||e===yt||e===wt}const Et={row:1,column:1,facet:1},Mt=ie(Et),jt=Object.assign(Object.assign({},At),Et),Rt=ie(jt),{order:Dt,detail:Tt,tooltip:Lt}=jt,Ft=M(jt,["order","detail","tooltip"]),{row:Nt,column:Pt,facet:zt}=Ft,It=M(Ft,["row","column","facet"]);ie(Ft),ie(It);function Bt(e){return!!jt[e]}const Wt=[ft,pt,"latitude2","longitude2",vt,"radius2"];function Ut(e){return Ht(e)!==e}function Ht(e){switch(e){case ft:return ht;case pt:return dt;case"latitude2":return"latitude";case"longitude2":return"longitude";case vt:return mt;case"radius2":return gt}return e}function qt(e){if(St(e))switch(e){case mt:return"startAngle";case vt:return"endAngle";case gt:return"outerRadius";case"radius2":return"innerRadius"}return e}function Vt(e){switch(e){case ht:return ft;case dt:return pt;case"latitude":return"latitude2";case"longitude":return"longitude2";case mt:return vt;case gt:return"radius2"}}function Gt(e){switch(e){case ht:case ft:return"width";case dt:case pt:return"height"}}ie(At);const{x:Kt,y:Yt,x2:Xt,y2:Jt,latitude:Qt,longitude:Zt,latitude2:en,longitude2:tn,theta:nn,theta2:rn,radius:on,radius2:sn}=At,an=M(At,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),ln=ie(an),cn={x:1,y:1},un=ie(cn);function hn(e){return e in cn}const dn={theta:1,radius:1},fn=ie(dn);function pn(e){return"width"===e?ht:dt}const{text:gn,tooltip:mn,href:vn,url:bn,description:yn,detail:wn,key:xn,order:_n}=an,kn=M(an,["text","tooltip","href","url","description","detail","key","order"]),Sn=ie(kn);const On=Object.assign(Object.assign(Object.assign({},cn),dn),kn),Cn=ie(On);function An(e){return!!On[e]}function $n(e,t){return function(e){switch(e){case bt:case yt:case wt:case"description":case"detail":case"key":case"tooltip":case"href":case"order":case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeWidth":case"facet":case ct:case ut:return En;case ht:case dt:case"latitude":case"longitude":return jn;case ft:case pt:case"latitude2":case"longitude2":return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case _t:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case"strokeDash":return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case xt:return{point:"always",geoshape:"always"};case"text":return{text:"always"};case"angle":return{point:"always",square:"always",text:"always"};case"url":return{image:"always"};case mt:case gt:return{text:"always",arc:"always"};case vt:case"radius2":return{arc:"always"}}}(e)[t]}const En={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:Mn}=En,jn=M(En,["geoshape"]);function Rn(e){switch(e){case ht:case dt:case mt:case gt:case _t:case"angle":case"strokeWidth":case"opacity":case"fillOpacity":case"strokeOpacity":case ft:case pt:case vt:case"radius2":return;case"facet":case ct:case ut:case xt:case"strokeDash":case"text":case"tooltip":case"href":case"url":case"description":return"discrete";case bt:case yt:case wt:return"flexible";case"latitude":case"longitude":case"latitude2":case"longitude2":case"detail":case"key":case"order":return}}function Dn(e){return O(e)&&(e=Gs(e,void 0)),"bin"+ie(e).map(t=>Nn(e[t])?ae(`_${t}_${Object.entries(e[t])}`):ae(`_${t}_${e[t]}`)).join("")}function Tn(e){return!0===e||Fn(e)&&!e.binned}function Ln(e){return"binned"===e||Fn(e)&&!0===e.binned}function Fn(e){return m(e)}function Nn(e){return null==e?void 0:e.selection}function Pn(e){switch(e){case ct:case ut:case _t:case bt:case yt:case wt:case"strokeWidth":case"opacity":case"fillOpacity":case"strokeOpacity":case xt:return 6;case"strokeDash":return 4;default:return 10}}function zn(e){return`Invalid specification ${JSON.stringify(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const In='Autosize "fit" only works for single views and layered views.';function Bn(e){return("width"==e?"Width":"Height")+' "container" only works for single views and layered views.'}function Wn(e){return`${"width"==e?"Width":"Height"} "container" only works well with autosize "fit" or "fit-${"width"==e?"x":"y"}".`}function Un(e){return e?`Dropping "fit-${e}" because spec has discrete ${Gt(e)}.`:'Dropping "fit" because spec has discrete size.'}function Hn(e){return`Unknown field for ${e}. Cannot calculate view size.`}function qn(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function Vn(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function Gn(e){return`The "nearest" transform is not supported for ${e} marks.`}function Kn(e){return`Selection not supported for ${e} yet.`}function Yn(e){return`Cannot find a selection named "${e}".`}const Xn="Scale bindings are currently only supported for scales with unbinned, continuous domains.",Jn="Legend bindings are only supported for selections over an individual field or encoding channel.";function Qn(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}const Zn="The same selection must be used to override scale domains in a layered view.",ei='Interval selections should be initialized using "x" and/or "y" keys.';function ti(e){return`Unknown repeated value "${e}".`}function ni(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const ii="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function ri(e){return`Unrecognized parse "${e}".`}function oi(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}const si="Attempt to add the same child twice.";function ai(e){return`Ignoring an invalid transform: ${q(e)}.`}const li='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function ci(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function ui(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${q(t)} is overridden by a child projection ${q(n)}.`}const hi="Arc marks uses theta channel rather than angle, replacing angle with theta.";function di(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${q(n)}}.`}function fi(e){return`Invalid field type "${e}".`}function pi(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function gi(e){return`Invalid aggregation operator "${e}".`}function mi(e,t){return`Missing type for channel "${e}", using "${t}" instead.`}function vi(e,t){const{fill:n,stroke:i}=t;return`Dropping color ${e} as the plot also has ${n&&i?"fill and stroke":n?"fill":"stroke"}.`}function bi(e,t){return`Dropping ${q(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}function yi(e,t,n){return`${e}-encoding with type ${t} is deprecated. Replacing with ${n}-encoding.`}const wi="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function xi(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?" when "+n:""}.`}function _i(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function ki(e){return e+" encoding should be discrete (ordinal / nominal / binned)."}function Si(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function Oi(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${"ordinal"===t?"order":"magnitude"}.`}function Ci(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function Ai(e,t){return`Specified orient "${e}" overridden with "${t}".`}const $i="Custom domain scale cannot be unioned with default field-based domain.",Ei='Scale\'s "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.';function Mi(e){return`Cannot use the scale property "${e}" with non-color channel.`}function ji(e){return`Using unaggregated domain with raw field has no effect (${q(e)}).`}function Ri(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function Di(e){return`Unaggregated domain is currently unsupported for log scale (${q(e)}).`}function Ti(e){return`Cannot apply size to non-oriented mark "${e}".`}function Li(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function Fi(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function Ni(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function Pi(e,t){return`Scale type "${t}" does not work with mark "${e}".`}function zi(e){return`The step for "${e}" is dropped because the ${"width"===e?"x":"y"} is continuous.`}function Ii(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${q(n)} and ${q(i)}). Using ${q(n)}.`}function Bi(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${q(n)} and ${q(i)}). Using the union of the two domains.`}function Wi(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function Ui(e){return`Dropping sort property ${q(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const Hi="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",qi="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",Vi="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",Gi="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.",Ki="Invalid channel for axis.";function Yi(e){return`Cannot stack "${e}" if there is already "${e}2".`}function Xi(e){return`Cannot stack non-linear scale (${e}).`}function Ji(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function Qi(e,t){return`Invalid ${e}: ${q(t)}.`}function Zi(e){return`Dropping day from datetime ${q(e)} as day cannot be combined with other units.`}function er(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function tr(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function nr(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function ir(e){return`1D error band does not support ${e}.`}function rr(e){return`Channel ${e} is required for "binned" bin.`}function or(e){return`Channel ${e} should not be used with "binned" bin.`}function sr(e){return`Domain for ${e} is required for threshold scale.`}const ar=(cr=2||0,{level:function(e){return arguments.length?(cr=+e,this):cr},error:function(){return cr>=1&&p(lr||"error","ERROR",arguments),this},warn:function(){return cr>=2&&p(lr||"warn","WARN",arguments),this},info:function(){return cr>=3&&p(lr||"log","INFO",arguments),this},debug:function(){return cr>=4&&p(lr||"log","DEBUG",arguments),this}});var lr,cr;let ur=ar;function hr(){return ur=ar,ur}function dr(...e){ur.warn(...e)}function fr(e){if(e&&m(e))for(const t of xr)if(t in e)return!0;return!1}new WeakMap;const pr=["january","february","march","april","may","june","july","august","september","october","november","december"],gr=pr.map(e=>e.substr(0,3)),mr=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],vr=mr.map(e=>e.substr(0,3));function br(e,t){const n=[];if(t&&void 0!==e.day&&ie(e).length>1&&(dr(i.droppedDay(e)),delete(e=W(e)).day),void 0!==e.year?n.push(e.year):n.push(2012),void 0!==e.month){const r=t?function(e){if(we(e)&&(e=+e),C(e))return e-1;{const t=e.toLowerCase(),n=pr.indexOf(t);if(-1!==n)return n;const r=t.substr(0,3),o=gr.indexOf(r);if(-1!==o)return o;throw new Error(i.invalidTimeUnit("month",e))}}(e.month):e.month;n.push(r)}else if(void 0!==e.quarter){const r=t?function(e){if(we(e)&&(e=+e),C(e))return e>4&&dr(i.invalidTimeUnit("quarter",e)),e-1;throw new Error(i.invalidTimeUnit("quarter",e))}(e.quarter):e.quarter;n.push(C(r)?3*r:r+"*3")}else n.push(0);if(void 0!==e.date)n.push(e.date);else if(void 0!==e.day){const r=t?function(e){if(we(e)&&(e=+e),C(e))return e%7;{const t=e.toLowerCase(),n=mr.indexOf(t);if(-1!==n)return n;const r=t.substr(0,3),o=vr.indexOf(r);if(-1!==o)return o;throw new Error(i.invalidTimeUnit("day",e))}}(e.day):e.day;n.push(C(r)?r+1:r+"+1")}else n.push(1);for(const t of["hours","minutes","seconds","milliseconds"]){const i=e[t];n.push(void 0===i?0:i)}return n}function yr(e){const t=br(e,!0).join(", ");return e.utc?`utc(${t})`:`datetime(${t})`}const wr={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},xr=ie(wr);function _r(e){return e.startsWith("utc")}const kr={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function Sr(e){const t=[];for(const n of xr)Or(e,n)&&t.push(n);return t}function Or(e,t){const n=e.indexOf(t);return!(n<0)&&(!(n>0&&"seconds"===t&&"i"===e.charAt(n-1))&&(!(e.length>n+3&&"day"===t&&"o"===e.charAt(n+3))&&!(n>0&&"year"===t&&"f"===e.charAt(n-1))))}function Cr(e,t,{end:n}={end:!1}){const i=he(t),r=_r(e)?"utc":"";let o;const s={};for(const t of xr)Or(e,t)&&(s[t]="quarter"===(a=t)?`(${r}quarter(${i})-1)`:`${r}${a}(${i})`,o=t);var a;return n&&(s[o]+="+1"),function(e){const t=br(e,!1).join(", ");return e.utc?`utc(${t})`:`datetime(${t})`}(s)}function Ar(e){if(!e)return;const t=Sr(e);return`timeUnitSpecifier(${F()(t)}, ${F()(kr)})`}function $r(e){if(!e)return;let t;return A(e)?t={unit:e}:m(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),_r(t.unit)&&(t.utc=!0,t.unit=t.unit.substr(3)),t}function Er(e){return e&&!!e.signal}function Mr(e){return!!e.step}function jr(e){return!g(e)&&("field"in e&&"data"in e)}const Rr=ie({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1}),Dr={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},Tr=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function Lr(e){return e&&!!e.field&&void 0!==e.equal}function Fr(e){return e&&!!e.field&&void 0!==e.lt}function Nr(e){return e&&!!e.field&&void 0!==e.lte}function Pr(e){return e&&!!e.field&&void 0!==e.gt}function zr(e){return e&&!!e.field&&void 0!==e.gte}function Ir(e){if(e&&e.field){if(g(e.range)&&2===e.range.length)return!0;if(Er(e.range))return!0}return!1}function Br(e){return e&&!!e.field&&(g(e.oneOf)||g(e.in))}function Wr(e){return Br(e)||Lr(e)||Ir(e)||Fr(e)||Pr(e)||Nr(e)||zr(e)}function Ur(e,t){return Xs(e,{timeUnit:t,wrapTime:!0})}function Hr(e,t=!0){var n;const{field:i}=e,r=null===(n=$r(e.timeUnit))||void 0===n?void 0:n.unit,o=r?"time("+Cr(r,i)+")":Rs(e,{expr:"datum"});if(Lr(e))return o+"==="+Ur(e.equal,r);if(Fr(e)){return`${o}<${Ur(e.lt,r)}`}if(Pr(e)){return`${o}>${Ur(e.gt,r)}`}if(Nr(e)){return`${o}<=${Ur(e.lte,r)}`}if(zr(e)){return`${o}>=${Ur(e.gte,r)}`}if(Br(e))return`indexof([${function(e,t){return e.map(e=>Ur(e,t))}(e.oneOf,r).join(",")}], ${o}) !== -1`;if(function(e){return e&&!!e.field&&void 0!==e.valid}(e))return qr(o,e.valid);if(Ir(e)){const{range:n}=e,i=Er(n)?{signal:n.signal+"[0]"}:n[0],s=Er(n)?{signal:n.signal+"[1]"}:n[1];if(null!==i&&null!==s&&t)return"inrange("+o+", ["+Ur(i,r)+", "+Ur(s,r)+"])";const a=[];return null!==i&&a.push(`${o} >= ${Ur(i,r)}`),null!==s&&a.push(`${o} <= ${Ur(s,r)}`),a.length>0?a.join(" && "):"true"}throw new Error("Invalid field predicate: "+JSON.stringify(e))}function qr(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function Vr(e){var t;return Wr(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:null===(t=$r(e.timeUnit))||void 0===t?void 0:t.unit}):e}const Gr={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};const Kr=Gr.quantitative,Yr=Gr.ordinal,Xr=Gr.temporal,Jr=Gr.nominal,Qr=Gr.geojson;ie(Gr);const Zr="linear",eo="log",to="pow",no="sqrt",io="symlog",ro="time",oo="utc",so="quantile",ao="quantize",lo="threshold",co="point",uo="band",ho={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};ie(ho);function fo(e,t){const n=ho[e],i=ho[t];return n===i||"ordinal-position"===n&&"time"===i||"ordinal-position"===i&&"time"===n}const po={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function go(e){return po[e]}const mo=["linear","log","pow","sqrt","symlog","time","utc"],vo=E(mo),bo=E(["linear","log","pow","sqrt","symlog"]);const yo=E(["quantile","quantize","threshold"]),wo=E(mo.concat(["quantile","quantize","threshold","sequential","identity"])),xo=E(["ordinal","bin-ordinal","point","band"]);function _o(e){return e in xo}function ko(e){return e in wo}function So(e){return e in vo}function Oo(e){return e in yo}function Co(e){return null==e?void 0:e.selection}const Ao={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:$o,domain:Eo,range:Mo,rangeMax:jo,rangeMin:Ro,scheme:Do}=(ie(Ao),Ao),To=M(Ao,["type","domain","range","rangeMax","rangeMin","scheme"]),Lo=ie(To);function Fo(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!K(["point","band","identity"],e);case"bins":return!K(["point","band","identity","ordinal"],e);case"round":return So(e)||"band"===e||"point"===e;case"padding":case"rangeMin":case"rangeMax":return So(e)||K(["point","band"],e);case"paddingOuter":case"align":return K(["point","band"],e);case"paddingInner":return"band"===e;case"domainMax":case"domainMid":case"domainMin":case"clamp":return So(e);case"nice":return So(e)||"quantize"===e||"threshold"===e;case"exponent":return"pow"===e;case"base":return"log"===e;case"constant":return"symlog"===e;case"zero":return ko(e)&&!K(["log","time","utc","threshold","quantile"],e)}}function No(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return $t(e)?void 0:i.cannotUseScalePropertyWithNonColor(e);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function Po(e){const{channel:t,channelDef:n,markDef:i,scale:r,config:o}=e,s=Ho(e);return ys(n)&&!st(n.aggregate)&&r&&So(r.get("type"))&&!1===r.get("zero")?zo({fieldDef:n,channel:t,markDef:i,ref:s,config:o}):s}function zo({fieldDef:e,channel:t,markDef:n,ref:i,config:r}){if(Ue(n.type))return i;return null===oa("invalid",n,r)?i:[Io(e,t),i]}function Io(e,t){const n=Bo(e,!0),i="y"===Ht(t)?{field:{group:"height"}}:{value:0};return Object.assign({test:n},i)}function Bo(e,t=!0){return qr(A(e)?e:Rs(e,{expr:"datum"}),!t)}function Wo(e,t,n,i){const r={};if(t&&(r.scale=t),xs(e)){const{datum:t}=e;fr(t)?r.signal=yr(t):Er(t)?r.signal=t.signal:r.value=t}else r.field=Rs(e,n);if(i){const{offset:e,band:t}=i;e&&(r.offset=e),t&&(r.band=t)}return r}function Uo({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:i,startSuffix:r,band:o=.5}){const s=0<o&&o<1?"datum":void 0,a=Rs(t,{expr:s,suffix:r}),l=void 0!==n?Rs(n,{expr:s}):Rs(t,{suffix:"end",expr:s}),c={};if(0===o||1===o){c.scale=e;const t=0===o?a:l;c.field=t}else{const t=`${o} * ${a} + ${1-o} * ${l}`;c.signal=`scale("${e}", ${t})`}return i&&(c.offset=i),c}function Ho({channel:e,channelDef:t,channel2Def:n,markDef:r,config:o,scaleName:s,scale:a,stack:l,offset:c,defaultRef:u,band:h}){var d;if(t){if(Ss(t)){if(Os(t)){h=null!=h?h:ps({channel:e,fieldDef:t,fieldDef2:n,markDef:r,stack:l,config:o,isMidPoint:!0});const{bin:a,timeUnit:u,type:d}=t;if(Tn(a)||h&&u&&d===Xr)return l&&l.impute?Wo(t,s,{binSuffix:"mid"},{offset:c}):h?Uo({scaleName:s,fieldOrDatumDef:t,band:h,offset:c}):Wo(t,s,Qs(t,e)?{binSuffix:"range"}:{},{offset:c});if(Ln(a)){if(ys(n))return Uo({scaleName:s,fieldOrDatumDef:t,fieldOrDatumDef2:n,band:h,offset:c});{const t=e===ht?ft:pt;dr(i.channelRequiredForBinned(t))}}}const u=null==a?void 0:a.get("type");return Wo(t,s,_o(u)?{binSuffix:"range"}:{},{offset:c,band:"band"===u?null!==(d=null!=h?h:t.band)&&void 0!==d?d:.5:void 0})}if(Cs(t)){const n=t.value,i=c?{offset:c}:{};return Object.assign(Object.assign({},qo(e,n)),i)}}return _(u)&&(u=u()),u?Object.assign(Object.assign({},u),c?{offset:c}:{}):u}function qo(e,t){return K(["x","x2"],e)&&"width"===t?{field:{group:"width"}}:K(["y","y2"],e)&&"height"===t?{field:{group:"height"}}:ta(t)}function Vo(e){return e&&"number"!==e&&"time"!==e}function Go(e,t,n){return`${e}(${t}${n?", "+JSON.stringify(n):""})`}function Ko({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:o}){var s,a;if(Vo(n))return Xo({fieldOrDatumDef:e,format:t,formatType:n,expr:i,config:o});const l=Yo(e,i,r);if(Ys(e)){const n=function(e,t,n,i,r){return!t||n?(n=A(n)?n:i,`${r?"utc":"time"}Format(${e}, '${n}')`):function(e,t,n){if(!e)return;const i=Ar(e);return`${n||_r(e)?"utc":"time"}Format(${t}, ${i})`}(t,e,r)}(l,ys(e)?null===(s=$r(e.timeUnit))||void 0===s?void 0:s.unit:void 0,t,o.timeFormat,As(e)&&(null===(a=e.scale)||void 0===a?void 0:a.type)===oo);return n?{signal:n}:void 0}if(t=Zo(ws(e),t,o),ys(e)&&Tn(e.bin)){return{signal:ns(l,Rs(e,{expr:i,binSuffix:"end"}),t,n,o)}}return t||"quantitative"===ws(e)?{signal:""+es(l,t)}:{signal:`isValid(${l}) ? ${l} : ""+${l}`}}function Yo(e,t,n){return ys(e)?n?`${Rs(e,{expr:t,suffix:"end"})}-${Rs(e,{expr:t,suffix:"start"})}`:Rs(e,{expr:t}):function(e){const{datum:t}=e;return fr(t)?yr(t):""+JSON.stringify(t)}(e)}function Xo({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:o,field:s}){if(s=null!=s?s:Yo(e,i,r),ys(e)&&Tn(e.bin)){return{signal:ns(s,Rs(e,{expr:i,binSuffix:"end"}),t,n,o)}}return{signal:Go(n,s,t)}}function Jo(e,t,n,i,r,o){var s;if(!Vo(i)){if(Ys(e)){return function(e,t,n,i){if(e)return e;if(t)return{signal:Ar(t)};return i?void 0:n.timeFormat}(n,ys(e)?null===(s=$r(e.timeUnit))||void 0===s?void 0:s.unit:void 0,r,o)}return Zo(t,n,r)}}function Qo(e,t,n){return e&&(Er(e)||"number"===e||"time"===e)?e:Ys(t)&&"time"!==n&&"utc"!==n?"time":void 0}function Zo(e,t,n){return A(t)?t:e===Kr?n.numberFormat:void 0}function es(e,t){return`format(${e}, "${t||""}")`}function ts(e,t,n,i){var r;return Vo(n)?Go(n,e,t):es(e,null!==(r=A(t)?t:void 0)&&void 0!==r?r:i.numberFormat)}function ns(e,t,n,i,r){const o=ts(e,n,i,r),s=ts(t,n,i,r);return`${qr(e,!1)} ? "null" : ${o} + " â€“ " + ${s}`}const is="min",rs={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function os(e){return e in rs}function ss(e){return!!e&&!!e.encoding}function as(e){return!(!e||"count"!==e.op&&!e.field)}function ls(e){return!!e&&g(e)}function cs(e){return"row"in e||"column"in e}function us(e){return!!e&&"header"in e}function hs(e){return"facet"in e}function ds(e){const{field:t,timeUnit:n,bin:i,aggregate:r}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),i?{bin:i}:{}),r?{aggregate:r}:{}),{field:t})}function fs(e){return"sort"in e}function ps({channel:e,fieldDef:t,fieldDef2:n,markDef:i,stack:r,config:o,isMidPoint:s}){if(Ss(t)&&void 0!==t.band)return t.band;if(ys(t)){const{timeUnit:e,bin:r}=t;if(e&&!n)return s?sa("timeUnitBandPosition",i,o):He(i.type)?sa("timeUnitBand",i,o):0;if(Tn(r))return He(i.type)&&!s?1:.5}return(null==r?void 0:r.fieldChannel)===e&&s?.5:void 0}function gs(e,t,n,i,r,o){return!!(Tn(t.bin)||t.timeUnit&&Os(t)&&"temporal"===t.type)&&!!ps({channel:e,fieldDef:t,fieldDef2:n,stack:i,markDef:r,config:o})}function ms(e){return!!e&&"condition"in e}function vs(e){const t=e&&e.condition;return!!t&&!g(t)&&ys(t)}function bs(e){const t=e&&e.condition;return!!t&&!g(t)&&Ss(t)}function ys(e){return!(!e||!e.field&&"count"!==e.aggregate)}function ws(e){return e&&e.type}function xs(e){return!!e&&"datum"in e}function _s(e){return Os(e)&&Ts(e)||ks(e)}function ks(e){return xs(e)&&C(e.datum)}function Ss(e){return ys(e)||xs(e)}function Os(e){return!!e&&("field"in e||"count"===e.aggregate)&&"type"in e}function Cs(e){return e&&"value"in e&&"value"in e}function As(e){return!!e&&("scale"in e||"sort"in e)}function $s(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function Es(e){return!!e&&"legend"in e}function Ms(e){return!!e&&("format"in e||"formatType"in e)}function js(e){return H(e,["legend","axis","header","scale"])}function Rs(e,t={}){var n,i,r;let o=e.field;const s=t.prefix;let a=t.suffix,l="";if(function(e){return"count"===e.aggregate}(e))o=function(e){return 0===e.indexOf("__")}(c="count")?c:"__"+c;else{let s;if(!t.nofn)if(function(e){return"op"in e}(e))s=e.op;else{const{bin:c,aggregate:u,timeUnit:h}=e;Tn(c)?(s=Dn(c),a=(null!==(n=t.binSuffix)&&void 0!==n?n:"")+(null!==(i=t.suffix)&&void 0!==i?i:"")):u?it(u)?(l=`["${o}"]`,o="argmax_"+u.argmax):nt(u)?(l=`["${o}"]`,o="argmin_"+u.argmin):s=String(u):h&&(s=function(e){const t=$r(e),{utc:n}=t,i=M(t,["utc"]);return i.unit?(n?"utc":"")+ie(i).map(e=>ae(`${"unit"===e?"":`_${e}_`}${i[e]}`)).join(""):(n?"utc":"")+"timeunit"+ie(i).map(e=>ae(`_${e}_${i[e]}`)).join("")}(h),a=(!K(["range","mid"],t.binSuffix)&&t.binSuffix||"")+(null!==(r=t.suffix)&&void 0!==r?r:""))}s&&(o=o?`${s}_${o}`:s)}var c;return a&&(o=`${o}_${a}`),s&&(o=`${s}_${o}`),t.forAs?ge(o):t.expr?function(e,t="datum"){return`${t}[${$(u(e).join("."))}]`}(o,t.expr)+l:fe(o)+l}function Ds(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return ys(e)&&!!e.bin;case"temporal":return!1}throw new Error(i.invalidFieldType(e.type))}function Ts(e){return!Ds(e)}const Ls=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return function(e){const{aggregate:t,bin:n,timeUnit:i,field:r}=e;if(it(t))return`${r} for argmax(${t.argmax})`;if(nt(t))return`${r} for argmin(${t.argmin})`;const o=$r(i),s=t||(null==o?void 0:o.unit)||(null==o?void 0:o.maxbins)&&"timeunit"||Tn(n)&&"bin";return s?s.toUpperCase()+"("+r+")":r}(e);default:return function(e,t){var n;const{field:i,bin:r,timeUnit:o,aggregate:s}=e;if("count"===s)return t.countTitle;if(Tn(r))return i+" (binned)";if(o){const e=null===(n=$r(o))||void 0===n?void 0:n.unit;if(e)return`${i} (${Sr(e).join("-")})`}else if(s)return it(s)?`${i} for max ${s.argmax}`:nt(s)?`${i} for min ${s.argmin}`:`${ue(s)} of ${i}`;return i}(e,t)}};let Fs=Ls;function Ns(e){Fs=e}function Ps(e,t,{allowDisabling:n,includeDefault:i=!0}){var r,o;const s=null===(r=zs(e))||void 0===r?void 0:r.title;if(!ys(e))return s;const a=e,l=i?Is(a,t):void 0;return n?ve(s,a.title,l):null!==(o=null!=s?s:a.title)&&void 0!==o?o:l}function zs(e){return $s(e)&&e.axis?e.axis:Es(e)&&e.legend?e.legend:us(e)&&e.header?e.header:void 0}function Is(e,t){return Fs(e,t)}function Bs(e){var t;if(Ms(e)){const{format:t,formatType:n}=e;return{format:t,formatType:n}}{const n=null!==(t=zs(e))&&void 0!==t?t:{},{format:i,formatType:r}=n;return{format:i,formatType:r}}}function Ws(e){return ys(e)?e:vs(e)?e.condition:void 0}function Us(e){return Ss(e)?e:bs(e)?e.condition:void 0}function Hs(e,t,n,r={}){if(A(e)||C(e)||O(e)){const n=A(e)?"string":C(e)?"number":"boolean";return dr(i.primitiveChannelDef(t,n,e)),{value:e}}return Ss(e)?qs(e,t,n,r):bs(e)?Object.assign(Object.assign({},e),{condition:qs(e.condition,t,n,r)}):e}function qs(e,t,n,r){if(Ms(e)){const{format:o,formatType:s}=e,a=M(e,["format","formatType"]);if(Vo(s)&&!n.customFormatTypes)return dr(i.customFormatTypeNotAllowed(t)),qs(a,t,n,r)}else{const o=$s(e)?"axis":Es(e)?"legend":us(e)?"header":null;if(o&&e[o]){const s=e[o],{format:a,formatType:l}=s,c=M(s,["format","formatType"]);if(Vo(l)&&!n.customFormatTypes)return dr(i.customFormatTypeNotAllowed(t)),qs(Object.assign(Object.assign({},e),{[o]:c}),t,n,r)}}return ys(e)?Vs(e,t,r):function(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=C(n)?"quantitative":A(n)?"nominal":fr(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}(e)}function Vs(e,t,{compositeMark:n=!1}={}){const{aggregate:r,timeUnit:o,bin:s,field:a}=e,l=Object.assign({},e);if(n||!r||rt(r)||it(r)||nt(r)||(dr(i.invalidAggregate(r)),delete l.aggregate),o&&(l.timeUnit=$r(o)),a&&(l.field=""+a),Tn(s)&&(l.bin=Gs(s,t)),Ln(s)&&!hn(t)&&dr(i.channelShouldNotBeUsedForBinned(t)),Os(l)){const{type:e}=l,t=function(e){if(e)switch(e=e.toLowerCase()){case"q":case Kr:return"quantitative";case"t":case Xr:return"temporal";case"o":case Yr:return"ordinal";case"n":case Jr:return"nominal";case Qr:return"geojson"}}(e);e!==t&&(l.type=t),"quantitative"!==e&&st(r)&&(dr(i.invalidFieldTypeForCountAggregate(e,r)),l.type="quantitative")}else if(!Ut(t)){const e=function(e,t){var n;switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal"}if(fs(e)&&g(e.sort))return"ordinal";const{aggregate:i,bin:r,timeUnit:o}=e;if(o)return"temporal";if(r||i&&!it(i)&&!nt(i))return"quantitative";if(As(e)&&(null===(n=e.scale)||void 0===n?void 0:n.type))switch(ho[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}(l,t);l.type=e}if(Os(l)){const{compatible:e,warning:n}=function(e,t){const n=e.type;if("geojson"===n&&"shape"!==t)return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case ct:case ut:case"facet":return Ts(e)?{compatible:!1,warning:i.facetChannelShouldBeDiscrete(t)}:Ks;case ht:case dt:case bt:case yt:case wt:case"text":case"detail":case"key":case"tooltip":case"href":case"url":case"angle":case mt:case gt:case"description":return Ks;case"longitude":case"longitude2":case"latitude":case"latitude2":return n!==Kr?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:Ks;case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeWidth":case _t:case vt:case"radius2":case ft:case pt:return"nominal"!==n||e.sort?Ks:{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`};case"strokeDash":return K(["ordinal","nominal"],e.type)?Ks:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case xt:return K(["ordinal","nominal","geojson"],e.type)?Ks:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case"order":return"nominal"!==e.type||"sort"in e?Ks:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(l,t)||{};!1===e&&dr(n)}if(fs(l)&&A(l.sort)){const{sort:e}=l;if(os(e))return Object.assign(Object.assign({},l),{sort:{encoding:e}});const t=e.substr(1);if("-"===e.charAt(0)&&os(t))return Object.assign(Object.assign({},l),{sort:{encoding:t,order:"descending"}})}if(us(l)){const{header:e}=l,{orient:t}=e,n=M(e,["orient"]);if(t)return Object.assign(Object.assign({},l),{header:Object.assign(Object.assign({},n),{labelOrient:e.labelOrient||t,titleOrient:e.titleOrient||t})})}return l}function Gs(e,t){return O(e)?{maxbins:Pn(t)}:"binned"===e?{binned:!0}:e.maxbins||e.step?e:Object.assign(Object.assign({},e),{maxbins:Pn(t)})}const Ks={compatible:!0};function Ys(e){const{formatType:t}=Bs(e);return"time"===t||!t&&((n=e)&&("temporal"===n.type||ys(n)&&!!n.timeUnit));var n}function Xs(e,{timeUnit:t,type:n,wrapTime:i,undefinedIfExprNotRequired:r}){var o;const s=t&&(null===(o=$r(t))||void 0===o?void 0:o.unit);let a,l=s||"temporal"===n;return Er(e)?a=e.signal:fr(e)?(l=!0,a=yr(e)):(A(e)||C(e))&&l&&(a=`datetime(${JSON.stringify(e)})`,function(e){return!!wr[e]}(s)&&(C(e)&&e<1e4||A(e)&&isNaN(Date.parse(e)))&&(a=yr({[s]:e}))),a?i&&l?`time(${a})`:a:r?void 0:JSON.stringify(e)}function Js(e,t){const{type:n}=e;return t.map(t=>{const i=Xs(t,{timeUnit:ys(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==i?{signal:i}:t})}function Qs(e,t){return Tn(e.bin)?An(t)&&K(["ordinal","nominal"],e.type):(console.warn("Only call this method for binned field defs."),!1)}function Zs(e){const{anchor:t,frame:n,offset:i,orient:r,color:o,subtitleColor:s,subtitleFont:a,subtitleFontSize:l,subtitleFontStyle:c,subtitleFontWeight:u,subtitleLineHeight:h,subtitlePadding:d}=e,f=M(e,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),p=Object.assign(Object.assign({},f),o?{fill:o}:{}),g=Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),i?{offset:i}:{}),r?{orient:r}:{}),m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},s?{subtitleColor:s}:{}),a?{subtitleFont:a}:{}),l?{subtitleFontSize:l}:{}),c?{subtitleFontStyle:c}:{}),u?{subtitleFontWeight:u}:{}),h?{subtitleLineHeight:h}:{}),d?{subtitlePadding:d}:{});return{titleMarkConfig:p,subtitleMarkConfig:U(p,["align","baseline","dx","dy","limit"]),nonMark:g,subtitle:m}}function ea(e){return A(e)||g(e)&&A(e[0])}function ta(e){return Er(e)?e:void 0!==e?{value:e}:void 0}function na(e){return Er(e)?e.signal:$(e.value)}function ia(e){return Er(e)?e.signal:null==e?null:$(e)}function ra(e){var t;return[].concat(e.type,null!==(t=e.style)&&void 0!==t?t:[])}function oa(e,t,n,i={}){const{vgChannel:r,ignoreVgConfig:o}=i;return r&&void 0!==t[r]?t[r]:void 0!==t[e]?t[e]:!o||r&&r!==e?sa(e,t,n,i):void 0}function sa(e,t,n,{vgChannel:i}={}){return ve(i?aa(e,t,n.style):void 0,aa(e,t,n.style),i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e])}function aa(e,t,n){return la(e,ra(t),n)}function la(e,t,n){let i;t=x(t);for(const r of t){const t=n[r];t&&void 0!==t[e]&&(i=t[e])}return i}function ca(e,t){return x(e).reduce((e,n)=>{var i;return e.field.push(Rs(n,t)),e.order.push(null!==(i=n.sort)&&void 0!==i?i:"ascending"),e},{field:[],order:[]})}function ua(e,t){const n=[...e];return t.forEach(e=>{for(const t of n)if(B(t,e))return;n.push(e)}),n}function ha(e,t){return B(e,t)||!t?e:e?[...x(e),...x(t)].join(", "):t}function da(e,t){const n=e.value,i=t.value;if(null==n||null===i)return{explicit:e.explicit,value:null};if((ea(n)||Er(n))&&(ea(i)||Er(i)))return{explicit:e.explicit,value:ha(n,i)};if(ea(n)||Er(n))return{explicit:e.explicit,value:n};if(ea(i)||Er(i))return{explicit:e.explicit,value:i};if(!(ea(n)||Er(n)||ea(i)||Er(i)))return{explicit:e.explicit,value:ua(n,i)};throw new Error("It should never reach here")}function fa(e,t){const n=e&&e[t];return!!n&&(g(n)?Y(n,e=>!!e.field):ys(n)||vs(n))}function pa(e){return Y(Rt,t=>{if(fa(e,t)){const n=e[t];if(g(n))return Y(n,e=>!!e.aggregate);{const e=Ws(n);return e&&!!e.aggregate}}return!1})}function ga(e,t){const n=[],i=[],r=[],o=[],s={};return ba(e,(a,l)=>{if(ys(a)){const{field:c,aggregate:u,bin:h,timeUnit:d}=a,f=M(a,["field","aggregate","bin","timeUnit"]);if(u||d||h){const e=zs(a),p=e&&e.title;let g=Rs(a,{forAs:!0});const m=Object.assign(Object.assign(Object.assign({},p?[]:{title:Ps(a,t,{allowDisabling:!0})}),f),{field:g});if(u){let e;if(it(u)?(e="argmax",g=Rs({op:"argmax",field:u.argmax},{forAs:!0}),m.field=`${g}.${c}`):nt(u)?(e="argmin",g=Rs({op:"argmin",field:u.argmin},{forAs:!0}),m.field=`${g}.${c}`):"boxplot"!==u&&"errorbar"!==u&&"errorband"!==u&&(e=u),e){const t={op:e,as:g};c&&(t.field=c),o.push(t)}}else if(n.push(g),Os(a)&&Tn(h)){if(i.push({bin:h,field:c,as:g}),n.push(Rs(a,{binSuffix:"end"})),Qs(a,l)&&n.push(Rs(a,{binSuffix:"range"})),hn(l)){const e={field:g+"_end"};s[l+"2"]=e}m.bin="binned",Ut(l)||(m.type=Kr)}else if(d){r.push({timeUnit:d,field:c,as:g});const e=Os(a)&&a.type!==Xr&&"time";e&&("text"===l||"tooltip"===l?m.formatType=e:!function(e){return!!an[e]}(l)?hn(l)&&(m.axis=Object.assign({formatType:e},m.axis)):m.legend=Object.assign({formatType:e},m.legend))}s[l]=m}else n.push(c),s[l]=e[l]}else s[l]=e[l]}),{bins:i,timeUnits:r,aggregate:o,groupby:n,encoding:s}}function ma(e,t,n,r){return ie(e).reduce((o,s)=>{if(!Bt(s))return dr(i.invalidEncodingChannel(s)),o;const a=e[s];if("angle"!==s||"arc"!==t||e.theta||(dr(i.REPLACE_ANGLE_WITH_THETA),s=mt),!function(e,t,n){const i=$n(t,n);if(!i)return!1;if("binned"===i){const n=e[t===ft?ht:dt];return!!(ys(n)&&ys(e[t])&&Ln(n.bin))}return!0}(e,s,t))return dr(i.incompatibleChannel(s,t)),o;if(s===_t&&"line"===t){const t=Ws(e[s]);if(null==t?void 0:t.aggregate)return dr(i.LINE_WITH_VARYING_SIZE),o}if(s===bt&&(n?"fill"in e:"stroke"in e))return dr(i.droppingColor("encoding",{fill:"fill"in e,stroke:"stroke"in e})),o;if("detail"===s||"order"===s&&!g(a)&&!Cs(a)||"tooltip"===s&&g(a))a&&(o[s]=x(a).reduce((e,t)=>(ys(t)?e.push(Vs(t,s)):dr(i.emptyFieldDef(t,s)),e),[]));else{if("tooltip"===s&&null===a)o[s]=null;else if(!(ys(a)||xs(a)||Cs(a)||ms(a)||Er(a)))return dr(i.emptyFieldDef(a,s)),o;o[s]=Hs(a,s,r)}return o},{})}function va(e,t){return ie(e).reduce((n,i)=>{const r=Hs(e[i],i,t,{compositeMark:!0});return n[i]=r,n},{})}function ba(e,t,n){if(e)for(const i of ie(e)){const r=e[i];if(g(r))for(const e of r)t.call(n,e,i);else t.call(n,r,i)}}function ya(e,t,n,i){return e?ie(e).reduce((n,r)=>{const o=e[r];return g(o)?o.reduce((e,n)=>t.call(i,e,n,r),n):t.call(i,n,o,r)},n):n}function wa(e,t){return ie(t).reduce((n,i)=>{switch(i){case ht:case dt:case"href":case"description":case"url":case ft:case pt:case mt:case vt:case gt:case"radius2":case"latitude":case"longitude":case"latitude2":case"longitude2":case"text":case xt:case"angle":case"tooltip":return n;case"order":if("line"===e||"trail"===e)return n;case"detail":case"key":{const e=t[i];if(g(e)||ys(e))for(const t of x(e))t.aggregate||n.push(Rs(t,{}));return n}case _t:if("trail"===e)return n;case bt:case yt:case wt:case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeDash":case"strokeWidth":{const e=Ws(t[i]);return e&&!e.aggregate&&n.push(Rs(e,{})),n}}},[])}function xa(e,t,n,i=!0){if("tooltip"in n)return{tooltip:n.tooltip};return{tooltip:[...e.map(({fieldPrefix:e,titlePrefix:n})=>{const r=i?" of "+_a(t):"";return{field:e+t.field,type:t.type,title:Er(n)?{signal:n+`"${escape(r)}"`}:n+r}}),...Q(function(e){const t=[];for(const n of ie(e))if(fa(e,n)){const i=e[n],r=x(i);for(const e of r)ys(e)?t.push(e):vs(e)&&t.push(e.condition)}return t}(n).map(js),V)]}}function _a(e){const{title:t,field:n}=e;return ve(t,n)}function ka(e,t,n,i,r){const{scale:o,axis:s}=n;return({partName:a,mark:l,positionPrefix:c,endPositionPrefix:u,extraEncoding:h={}})=>{const d=_a(n);return Sa(e,a,r,{mark:l,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:c+"_"+n.field,type:n.type},void 0!==d?{title:d}:{}),void 0!==o?{scale:o}:{}),void 0!==s?{axis:s}:{})},A(u)?{[t+"2"]:{field:u+"_"+n.field}}:{}),i),h)})}}function Sa(e,t,n,i){const{clip:r,color:o,opacity:s}=e,a=e.type;return e[t]||void 0===e[t]&&n[t]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),r?{clip:r}:{}),o?{color:o}:{}),s?{opacity:s}:{}),Ve(i.mark)?i.mark:{type:i.mark}),{style:`${a}-${t}`}),O(e[t])?{}:e[t])})]:[]}function Oa(e,t,n){const{encoding:i}=e,r="vertical"===t?"y":"x",o=i[r],s=i[r+"2"],a=i[r+"Error"],l=i[r+"Error2"];return{continuousAxisChannelDef:Ca(o,n),continuousAxisChannelDef2:Ca(s,n),continuousAxisChannelDefError:Ca(a,n),continuousAxisChannelDefError2:Ca(l,n),continuousAxis:r}}function Ca(e,t){if(e&&e.aggregate){const{aggregate:n}=e,r=M(e,["aggregate"]);return n!==t&&dr(i.errorBarContinuousAxisHasCustomizedAggregate(n,t)),r}return e}function Aa(e,t){const{mark:n,encoding:i}=e,{x:r,y:o}=i;if(Ve(n)&&n.orient)return n.orient;if(_s(r)){if(_s(o)){const e=ys(r)&&r.aggregate,n=ys(o)&&o.aggregate;if(e||n!==t){if(n||e!==t){if(e===t&&n===t)throw new Error("Both x and y cannot have aggregate");return Ys(o)&&!Ys(r)?"horizontal":"vertical"}return"horizontal"}return"vertical"}return"horizontal"}if(_s(o))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}const $a=new Ze("boxplot",Ma);function Ea(e){return C(e)?"tukey":e}function Ma(e,{config:t}){var n,r;e=Object.assign(Object.assign({},e),{encoding:va(e.encoding,t)});const{mark:o,encoding:s,selection:a,projection:l}=e,c=M(e,["mark","encoding","selection","projection"]),u=Ve(o)?o:{type:o};a&&dr(i.selectionNotSupported("boxplot"));const h=null!==(n=u.extent)&&void 0!==n?n:t.boxplot.extent,d=oa("size",u,t),f=Ea(h),{bins:p,timeUnits:v,transform:b,continuousAxisChannelDef:y,continuousAxis:w,groupby:x,aggregate:_,encodingWithoutContinuousAxis:k,ticksOrient:S,boxOrient:O,customTooltipWithoutAggregatedField:C}=function(e,t,n){const i=Aa(e,"boxplot"),{continuousAxisChannelDef:r,continuousAxis:o}=Oa(e,i,"boxplot"),s=r.field,a=Ea(t),l=[...ja(s),{op:"median",field:s,as:"mid_box_"+s},{op:"min",field:s,as:("min-max"===a?"lower_whisker_":"min_")+s},{op:"max",field:s,as:("min-max"===a?"upper_whisker_":"max_")+s}],c="min-max"===a||"tukey"===a?[]:[{calculate:`datum["upper_box_${s}"] - datum["lower_box_${s}"]`,as:"iqr_"+s},{calculate:`min(datum["upper_box_${s}"] + datum["iqr_${s}"] * ${t}, datum["max_${s}"])`,as:"upper_whisker_"+s},{calculate:`max(datum["lower_box_${s}"] - datum["iqr_${s}"] * ${t}, datum["min_${s}"])`,as:"lower_whisker_"+s}],u=e.encoding,h=o,d=(u[h],M(u,["symbol"==typeof h?h:h+""])),{customTooltipWithoutAggregatedField:f,filteredEncoding:p}=function(e){const{tooltip:t}=e,n=M(e,["tooltip"]);if(!t)return{filteredEncoding:n};let i,r;if(g(t)){for(const e of t)e.aggregate?(i||(i=[]),i.push(e)):(r||(r=[]),r.push(e));i&&(n.tooltip=i)}else t.aggregate?n.tooltip=t:r=t;return g(r)&&1===r.length&&(r=r[0]),{customTooltipWithoutAggregatedField:r,filteredEncoding:n}}(d),{bins:m,timeUnits:v,aggregate:b,groupby:y,encoding:w}=ga(p,n),x="vertical"===i?"horizontal":"vertical",_=i,k=[...m,...v,{aggregate:[...b,...l],groupby:y},...c];return{bins:m,timeUnits:v,transform:k,groupby:y,aggregate:b,continuousAxisChannelDef:r,continuousAxis:o,encodingWithoutContinuousAxis:w,ticksOrient:x,boxOrient:_,customTooltipWithoutAggregatedField:f}}(e,h,t),{color:A,size:$}=k,E=M(k,["color","size"]),j=e=>ka(u,w,y,e,t.boxplot),R=j(E),D=j(k),T=j(Object.assign(Object.assign({},E),$?{size:$}:{})),L=xa([{fieldPrefix:"min-max"===f?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===f?"lower_whisker_":"min_",titlePrefix:"Min"}],y,k),F={type:"tick",color:"black",opacity:1,orient:S,invalid:null,aria:!1},N="min-max"===f?L:xa([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],y,k),P=[...R({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:N}),...R({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:N}),...R({partName:"ticks",mark:F,positionPrefix:"lower_whisker",extraEncoding:N}),...R({partName:"ticks",mark:F,positionPrefix:"upper_whisker",extraEncoding:N})],z=[..."tukey"!==f?P:[],...D({partName:"box",mark:Object.assign(Object.assign({type:"bar"},d?{size:d}:{}),{orient:O,invalid:null,ariaRoleDescription:"box"}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:L}),...T({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},m(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),d?{size:d}:{}),{orient:S,aria:!1}),positionPrefix:"mid_box",extraEncoding:L})];if("min-max"===f)return Object.assign(Object.assign({},c),{transform:(null!==(r=c.transform)&&void 0!==r?r:[]).concat(b),layer:z});const I=`datum["lower_box_${y.field}"]`,B=`datum["upper_box_${y.field}"]`,W=`(${B} - ${I})`,U=`${I} - ${h} * ${W}`,q=`${B} + ${h} * ${W}`,V=`datum["${y.field}"]`,G={joinaggregate:ja(y.field),groupby:x},K={transform:[{filter:`(${U} <= ${V}) && (${V} <= ${q})`},{aggregate:[{op:"min",field:y.field,as:"lower_whisker_"+y.field},{op:"max",field:y.field,as:"upper_whisker_"+y.field},{op:"min",field:"lower_box_"+y.field,as:"lower_box_"+y.field},{op:"max",field:"upper_box_"+y.field,as:"upper_box_"+y.field},..._],groupby:x}],layer:P},{tooltip:Y}=E,X=M(E,["tooltip"]),{scale:J,axis:Q}=y,Z=_a(y),ee=H(Q,["title"]),te=Sa(u,"outliers",t.boxplot,{transform:[{filter:`(${V} < ${U}) || (${V} > ${q})`}],mark:"point",encoding:Object.assign(Object.assign({[w]:Object.assign(Object.assign(Object.assign({field:y.field,type:y.type},void 0!==Z?{title:Z}:{}),void 0!==J?{scale:J}:{}),ne(ee)?{}:{axis:ee})},X),C?{tooltip:C}:{})})[0];let ie;const re=[...p,...v,G];return te?ie={transform:re,layer:[te,K]}:(ie=K,ie.transform.unshift(...re)),Object.assign(Object.assign({},c),{layer:[ie,{transform:b,layer:z}]})}function ja(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}const Ra=new Ze("errorbar",Da);function Da(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:va(e.encoding,t)});const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:o,ticksOrient:s,markDef:a,outerSpec:l,tooltipEncoding:c}=La(e,"errorbar",t);delete o.size;const u=ka(a,r,i,o,t.errorbar),h=a.thickness,d=a.size,f=Object.assign(Object.assign({type:"tick",orient:s,aria:!1},void 0!==h?{thickness:h}:{}),void 0!==d?{size:d}:{}),p=[...u({partName:"ticks",mark:f,positionPrefix:"lower",extraEncoding:c}),...u({partName:"ticks",mark:f,positionPrefix:"upper",extraEncoding:c}),...u({partName:"rule",mark:Object.assign({type:"rule",ariaRoleDescription:"errorbar"},void 0!==h?{size:h}:{}),positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:c})];return Object.assign(Object.assign(Object.assign({},l),{transform:n}),p.length>1?{layer:p}:Object.assign({},p[0]))}function Ta(e,t){const{encoding:n}=e;if(function(e){return(Ss(e.x)||Ss(e.y))&&!Ss(e.x2)&&!Ss(e.y2)&&!Ss(e.xError)&&!Ss(e.xError2)&&!Ss(e.yError)&&!Ss(e.yError2)}(n))return{orient:Aa(e,t),inputType:"raw"};const i=function(e){return Ss(e.x2)||Ss(e.y2)}(n),r=function(e){return Ss(e.xError)||Ss(e.xError2)||Ss(e.yError)||Ss(e.yError2)}(n),o=n.x,s=n.y;if(i){if(r)throw new Error(t+" cannot be both type aggregated-upper-lower and aggregated-error");const e=n.x2,i=n.y2;if(Ss(e)&&Ss(i))throw new Error(t+" cannot have both x2 and y2");if(Ss(e)){if(_s(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error("Both x and x2 have to be quantitative in "+t)}if(Ss(i)){if(_s(s))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error("Both y and y2 have to be quantitative in "+t)}throw new Error("No ranged axis")}{const e=n.xError,i=n.xError2,r=n.yError,a=n.yError2;if(Ss(i)&&!Ss(e))throw new Error(t+" cannot have xError2 without xError");if(Ss(a)&&!Ss(r))throw new Error(t+" cannot have yError2 without yError");if(Ss(e)&&Ss(r))throw new Error(t+" cannot have both xError and yError with both are quantiative");if(Ss(e)){if(_s(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(Ss(r)){if(_s(s))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function La(e,t,n){var r;const{mark:o,encoding:s,selection:a,projection:l}=e,c=M(e,["mark","encoding","selection","projection"]),u=Ve(o)?o:{type:o};a&&dr(i.selectionNotSupported(t));const{orient:h,inputType:d}=Ta(e,t),{continuousAxisChannelDef:f,continuousAxisChannelDef2:p,continuousAxisChannelDefError:g,continuousAxisChannelDefError2:m,continuousAxis:v}=Oa(e,h,t),{errorBarSpecificAggregate:b,postAggregateCalculates:y,tooltipSummary:w,tooltipTitleWithFieldName:x}=function(e,t,n,r,o,s,a,l){let c=[],u=[];const h=t.field;let d,f=!1;if("raw"===s){const t=e.center?e.center:e.extent?"iqr"===e.extent?"median":"mean":l.errorbar.center,n=e.extent?e.extent:"mean"===t?"stderr":"iqr";if("median"===t!=("iqr"===n)&&dr(i.errorBarCenterIsUsedWithWrongExtent(t,n,a)),"stderr"===n||"stdev"===n)c=[{op:n,field:h,as:"extent_"+h},{op:t,field:h,as:"center_"+h}],u=[{calculate:`datum["center_${h}"] + datum["extent_${h}"]`,as:"upper_"+h},{calculate:`datum["center_${h}"] - datum["extent_${h}"]`,as:"lower_"+h}],d=[{fieldPrefix:"center_",titlePrefix:ue(t)},{fieldPrefix:"upper_",titlePrefix:Fa(t,n,"+")},{fieldPrefix:"lower_",titlePrefix:Fa(t,n,"-")}],f=!0;else{let e,t,i;"ci"===n?(e="mean",t="ci0",i="ci1"):(e="median",t="q1",i="q3"),c=[{op:t,field:h,as:"lower_"+h},{op:i,field:h,as:"upper_"+h},{op:e,field:h,as:"center_"+h}],d=[{fieldPrefix:"upper_",titlePrefix:Ps({field:h,aggregate:i,type:"quantitative"},l,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Ps({field:h,aggregate:t,type:"quantitative"},l,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Ps({field:h,aggregate:e,type:"quantitative"},l,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&dr(i.errorBarCenterAndExtentAreNotNeeded(e.center,e.extent)),"aggregated-upper-lower"===s?(d=[],u=[{calculate:`datum["${n.field}"]`,as:"upper_"+h},{calculate:`datum["${h}"]`,as:"lower_"+h}]):"aggregated-error"===s&&(d=[{fieldPrefix:"",titlePrefix:h}],u=[{calculate:`datum["${h}"] + datum["${r.field}"]`,as:"upper_"+h}],o?u.push({calculate:`datum["${h}"] + datum["${o.field}"]`,as:"lower_"+h}):u.push({calculate:`datum["${h}"] - datum["${r.field}"]`,as:"lower_"+h}));for(const e of u)d.push({fieldPrefix:e.as.substring(0,6),titlePrefix:pe(pe(e.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:u,errorBarSpecificAggregate:c,tooltipSummary:d,tooltipTitleWithFieldName:f}}(u,f,p,g,m,d,t,n),_=s,k=v,S=(_[k],"x"===v?"x2":"y2"),O=(_[S],"x"===v?"xError":"yError"),C=(_[O],"x"===v?"xError2":"yError2"),A=(_[C],M(_,["symbol"==typeof k?k:k+"","symbol"==typeof S?S:S+"","symbol"==typeof O?O:O+"","symbol"==typeof C?C:C+""])),{bins:$,timeUnits:E,aggregate:j,groupby:R,encoding:D}=ga(A,n),T=[...j,...b],L="raw"!==d?[]:R,F=xa(w,f,D,x);return{transform:[...null!==(r=c.transform)&&void 0!==r?r:[],...$,...E,...0===T.length?[]:[{aggregate:T,groupby:L}],...y],groupby:L,continuousAxisChannelDef:f,continuousAxis:v,encodingWithoutContinuousAxis:D,ticksOrient:"vertical"===h?"horizontal":"vertical",markDef:u,outerSpec:c,tooltipEncoding:F}}function Fa(e,t,n){return ue(e)+" "+n+" "+t}const Na=new Ze("errorband",Pa);function Pa(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:va(e.encoding,t)});const{transform:n,continuousAxisChannelDef:r,continuousAxis:o,encodingWithoutContinuousAxis:s,markDef:a,outerSpec:l,tooltipEncoding:c}=La(e,"errorband",t),u=a,h=ka(u,o,r,s,t.errorband),d=void 0!==e.encoding.x&&void 0!==e.encoding.y;let f={type:d?"area":"rect"},p={type:d?"line":"rule"};const g=Object.assign(Object.assign({},u.interpolate?{interpolate:u.interpolate}:{}),u.tension&&u.interpolate?{tension:u.tension}:{});return d?(f=Object.assign(Object.assign(Object.assign({},f),g),{ariaRoleDescription:"errorband"}),p=Object.assign(Object.assign(Object.assign({},p),g),{aria:!1})):u.interpolate?dr(i.errorBand1DNotSupport("interpolate")):u.tension&&dr(i.errorBand1DNotSupport("tension")),Object.assign(Object.assign({},l),{transform:n,layer:[...h({partName:"band",mark:f,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:c}),...h({partName:"borders",mark:p,positionPrefix:"lower",extraEncoding:c}),...h({partName:"borders",mark:p,positionPrefix:"upper",extraEncoding:c})]})}const za={};function Ia(e,t,n){const i=new Ze(e,t);za[e]={normalizer:i,parts:n}}Ia("boxplot",Ma,["box","median","outliers","rule","ticks"]),Ia("errorbar",Da,["ticks","rule"]),Ia("errorband",Pa,["band","borders"]);const Ba=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],Wa=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],Ua={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},Ha={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},qa=(ie(Ha),{single:{on:"click",fields:["_vgsid_"],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:["_vgsid_"],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}});function Va(e){return!(!e||"legend"!==e&&!e.legend)}function Ga(e){return Va(e)&&m(e)}function Ka(e){return"concat"in e}function Ya(e){return"vconcat"in e}function Xa(e){return"hconcat"in e}function Ja(e){return m(e)&&void 0!==e.step}function Qa(e){return e.view||e.width||e.height}const Za=ie({align:1,bounds:1,center:1,columns:1,spacing:1});function el(e,t){var n;return null!==(n=e[t])&&void 0!==n?n:e["width"===t?"continuousWidth":"continuousHeight"]}function tl(e,t){const n=nl(e,t);return Ja(n)?n.step:il}function nl(e,t){var n;return ve(null!==(n=e[t])&&void 0!==n?n:e["width"===t?"discreteWidth":"discreteHeight"],{step:e.step})}const il=20;const rl={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:il},mark:{color:"#4c78a8",invalid:"filter",timeUnitBand:1},arc:{},area:{},bar:Xe,circle:{},geoshape:{},image:{},line:{},point:{},rect:Je,rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:qa,style:{},title:{},facet:{spacing:20},concat:{spacing:20}},ol=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],sl={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},al={blue:ol[0],orange:ol[1],red:ol[2],teal:ol[3],green:ol[4],yellow:ol[5],purple:ol[6],pink:ol[7],brown:ol[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function ll(e={}){const{color:t,font:n,fontSize:i}=e,r=M(e,["color","font","fontSize"]);return b({},rl,n?function(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}(n):{},t?function(e={}){return{signals:[{name:"color",value:m(e)?Object.assign(Object.assign({},al),e):al}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}(t):{},i?function(e){return{signals:[{name:"fontSize",value:m(e)?Object.assign(Object.assign({},sl),e):sl}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}(i):{},r||{})}const cl=["view",...qe],ul=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],hl=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},{area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]});function dl(e){e=W(e);for(const t of ul)delete e[t];if(e.axis)for(const t in e.axis)_e(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of Ba)delete e.legend[t];if(e.mark){for(const t of Ke)delete e.mark[t];e.mark.tooltip&&m(e.mark.tooltip)&&delete e.mark.tooltip}for(const t of cl){for(const n of Ke)delete e[t][n];const n=hl[t];if(n)for(const i of n)delete e[t][i];fl(e,t)}for(const t of ie(za))delete e[t];!function(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:i}=Zs(e.title);ne(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t));ne(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n));ne(i)?delete e.title:e.title=i}(e);for(const t in e)m(e[t])&&ne(e[t])&&delete e[t];return ne(e)?void 0:e}function fl(e,t,n,i){const r=i?e[t][i]:e[t];"view"===t&&(n="cell");const o=Object.assign(Object.assign({},r),e.style[null!=n?n:t]);ne(o)||(e.style[null!=n?n:t]=o),i||delete e[t]}function pl(e){return"layer"in e}const gl={zero:1,center:1,normalize:1};const ml=new Set([Ee,je,Me,Fe,Te,Ie,Be,De,Ne,Pe]),vl=new Set([je,Me,Ee]);function bl(e,t){var n,i;const r="x"===t?"y":"radius",o=e[t],s=e[r];if(ys(o)&&ys(s))if("quantitative"===ws(o)&&"quantitative"===ws(s)){if(o.stack)return t;if(s.stack)return r;const e=ys(o)&&!!o.aggregate;if(e!==(ys(s)&&!!s.aggregate))return e?t:r;{const e=null===(n=o.scale)||void 0===n?void 0:n.type,a=null===(i=s.scale)||void 0===i?void 0:i.type;if(e&&"linear"!==e)return r;if(a&&"linear"!==a)return t}}else{if("quantitative"===ws(o))return t;if("quantitative"===ws(s))return r}else{if("quantitative"===ws(o))return t;if("quantitative"===ws(s))return r}}function yl(e,t,n={}){const r=Ve(e)?e.type:e;if(!ml.has(r))return null;const o=bl(t,"x")||bl(t,"theta");if(!o)return null;const s=t[o],a=ys(s)?Rs(s,{}):void 0;let l=function(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}(o),c=t[l],u=ys(c)?Rs(c,{}):void 0;u===a&&(u=void 0,c=void 0,l=void 0);const h=ln.reduce((e,n)=>{if("tooltip"!==n&&fa(t,n)){const i=t[n];for(const t of x(i)){const i=Ws(t);if(i.aggregate)continue;const r=Rs(i,{});r&&r===u||e.push({channel:n,fieldDef:i})}}return e},[]);let d;if(void 0!==s.stack?d=O(s.stack)?s.stack?"zero":null:s.stack:h.length>0&&vl.has(r)&&(d="zero"),!d||!(d in gl))return null;if(pa(t)&&0===h.length)return null;if(s.scale&&s.scale.type&&s.scale.type!==Zr){if(n.disallowNonLinearStack)return null;dr(i.cannotStackNonLinearScale(s.scale.type))}return Ss(t[Vt(o)])?(void 0!==s.stack&&dr(i.cannotStackRangedMark(o)),null):(ys(s)&&s.aggregate&&!K(at,s.aggregate)&&dr(i.stackNonSummativeAggregate(s.aggregate)),{groupbyChannel:c?l:void 0,groupbyField:u,fieldChannel:o,impute:null!==s.impute&&Ue(r),stackBy:h,offset:d})}function wl(e){const{point:t,line:n}=e,i=M(e,["point","line"]);return ie(i).length>1?i:i.type}function xl(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:H(e[t],["point","line"])}));return e}function _l(e,t={},n){return"transparent"===e.point?{opacity:0}:e.point?m(e.point)?e.point:{}:void 0!==e.point?null:t.point||n.shape?m(t.point)?t.point:{}:void 0}function kl(e,t={}){return e.line?!0===e.line?{}:e.line:void 0!==e.line?null:t.line?!0===t.line?{}:t.line:void 0}class Sl{constructor(){this.name="path-overlay"}hasMatchingType(e,t){if(Qe(e)){const{mark:n,encoding:i}=e,r=Ve(n)?n:{type:n};switch(r.type){case"line":case"rule":case"trail":return!!_l(r,t[r.type],i);case"area":return!!_l(r,t[r.type],i)||!!kl(r,t[r.type])}}return!1}run(e,t,n){const{config:i}=t,{selection:r,projection:o,mark:s,encoding:a}=e,l=M(e,["selection","projection","mark","encoding"]),c=va(a,i),u=Ve(s)?s:{type:s},h=_l(u,i[u.type],c),d="area"===u.type&&kl(u,i[u.type]),f=[Object.assign(Object.assign({},r?{selection:r}:{}),{mark:wl(Object.assign(Object.assign({},"area"===u.type&&void 0===u.opacity&&void 0===u.fillOpacity?{opacity:.7}:{}),u)),encoding:H(c,["shape"])})],p=yl(u,c);let g=c;if(p){const{fieldChannel:e,offset:t}=p;g=Object.assign(Object.assign({},c),{[e]:Object.assign(Object.assign({},c[e]),t?{stack:t}:{})})}return d&&f.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"line"},U(u,["clip","interpolate","tension","tooltip"])),d),encoding:g})),h&&f.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},U(u,["clip","tooltip"])),h),encoding:g})),n(Object.assign(Object.assign({},l),{layer:f}),Object.assign(Object.assign({},t),{config:xl(i)}))}}class Ol{constructor(){this.name="RangeStep"}hasMatchingType(e){var t;if(Qe(e)&&e.encoding)for(const n of un){const i=e.encoding[n];if(i&&Ss(i)&&(null===(t=null==i?void 0:i.scale)||void 0===t?void 0:t.rangeStep))return!0}return!1}run(e){var t;const n={};let r=Object.assign({},e.encoding);for(const e of un){const o=Gt(e),s=r[e];if(s&&Ss(s)&&(null===(t=null==s?void 0:s.scale)||void 0===t?void 0:t.rangeStep)){const{scale:t}=s,a=M(s,["scale"]),l=t,{rangeStep:c}=l,u=M(l,["rangeStep"]);n[o]={step:t.rangeStep},dr(i.RANGE_STEP_DEPRECATED),r=Object.assign(Object.assign({},r),{[e]:Object.assign(Object.assign({},a),ne(u)?{}:{scale:u})})}}return Object.assign(Object.assign(Object.assign({},n),e),{encoding:r})}}function Cl(e,t){return t?cs(e)?Rl(e,t):El(e,t):e}function Al(e,t){return t?Rl(e,t):e}function $l(e,t,n){const r=t[e];return(o=r)&&!A(o)&&"repeat"in o?r.repeat in n?Object.assign(Object.assign({},t),{[e]:n[r.repeat]}):void dr(i.noSuchRepeatedValue(r.repeat)):t;var o}function El(e,t){if(void 0!==(e=$l("field",e,t))){if(null===e)return null;if(fs(e)&&as(e.sort)){const n=$l("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function Ml(e,t){if(ys(e))return El(e,t);{const n=$l("datum",e,t);return n===e||n.type||(n.type="nominal"),n}}function jl(e,t){if(!Ss(e)){if(bs(e)){const n=Ml(e.condition,t);if(n)return Object.assign(Object.assign({},e),{condition:n});{const{condition:t}=e;return M(e,["condition"])}}return e}{const n=Ml(e,t);if(n)return n;if(ms(e))return{condition:e.condition}}}function Rl(e,t){const n={};for(const i in e)if(S(e,i)){const r=e[i];if(g(r))n[i]=r.map(e=>jl(e,t)).filter(e=>e);else{const e=jl(r,t);void 0!==e&&(n[i]=e)}}return n}class Dl{constructor(){this.name="RuleForRangedLine"}hasMatchingType(e){if(Qe(e)){const{encoding:t,mark:n}=e;if("line"===n)for(const e of Wt){const n=t[Ht(e)];if(t[e]&&(ys(n)&&!Ln(n.bin)||xs(n)))return!0}}return!1}run(e,t,n){const{encoding:r}=e;return dr(i.lineWithRange(!!r.x2,!!r.y2)),n(Object.assign(Object.assign({},e),{mark:"rule"}),t)}}function Tl({parentEncoding:e,encoding:t={},layer:n}){let i={};if(e){const r=new Set([...ie(e),...ie(t)]);for(const o of r){const r=t[o],s=e[o];if(Ss(r)){const e=Object.assign(Object.assign({},s),r);i[o]=e}else bs(r)?i[o]=Object.assign(Object.assign({},r),{condition:Object.assign(Object.assign({},s),r.condition)}):r||null===r?i[o]=r:(n||Cs(s)||Er(s)||Ss(s)||g(s))&&(i[o]=s)}}else i=t;return!i||ne(i)?void 0:i}function Ll(e){const{parentProjection:t,projection:n}=e;return t&&n&&dr(i.projectionOverridden({parentProjection:t,projection:n})),null!=n?n:t}function Fl(e,t){void 0===t&&(t=ll(e.config));const n=function(e,t={}){return Nl.map(e,{config:t})}(e,t),{width:r,height:o}=e,s=function(e,t,n){let{width:r,height:o}=t;const s=Qe(e)||pl(e),a={};s?"container"==r&&"container"==o?(a.type="fit",a.contains="padding"):"container"==r?(a.type="fit-x",a.contains="padding"):"container"==o&&(a.type="fit-y",a.contains="padding"):("container"==r&&(dr(i.containerSizeNonSingle("width")),r=void 0),"container"==o&&(dr(i.containerSizeNonSingle("height")),o=void 0));const l=Object.assign(Object.assign(Object.assign({type:"pad"},a),n?Pl(n.autosize):{}),Pl(e.autosize));"fit"!==l.type||s||(dr(i.FIT_NON_SINGLE),l.type="pad");"container"==r&&"fit"!=l.type&&"fit-x"!=l.type&&dr(i.containerSizeNotCompatibleWithAutosize("width"));"container"==o&&"fit"!=l.type&&"fit-y"!=l.type&&dr(i.containerSizeNotCompatibleWithAutosize("height"));if(B(l,{type:"pad"}))return;return l}(n,{width:r,height:o,autosize:e.autosize},t);return Object.assign(Object.assign({},n),s?{autosize:s}:{})}const Nl=new class extends class{map(e,t){return hs(e)?this.mapFacet(e,t):function(e){return"repeat"in e}(e)?this.mapRepeat(e,t):Xa(e)?this.mapHConcat(e,t):Ya(e)?this.mapVConcat(e,t):Ka(e)?this.mapConcat(e,t):this.mapLayerOrUnit(e,t)}mapLayerOrUnit(e,t){if(pl(e))return this.mapLayer(e,t);if(Qe(e))return this.mapUnit(e,t);throw new Error(i.invalidSpec(e))}mapLayer(e,t){return Object.assign(Object.assign({},e),{layer:e.layer.map(e=>this.mapLayerOrUnit(e,t))})}mapHConcat(e,t){return Object.assign(Object.assign({},e),{hconcat:e.hconcat.map(e=>this.map(e,t))})}mapVConcat(e,t){return Object.assign(Object.assign({},e),{vconcat:e.vconcat.map(e=>this.map(e,t))})}mapConcat(e,t){const{concat:n}=e,i=M(e,["concat"]);return Object.assign(Object.assign({},i),{concat:n.map(e=>this.map(e,t))})}mapFacet(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})}mapRepeat(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})}}{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[$a,Ra,Na,new Sl,new Dl,new Ol]}map(e,t){if(Qe(e)){const n=fa(e.encoding,ct),i=fa(e.encoding,ut),r=fa(e.encoding,"facet");if(n||i||r)return this.mapFacetedUnit(e,t)}return super.map(e,t)}mapUnit(e,t){const{parentEncoding:n,parentProjection:i}=t,r=Al(e.encoding,t.repeater),o=Object.assign(Object.assign({},e),r?{encoding:r}:{});if(n||i)return this.mapUnitWithParentEncodingOrProjection(o,t);const s=this.mapLayerOrUnit.bind(this);for(const e of this.nonFacetUnitNormalizers)if(e.hasMatchingType(o,t.config))return e.run(o,t,s);return o}mapRepeat(e,t){return function(e){return!g(e.repeat)&&e.repeat.layer}(e)?this.mapLayerRepeat(e,t):this.mapNonLayerRepeat(e,t)}mapLayerRepeat(e,t){const{repeat:n,spec:i}=e,r=M(e,["repeat","spec"]),{row:o,column:s,layer:a}=n,{repeater:l={},repeaterPrefix:c=""}=t;return o||s?this.mapRepeat(Object.assign(Object.assign({},e),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),s?{column:s}:{}),spec:{repeat:{layer:a},spec:i}}),t):Object.assign(Object.assign({},r),{layer:a.map(e=>{const n=Object.assign(Object.assign({},l),{layer:e}),r=(i.name||"")+c+"child__layer_"+ae(e),o=this.mapLayerOrUnit(i,Object.assign(Object.assign({},t),{repeater:n,repeaterPrefix:r}));return o.name=r,o})})}mapNonLayerRepeat(e,t){var n;const{repeat:r,spec:o,data:s}=e,a=M(e,["repeat","spec","data"]);!g(r)&&e.columns&&(e=H(e,["columns"]),dr(i.columnsNotSupportByRowCol("repeat")));const l=[],{repeater:c={},repeaterPrefix:u=""}=t,h=!g(r)&&r.row||[c?c.row:null],d=!g(r)&&r.column||[c?c.column:null],f=g(r)&&r||[c?c.repeat:null];for(const e of f)for(const n of h)for(const i of d){const s={repeat:e,row:n,column:i,layer:c.layer},a=(o.name||"")+u+"child__"+(g(r)?""+ae(e):(r.row?"row_"+ae(n):"")+(r.column?"column_"+ae(i):"")),h=this.map(o,Object.assign(Object.assign({},t),{repeater:s,repeaterPrefix:a}));h.name=a,l.push(H(h,["data"]))}const p=g(r)?e.columns:r.column?r.column.length:1;return Object.assign(Object.assign({data:null!==(n=o.data)&&void 0!==n?n:s,align:"all"},a),{columns:p,concat:l})}mapFacet(e,t){const{facet:n}=e;return cs(n)&&e.columns&&(e=H(e,["columns"]),dr(i.columnsNotSupportByRowCol("facet"))),super.mapFacet(e,t)}mapUnitWithParentEncodingOrProjection(e,t){const{encoding:n,projection:i}=e,{parentEncoding:r,parentProjection:o,config:s}=t,a=Ll({parentProjection:o,projection:i}),l=Tl({parentEncoding:r,encoding:Al(n,t.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},e),a?{projection:a}:{}),l?{encoding:l}:{}),{config:s})}mapFacetedUnit(e,t){const n=e.encoding,{row:i,column:r,facet:o}=n,s=M(n,["row","column","facet"]),{mark:a,width:l,projection:c,height:u,view:h,selection:d,encoding:f}=e,p=M(e,["mark","width","projection","height","view","selection","encoding"]),{facetMapping:g,layout:m}=this.getFacetMappingAndLayout({row:i,column:r,facet:o},t),v=Al(s,t.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},p),m),{facet:g,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l?{width:l}:{}),u?{height:u}:{}),h?{view:h}:{}),c?{projection:c}:{}),{mark:a,encoding:v}),d?{selection:d}:{})}),t)}getFacetMappingAndLayout(e,t){var n;const{row:r,column:o,facet:s}=e;if(r||o){s&&dr(i.facetChannelDropped([...r?[ct]:[],...o?[ut]:[]]));const t={},a={};for(const i of[ct,ut]){const r=e[i];if(r){const{align:e,center:o,spacing:s,columns:l}=r,c=M(r,["align","center","spacing","columns"]);t[i]=c;for(const e of["align","center","spacing"])void 0!==r[e]&&(a[e]=null!==(n=a[e])&&void 0!==n?n:{},a[e][i]=r[e])}}return{facetMapping:t,layout:a}}{const{align:e,center:n,spacing:i,columns:r}=s;return{facetMapping:Cl(M(s,["align","center","spacing","columns"]),t.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},e?{align:e}:{}),n?{center:n}:{}),i?{spacing:i}:{}),r?{columns:r}:{})}}}mapLayer(e,t){var{parentEncoding:n,parentProjection:i}=t,r=M(t,["parentEncoding","parentProjection"]);const{encoding:o,projection:s}=e,a=M(e,["encoding","projection"]),l=Object.assign(Object.assign({},r),{parentEncoding:Tl({parentEncoding:n,encoding:o,layer:!0}),parentProjection:Ll({parentProjection:i,projection:s})});return super.mapLayer(a,l)}};function Pl(e){return A(e)?{type:e}:null!=e?e:{}}const zl=["background","padding"];function Il(e){return zl.reduce((t,n)=>(e&&void 0!==e[n]&&(t[n]=e[n]),t),{})}class Bl{constructor(e={},t={}){this.explicit=e,this.implicit=t}clone(){return new Bl(W(this.explicit),W(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(e){return ve(this.explicit[e],this.implicit[e])}getWithExplicit(e){return void 0!==this.explicit[e]?{explicit:!0,value:this.explicit[e]}:void 0!==this.implicit[e]?{explicit:!1,value:this.implicit[e]}:{explicit:!1,value:void 0}}setWithExplicit(e,t){void 0!==t.value&&this.set(e,t.value,t.explicit)}set(e,t,n){return delete this[n?"implicit":"explicit"][e],this[n?"explicit":"implicit"][e]=t,this}copyKeyFromSplit(e,t){void 0!==t.explicit[e]?this.set(e,t.explicit[e],!0):void 0!==t.implicit[e]&&this.set(e,t.implicit[e],!1)}copyKeyFromObject(e,t){void 0!==t[e]&&this.set(e,t[e],!0)}copyAll(e){for(const t of ie(e.combine())){const n=e.getWithExplicit(t);this.setWithExplicit(t,n)}}}function Wl(e){return{explicit:!0,value:e}}function Ul(e){return{explicit:!1,value:e}}function Hl(e){return(t,n,i,r)=>{const o=e(t.value,n.value);return o>0?t:o<0?n:ql(t,n,i,r)}}function ql(e,t,n,r){return e.explicit&&t.explicit&&dr(i.mergeConflictingProperty(n,r,e.value,t.value)),e}function Vl(e,t,n,i,r=ql){return void 0===e||void 0===e.value?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:B(e.value,t.value)?e:r(e,t,n,i)}class Gl extends Bl{constructor(e={},t={},n=!1){super(e,t),this.explicit=e,this.implicit=t,this.parseNothing=n}clone(){const e=super.clone();return e.parseNothing=this.parseNothing,e}}function Kl(e){return"url"in e}function Yl(e){return"values"in e}function Xl(e){return"name"in e&&!Kl(e)&&!Yl(e)&&!Jl(e)}function Jl(e){return e&&(Ql(e)||Zl(e)||ec(e))}function Ql(e){return"sequence"in e}function Zl(e){return"sphere"in e}function ec(e){return"graticule"in e}var tc;function nc(e){return"filter"in e}function ic(e){return"lookup"in e}function rc(e){return"pivot"in e}function oc(e){return"density"in e}function sc(e){return"quantile"in e}function ac(e){return"regression"in e}function lc(e){return"loess"in e}function cc(e){return"sample"in e}function uc(e){return"window"in e}function hc(e){return"joinaggregate"in e}function dc(e){return"flatten"in e}function fc(e){return"calculate"in e}function pc(e){return"bin"in e}function gc(e){return"impute"in e}function mc(e){return"timeUnit"in e}function vc(e){return"aggregate"in e}function bc(e){return"stack"in e}function yc(e){return"fold"in e}!function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup"}(tc||(tc={}));var wc=n(6);function xc(e,t,n,i){const r=ms(t)&&t.condition,o=i(t);if(r){return{[n]:[...x(r).map(t=>{const n=i(t),r=function(e){return e.selection}(t)?Du(e,t.selection):Lu(e,t.test);return Object.assign({test:r},n)}),...void 0!==o?[o]:[]]}}return void 0!==o?{[n]:o}:{}}function _c(e,t="text"){const n=e.encoding[t];return xc(e,n,t,t=>kc(t,e.config))}function kc(e,t,n="datum"){if(e){if(Cs(e))return ta(e.value);if(Ss(e)){const{format:i,formatType:r}=Bs(e);return Ko({fieldOrDatumDef:e,format:i,formatType:r,expr:n,config:t})}}}function Sc(e,t={}){const{encoding:n,markDef:i,config:r,stack:o}=e,s=n.tooltip;if(g(s))return{tooltip:Cc({tooltip:s},o,r,t)};{const a=t.reactiveGeom?"datum.datum":"datum";return xc(e,s,"tooltip",e=>{const s=kc(e,r,a);if(s)return s;if(null===e)return;let l=oa("tooltip",i,r);return!0===l&&(l={content:"encoding"}),A(l)?{value:l}:m(l)?Er(l)?l:"encoding"===l.content?Cc(n,o,r,t):{signal:a}:void 0})}}function Oc(e,t,n,{reactiveGeom:i}={}){const r={},o=i?"datum.datum":"datum",s=[];function a(i,a){const l=Ht(a),c=Os(i)?i:Object.assign(Object.assign({},i),{type:e[l].type}),u=c.title||Is(c,n),h=x(u).join(", ");let d;if(hn(a)){const i="x"===a?"x2":"y2",s=Ws(e[i]);if(Ln(c.bin)&&s){const e=Rs(c,{expr:o}),t=Rs(s,{expr:o}),{format:a,formatType:l}=Bs(c);d=ns(e,t,a,l,n),r[i]=!0}else if(t&&t.fieldChannel===a&&"normalize"===t.offset){const{format:e,formatType:t}=Bs(c);d=Ko({fieldOrDatumDef:c,format:e,formatType:t,expr:o,config:n,normalizeStack:!0}).signal}}d=null!=d?d:kc(c,n,o).signal,s.push({channel:a,key:h,value:d})}ba(e,(e,t)=>{ys(e)?a(e,t):vs(e)&&a(e.condition,t)});const l={};for(const{channel:e,key:t,value:n}of s)r[e]||l[t]||(l[t]=n);return l}function Cc(e,t,n,{reactiveGeom:i}={}){const r=oe(Oc(e,t,n,{reactiveGeom:i})).map(({key:e,value:t})=>`"${e}": ${t}`);return r.length>0?{signal:`{${r.join(", ")}}`}:void 0}function Ac(e){const{markDef:t,config:n}=e,i=oa("aria",t,n);return!1===i?{}:Object.assign(Object.assign(Object.assign({},i?{aria:i}:{}),function(e){const{mark:t,markDef:n,config:i}=e;if(!1===i.aria)return{};const r=oa("ariaRoleDescription",n,i);if(null!=r)return{ariaRoleDescription:{value:r}};return t in Dr?{}:{ariaRoleDescription:{value:t}}}(e)),function(e){const{encoding:t,markDef:n,config:i,stack:r}=e,o=t.description;if(o)return xc(e,o,"description",t=>kc(t,e.config));const s=oa("description",n,i);if(null!=s)return{description:ta(s)};if(!1===i.aria)return{};const a=Oc(t,r,i);if(ne(a))return;return{description:{signal:oe(a).map(({key:e,value:t},n)=>`"${n>0?"; ":""}${e}: " + (${t})`).join(" + ")}}}(e))}function $c(e,t,n={}){const{markDef:i,encoding:r,config:o}=t,{vgChannel:s}=n;let{defaultRef:a,defaultValue:l}=n;void 0===a&&(l=null!=l?l:oa(e,i,o,{vgChannel:s,ignoreVgConfig:!0}),void 0!==l&&(a=ta(l)));const c=r[e];return xc(t,c,null!=s?s:e,n=>Ho({channel:e,channelDef:n,markDef:i,config:o,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:a}))}function Ec(e,t={filled:void 0}){var n,r,o,s;const{markDef:a,encoding:l,config:c}=e,{type:u}=a,h=null!==(n=t.filled)&&void 0!==n?n:oa("filled",a,c),d=K(["bar","point","circle","square","geoshape"],u)?"transparent":void 0,f=null!==(o=null!==(r=oa(!0===h?"color":void 0,a,c,{vgChannel:"fill"}))&&void 0!==r?r:c.mark[!0===h&&"color"])&&void 0!==o?o:d,p=null!==(s=oa(!1===h?"color":void 0,a,c,{vgChannel:"stroke"}))&&void 0!==s?s:c.mark[!1===h&&"color"],g=h?"fill":"stroke",m=Object.assign(Object.assign({},f?{fill:ta(f)}:{}),p?{stroke:ta(p)}:{});return a.color&&(h?a.fill:a.stroke)&&dr(i.droppingColor("property",{fill:"fill"in a,stroke:"stroke"in a})),Object.assign(Object.assign(Object.assign(Object.assign({},m),$c("color",e,{vgChannel:g,defaultValue:h?f:p})),$c("fill",e,{defaultValue:l.fill?f:void 0})),$c("stroke",e,{defaultValue:l.stroke?p:void 0}))}function Mc(e,t){const n=t[function(e){switch(e){case ht:return"xOffset";case dt:return"yOffset";case ft:return"x2Offset";case pt:return"y2Offset";case mt:return"thetaOffset";case gt:return"radiusOffset";case vt:return"theta2Offset";case"radius2":return"radius2Offset"}}(e)];if(n)return n}function jc(e,t,{defaultPos:n,vgChannel:i,isMidPoint:r}){const{encoding:o,markDef:s,config:a,stack:l}=t,c=o[e],u=o[Vt(e)],h=t.scaleName(e),d=t.getScaleComponent(e),f=Mc(e,s),p=Rc({model:t,defaultPos:n,channel:e,scaleName:h,scale:d}),g=!c&&hn(e)&&(o.latitude||o.longitude)?{field:t.getName(e)}:function(e){const{channel:t,channelDef:n,isMidPoint:i,scaleName:r,stack:o,offset:s,markDef:a,config:l}=e;if(Ss(n)&&o&&t===o.fieldChannel){if(ys(n)){const e=ps({channel:t,fieldDef:n,isMidPoint:i,markDef:a,stack:o,config:l});if(void 0!==e)return Uo({scaleName:r,fieldOrDatumDef:n,startSuffix:"start",band:e,offset:s})}return Wo(n,r,{suffix:"end"},{offset:s})}return Po(e)}({channel:e,channelDef:c,channel2Def:u,markDef:s,config:a,isMidPoint:r,scaleName:h,scale:d,stack:l,offset:f,defaultRef:p});return g?{[i||e]:g}:void 0}function Rc({model:e,defaultPos:t,channel:n,scaleName:i,scale:r}){const{markDef:o,config:s}=e;return()=>{const a=Ht(n),l=qt(n),c=oa(n,o,s,{vgChannel:l});if(void 0!==c)return qo(n,c);switch(t){case"zeroOrMin":case"zeroOrMax":if(i){const e=r.get("type");if(K([eo,ro,oo],e));else if(r.domainDefinitelyIncludesZero())return{scale:i,value:0}}if("zeroOrMin"===t)return"y"===a?{field:{group:"height"}}:{value:0};switch(a){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const t=e[Gt(n)];return Object.assign(Object.assign({},t),{mult:.5})}}}}const Dc={left:"x",center:"xc",right:"x2"},Tc={top:"y",middle:"yc",bottom:"y2"};function Lc(e,t,n,i="middle"){if("radius"===e||"theta"===e)return qt(e);const r=oa("x"===e?"align":"baseline",t,n);return"x"===e?Dc[r||("top"===i?"left":"center")]:Tc[r||i]}function Fc(e,t,{defaultPos:n,defaultPos2:i,range:r}){return r?Nc(e,t,{defaultPos:n,defaultPos2:i}):jc(e,t,{defaultPos:n})}function Nc(e,t,{defaultPos:n,defaultPos2:i}){const{markDef:r,config:o}=t,s=Vt(e),a=Gt(e),l=function(e,t,n){const{encoding:i,mark:r,markDef:o,stack:s,config:a}=e,l=Ht(n),c=Gt(n),u=qt(n),h=i[l],d=e.scaleName(l),f=e.getScaleComponent(l),p=Mc(n in i||n in o?n:l,e.markDef);if(!h&&("x2"===n||"y2"===n)&&(i.latitude||i.longitude))return{[u]:{field:e.getName(n)}};const g=function({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:o,scale:s,stack:a,offset:l,defaultRef:c}){if(Ss(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0))return Wo(t,o,{suffix:"start"},{offset:l});return Po({channel:e,channelDef:n,scaleName:o,scale:s,stack:a,markDef:i,config:r,offset:l,defaultRef:c})}({channel:n,channelDef:h,channel2Def:i[n],markDef:o,config:a,scaleName:d,scale:f,stack:s,offset:p,defaultRef:void 0});if(void 0!==g)return{[u]:g};return Pc(n,o)||Pc(n,{[n]:aa(n,o,a.style),[c]:aa(c,o,a.style)})||Pc(n,a[r])||Pc(n,a.mark)||{[u]:Rc({model:e,defaultPos:t,channel:n,scaleName:d,scale:f})()}}(t,i,s),c=l[a]?Lc(e,r,o):qt(e);return Object.assign(Object.assign({},jc(e,t,{defaultPos:n,vgChannel:c})),l)}function Pc(e,t){const n=Gt(e),i=qt(e);return void 0!==t[i]?{[i]:qo(e,t[i])}:void 0!==t[e]?{[i]:qo(e,t[e])}:t[n]?{[n]:qo(e,t[n])}:void 0}function zc(e,t,n){var r,o,s,a;const{config:l,encoding:c,markDef:u,stack:h}=e,d=Vt(t),f=Gt(t),p=c[t],m=c[d],v=e.getScaleComponent(t),b=v?v.get("type"):void 0,y=e.scaleName(t),w=u.orient,x=null!==(o=null!==(r=c[f])&&void 0!==r?r:c.size)&&void 0!==o?o:oa("size",u,l,{vgChannel:f}),_="bar"===n&&("x"===t?"vertical"===w:"horizontal"===w);if(ys(p)&&(Tn(p.bin)||Ln(p.bin)||p.timeUnit&&!m)&&!x&&!_o(b)){const n=ps({channel:t,fieldDef:p,stack:h,markDef:u,config:l}),r=null===(s=e.component.axes[t])||void 0===s?void 0:s[0];return function({fieldDef:e,fieldDef2:t,channel:n,band:r,scaleName:o,markDef:s,spacing:a=0,axisTranslate:l,reverse:c,config:u}){const h=Vt(n),d=qt(n),f=qt(h),p=Mc(n,s);if(Tn(e.bin)||e.timeUnit)return{[f]:Wc({channel:n,fieldDef:e,scaleName:o,markDef:s,band:(1-r)/2,offset:Bc(h,a,c,l,p),config:u}),[d]:Wc({channel:n,fieldDef:e,scaleName:o,markDef:s,band:1-(1-r)/2,offset:Bc(n,a,c,l,p),config:u})};if(Ln(e.bin)){const i=Wo(e,o,{},{offset:Bc(h,a,c,l,p)});if(ys(t))return{[f]:i,[d]:Wo(t,o,{},{offset:Bc(n,a,c,l,p)})};if(Fn(e.bin)&&e.bin.step)return{[f]:i,[d]:{signal:`scale("${o}", ${Rs(e,{expr:"datum"})} + ${e.bin.step})`,offset:Bc(n,a,c,l,p)}}}return void dr(i.channelRequiredForBinned(h))}({fieldDef:p,fieldDef2:m,channel:t,markDef:u,scaleName:y,band:n,axisTranslate:null!==(a=null==r?void 0:r.get("translate"))&&void 0!==a?a:.5,spacing:hn(t)?oa("binSpacing",u,l):void 0,reverse:v.get("reverse"),config:l})}return(Ss(p)&&_o(b)||_)&&!m?function(e,t,n,r){var o;const{markDef:s,encoding:a,config:l,stack:c}=r,u=s.orient,h=r.scaleName(n),d=r.getScaleComponent(n),f=Gt(n),p=Vt(n),m="horizontal"===u&&"y"===n||"vertical"===u&&"x"===n,v=oa(m?"size":f,s,l,{vgChannel:f});let b;(a.size||void 0!==v)&&(m?b=$c("size",r,{vgChannel:f,defaultValue:v}):dr(i.cannotApplySizeToNonOrientedMark(s.type)));const y=null!==(o=Ss(t)?ps({channel:n,fieldDef:t,markDef:s,stack:c,config:l}):void 0)&&void 0!==o?o:1;b=b||{[f]:Ic(e,f,h,d,l,y)};const w="band"!==(null==d?void 0:d.get("type"))||!("band"in b[f]),x=Lc(n,s,l,w?"middle":"top"),_=Mc(n,s),k=Po({channel:n,channelDef:t,markDef:s,config:l,scaleName:h,scale:d,stack:c,offset:_,defaultRef:Rc({model:r,defaultPos:"mid",channel:n,scaleName:h,scale:d}),band:w?.5:(1-y)/2});if(f)return Object.assign({[x]:k},b);{const e=qt(p),t=b[f],n=_?Object.assign(Object.assign({},t),{offset:_}):t;return{[x]:k,[e]:g(k)?[k[0],Object.assign(Object.assign({},k[1]),{offset:n})]:Object.assign(Object.assign({},k),{offset:n})}}}(n,p,t,e):Nc(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function Ic(e,t,n,i,r,o){if(i){const t=i.get("type");if("point"===t||"band"===t){if(void 0!==r[e].discreteBandSize)return{value:r[e].discreteBandSize};if(t===co){const e=i.get("range");return Mr(e)&&C(e.step)?{value:e.step-2}:{value:il-2}}return{scale:n,band:o}}return{value:r[e].continuousBandSize}}const s=tl(r.view,t),a=ve(r[e].discreteBandSize,s-2);return void 0!==a?{value:a}:void 0}function Bc(e,t,n,i,r){if(St(e))return 0;const o="x"===e||"y2"===e?-t/2:t/2;if(Er(n)||Er(r)||Er(i)){const e=ia(n),t=ia(r),s=ia(i);return{signal:(s?s+" + ":"")+(e?`(${e} ? -1 : 1) * `:"")+(t?`(${t} + ${o})`:o)}}return r=r||0,i+(n?-r-o:+r+o)}function Wc({channel:e,fieldDef:t,scaleName:n,markDef:i,band:r,offset:o,config:s}){return zo({fieldDef:t,channel:e,markDef:i,ref:Uo({scaleName:n,fieldOrDatumDef:t,band:r,offset:o}),config:s})}const Uc=new Set(["aria"]);function Hc(e,t){const{fill:n,stroke:i}="include"===t.color?Ec(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},function(e,t){return Rr.reduce((n,i)=>(Uc.has(i)||void 0===e[i]||"ignore"===t[i]||(n[i]=ta(e[i])),n),{})}(e.markDef,t)),qc(e,"fill",n)),qc(e,"stroke",i)),$c("opacity",e)),$c("fillOpacity",e)),$c("strokeOpacity",e)),$c("strokeWidth",e)),$c("strokeDash",e)),function(e){const{encoding:t,mark:n}=e,i=t.order;return!Ue(n)&&Cs(i)?xc(e,i,"zindex",e=>e):{}}(e)),Sc(e)),_c(e,"href")),Ac(e))}function qc(e,t,n){const{config:i,mark:r,markDef:o}=e;if("hide"===oa("invalid",o,i)&&n&&!Ue(r)){const i=function(e,{invalid:t=!1,channels:n}){const i=n.reduce((t,n)=>{const i=e.getScaleComponent(n);if(i){const r=i.get("type"),o=e.vgField(n,{expr:"datum"});o&&ko(r)&&(t[o]=!0)}return t},{}),r=ie(i);if(r.length>0){const e=t?"||":"&&";return r.map(e=>Bo(e,t)).join(` ${e} `)}return}(e,{invalid:!0,channels:Cn});if(i)return{[t]:[{test:i,value:null},...x(n)]}}return n?{[t]:n}:{}}function Vc(e){const{config:t,markDef:n}=e;if(oa("invalid",n,t)){const t=function(e,{invalid:t=!1,channels:n}){const i=n.reduce((t,n)=>{const i=e.getScaleComponent(n);if(i){const r=i.get("type"),o=e.vgField(n,{expr:"datum"});o&&ko(r)&&(t[o]=!0)}return t},{}),r=ie(i);if(r.length>0){const e=t?"||":"&&";return r.map(e=>Bo(e,t)).join(` ${e} `)}return}(e,{channels:un});if(t)return{defined:{signal:t}}}return{}}function Gc(e,t){if(void 0!==t)return{[e]:ta(t)}}var Kc={has:e=>"interval"!==e.type&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName("voronoi")},marks:(e,t,n)=>{const{x:r,y:o}=t.project.hasChannel,s=e.mark;if(Ue(s))return dr(i.nearestNotSupportForContinuous(s)),n;const a={name:e.getName("voronoi"),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},Sc(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:r||!o?"datum.datum.x || 0":"0"},y:{expr:o||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let l=0,c=!1;return n.forEach((t,n)=>{var i;const r=null!==(i=t.name)&&void 0!==i?i:"";r===e.component.mark[0].name?l=n:r.indexOf("voronoi")>=0&&(c=!0)}),c||n.splice(l+1,0,a),n}};class Yc{constructor(e,t){this.debugName=t,this._children=[],this._parent=null,e&&(this.parent=e)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(e){this._parent=e,e&&e.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(e,t){this._children.indexOf(e)>-1?dr(i.ADD_SAME_CHILD_TWICE):void 0!==t?this._children.splice(t,0,e):this._children.push(e)}removeChild(e){const t=this._children.indexOf(e);return this._children.splice(t,1),t}remove(){let e=this._parent.removeChild(this);for(const t of this._children)t._parent=this._parent,this._parent.addChild(t,e++)}insertAsParentOf(e){const t=e.parent;t.removeChild(this),this.parent=t,e.parent=this}swapWithParent(){const e=this._parent,t=e.parent;for(const t of this._children)t.parent=e;this._children=[],e.removeChild(this),e.parent.removeChild(e),this.parent=t,e.parent=this}}class Xc extends Yc{constructor(e,t,n,i){super(e,t),this.type=n,this.refCounts=i,this._source=this._name=t,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const e=new this.constructor;return e.debugName="clone_"+this.debugName,e._source=this._source,e._name="clone_"+this._name,e.type=this.type,e.refCounts=this.refCounts,e.refCounts[e._name]=0,e}dependentFields(){return new Set}producedFields(){return new Set}hash(){return void 0===this._hash&&(this._hash="Output "+function(e){const t=++be;return e?String(e)+t:t}()),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(e){this._source=e}}class Jc extends Yc{constructor(e,t){super(e),this.formula=t}clone(){return new Jc(null,W(this.formula))}static makeFromEncoding(e,t){const n=t.reduceFieldDef((e,n,i)=>{const{field:r,timeUnit:o}=n,s=af(t)?t.encoding[Vt(i)]:void 0,a=af(t)&&gs(i,n,s,t.stack,t.markDef,t.config);if(o){const t=Rs(n,{forAs:!0});e[V({as:t,field:r,timeUnit:o})]=Object.assign({as:t,field:r,timeUnit:o},a?{band:!0}:{})}return e},{});return ne(n)?null:new Jc(e,n)}static makeFromTransform(e,t){const n=Object.assign({},t),{timeUnit:i}=n,r=M(n,["timeUnit"]),o=$r(i),s=Object.assign(Object.assign({},r),{timeUnit:o});return new Jc(e,{[V(s)]:s})}merge(e){this.formula=Object.assign({},this.formula);for(const t in e.formula)this.formula[t]&&!e.formula[t].band||(this.formula[t]=e.formula[t]);for(const t of e.children)e.removeChild(t),t.parent=this;e.remove()}producedFields(){return new Set(re(this.formula).map(e=>e.as))}dependentFields(){return new Set(re(this.formula).map(e=>e.field))}hash(){return"TimeUnit "+V(this.formula)}assemble(){const e=[];for(const t of re(this.formula)){const{field:n,as:i,timeUnit:r}=t,o=$r(r),{unit:s,utc:a}=o,l=M(o,["unit","utc"]);e.push(Object.assign(Object.assign(Object.assign(Object.assign({field:fe(n),type:"timeunit"},s?{units:Sr(s)}:{}),a?{timezone:"utc"}:{}),l),{as:[i,i+"_end"]}))}return e}}class Qc{constructor(...e){this.items=e,this.hasChannel={},this.hasField={}}}var Zc={has:e=>"single"===e.type&&"global"===e.resolve&&e.bind&&"scales"!==e.bind&&!Va(e.bind),parse:(e,t,n,i)=>{i.on||delete t.events,i.clear||delete t.clear},topLevelSignals:(e,t,n)=>{const i=t.name,r=t.project,o=t.bind,s=t.init&&t.init[0],a=Kc.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return r.items.forEach((e,r)=>{var l,c;const u=ae(`${i}_${e.field}`);n.filter(e=>e.name===u).length||n.unshift(Object.assign(Object.assign({name:u},s?{init:fu(s[r])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${$(e.field)}] : null`}]:[],bind:null!==(c=null!==(l=o[e.field])&&void 0!==l?l:o[e.channel])&&void 0!==c?c:o}))}),n},signals:(e,t,n)=>{const i=t.name,r=t.project,o=n.filter(e=>e.name===i+ku)[0],s=i+"_tuple_fields",a=r.items.map(e=>ae(`${i}_${e.field}`)),l=a.map(e=>e+" !== null").join(" && ");return a.length&&(o.update=`${l} ? {fields: ${s}, values: [${a.join(", ")}]} : null`),delete o.value,delete o.on,n}};var eu={has:e=>"multi"===e.type&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+"_toggle",value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+ku,i=t.name+"_toggle";return`${i} ? null : ${n}, `+("global"===t.resolve?i+" ? null : true, ":`${i} ? null : {unit: ${$u(e)}}, `)+`${i} ? ${n} : null`}};const tu={has:e=>void 0!==e.clear&&!1!==e.clear,parse:(e,t,n)=>{n.clear&&(t.clear=A(n.clear)?Object(wc.a)(n.clear,"scope"):n.clear)},topLevelSignals:(e,t,n)=>{if(Zc.has(t))for(const e of t.project.items){const i=n.findIndex(n=>n.name===ae(`${t.name}_${e.field}`));-1!==i&&n[i].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function i(e,i){-1!==e&&n[e].on&&n[e].on.push({events:t.clear,update:i})}if("interval"===t.type)for(const e of t.project.items){const t=n.findIndex(t=>t.name===e.signals.visual);if(i(t,"[0, 0]"),-1===t){i(n.findIndex(t=>t.name===e.signals.data),"null")}}else{let e=n.findIndex(e=>e.name===t.name+ku);i(e,"null"),eu.has(t)&&(e=n.findIndex(e=>e.name===t.name+"_toggle"),i(e,"false"))}return n}};var nu={has:e=>"interval"===e.type&&"global"===e.resolve&&e.bind&&"scales"===e.bind,parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const o=r.channel;if(!An(o))continue;const s=e.getScaleComponent(o),a=s?s.get("type"):void 0;if(!s||!ko(a)){dr(i.SCALE_BINDINGS_CONTINUOUS);continue}const l={selection:t.name,field:r.field};s.set("selectionExtent",l,!0),n.push(r)}},topLevelSignals:(e,t,n)=>{const i=t.scales.filter(e=>0===n.filter(t=>t.name===e.signals.data).length);if(!e.parent||ru(e)||0===i.length)return n;const r=n.filter(e=>e.name===t.name)[0];let o=r.update;if(o.indexOf(Ou)>=0)r.update=`{${i.map(e=>`${$(e.field)}: ${e.signals.data}`).join(", ")}}`;else{for(const e of i){const t=`${$(e.field)}: ${e.signals.data}`;o.indexOf(t)<0&&(o=`${o.substring(0,o.length-1)}, ${t}}`)}r.update=o}return n.concat(i.map(e=>({name:e.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!ru(e))for(const e of t.scales){const t=n.filter(t=>t.name===e.signals.data)[0];t.push="outer",delete t.value,delete t.update}return n}};function iu(e,t){return`domain(${$(e.scaleName(t))})`}function ru(e){var t;return e.parent&&uf(e.parent)&&(null!==(t=!e.parent.parent)&&void 0!==t?t:ru(e.parent.parent))}const ou={has:e=>{const t="global"===e.resolve&&e.bind&&Va(e.bind),n=1===e.project.items.length&&"_vgsid_"!==e.project.items[0].field;return t&&!n&&dr(i.LEGEND_BINDINGS_MUST_HAVE_PROJECTION),t&&n},parse:(e,t,n,i)=>{var r;if(i.on||delete t.events,i.clear||delete t.clear,i.on||i.clear){const e='event.item && indexof(event.item.mark.role, "legend") < 0';for(const n of t.events)n.filter=x(null!==(r=n.filter)&&void 0!==r?r:[]),n.filter.indexOf(e)<0&&n.filter.push(e)}const o=Ga(t.bind)?t.bind.legend:"click",s=A(o)?Object(wc.a)(o,"view"):x(o);t.bind={legend:{merge:s}}},topLevelSignals:(e,t,n)=>{const i=t.name,r=Ga(t.bind)&&t.bind.legend,o=e=>t=>{const n=W(t);return n.markname=e,n};for(const e of t.project.items){if(!e.hasLegend)continue;const s=ae(e.field)+"_legend",a=`${i}_${s}`;if(0===n.filter(e=>e.name===a).length){const e=r.merge.map(o(s+"_symbols")).concat(r.merge.map(o(s+"_labels"))).concat(r.merge.map(o(s+"_entries")));n.unshift(Object.assign(Object.assign({name:a},t.init?{}:{value:null}),{on:[{events:e,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:r.merge,update:"!event.item || !datum ? null : "+a,force:!0}]}))}}return n},signals:(e,t,n)=>{const i=t.name,r=t.project,o=n.find(e=>e.name===i+ku),s=i+"_tuple_fields",a=r.items.filter(e=>e.hasLegend).map(e=>ae(`${i}_${ae(e.field)}_legend`)),l=`${a.map(e=>e+" !== null").join(" && ")} ? {fields: ${s}, values: [${a.join(", ")}]} : null`;t.events&&a.length>0?o.on.push({events:a.map(e=>({signal:e})),update:l}):a.length>0&&(o.update=l,delete o.value,delete o.on);const c=n.find(e=>e.name===i+"_toggle"),u=Ga(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:u})):c.on[0].events=u),n}};const su="_translate_delta",au={has:e=>"interval"===e.type&&e.translate,signals:(e,t,n)=>{const i=t.name,r=nu.has(t),o=i+"_translate_anchor",{x:s,y:a}=t.project.hasChannel;let l=Object(wc.a)(t.translate,"scope");return r||(l=l.map(e=>(e.between[0].markname=i+mu,e))),n.push({name:o,value:{},on:[{events:l.map(e=>e.between[0]),update:"{x: x(unit), y: y(unit)"+(void 0!==s?", extent_x: "+(r?iu(e,ht):`slice(${s.signals.visual})`):"")+(void 0!==a?", extent_y: "+(r?iu(e,dt):`slice(${a.signals.visual})`):"")+"}"}]},{name:i+su,value:{},on:[{events:l,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),void 0!==s&&lu(e,t,s,"width",n),void 0!==a&&lu(e,t,a,"height",n),n}};function lu(e,t,n,i,r){var o;const s=t.name,a=s+"_translate_anchor",l=s+su,c=n.channel,u=nu.has(t),h=r.filter(e=>e.name===n.signals[u?"data":"visual"])[0],d=e.getSizeSignalRef(i).signal,f=e.getScaleComponent(c),p=f.get("type"),g=`${a}.extent_${c}`,m=`${u?"log"===p?"panLog":"pow"===p?"panPow":"panLinear":"panLinear"}(${g}, ${`${u&&c===ht?"-":""}${l}.${c} / `+(u?""+d:`span(${g})`)}`+(u&&"pow"===p?", "+(null!==(o=f.get("exponent"))&&void 0!==o?o:1):"")+")";h.on.push({events:{signal:l},update:u?m:`clampRange(${m}, 0, ${d})`})}const cu={has:e=>"interval"===e.type&&e.zoom,signals:(e,t,n)=>{const i=t.name,r=nu.has(t),o=i+"_zoom_delta",{x:s,y:a}=t.project.hasChannel,l=$(e.scaleName(ht)),c=$(e.scaleName(dt));let u=Object(wc.a)(t.zoom,"scope");return r||(u=u.map(e=>(e.markname=i+mu,e))),n.push({name:i+"_zoom_anchor",on:[{events:u,update:r?"{"+[l?`x: invert(${l}, x(unit))`:"",c?`y: invert(${c}, y(unit))`:""].filter(e=>!!e).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:u,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==s&&uu(e,t,s,"width",n),void 0!==a&&uu(e,t,a,"height",n),n}};function uu(e,t,n,i,r){var o;const s=t.name,a=n.channel,l=nu.has(t),c=r.filter(e=>e.name===n.signals[l?"data":"visual"])[0],u=e.getSizeSignalRef(i).signal,h=e.getScaleComponent(a),d=h.get("type"),f=l?iu(e,a):c.name,p=s+"_zoom_delta",g=`${l?"log"===d?"zoomLog":"pow"===d?"zoomPow":"zoomLinear":"zoomLinear"}(${f}, ${`${s}_zoom_anchor.${a}`}, ${p}`+(l&&"pow"===d?", "+(null!==(o=h.get("exponent"))&&void 0!==o?o:1):"")+")";c.on.push({events:{signal:p},update:l?g:`clampRange(${g}, 0, ${u})`})}const hu=[{has:()=>!0,parse:(e,t,n)=>{var r,o,s;const a=t.name,l=null!==(r=t.project)&&void 0!==r?r:t.project=new Qc,c={},u={},h=new Set,d=(e,t)=>{const n="visual"===t?e.channel:e.field;let i=ae(`${a}_${n}`);for(let e=1;h.has(i);e++)i=ae(`${a}_${n}_${e}`);return h.add(i),{[t]:i}};if(!n.fields&&!n.encodings){const t=e.config.selection[n.type];if(n.init)for(const e of x(n.init))for(const r of ie(e))It[r]?(n.encodings||(n.encodings=[])).push(r):"interval"===n.type?(dr(i.INTERVAL_INITIALIZED_WITH_X_Y),n.encodings=t.encodings):(n.fields||(n.fields=[])).push(r);else n.encodings=t.encodings,n.fields=t.fields}for(const e of null!==(o=n.fields)&&void 0!==o?o:[]){const t={type:"E",field:e};t.signals=Object.assign({},d(t,"data")),l.items.push(t),l.hasField[e]=t}for(const r of null!==(s=n.encodings)&&void 0!==s?s:[]){const n=e.fieldDef(r);if(n){let o=n.field;if(n.aggregate){dr(i.cannotProjectAggregate(r,n.aggregate));continue}if(!o){dr(i.cannotProjectOnChannelWithoutField(r));continue}if(n.timeUnit){o=e.vgField(r);const t={timeUnit:n.timeUnit,as:o,field:n.field};u[V(t)]=t}if(!c[o]){let i="E";if("interval"===t.type){ko(e.getScaleComponent(r).get("type"))&&(i="R")}else n.bin&&(i="R-RE");const s={field:o,channel:r,type:i};s.signals=Object.assign(Object.assign({},d(s,"data")),d(s,"visual")),l.items.push(c[o]=s),l.hasField[o]=l.hasChannel[r]=c[o]}}else dr(i.cannotProjectOnChannelWithoutField(r))}if(n.init){const e=e=>l.items.map(t=>void 0!==e[t.channel]?e[t.channel]:e[t.field]);if("interval"===n.type)t.init=e(n.init);else{const i=x(n.init);t.init=i.map(e)}}ne(u)||(l.timeUnit=new Jc(null,u))},signals:(e,t,n)=>{const i=t.name+"_tuple_fields";return n.filter(e=>e.name===i).length>0?n:n.concat({name:i,value:t.project.items.map(e=>{const{signals:t,hasLegend:n}=e,i=M(e,["signals","hasLegend"]);return i.field=fe(i.field),i})})}},eu,nu,ou,au,cu,Zc,Kc,tu];function du(e,t){for(const n of hu)n.has(e)&&t(n)}function fu(e,t=!0,n=f){if(g(e)){const i=e.map(e=>fu(e,t,n));return t?`[${i.join(", ")}]`:i}return fr(e)?n(t?yr(e):function(e){const t=br(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}(e)):t?n(JSON.stringify(e)):e}function pu(e,t){return Au(e,(n,i)=>{t=i.marks?i.marks(e,n,t):t,du(n,i=>{i.marks&&(t=i.marks(e,n,t))})}),t}function gu(e){return e.map(e=>(e.on&&!e.on.length&&delete e.on,e))}const mu="_brush",vu={signals:(e,t)=>{const n=t.name,i=n+"_tuple_fields",r=nu.has(t),o=[],s=[],a=[];if(t.translate&&!r){const e="!event.item || event.item.mark.name !== "+$(n+mu);bu(t,(t,n)=>{var i;const r=x(null!==(i=n.between[0].filter)&&void 0!==i?i:n.between[0].filter=[]);return r.indexOf(e)<0&&r.push(e),t})}t.project.items.forEach((n,i)=>{const r=n.channel;if(r!==ht&&r!==dt)return void dr("Interval selections only support x and y encoding channels.");const l=t.init?t.init[i]:null,c=function(e,t,n,i){const r=n.channel,o=n.signals.visual,s=n.signals.data,a=nu.has(t),l=$(e.scaleName(r)),c=e.getScaleComponent(r),u=c?c.get("type"):void 0,h=e=>`scale(${l}, ${e})`,d=e.getSizeSignalRef(r===ht?"width":"height").signal,f=r+"(unit)",p=bu(t,(e,t)=>[...e,{events:t.between[0],update:`[${f}, ${f}]`},{events:t,update:`[${o}[0], clamp(${f}, 0, ${d})]`}]);return p.push({events:{signal:t.name+"_scale_trigger"},update:ko(u)?`[${h(s+"[0]")}, ${h(s+"[1]")}]`:"[0, 0]"}),a?[{name:s,on:[]}]:[Object.assign(Object.assign({name:o},i?{init:fu(i,!0,h)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:s},i?{init:fu(i)}:{}),{on:[{events:{signal:o},update:`${o}[0] === ${o}[1] ? null : invert(${l}, ${o})`}]})]}(e,t,n,l),u=n.signals.data,h=n.signals.visual,d=$(e.scaleName(r)),f=ko(e.getScaleComponent(r).get("type"))?"+":"";o.push(...c),s.push(u),a.push({scaleName:e.scaleName(r),expr:`(!isArray(${u}) || (${f}invert(${d}, ${h})[0] === ${f}${u}[0] && ${f}invert(${d}, ${h})[1] === ${f}${u}[1]))`})}),r||o.push({name:n+"_scale_trigger",value:{},on:[{events:a.map(e=>({scale:e.scaleName})),update:a.map(e=>e.expr).join(" && ")+` ? ${n+"_scale_trigger"} : {}`}]});const l=t.init,c=`unit: ${$u(e)}, fields: ${i}, values`;return o.concat(Object.assign(Object.assign({name:n+ku},l?{init:`{${c}: ${fu(l)}}`}:{}),{on:[{events:[{signal:s.join(" || ")}],update:s.join(" && ")+` ? {${c}: [${s}]} : null`}]}))},modifyExpr:(e,t)=>t.name+ku+", "+("global"===t.resolve?"true":`{unit: ${$u(e)}}`),marks:(e,t,n)=>{const i=t.name,{x:r,y:o}=t.project.hasChannel,s=r&&r.signals.visual,a=o&&o.signals.visual,l=`data(${$(t.name+_u)})`;if(nu.has(t))return n;const c={x:void 0!==r?{signal:s+"[0]"}:{value:0},y:void 0!==o?{signal:a+"[0]"}:{value:0},x2:void 0!==r?{signal:s+"[1]"}:{field:{group:"width"}},y2:void 0!==o?{signal:a+"[1]"}:{field:{group:"height"}}};if("global"===t.resolve)for(const t of ie(c))c[t]=[Object.assign({test:`${l}.length && ${l}[0].unit === ${$u(e)}`},c[t]),{value:0}];const u=t.mark,{fill:h,fillOpacity:d,cursor:f}=u,p=M(u,["fill","fillOpacity","cursor"]),g=ie(p).reduce((e,t)=>(e[t]=[{test:[void 0!==r&&`${s}[0] !== ${s}[1]`,void 0!==o&&`${a}[0] !== ${a}[1]`].filter(e=>e).join(" && "),value:p[t]},{value:null}],e),{});return[{name:i+mu+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:h},fillOpacity:{value:d}},update:c}},...n,{name:i+mu,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},f?{cursor:{value:f}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},c),g)}}]}};function bu(e,t){return e.events.reduce((e,n)=>n.between?t(e,n):(dr(n+" is not an ordered event stream for interval selections."),e),[])}function yu(e,t){const n=t.name,i=n+"_tuple_fields",r=t.project,o="(item().isVoronoi ? datum.datum : datum)",s=r.items.map(t=>{const n=e.fieldDef(t.channel);return n&&n.bin?`[${o}[${$(e.vgField(t.channel,{}))}], ${o}[${$(e.vgField(t.channel,{binSuffix:"end"}))}]]`:`${o}[${$(t.field)}]`}).join(", "),a=`unit: ${$u(e)}, fields: ${i}, values`,l=t.events;return[{name:n+ku,on:l?[{events:l,update:`datum && item().mark.marktype !== 'group' ? {${a}: [${s}]} : null`,force:!0}]:[]}]}const wu={signals:yu,modifyExpr:(e,t)=>t.name+ku+", "+("global"===t.resolve?"null":`{unit: ${$u(e)}}`)};const xu={signals:yu,modifyExpr:(e,t)=>t.name+ku+", "+("global"===t.resolve?"true":`{unit: ${$u(e)}}`)};const _u="_store",ku="_tuple",Su="_modify",Ou="vlSelectionResolve",Cu={single:xu,multi:wu,interval:vu};function Au(e,t){const n=e.component.selection;if(n)for(const e of re(n)){if(!0===t(e,Cu[e.type]))break}}function $u(e,{escape:t}={escape:!0}){let n=t?$(e.name):e.name;const i=function(e){let t=e.parent;for(;t&&!lf(t);)t=t.parent;return t}(e);if(i){const{facet:e}=i;for(const t of Mt)e[t]&&(n+=` + '__facet_${t}_' + (facet[${$(i.vgField(t))}])`)}return n}function Eu(e){let t=!1;return Au(e,e=>{t=t||e.project.items.some(e=>"_vgsid_"===e.field)}),t}var Mu=n(3);function ju(e){const t=Object(Mu.f)(e),n=new Set;return t.visit(e=>{"MemberExpression"===e.type&&function e(t){return"MemberExpression"===t.object.type?e(t.object):"datum"===t.object.name}(e)&&n.add(function e(t){const n=[];return"Identifier"===t.type?[t.name]:"Literal"===t.type?[t.value]:("MemberExpression"===t.type&&(n.push(...e(t.object)),n.push(...e(t.property))),n)}(e).slice(1).join("."))}),n}class Ru extends Yc{constructor(e,t,n){super(e),this.model=t,this.filter=n,this.expr=Lu(this.model,this.filter,this),this._dependentFields=ju(this.expr)}clone(){return new Ru(null,this.model,W(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return"Filter "+this.expr}}function Du(e,t,n,i="datum"){const r=[];const o=le(t,(function(t){const o=ae(t),s=e.getSelectionComponent(o,t),a=$(o+_u);if(s.project.timeUnit){const t=null!=n?n:e.component.data.raw,i=s.project.timeUnit.clone();t.parent?i.insertAsParentOf(t):t.parent=i}return"none"!==s.empty&&r.push(a),`vlSelectionTest(${a}, ${i}`+("global"===s.resolve?")":`, ${$(s.resolve)})`)}));return(r.length?"!("+r.map(e=>`length(data(${e}))`).join(" || ")+") || ":"")+`(${o})`}function Tu(e,t){const n=t.encoding;let i=t.field;if(n||i){if(n&&!i){const r=e.project.items.filter(e=>e.channel===n);!r.length||r.length>1?(i=e.project.items[0].field,dr((r.length?"Multiple ":"No ")+`matching ${$(n)} encoding found for selection ${$(t.selection)}. `+`Using "field": ${$(i)}.`)):i=r[0].field}}else i=e.project.items[0].field,e.project.items.length>1&&dr(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${$(i)}.`);return`${e.name}[${$(i)}]`}function Lu(e,t,n){return le(t,t=>A(t)?t:function(e){return null==e?void 0:e.selection}(t)?Du(e,t.selection,n):Hr(t))}function Fu(e,t,n,i){var r,o,s;e.encode=null!==(r=e.encode)&&void 0!==r?r:{},e.encode[t]=null!==(o=e.encode[t])&&void 0!==o?o:{},e.encode[t].update=null!==(s=e.encode[t].update)&&void 0!==s?s:{},e.encode[t].update[n]=i}function Nu(e,t,n,i={header:!1}){var r,o;const s=e.combine(),{disable:a,orient:l,scale:c,labelExpr:u,title:h,zindex:d}=s,f=M(s,["disable","orient","scale","labelExpr","title","zindex"]);if(!a){for(const e in f){const n=Se[e],i=f[e];if(n&&n!==t&&"both"!==n)delete f[e];else if(_e(i)){const{condition:t}=i,n=M(i,["condition"]),r=x(t),o=xe[e];if(o){const{vgProp:t,part:i}=o;Fu(f,i,t,[...r.map(e=>{const{test:t}=e,n=M(e,["test"]);return Object.assign({test:Lu(null,t)},n)}),n]),delete f[e]}else if(null===o){const t={signal:r.map(e=>{const{test:t}=e,n=M(e,["test"]);return`${Lu(null,t)} ? ${na(n)} : `}).join("")+na(n)};f[e]=t}}else if(Er(i)){const t=xe[e];if(t){const{vgProp:n,part:r}=t;Fu(f,r,n,i),delete f[e]}}}if("grid"===t){if(!f.grid)return;if(f.encode){const{grid:e}=f.encode;f.encode=Object.assign({},e?{grid:e}:{}),ne(f.encode)&&delete f.encode}return Object.assign(Object.assign({scale:c,orient:l},f),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:ve(d,0)})}{if(!i.header&&e.mainExtracted)return;if(void 0!==u){let e=u;(null===(o=null===(r=f.encode)||void 0===r?void 0:r.labels)||void 0===o?void 0:o.update)&&Er(f.encode.labels.update.text)&&(e=pe(u,"datum.label",f.encode.labels.update.text.signal)),Fu(f,"labels","text",{signal:e})}if(null===f.labelAlign&&delete f.labelAlign,f.encode){for(const t of ke)e.hasAxisPart(t)||delete f.encode[t];ne(f.encode)&&delete f.encode}const t=function(e,t){if(e)return g(e)&&!ea(e)?e.map(e=>Is(e,t)).join(", "):e}(h,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:c,orient:l,grid:!1},t?{title:t}:{}),f),!1===n.aria?{aria:!1}:{}),{zindex:ve(d,0)})}}}function Pu(e){const{axes:t}=e.component,n=[];for(const i of un)if(t[i])for(const r of t[i])if(!r.get("disable")&&!r.get("gridScale")){const t="x"===i?"height":"width",r=e.getSizeSignalRef(t).signal;t!==r&&n.push({name:t,update:r})}return n}const zu={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},Iu={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},Bu=ie(zu),Wu=ie(Iu);function Uu(e,t,n,i){return Object.assign.apply(null,[{},...e.map(e=>{if("axisOrient"===e){const e="x"===n?"bottom":"left",r=t["x"===n?"axisBottom":"axisLeft"]||{},o=t["x"===n?"axisTop":"axisRight"]||{},s=new Set([...ie(r),...ie(o)]),a={};for(const t of s.values())a[t]={signal:`${i.signal} === "${e}" ? ${ia(r[t])} : ${ia(o[t])}`};return a}return t[e]})])}function Hu(e,t,n,i){const r="band"===t?["axisDiscrete","axisBand"]:"point"===t?["axisDiscrete","axisPoint"]:t in bo?["axisQuantitative"]:"time"===t||"utc"===t?["axisTemporal"]:[];const o="x"===e?"axisX":"axisY",s=Er(n)?"axisOrient":"axis"+ue(n),a=[...r,...r.map(e=>o+e.substr(4))],l=["axis",s,o];return{vlOnlyAxisConfig:Uu(a,i,e,n),vgAxisConfig:Uu(l,i,e,n),axisConfigStyle:qu([...l,...a],i)}}function qu(e,t){var n;const i=[{}];for(const r of e){let e=null===(n=t[r])||void 0===n?void 0:n.style;if(e){e=x(e);for(const n of e)i.push(t.style[n])}}return Object.assign.apply(null,i)}function Vu(e,t,n,i={}){var r;const o=la(e,n,t);if(void 0!==o)return{configFrom:"style",configValue:o};for(const t of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(void 0!==(null===(r=i[t])||void 0===r?void 0:r[e]))return{configFrom:t,configValue:i[t][e]};return{}}const Gu={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:i,formatType:r}=n;return Jo(e,e.type,i,r,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return Qo(i,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var i;return(!ys(e)||!Ln(e.bin))&&(null!==(i=t.grid)&&void 0!==i?i:function(e,t){return!_o(e)&&ys(t)&&!Tn(null==t?void 0:t.bin)}(n,e))},gridScale:({model:e,channel:t})=>function(e,t){const n="x"===t?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n);return}(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelAlign||Xu(t,n,i),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelBaseline||Yu(t,n,i),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var i;return null!==(i=e.labelFlush)&&void 0!==i?i:function(e,t){if("x"===t&&K(["quantitative","temporal"],e))return!0;return}(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var i;return null!==(i=e.labelOverlap)&&void 0!==i?i:function(e,t,n,i){if(n&&!m(i)||"nominal"!==e&&"ordinal"!==e)return"log"!==t||"greedy";return}(t.type,n,ys(t)&&!!t.timeUnit,ys(t)?t.sort:void 0)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:i,scaleType:r})=>{var o;const s="x"===e?"width":"y"===e?"height":void 0,a=s?t.getSizeSignalRef(s):void 0;return null!==(o=n.tickCount)&&void 0!==o?o:function({fieldOrDatumDef:e,scaleType:t,size:n,values:i}){var r;if(!i&&!_o(t)&&"log"!==t){if(ys(e)){if(Tn(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&K(["month","hours","day","quarter"],null===(r=$r(e.timeUnit))||void 0===r?void 0:r.unit))return}return{signal:`ceil(${n.signal}/40)`}}return}({fieldOrDatumDef:i,scaleType:r,size:a,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(void 0!==e.title)return e.title;const i=Ju(t,n);if(void 0!==i)return i;const r=t.typedFieldDef(n),o="x"===n?"x2":"y2",s=t.fieldDef(o);return ua(r?[ds(r)]:[],ys(s)?[ds(s)]:[])},values:({axis:e,fieldOrDatumDef:t})=>function(e,t){const n=e.values;if(g(n))return Js(t,n);if(Er(n))return n;return}(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var i;return null!==(i=e.zindex)&&void 0!==i?i:function(e,t){if("rect"===e&&Ds(t))return 1;return 0}(n,t)}};function Ku(e){return`(((${e.signal} % 360) + 360) % 360)`}function Yu(e,t,n,i){if(void 0!==e){if("x"===n){if(Er(e)){const n=Ku(e);return{signal:`(45 < ${n} && ${n} < 135) || (225 < ${n} && ${n} < 315) ? "middle" :(${n} <= 45 || 315 <= ${n}) === ${Er(t)?`(${t.signal} === "top")`:"top"===t} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(Er(t)){const n=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${n} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==("top"===t)?"bottom":"top"}if(Er(e)){const n=Ku(e);return{signal:`${n} <= 45 || 315 <= ${n} || (135 <= ${n} && ${n} <= 225) ? ${i?'"middle"':"null"} : (45 <= ${n} && ${n} <= 135) === ${Er(t)?`(${t.signal} === "left")`:"left"===t} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return i?"middle":null;if(Er(t)){const n=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${n} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==("left"===t)?"top":"bottom"}}function Xu(e,t,n){if(void 0===e)return;const i="x"===n,r=i?0:90,o=i?"bottom":"left";if(Er(e)){const n=Ku(e);return{signal:`(${r?"("+n+" + 90)":n} % 180 === 0) ? ${i?null:'"center"'} :(${r} < ${n} && ${n} < ${180+r}) === ${Er(t)?`(${t.signal} === "${o}")`:t===o} ? "left" : "right"`}}if((e+r)%180==0)return i?null:"center";if(Er(t)){const n=r<e&&e<180+r?"===":"!==";return{signal:`${t.signal} ${n} "${o}"`+' ? "left" : "right"'}}return(r<e&&e<180+r)==(t===o)?"left":"right"}function Ju(e,t){const n="x"===t?"x2":"y2",i=e.fieldDef(t),r=e.fieldDef(n),o=i?i.title:void 0,s=r?r.title:void 0;return o&&s?ha(o,s):o||(s||(void 0!==o?o:void 0!==s?s:void 0))}class Qu extends Yc{constructor(e,t){super(e),this.transform=t,this._dependentFields=ju(this.transform.calculate)}clone(){return new Qu(null,W(this.transform))}static parseAllForSortIndex(e,t){return t.forEachFieldDef((t,n)=>{if(As(t)&&ls(t.sort)){const{field:i,timeUnit:r}=t,o=t.sort,s=o.map((e,t)=>`${Hr({field:i,timeUnit:r,equal:e})} ? ${t} : `).join("")+o.length;e=new Qu(e,{calculate:s,as:Zu(t,n,{forAs:!0})})}}),e}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return"Calculate "+V(this.transform)}}function Zu(e,t,n){return Rs(e,Object.assign({prefix:t,suffix:"sort_index"},null!=n?n:{}))}function eh(e,t){return K(["top","bottom"],t)?"column":K(["left","right"],t)||"row"===e?"row":"column"}function th(e,t,n,i){const r="row"===i?n.headerRow:"column"===i?n.headerColumn:n.headerFacet;return ve(((null==t?void 0:t.header)||{})[e],r[e],n.header[e])}function nh(e,t,n,i){const r={};for(const o of e){const e=th(o,t,n,i);void 0!==e&&(r[o]=e)}return r}const ih=["row","column"],rh=["header","footer"];function oh(e,t){const n=e.component.layoutHeaders[t].title,i=e.config?e.config:void 0,r=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:o,titleAngle:s,titleOrient:a}=nh(["titleAnchor","titleAngle","titleOrient"],r,i,t),l=eh(t,a),c=ye(s);return{name:t+"-title",type:"group",role:l+"-title",title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},"row"===t?{orient:"left"}:{}),{style:"guide-title"}),ah(c,l)),sh(l,c,o)),ph(i,r,t,Bu,zu))}}function sh(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const i=Xu(t,"row"===e?"left":"top","row"===e?"y":"x");return i?{align:i}:{}}function ah(e,t){const n=Yu(e,"row"===t?"left":"top","row"===t?"y":"x",!0);return n?{baseline:n}:{}}function lh(e,t){const n=e.component.layoutHeaders[t],i=[];for(const r of rh)if(n[r])for(const o of n[r]){const s=hh(e,t,r,n,o);null!=s&&i.push(s)}return i}function ch(e,t){var n;const{sort:i}=e;return as(i)?{field:Rs(i,{expr:"datum"}),order:null!==(n=i.order)&&void 0!==n?n:"ascending"}:g(i)?{field:Zu(e,t,{expr:"datum"}),order:"ascending"}:{field:Rs(e,{expr:"datum"}),order:null!=i?i:"ascending"}}function uh(e,t,n){const{format:i,formatType:r,labelAngle:o,labelAnchor:s,labelOrient:a,labelExpr:l}=nh(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e,n,t),c=Ko({fieldOrDatumDef:e,format:i,formatType:r,expr:"parent",config:n}).signal,u=eh(t,a);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:l?pe(pe(l,"datum.label",c),"datum.value",Rs(e,{expr:"parent"})):c}},"row"===t?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),ah(o,u)),sh(u,o,s)),ph(n,e,t,Wu,Iu))}function hh(e,t,n,i,r){if(r){let o=null;const{facetFieldDef:s}=i,a=e.config?e.config:void 0;if(s&&r.labels){const{labelOrient:e}=nh(["labelOrient"],s,a,t);("row"===t&&!K(["top","bottom"],e)||"column"===t&&!K(["left","right"],e))&&(o=uh(s,t,a))}const l=lf(e)&&!cs(e.facet),c=r.axes,u=(null==c?void 0:c.length)>0;if(o||u){const a="row"===t?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},i.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:ch(s,t)}:{}),u&&l?{from:{data:e.getName("facet_domain_"+t)}}:{}),o?{title:o}:{}),r.sizeSignal?{encode:{update:{[a]:r.sizeSignal}}}:{}),u?{axes:c}:{})}}return null}const dh={column:{start:0,end:1},row:{start:1,end:0}};function fh(e,t){return dh[t][e]}function ph(e,t,n,i,r){const o={};for(const s of i){if(!r[s])continue;const i=th(s,t,e,n);void 0!==i&&(o[r[s]]=i)}return o}function gh(e){return[...mh(e,"width"),...mh(e,"height"),...mh(e,"childWidth"),...mh(e,"childHeight")]}function mh(e,t){const n="width"===t?"x":"y",i=e.component.layoutSize.get(t);if(!i||"merged"===i)return[];const r=e.getSizeSignalRef(t).signal;if("step"===i){const t=e.getScaleComponent(n);if(t){const i=t.get("type"),o=t.get("range");if(_o(i)&&Mr(o)){const i=e.scaleName(n);if(lf(e.parent)){if("independent"===e.parent.component.resolve.scale[n])return[vh(i,o)]}return[vh(i,o),{name:r,update:bh(i,t,`domain('${i}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==i){const t=r.endsWith("width"),n=t?"containerSize()[0]":"containerSize()[1]",i=`isFinite(${n}) ? ${n} : ${el(e.config.view,t?"width":"height")}`;return[{name:r,init:i,on:[{update:i,events:"window:resize"}]}]}return[{name:r,value:i}]}function vh(e,t){return{name:e+"_step",value:t.step}}function bh(e,t,n){const i=t.get("type"),r=t.get("padding"),o=ve(t.get("paddingOuter"),r);let s=t.get("paddingInner");return s="band"===i?void 0!==s?s:r:1,`bandspace(${n}, ${s}, ${o}) * ${e}_step`}function yh(e){return"childWidth"===e?"width":"childHeight"===e?"height":e}function wh(e,t){return ie(e).reduce((n,i)=>{const r=e[i];return Object.assign(Object.assign({},n),xc(t,r,i,e=>Er(e)?e:{value:e.value}))},{})}function xh(e,t){if(uf(t)||lf(t))return"shared";if(cf(t))return hn(e)?"independent":"shared";throw new Error("invalid model type for resolve")}function _h(e,t){const n=e.scale[t],r=hn(t)?"axis":"legend";return"independent"===n?("shared"===e[r][t]&&dr(i.independentScaleMeansIndependentGuide(t)),"independent"):e[r][t]||"shared"}const kh=Object.assign(Object.assign({},Ha),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),Sh=ie(kh);class Oh extends Bl{}const Ch={symbols:function(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r,legendType:o}){var s,a,l,c,u,h,d,f;if("symbol"!==o)return;const{markDef:p,encoding:m,config:v,mark:b}=n,y=p.filled&&"trail"!==b;let w=Object.assign(Object.assign({},function(e,t,n){for(const i of n){const n=sa(i,t.markDef,t.config);void 0!==n&&(e[i]=ta(n))}return e}({},n,Ge)),Ec(n,{filled:y}));const x=null!==(s=r.get("symbolOpacity"))&&void 0!==s?s:v.legend.symbolOpacity,_=null!==(a=r.get("symbolFillColor"))&&void 0!==a?a:v.legend.symbolFillColor,k=null!==(l=r.get("symbolStrokeColor"))&&void 0!==l?l:v.legend.symbolStrokeColor,S=void 0===x?null!==(c=Ah(m.opacity))&&void 0!==c?c:p.opacity:void 0;if(w.fill)if("fill"===i||y&&i===bt)delete w.fill;else if(w.fill.field)_?delete w.fill:(w.fill=ta(null!==(u=v.legend.symbolBaseFillColor)&&void 0!==u?u:"black"),w.fillOpacity=ta(null!=S?S:1));else if(g(w.fill)){const e=null!==(f=null!==(d=$h(null!==(h=m.fill)&&void 0!==h?h:m.color))&&void 0!==d?d:p.fill)&&void 0!==f?f:y&&p.color;e&&(w.fill=ta(e))}if(w.stroke)if("stroke"===i||!y&&i===bt)delete w.stroke;else if(w.stroke.field||k)delete w.stroke;else if(g(w.stroke)){const e=ve($h(m.stroke||m.color),p.stroke,y?p.color:void 0);e&&(w.stroke={value:e})}if("opacity"!==i){const e=ys(t)&&Mh(n,r,t);e?w.opacity=[Object.assign({test:e},ta(null!=S?S:1)),ta(v.legend.unselectedOpacity)]:S&&(w.opacity=ta(S))}return w=Object.assign(Object.assign({},w),e),ne(w)?void 0:w},gradient:function(e,{model:t,legendType:n,legendCmpt:i}){var r;if("gradient"!==n)return;const{config:o,markDef:s,encoding:a}=t;let l={};const c=void 0===(null!==(r=i.get("gradientOpacity"))&&void 0!==r?r:o.legend.gradientOpacity)?Ah(a.opacity)||s.opacity:void 0;c&&(l.opacity=ta(c));return l=Object.assign(Object.assign({},l),e),ne(l)?void 0:l},labels:function(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r}){const o=n.legend(i)||{},s=n.config,a=ys(t)?Mh(n,r,t):void 0,l=a?[{test:a,value:1},{value:s.legend.unselectedOpacity}]:void 0,{format:c,formatType:u}=o,h=Vo(u)?Xo({fieldOrDatumDef:t,field:"datum.value",format:c,formatType:u,config:s}):void 0,d=Object.assign(Object.assign(Object.assign({},l?{opacity:l}:{}),h?{text:h}:{}),e);return ne(d)?void 0:d},entries:function(e,{legendCmpt:t}){const n=t.get("selections");return(null==n?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}};function Ah(e){return Eh(e,(e,t)=>Math.max(e,t.value))}function $h(e){return Eh(e,(e,t)=>ve(e,t.value))}function Eh(e,t){return function(e){const t=e&&e.condition;return!!t&&(g(t)||Cs(t))}(e)?x(e.condition).reduce(t,e.value):Cs(e)?e.value:void 0}function Mh(e,t,n){const i=t.get("selections");if(!(null==i?void 0:i.length))return;const r=$(n.field);return i.map(e=>`(!length(data(${$(ae(e)+_u)})) || (${e}[${r}] && indexof(${e}[${r}], datum.value) >= 0))`).join(" || ")}const jh={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:i,formatType:r}=t;return Jo(e,e.type,i,r,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return Qo(i,t,n)},gradientLength:e=>{var t,n;const{legend:i,legendConfig:r}=e;return null!==(n=null!==(t=i.gradientLength)&&void 0!==t?t:r.gradientLength)&&void 0!==n?n:function({legendConfig:e,model:t,direction:n,orient:i,scaleType:r}){const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:s,gradientVerticalMaxLength:a,gradientVerticalMinLength:l}=e;if(So(r))return"horizontal"===n?"top"===i||"bottom"===i?Th(t,"width",s,o):s:Th(t,"height",l,a);return}(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var i,r;return null!==(r=null!==(i=e.labelOverlap)&&void 0!==i?i:t.labelOverlap)&&void 0!==r?r:function(e){if(K(["quantile","threshold","log"],e))return"greedy";return}(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:i})=>{var r;return null!==(r=e.symbolType)&&void 0!==r?r:function(e,t,n,i){var r;if("shape"!==t){const e=null!==(r=$h(n))&&void 0!==r?r:i;if(e)return e}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(t.type,n,i.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>Ps(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if($t(n)&&So(t)){if("gradient"===e)return}else if("symbol"===e)return;return e},values:({fieldOrDatumDef:e,legend:t})=>function(e,t){const n=e.values;if(g(n))return Js(t,n);if(Er(n))return n;return}(t,e)};function Rh(e){const{legend:t}=e;return ve(t.type,function({channel:e,timeUnit:t,scaleType:n}){if($t(e)){if(K(["quarter","month","day"],t))return"symbol";if(So(n))return"gradient"}return"symbol"}(e))}function Dh({legendConfig:e,legendType:t,orient:n,legend:i}){var r,o;return null!==(o=null!==(r=i.direction)&&void 0!==r?r:e[t?"gradientDirection":"symbolDirection"])&&void 0!==o?o:function(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===t?"horizontal":void 0}}(n,t)}function Th(e,t,n,i){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${i})`}}function Lh(e){const t=af(e)?function(e){const{encoding:t}=e,n={};for(const i of[bt,...Wa]){const r=Us(t[i]);r&&e.getScaleComponent(i)&&(i===xt&&ys(r)&&r.type===Qr||(n[i]=Nh(e,i)))}return n}(e):function(e){const{legends:t,resolve:n}=e.component;for(const i of e.children){Lh(i);for(const r of ie(i.component.legends))n.legend[r]=_h(e.component.resolve,r),"shared"===n.legend[r]&&(t[r]=Ph(t[r],i.component.legends[r]),t[r]||(n.legend[r]="independent",delete t[r]))}for(const i of ie(t))for(const t of e.children)t.component.legends[i]&&"shared"===n.legend[i]&&delete t.component.legends[i];return t}(e);return e.component.legends=t,t}function Fh(e,t,n,i){switch(t){case"disable":return void 0!==n;case"values":return!!(null==n?void 0:n.values);case"title":if("title"===t&&e===(null==i?void 0:i.title))return!0}return e===(n||{})[t]}function Nh(e,t){var n,i,r;let o=e.legend(t);const{markDef:s,encoding:a,config:l}=e,c=l.legend,u=new Oh({},function(e,t){const n=e.scaleName(t);if("trail"===e.mark){if("color"===t)return{stroke:n};if("size"===t)return{strokeWidth:n}}return"color"===t?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}(e,t));!function(e,t,n){var i;const r=null===(i=e.fieldDef(t))||void 0===i?void 0:i.field;Au(e,e=>{var i,o;const s=null!==(i=e.project.hasField[r])&&void 0!==i?i:e.project.hasChannel[t];if(s&&ou.has(e)){const t=null!==(o=n.get("selections"))&&void 0!==o?o:[];t.push(e.name),n.set("selections",t,!1),s.hasLegend=!0}})}(e,t,u);const h=void 0!==o?!o:c.disable;if(u.set("disable",h,void 0!==o),h)return u;o=o||{};const d=e.getScaleComponent(t).get("type"),f=Us(a[t]),p=ys(f)?null===(n=$r(f.timeUnit))||void 0===n?void 0:n.unit:void 0,g=o.orient||l.legend.orient||"right",m=Rh({legend:o,channel:t,timeUnit:p,scaleType:d}),v={legend:o,channel:t,model:e,markDef:s,encoding:a,fieldOrDatumDef:f,legendConfig:c,config:l,scaleType:d,orient:g,legendType:m,direction:Dh({legend:o,legendType:m,orient:g,legendConfig:c})};for(const n of Sh){if("gradient"===m&&n.startsWith("symbol")||"symbol"===m&&n.startsWith("gradient"))continue;const i=n in jh?jh[n](v):o[n];if(void 0!==i){const r=Fh(i,n,o,e.fieldDef(t));(r||void 0===l.legend[n])&&u.set(n,i,r)}}const b=null!==(i=null==o?void 0:o.encoding)&&void 0!==i?i:{},y=u.get("selections"),w={},x={fieldOrDatumDef:f,model:e,channel:t,legendCmpt:u,legendType:m};for(const t of["labels","legend","title","symbols","gradient","entries"]){const n=wh(null!==(r=b[t])&&void 0!==r?r:{},e),i=t in Ch?Ch[t](n,x):n;void 0===i||ne(i)||(w[t]=Object.assign(Object.assign(Object.assign({},(null==y?void 0:y.length)&&ys(f)?{name:`${ae(f.field)}_legend_${t}`}:{}),(null==y?void 0:y.length)?{interactive:!!y}:{}),{update:i}))}return ne(w)||u.set("encode",w,!!(null==o?void 0:o.encoding)),u}function Ph(e,t){var n,i,r,o;if(!e)return t.clone();const s=e.getWithExplicit("orient"),a=t.getWithExplicit("orient");if(s.explicit&&a.explicit&&s.value!==a.value)return;let l=!1;for(const n of Sh){const i=Vl(e.getWithExplicit(n),t.getWithExplicit(n),n,"legend",(e,t)=>{switch(n){case"symbolType":return zh(e,t);case"title":return da(e,t);case"type":return l=!0,Ul("symbol")}return ql(e,t,n,"legend")});e.setWithExplicit(n,i)}return l&&((null===(i=null===(n=e.implicit)||void 0===n?void 0:n.encode)||void 0===i?void 0:i.gradient)&&ce(e.implicit,["encode","gradient"]),(null===(o=null===(r=e.explicit)||void 0===r?void 0:r.encode)||void 0===o?void 0:o.gradient)&&ce(e.explicit,["encode","gradient"])),e}function zh(e,t){return"circle"===t.value?t:e}function Ih(e,t,n,i){var r,o,s;e.encode=null!==(r=e.encode)&&void 0!==r?r:{},e.encode[t]=null!==(o=e.encode[t])&&void 0!==o?o:{},e.encode[t].update=null!==(s=e.encode[t].update)&&void 0!==s?s:{},e.encode[t].update[n]=i}function Bh(e){const t=e.component.legends,n={};for(const i of ie(t)){const r=e.getScaleComponent(i),o=q(r.get("domains"));if(n[o])for(const e of n[o]){Ph(e,t[i])||n[o].push(t[i])}else n[o]=[t[i].clone()]}return re(n).flat().map(t=>function(e,t){var n,i,r;const o=e.combine(),{disable:s,labelExpr:a,selections:l}=o,c=M(o,["disable","labelExpr","selections"]);if(s)return;!1===t.aria&&null==c.aria&&(c.aria=!1);if(null===(n=c.encode)||void 0===n?void 0:n.symbols){const e=c.encode.symbols.update;!e.fill||"transparent"===e.fill.value||e.stroke||c.stroke||(e.stroke={value:"transparent"});for(const t of Wa)c[t]&&delete e[t]}c.title||delete c.title;if(void 0!==a){let e=a;(null===(r=null===(i=c.encode)||void 0===i?void 0:i.labels)||void 0===r?void 0:r.update)&&Er(c.encode.labels.update.text)&&(e=pe(a,"datum.label",c.encode.labels.update.text.signal)),Ih(c,"labels","text",{signal:e})}for(const e in c){const t=c[e];if(Er(t)){const n=Ua[e];if(n){const{vgProp:i,part:r}=n;Ih(c,r,i,t),delete c[e]}}}return c}(t,e.config)).filter(e=>void 0!==e)}function Wh(e){return uf(e)||cf(e)?function(e){return e.children.reduce((e,t)=>e.concat(t.assembleProjections()),Uh(e))}(e):Uh(e)}function Uh(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:i}=n;if(t.data){const r={signal:`[${t.size.map(e=>e.signal).join(", ")}]`},o=t.data.reduce((t,n)=>{const i=Er(n)?n.signal:`data('${e.lookupDataSource(n)}')`;return K(t,i)||t.push(i),t},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:i,size:r,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]}},n)]}return[Object.assign(Object.assign({name:i},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const Hh=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class qh extends Bl{constructor(e,t,n,i){super(Object.assign({},t),{name:e}),this.specifiedProjection=t,this.size=n,this.data=i,this.merged=!1}get isFit(){return!!this.data}}function Vh(e){e.component.projection=af(e)?function(e){var t;if(e.hasProjection){const n=e.specifiedProjection,i=!(n&&(null!=n.scale||null!=n.translate)),r=i?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,o=i?function(e){const t=[],{encoding:n}=e;for(const i of[["longitude","latitude"],["longitude2","latitude2"]])(Us(n[i[0]])||Us(n[i[1]]))&&t.push({signal:e.getName("geojson_"+t.length)});e.channelHasField(xt)&&e.typedFieldDef(xt).type===Qr&&t.push({signal:e.getName("geojson_"+t.length)});0===t.length&&t.push(e.requestDataName(tc.Main));return t}(e):void 0;return new qh(e.projectionName(!0),Object.assign(Object.assign({},null!==(t=e.config.projection)&&void 0!==t?t:{}),null!=n?n:{}),r,o)}return}(e):function(e){if(0===e.children.length)return;let t;for(const t of e.children)Vh(t);const n=X(e.children,e=>{const n=e.component.projection;if(n){if(t){const e=function(e,t){const n=X(Hh,n=>!S(e.explicit,n)&&!S(t.explicit,n)||!(!S(e.explicit,n)||!S(t.explicit,n)||q(e.get(n))!==q(t.get(n))));if(q(e.size)===q(t.size)){if(n)return e;if(q(e.explicit)===q({}))return t;if(q(t.explicit)===q({}))return e}return null}(t,n);return e&&(t=e),!!e}return t=n,!0}return!0});if(t&&n){const n=e.projectionName(!0),i=new qh(n,t.specifiedProjection,t.size,W(t.data));for(const t of e.children){const e=t.component.projection;e&&(e.isFit&&i.data.push(...t.component.projection.data),t.renameProjection(e.get("name"),n),e.merged=!0)}return i}return}(e)}function Gh(e,t){return`${Dn(e)}_${t}`}function Kh(e,t,n){var i;const r=Gh(null!==(i=Gs(n,void 0))&&void 0!==i?i:{},t);return e.getName(r+"_bins")}function Yh(e,t,n){let i,r;i=function(e){return"as"in e}(e)?A(e.as)?[e.as,e.as+"_end"]:[e.as[0],e.as[1]]:[Rs(e,{forAs:!0}),Rs(e,{binSuffix:"end",forAs:!0})];const o=Object.assign({},Gs(t,void 0)),s=Gh(o,e.field),{signal:a,extentSignal:l}=function(e,t){return{signal:e.getName(t+"_bins"),extentSignal:e.getName(t+"_extent")}}(n,s);if(Nn(o.extent)){const e=o.extent,t=e.selection;r=Tu(n.getSelectionComponent(ae(t),t),e),delete o.extent}return{key:s,binComponent:Object.assign(Object.assign(Object.assign({bin:o,field:e.field,as:[i]},a?{signal:a}:{}),l?{extentSignal:l}:{}),r?{span:r}:{})}}class Xh extends Yc{constructor(e,t){super(e),this.bins=t}clone(){return new Xh(null,W(this.bins))}static makeFromEncoding(e,t){const n=t.reduceFieldDef((e,n,i)=>{if(Os(n)&&Tn(n.bin)){const{key:r,binComponent:o}=Yh(n,n.bin,t);e[r]=Object.assign(Object.assign(Object.assign({},o),e[r]),function(e,t,n,i){var r,o;if(Qs(t,n)){const s=af(e)&&null!==(o=null!==(r=e.axis(n))&&void 0!==r?r:e.legend(n))&&void 0!==o?o:{},a=Rs(t,{expr:"datum"}),l=Rs(t,{expr:"datum",binSuffix:"end"});return{formulaAs:Rs(t,{binSuffix:"range",forAs:!0}),formula:ns(a,l,s.format,s.formatType,i)}}return{}}(t,n,i,t.config))}return e},{});return ne(n)?null:new Xh(e,n)}static makeFromTransform(e,t,n){const{key:i,binComponent:r}=Yh(t,t.bin,n);return new Xh(e,{[i]:r})}merge(e,t){for(const n of ie(e.bins))n in this.bins?(t(e.bins[n].signal,this.bins[n].signal),this.bins[n].as=Q([...this.bins[n].as,...e.bins[n].as],V)):this.bins[n]=e.bins[n];for(const t of e.children)e.removeChild(t),t.parent=this;e.remove()}producedFields(){return new Set(re(this.bins).map(e=>e.as).flat(2))}dependentFields(){return new Set(re(this.bins).map(e=>e.field))}hash(){return"Bin "+V(this.bins)}assemble(){return re(this.bins).flatMap(e=>{const t=[],[n,...i]=e.as,r=e.bin,{extent:o}=r,s=M(r,["extent"]),a=Object.assign(Object.assign(Object.assign({type:"bin",field:fe(e.field),as:n,signal:e.signal},Nn(o)?{extent:null}:{extent:o}),e.span?{span:{signal:`span(${e.span})`}}:{}),s);!o&&e.extentSignal&&(t.push({type:"extent",field:fe(e.field),signal:e.extentSignal}),a.extent={signal:e.extentSignal}),t.push(a);for(const e of i)for(let i=0;i<2;i++)t.push({type:"formula",expr:Rs({field:n[i]},{expr:"datum"}),as:e[i]});return e.formula&&t.push({type:"formula",expr:e.formula,as:e.formulaAs}),t})}}class Jh extends Yc{constructor(e){let t;if(super(null),Jl(e=null!=e?e:{name:"source"})||(t=e.format?Object.assign({},H(e.format,["parse"])):{}),Yl(e))this._data={values:e.values};else if(Kl(e)){if(this._data={url:e.url},!t.type){let n=/(?:\.([^.]+))?$/.exec(e.url)[1];K(["json","csv","tsv","dsv","topojson"],n)||(n="json"),t.type=n}}else Zl(e)?this._data={values:[{type:"Sphere"}]}:(Xl(e)||Jl(e))&&(this._data={});this._generator=Jl(e),e.name&&(this._name=e.name),t&&!ne(t)&&(this._data.format=t)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(e){this._name=e}set parent(e){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}class Qh extends Yc{constructor(e,t){super(e),this.params=t}clone(){return new Qh(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return"Graticule "+V(this.params)}assemble(){return Object.assign({type:"graticule"},!0===this.params?{}:this.params)}}class Zh extends Yc{constructor(e,t){super(e),this.params=t}clone(){return new Zh(null,this.params)}dependentFields(){return new Set}producedFields(){var e;return new Set([null!==(e=this.params.as)&&void 0!==e?e:"data"])}hash(){return"Hash "+V(this.params)}assemble(){return Object.assign({type:"sequence"},this.params)}}function ed(e){return e instanceof Jh||e instanceof Qh||e instanceof Zh}class td{constructor(){this._mutated=!1}setMutated(){this._mutated=!0}get mutatedFlag(){return this._mutated}}class nd extends td{constructor(){super(),this._continue=!1}setContinue(){this._continue=!0}get continueFlag(){return this._continue}get flags(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}}set flags({continueFlag:e,mutatedFlag:t}){e&&this.setContinue(),t&&this.setMutated()}reset(){}optimizeNextFromLeaves(e){if(ed(e))return!1;const t=e.parent,{continueFlag:n}=this.run(e);return n&&this.optimizeNextFromLeaves(t),this.mutatedFlag}}class id extends td{}function rd(e,t,n,i){const r=af(i)?i.encoding[Vt(t)]:void 0;if(Os(n)&&af(i)&&gs(t,n,r,i.stack,i.markDef,i.config))e.add(Rs(n,{})),e.add(Rs(n,{suffix:"end"})),n.bin&&Qs(n,t)&&e.add(Rs(n,{binSuffix:"range"}));else if(t in Ot){const n=function(e){switch(e){case"latitude":return"y";case"latitude2":return"y2";case"longitude":return"x";case"longitude2":return"x2"}}(t);e.add(i.getName(n))}else e.add(Rs(n));return e}class od extends Yc{constructor(e,t,n){super(e),this.dimensions=t,this.measures=n}clone(){return new od(null,new Set(this.dimensions),W(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(e,t){let n=!1;t.forEachFieldDef(e=>{e.aggregate&&(n=!0)});const i={},r=new Set;return n?(t.forEachFieldDef((e,n)=>{var o,s,a,l;const{aggregate:c,field:u}=e;if(c)if("count"===c)i["*"]=null!==(o=i["*"])&&void 0!==o?o:{},i["*"].count=new Set([Rs(e,{forAs:!0})]);else{if(nt(c)||it(c)){const e=nt(c)?"argmin":"argmax",t=c[e];i[t]=null!==(s=i[t])&&void 0!==s?s:{},i[t][e]=new Set([Rs({op:e,field:t},{forAs:!0})])}else i[u]=null!==(a=i[u])&&void 0!==a?a:{},i[u][c]=new Set([Rs(e,{forAs:!0})]);An(n)&&"unaggregated"===t.scaleDomain(n)&&(i[u]=null!==(l=i[u])&&void 0!==l?l:{},i[u].min=new Set([Rs({field:u,aggregate:"min"},{forAs:!0})]),i[u].max=new Set([Rs({field:u,aggregate:"max"},{forAs:!0})]))}else rd(r,n,e,t)}),r.size+ie(i).length===0?null:new od(e,r,i)):null}static makeFromTransform(e,t){var n,i,r;const o=new Set,s={};for(const e of t.aggregate){const{op:t,field:r,as:o}=e;t&&("count"===t?(s["*"]=null!==(n=s["*"])&&void 0!==n?n:{},s["*"].count=new Set([o||Rs(e,{forAs:!0})])):(s[r]=null!==(i=s[r])&&void 0!==i?i:{},s[r][t]=new Set([o||Rs(e,{forAs:!0})])))}for(const e of null!==(r=t.groupby)&&void 0!==r?r:[])o.add(e);return o.size+ie(s).length===0?null:new od(e,o,s)}merge(e){return function(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}(this.dimensions,e.dimensions)?(function(e,t){var n;for(const i of ie(t)){const r=t[i];for(const t of ie(r))i in e?e[i][t]=new Set([...null!==(n=e[i][t])&&void 0!==n?n:[],...r[t]]):e[i]={[t]:r[t]}}}(this.measures,e.measures),!0):(function(...e){ur.debug(...e)}("different dimensions, cannot merge"),!1)}addDimensions(e){e.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...ie(this.measures)])}producedFields(){const e=new Set;for(const t of ie(this.measures))for(const n of ie(this.measures[t])){const i=this.measures[t][n];0===i.size?e.add(`${n}_${t}`):i.forEach(e.add,e)}return e}hash(){return"Aggregate "+V({dimensions:this.dimensions,measures:this.measures})}assemble(){const e=[],t=[],n=[];for(const i of ie(this.measures))for(const r of ie(this.measures[i]))for(const o of this.measures[i][r])n.push(o),e.push(r),t.push("*"===i?null:fe(i));return{type:"aggregate",groupby:[...this.dimensions].map(fe),ops:e,fields:t,as:n}}}class sd extends Yc{constructor(e,t,n,i){super(e),this.model=t,this.name=n,this.data=i;for(const e of Mt){const n=t.facet[e];if(n){const{bin:i,sort:r}=n;this[e]=Object.assign({name:t.getName(e+"_domain"),fields:[Rs(n),...Tn(i)?[Rs(n,{binSuffix:"end"})]:[]]},as(r)?{sortField:r}:g(r)?{sortIndexField:Zu(n,e)}:{})}}this.childModel=t.child}hash(){let e="Facet";for(const t of Mt)this[t]&&(e+=` ${t.charAt(0)}:${V(this[t])}`);return e}get fields(){var e;const t=[];for(const n of Mt)(null===(e=this[n])||void 0===e?void 0:e.fields)&&t.push(...this[n].fields);return t}dependentFields(){const e=new Set(this.fields);for(const t of Mt)this[t]&&(this[t].sortField&&e.add(this[t].sortField.field),this[t].sortIndexField&&e.add(this[t].sortIndexField));return e}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const e={};for(const t of un){const n=this.childModel.component.scales[t];if(n&&!n.merged){const r=n.get("type"),o=n.get("range");if(_o(r)&&Mr(o)){const n=Wd(Ud(this.childModel,t));n?e[t]=n:dr(i.unknownField(t))}}}return e}assembleRowColumnHeaderData(e,t,n){const i={row:"y",column:"x"}[e],r=[],o=[],s=[];n&&n[i]&&(t?(r.push("distinct_"+n[i]),o.push("max")):(r.push(n[i]),o.push("distinct")),s.push("distinct_"+n[i]));const{sortField:a,sortIndexField:l}=this[e];if(a){const{op:e=is,field:t}=a;r.push(t),o.push(e),s.push(Rs(a,{forAs:!0}))}else l&&(r.push(l),o.push("max"),s.push(l));return{name:this[e].name,source:null!=t?t:this.data,transform:[Object.assign({type:"aggregate",groupby:this[e].fields},r.length?{fields:r,ops:o,as:s}:{})]}}assembleFacetHeaderData(e){var t,n;const{columns:i}=this.model.layout,{layoutHeaders:r}=this.model.component,o=[],s={};for(const e of ih){for(const i of rh){const o=null!==(t=r[e]&&r[e][i])&&void 0!==t?t:[];for(const t of o)if((null===(n=t.axes)||void 0===n?void 0:n.length)>0){s[e]=!0;break}}if(s[e]){const t=`length(data("${this.facet.name}"))`,n="row"===e?i?{signal:`ceil(${t} / ${i})`}:1:i?{signal:`min(${t}, ${i})`}:{signal:t};o.push({name:`${this.facet.name}_${e}`,transform:[{type:"sequence",start:0,stop:n}]})}}const{row:a,column:l}=s;return(a||l)&&o.unshift(this.assembleRowColumnHeaderData("facet",null,e)),o}assemble(){var e,t;const n=[];let i=null;const r=this.getChildIndependentFieldsWithStep(),{column:o,row:s,facet:a}=this;if(o&&s&&(r.x||r.y)){i=`cross_${this.column.name}_${this.row.name}`;const o=[].concat(null!==(e=r.x)&&void 0!==e?e:[],null!==(t=r.y)&&void 0!==t?t:[]),s=o.map(()=>"distinct");n.push({name:i,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:o,ops:s}]})}for(const e of[ut,ct])this[e]&&n.push(this.assembleRowColumnHeaderData(e,i,r));if(a){const e=this.assembleFacetHeaderData(r);e&&n.push(...e)}return n}}function ad(e){return"'"===e[0]&&"'"===e[e.length-1]||'"'===e[0]&&'"'===e[e.length-1]?e.slice(1,-1):e}function ld(e){const t={};return function e(t,n){if(z(t))e(t.not,n);else if(P(t))for(const i of t.and)e(i,n);else if(N(t))for(const i of t.or)e(i,n);else n(t)}(e.filter,e=>{var n;if(Wr(e)){let i=null;Lr(e)?i=e.equal:Ir(e)?i=e.range[0]:Br(e)&&(i=(null!==(n=e.oneOf)&&void 0!==n?n:e.in)[0]),i&&(fr(i)?t[e.field]="date":C(i)?t[e.field]="number":A(i)&&(t[e.field]="string")),e.timeUnit&&(t[e.field]="date")}}),t}function cd(e){const t={};function n(e){var n;Ys(e)?t[e.field]="date":"quantitative"===e.type&&(n=e.aggregate,A(n)&&K(["min","max"],n))?t[e.field]="number":me(e.field)>1?e.field in t||(t[e.field]="flatten"):As(e)&&as(e.sort)&&me(e.sort.field)>1&&(e.sort.field in t||(t[e.sort.field]="flatten"))}if((af(e)||lf(e))&&e.forEachFieldDef((t,i)=>{if(Os(t))n(t);else{const r=Ht(i),o=e.fieldDef(r);n(Object.assign(Object.assign({},t),{type:o.type}))}}),af(e)){const{mark:n,markDef:i,encoding:r}=e;if(Ue(n)&&!e.encoding.order){const e=r["horizontal"===i.orient?"y":"x"];ys(e)&&"quantitative"===e.type&&!(e.field in t)&&(t[e.field]="number")}}return t}class ud extends Yc{constructor(e,t){super(e),this._parse=t}clone(){return new ud(null,W(this._parse))}hash(){return"Parse "+V(this._parse)}static makeExplicit(e,t,n){let i={};const r=t.data;return!Jl(r)&&r&&r.format&&r.format.parse&&(i=r.format.parse),this.makeWithAncestors(e,i,{},n)}static makeWithAncestors(e,t,n,r){for(const e of ie(n)){const t=r.getWithExplicit(e);void 0!==t.value&&(t.explicit||t.value===n[e]||"derived"===t.value||"flatten"===n[e]?delete n[e]:dr(i.differentParse(e,n[e],t.value)))}for(const e of ie(t)){const n=r.get(e);void 0!==n&&(n===t[e]?delete t[e]:dr(i.differentParse(e,t[e],n)))}const o=new Bl(t,n);r.copyAll(o);const s={};for(const e of ie(o.combine())){const t=o.get(e);null!==t&&(s[e]=t)}return 0===ie(s).length||r.parseNothing?null:new ud(e,s)}get parse(){return this._parse}merge(e){this._parse=Object.assign(Object.assign({},this._parse),e.parse),e.remove()}assembleFormatParse(){const e={};for(const t of ie(this._parse)){const n=this._parse[t];1===me(t)&&(e[t]=n)}return e}producedFields(){return new Set(ie(this._parse))}dependentFields(){return new Set(ie(this._parse))}assembleTransforms(e=!1){return ie(this._parse).filter(t=>!e||me(t)>1).map(e=>{const t=function(e,t){const n=he(e);if("number"===t)return`toNumber(${n})`;if("boolean"===t)return`toBoolean(${n})`;if("string"===t)return`toString(${n})`;if("date"===t)return`toDate(${n})`;if("flatten"===t)return n;if(0===t.indexOf("date:")){return`timeParse(${n},'${ad(t.slice(5,t.length))}')`}if(0===t.indexOf("utc:")){return`utcParse(${n},'${ad(t.slice(4,t.length))}')`}return dr(i.unrecognizedParse(t)),null}(e,this._parse[e]);if(!t)return null;return{type:"formula",expr:t,as:ge(e)}}).filter(e=>null!==e)}}class hd extends Yc{clone(){return new hd(null)}constructor(e){super(e)}dependentFields(){return new Set}producedFields(){return new Set(["_vgsid_"])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:"_vgsid_"}}}class dd extends Yc{constructor(e,t){super(e),this.transform=t}clone(){return new dd(null,W(this.transform))}addDimensions(e){this.transform.groupby=Q(this.transform.groupby.concat(e),e=>e)}dependentFields(){const e=new Set;return this.transform.groupby&&this.transform.groupby.forEach(e.add,e),this.transform.joinaggregate.map(e=>e.field).filter(e=>void 0!==e).forEach(e.add,e),e}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(e){var t;return null!==(t=e.as)&&void 0!==t?t:Rs(e)}hash(){return"JoinAggregateTransform "+V(this.transform)}assemble(){const e=[],t=[],n=[];for(const i of this.transform.joinaggregate)t.push(i.op),n.push(this.getDefaultName(i)),e.push(void 0===i.field?null:i.field);const i=this.transform.groupby;return Object.assign({type:"joinaggregate",as:n,ops:t,fields:e},void 0!==i?{groupby:i}:{})}}class fd extends Yc{constructor(e,t){super(e),this._stack=t}clone(){return new fd(null,W(this._stack))}static makeFromTransform(e,t){const{stack:n,groupby:i,as:r,offset:o="zero"}=t,s=[],a=[];if(void 0!==t.sort)for(const e of t.sort)s.push(e.field),a.push(ve(e.order,"ascending"));const l={field:s,order:a};let c;return c=function(e){return g(e)&&e.every(e=>A(e))&&e.length>1}(r)?r:A(r)?[r,r+"_end"]:[t.stack+"_start",t.stack+"_end"],new fd(e,{stackField:n,groupby:i,offset:o,sort:l,facetby:[],as:c})}static makeFromEncoding(e,t){const n=t.stack,{encoding:i}=t;if(!n)return null;const{groupbyChannel:r,fieldChannel:o,offset:s,impute:a}=n;let l;if(r){l=Ws(i[r])}const c=function(e){return e.stack.stackBy.reduce((e,t)=>{const n=Rs(t.fieldDef);return n&&e.push(n),e},[])}(t),u=t.encoding.order;let h;return h=g(u)||ys(u)?ca(u):c.reduce((e,t)=>(e.field.push(t),e.order.push("y"===o?"descending":"ascending"),e),{field:[],order:[]}),new fd(e,{dimensionFieldDef:l,stackField:t.vgField(o),facetby:[],stackby:c,sort:h,offset:s,impute:a,as:[t.vgField(o,{suffix:"start",forAs:!0}),t.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(e){this._stack.facetby.push(...e)}dependentFields(){const e=new Set;return e.add(this._stack.stackField),this.getGroupbyFields().forEach(e.add,e),this._stack.facetby.forEach(e.add,e),this._stack.sort.field.forEach(e.add,e),e}producedFields(){return new Set(this._stack.as)}hash(){return"Stack "+V(this._stack)}getGroupbyFields(){const{dimensionFieldDef:e,impute:t,groupby:n}=this._stack;return e?e.bin?t?[Rs(e,{binSuffix:"mid"})]:[Rs(e,{}),Rs(e,{binSuffix:"end"})]:[Rs(e)]:null!=n?n:[]}assemble(){const e=[],{facetby:t,dimensionFieldDef:n,stackField:i,stackby:r,sort:o,offset:s,impute:a,as:l}=this._stack;if(a&&n){const{band:o=.5,bin:s}=n;s&&e.push({type:"formula",expr:o+"*"+Rs(n,{expr:"datum"})+`+${1-o}*`+Rs(n,{expr:"datum",binSuffix:"end"}),as:Rs(n,{binSuffix:"mid",forAs:!0})}),e.push({type:"impute",field:i,groupby:[...r,...t],key:Rs(n,{binSuffix:"mid"}),method:"value",value:0})}return e.push({type:"stack",groupby:[...this.getGroupbyFields(),...t],field:i,sort:o,as:l,offset:s}),e}}class pd extends Yc{constructor(e,t){super(e),this.transform=t}clone(){return new pd(null,W(this.transform))}addDimensions(e){this.transform.groupby=Q(this.transform.groupby.concat(e),e=>e)}dependentFields(){var e,t;const n=new Set;return(null!==(e=this.transform.groupby)&&void 0!==e?e:[]).forEach(n.add,n),(null!==(t=this.transform.sort)&&void 0!==t?t:[]).forEach(e=>n.add(e.field)),this.transform.window.map(e=>e.field).filter(e=>void 0!==e).forEach(n.add,n),n}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(e){var t;return null!==(t=e.as)&&void 0!==t?t:Rs(e)}hash(){return"WindowTransform "+V(this.transform)}assemble(){var e;const t=[],n=[],i=[],r=[];for(const e of this.transform.window)n.push(e.op),i.push(this.getDefaultName(e)),r.push(void 0===e.param?null:e.param),t.push(void 0===e.field?null:e.field);const o=this.transform.frame,s=this.transform.groupby;if(o&&null===o[0]&&null===o[1]&&n.every(e=>rt(e)))return Object.assign({type:"joinaggregate",as:i,ops:n,fields:t},void 0!==s?{groupby:s}:{});const a=[],l=[];if(void 0!==this.transform.sort)for(const t of this.transform.sort)a.push(t.field),l.push(null!==(e=t.order)&&void 0!==e?e:"ascending");const c={field:a,order:l},u=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:r,as:i,ops:n,fields:t,sort:c},void 0!==u?{ignorePeers:u}:{}),void 0!==s?{groupby:s}:{}),void 0!==o?{frame:o}:{})}}class gd extends nd{run(e){const t=e.parent;if(e instanceof ud){if(ed(t))return this.flags;if(t.numChildren()>1)return this.setContinue(),this.flags;if(t instanceof ud)this.setMutated(),t.merge(e);else{if(te(t.producedFields(),e.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),e.swapWithParent()}}return this.setContinue(),this.flags}}class md extends id{mergeNodes(e,t){const n=t.shift();for(const i of t)e.removeChild(i),i.parent=n,i.remove()}run(e){const t=e.children.map(e=>e.hash()),n={};for(let i=0;i<t.length;i++)void 0===n[t[i]]?n[t[i]]=[e.children[i]]:n[t[i]].push(e.children[i]);for(const t of ie(n))n[t].length>1&&(this.setMutated(),this.mergeNodes(e,n[t]));for(const t of e.children)this.run(t);return this.mutatedFlag}}class vd extends nd{run(e){return e instanceof Xc||e.numChildren()>0||e instanceof sd||(this.setMutated(),e.remove()),this.flags}}class bd extends nd{constructor(){super(...arguments),this.fields=new Set,this.prev=null}run(e){if(this.setContinue(),e instanceof Jc){const t=e.producedFields();Z(t,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([...this.fields,...t]),this.prev=e}return this.flags}reset(){this.fields.clear()}}class yd extends nd{run(e){this.setContinue();const t=e.parent.children.filter(e=>e instanceof Jc),n=t.pop();for(const e of t)this.setMutated(),n.merge(e);return this.flags}}function wd(e){if(e instanceof sd)if(1!==e.numChildren()||e.children[0]instanceof Xc){const n=e.model.component.data.main;!function e(t){if(t instanceof Xc&&t.type===tc.Main&&1===t.numChildren()){const n=t.children[0];n instanceof sd||(n.swapWithParent(),e(t))}}(n);const i=(t=e,function e(n){if(!(n instanceof sd)){const i=n.clone();if(i instanceof Xc){const e=Ad+i.getSource();i.setSource(e),t.model.component.data.outputNodes[e]=i}else(i instanceof od||i instanceof fd||i instanceof pd||i instanceof dd)&&i.addDimensions(t.fields);for(const t of n.children.flatMap(e))t.parent=i;return[i]}return n.children.flatMap(e)}),r=e.children.map(i).flat();for(const e of r)e.parent=n}else{const t=e.children[0];(t instanceof od||t instanceof fd||t instanceof pd||t instanceof dd)&&t.addDimensions(e.fields),t.swapWithParent(),wd(e)}else e.children.map(wd);var t}class xd extends id{constructor(){super()}run(e){e instanceof Xc&&!e.isRequired()&&(this.setMutated(),e.remove());for(const t of e.children)this.run(t);return this.mutatedFlag}}class _d extends id{constructor(e){super(),this.requiresSelectionId=e&&Eu(e)}run(e){e instanceof hd&&(this.requiresSelectionId&&(ed(e.parent)||e.parent instanceof od||e.parent instanceof ud)||(this.setMutated(),e.remove()));for(const t of e.children)this.run(t);return this.mutatedFlag}}class kd extends nd{run(e){const t=e.parent,n=[...t.children],i=t.children.filter(e=>e instanceof ud);if(t.numChildren()>1&&i.length>=1){const e={},r=new Set;for(const t of i){const n=t.parse;for(const t of ie(n))t in e?e[t]!==n[t]&&r.add(t):e[t]=n[t]}for(const t of r)delete e[t];if(!ne(e)){this.setMutated();const i=new ud(t,e);for(const r of n){if(r instanceof ud)for(const t of ie(e))delete r.parse[t];t.removeChild(r),r.parent=i,r instanceof ud&&0===ie(r.parse).length&&r.remove()}}}return this.setContinue(),this.flags}}class Sd extends nd{run(e){const t=e.parent,n=t.children.filter(e=>e instanceof od),i={};for(const e of n){const t=V(e.groupBy);t in i||(i[t]=[]),i[t].push(e)}for(const e of ie(i)){const n=i[e];if(n.length>1){const e=n.pop();for(const i of n)e.merge(i)&&(t.removeChild(i),i.parent=e,i.remove(),this.setMutated())}}return this.setContinue(),this.flags}}class Od extends nd{constructor(e){super(),this.model=e}run(e){const t=e.parent,n=!(ed(t)||t instanceof Ru||t instanceof ud||t instanceof hd),i=[],r=[];for(const e of t.children)e instanceof Xh&&(n&&!te(t.producedFields(),e.dependentFields())?i.push(e):r.push(e));if(i.length>0){const e=i.pop();for(const t of i)e.merge(t,this.model.renameSignal.bind(this.model));this.setMutated(),t instanceof Xh?t.merge(e,this.model.renameSignal.bind(this.model)):e.swapWithParent()}if(r.length>1){const e=r.pop();for(const t of r)e.merge(t,this.model.renameSignal.bind(this.model));this.setMutated()}return this.setContinue(),this.flags}}class Cd extends nd{run(e){const t=e.parent,n=[...t.children];if(!Y(n,e=>e instanceof Xc)||t.numChildren()<=1)return this.setContinue(),this.flags;const i=[];let r;for(const e of n)if(e instanceof Xc){let n=e;for(;1===n.numChildren();){const[e]=n.children;if(!(e instanceof Xc))break;n=e}i.push(...n.children),r?(t.removeChild(e),e.parent=r.parent,r.parent.removeChild(r),r.parent=n,this.setMutated()):r=n}else i.push(e);if(i.length){this.setMutated();for(const e of i)e.parent.removeChild(e),e.parent=r}return this.setContinue(),this.flags}}const Ad="scale_";function $d(e){for(const t of e){for(const e of t.children)if(e.parent!==t)return!1;if(!$d(t.children))return!1}return!0}function Ed(e){const t=[];function n(e){if(0===e.numChildren())t.push(e);else for(const t of e.children)n(t)}for(const t of e)n(t);return t}function Md(e){return e}function jd(e,t){return t.map(t=>{if(e instanceof nd){const n=e.optimizeNextFromLeaves(t);return e.reset(),n}return e.run(t)}).some(Md)}function Rd(e,t,n){let i=e.sources;const r=new Set;return r.add(jd(new xd,i)),r.add(jd(new _d(t),i)),i=i.filter(e=>e.numChildren()>0),r.add(jd(new vd,Ed(i))),i=i.filter(e=>e.numChildren()>0),n||(r.add(jd(new gd,Ed(i))),r.add(jd(new Od(t),Ed(i))),r.add(jd(new bd,Ed(i))),r.add(jd(new kd,Ed(i))),r.add(jd(new Sd,Ed(i))),r.add(jd(new yd,Ed(i))),r.add(jd(new md,i)),r.add(jd(new Cd,Ed(i)))),e.sources=i,r.has(!0)}class Dd{constructor(e){Object.defineProperty(this,"signal",{enumerable:!0,get:e})}static fromName(e,t){return new Dd(()=>e(t))}}function Td(e){af(e)?function(e){const t=e.component.scales;for(const n of ie(t)){const i=Ld(e,n);if(t[n].setWithExplicit("domains",i),zd(e,n),e.component.data.isFaceted){let t=e;for(;!lf(t)&&t.parent;)t=t.parent;if("shared"===t.component.resolve.scale[n])for(const e of i.value)jr(e)&&(e.data=Ad+e.data.replace(Ad,""))}}}(e):function(e){for(const t of e.children)Td(t);const t=e.component.scales;for(const n of ie(t)){let r,o=null;for(const t of e.children){const e=t.component.scales[n];if(e){r=void 0===r?e.getWithExplicit("domains"):Vl(r,e.getWithExplicit("domains"),"domains","scale",Bd);const t=e.get("selectionExtent");o&&t&&o.selection!==t.selection&&dr(i.NEEDS_SAME_SELECTION),o=t}}t[n].setWithExplicit("domains",r),o&&t[n].set("selectionExtent",o,!0)}}(e)}function Ld(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:i}=e,r=function(e,t,n,i){if("unaggregated"===e){const{valid:e,reason:i}=Id(t,n);if(!e)return void dr(i)}else if(void 0===e&&i.useUnaggregatedDomain){const{valid:e}=Id(t,n);if(e)return"unaggregated"}return e}(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:r})),"x"===t&&Us(i.x2)?Us(i.x)?Vl(Nd(n,r,e,"x"),Nd(n,r,e,"x2"),"domain","scale",Bd):Nd(n,r,e,"x2"):"y"===t&&Us(i.y2)?Us(i.y)?Vl(Nd(n,r,e,"y"),Nd(n,r,e,"y2"),"domain","scale",Bd):Nd(n,r,e,"y2"):Nd(n,r,e,t)}function Fd(e,t,n){var i;const r=null===(i=$r(n))||void 0===i?void 0:i.unit;return"temporal"===t||r?function(e,t,n){return e.map(e=>({signal:`{data: ${Xs(e,{timeUnit:n,type:t})}}`}))}(e,t,r):[e]}function Nd(e,t,n,i){const{encoding:r}=n,o=Us(r[i]),{type:s}=o,a=o.timeUnit;if(function(e){return e&&e.unionWith}(t)){const r=Nd(e,void 0,n,i),o=Fd(t.unionWith,s,a);return Wl([...r.value,...o])}if(Er(t))return Wl([t]);if(t&&"unaggregated"!==t&&!Co(t))return Wl(Fd(t,s,a));const l=n.stack;if(l&&i===l.fieldChannel){if("normalize"===l.offset)return Ul([[0,1]]);const e=n.requestDataName(tc.Main);return Ul([{data:e,field:n.vgField(i,{suffix:"start"})},{data:e,field:n.vgField(i,{suffix:"end"})}])}const c=An(i)&&ys(o)?function(e,t,n){if(!_o(n))return;const i=e.fieldDef(t),r=i.sort;if(ls(r))return{op:"min",field:Zu(i,t),order:"ascending"};const{stack:o}=e,s=o?[...o.groupbyField?[o.groupbyField]:[],...o.stackBy.map(e=>e.fieldDef.field)]:void 0;if(as(r)){const e=o&&!K(s,r.field);return Pd(r,e)}if(ss(r)){const{encoding:t,order:n}=r,i=e.fieldDef(t),{aggregate:a,field:l}=i,c=o&&!K(s,l);if(nt(a)||it(a))return Pd({field:Rs(i),order:n},c);if(rt(a)||!a)return Pd({op:a,field:l,order:n},c)}else{if("descending"===r)return{op:"min",field:e.vgField(t),order:"descending"};if(K(["ascending",void 0],r))return!0}return}(n,i,e):void 0;if(xs(o)){return Ul(Fd([o.datum],s,a))}const u=o;if("unaggregated"===t){const e=n.requestDataName(tc.Main),{field:t}=o;return Ul([{data:e,field:Rs({field:t,aggregate:"min"})},{data:e,field:Rs({field:t,aggregate:"max"})}])}if(Tn(u.bin)){if(_o(e))return Ul("bin-ordinal"===e?[]:[{data:se(c)?n.requestDataName(tc.Main):n.requestDataName(tc.Raw),field:n.vgField(i,Qs(u,i)?{binSuffix:"range"}:{}),sort:!0!==c&&m(c)?c:{field:n.vgField(i,{}),op:"min"}}]);{const{bin:e}=u;if(Tn(e)){const t=Kh(n,u.field,e);return Ul([new Dd(()=>{const e=n.getSignalName(t);return`[${e}.start, ${e}.stop]`})])}return Ul([{data:n.requestDataName(tc.Main),field:n.vgField(i,{})}])}}if(u.timeUnit&&K(["time","utc"],e)&&gs(i,u,af(n)?n.encoding[Vt(i)]:void 0,n.stack,n.markDef,n.config)){const e=n.requestDataName(tc.Main);return Ul([{data:e,field:n.vgField(i)},{data:e,field:n.vgField(i,{suffix:"end"})}])}return Ul(c?[{data:se(c)?n.requestDataName(tc.Main):n.requestDataName(tc.Raw),field:n.vgField(i),sort:c}]:[{data:n.requestDataName(tc.Main),field:n.vgField(i)}])}function Pd(e,t){const{op:n,field:i,order:r}=e;return Object.assign(Object.assign({op:null!=n?n:t?"sum":is},i?{field:fe(i)}:{}),r?{order:r}:{})}function zd(e,t){var n;const i=e.component.scales[t],r=e.specifiedScales[t].domain,o=null===(n=e.fieldDef(t))||void 0===n?void 0:n.bin,s=Co(r)&&r,a=Fn(o)&&Nn(o.extent)&&o.extent;(s||a)&&i.set("selectionExtent",null!=s?s:a,!0)}function Id(e,t){const{aggregate:n,type:r}=e;return n?A(n)&&!lt[n]?{valid:!1,reason:i.unaggregateDomainWithNonSharedDomainOp(n)}:"quantitative"===r&&"log"===t?{valid:!1,reason:i.unaggregatedDomainWithLogScale(e)}:{valid:!0}:{valid:!1,reason:i.unaggregateDomainHasNoEffectForRawField(e)}}function Bd(e,t,n,r){return e.explicit&&t.explicit&&dr(i.mergeConflictingDomainProperty(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function Wd(e){if(jr(e)&&A(e.field))return e.field;if(function(e){return!g(e)&&("fields"in e&&!("data"in e))}(e)){let t;for(const n of e.fields)if(jr(n)&&A(n.field))if(t){if(t!==n.field)return dr(i.FACETED_INDEPENDENT_DIFFERENT_SOURCES),t}else t=n.field;return dr(i.FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES),t}if(function(e){return!g(e)&&("fields"in e&&"data"in e)}(e)){dr(i.FACETED_INDEPENDENT_SAME_SOURCE);const t=e.fields[0];return A(t)?t:void 0}}function Ud(e,t){return function(e){const t=Q(e.map(e=>{if(jr(e)){const{sort:t}=e;return M(e,["sort"])}return e}),V),n=Q(e.map(e=>{if(jr(e)){const t=e.sort;return void 0===t||se(t)||("op"in t&&"count"===t.op&&delete t.field,"ascending"===t.order&&delete t.order),t}}).filter(e=>void 0!==e),V);if(0===t.length)return;if(1===t.length){const t=e[0];if(jr(t)&&n.length>0){let e=n[0];if(n.length>1)dr(i.MORE_THAN_ONE_SORT),e=!0;else if(m(e)&&"field"in e){const n=e.field;t.field===n&&(e=!e.order||{order:e.order})}return Object.assign(Object.assign({},t),{sort:e})}return t}const r=Q(n.map(e=>se(e)||!("op"in e)||e.op in tt?e:(dr(i.domainSortDropped(e)),!0)),V);let o;1===r.length?o=r[0]:r.length>1&&(dr(i.MORE_THAN_ONE_SORT),o=!0);const s=Q(e.map(e=>jr(e)?e.data:null),e=>e);if(1===s.length&&null!==s[0]){return Object.assign({data:s[0],fields:t.map(e=>e.field)},o?{sort:o}:{})}return Object.assign({fields:t},o?{sort:o}:{})}(e.component.scales[t].get("domains").map(t=>(jr(t)&&(t.data=e.lookupDataSource(t.data)),t)))}function Hd(e){return ie(e.component.scales).reduce((t,n)=>{const i=e.component.scales[n];if(i.merged)return t;const r=i.combine(),{name:o,type:s,selectionExtent:a,domains:l,range:c,reverse:u}=r,h=M(r,["name","type","selectionExtent","domains","range","reverse"]),d=function(e,t,n,i){if(hn(n)){if(Mr(e))return{step:{signal:t+"_step"}}}else if(m(e)&&jr(e))return Object.assign(Object.assign({},e),{data:i.lookupDataSource(e.data)});return e}(r.range,o,n,e);let f;a&&(f=function(e,t){const n=t.selection;return{signal:Tu(e.getSelectionComponent(n,ae(n)),t)}}(e,a));const p=Ud(e,n);return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:o,type:s},p?{domain:p}:{}),f?{domainRaw:f}:{}),{range:d}),void 0!==u?{reverse:u}:{}),h)),t},[])}class qd extends Bl{constructor(e,t){super({},{name:e}),this.merged=!1,this.setWithExplicit("type",t)}domainDefinitelyIncludesZero(){return!1!==this.get("zero")||Y(this.get("domains"),e=>g(e)&&2===e.length&&e[0]<=0&&e[1]>=0)}}const Vd=["range","scheme"];function Gd(e){return"x"===e?"width":"y"===e?"height":void 0}function Kd(e,t){const n=e.fieldDef(t);if(n&&n.bin&&Tn(n.bin)){const i=Kh(e,n.field,n.bin),r=Gd(t),o=e.getName(r);return new Dd(()=>{const t=e.getSignalName(i),n=`(${t}.stop - ${t}.start) / ${t}.step`;return`${e.getSignalName(o)} / (${n})`})}}function Yd(e,t){const n=t.specifiedScales[e],{size:r}=t,o=t.getScaleComponent(e).get("type");for(const r of Vd)if(void 0!==n[r]){const s=Fo(o,r),a=No(e,r);if(s)if(a)dr(a);else switch(r){case"range":{const i=n.range;if(g(i)){if(hn(e))return Wl(i.map(e=>{if("width"===e||"height"===e){const n=t.getName(e),i=t.getSignalName.bind(t);return Dd.fromName(i,n)}return e}))}else if(m(i))return Wl({data:t.requestDataName(tc.Main),field:i.field,sort:{op:"min",field:t.vgField(e)}});return Wl(i)}case"scheme":return Wl(Xd(n[r]))}else dr(i.scalePropertyNotWorkWithScaleType(o,r,e))}if(e===ht||e===dt){const t=e===ht?"width":"height",n=r[t];if(Ja(n)){if(_o(o))return Wl({step:n.step});dr(i.stepDropped(t))}}const{rangeMin:s,rangeMax:a}=n,l=function(e,t){const{size:n,config:r,mark:o,encoding:s}=t,a=t.getSignalName.bind(t),{type:l}=Us(s[e]),c=t.getScaleComponent(e).get("type"),{domain:u,domainMid:h}=t.specifiedScales[e];switch(e){case ht:case dt:{if(K(["point","band"],c))if(e!==ht||n.width){if(e===dt&&!n.height){const e=nl(r.view,"height");if(Ja(e))return e}}else{const e=nl(r.view,"width");if(Ja(e))return e}const i=Gd(e),o=t.getName(i);return e===dt&&ko(c)?[Dd.fromName(a,o),0]:[0,Dd.fromName(a,o)]}case _t:{const s=t.component.scales[e].get("zero"),a=function e(t,n,r){if(n)return Er(n)?{signal:`${n.signal} ? 0 : ${e(t,!1,r)}`}:0;switch(t){case"bar":case"tick":return r.scale.minBandSize;case"line":case"trail":case"rule":return r.scale.minStrokeWidth;case"text":return r.scale.minFontSize;case"point":case"square":case"circle":return r.scale.minSize}throw new Error(i.incompatibleChannel("size",t))}(o,s,r),l=function(e,t,n,r){const o={x:Kd(n,"x"),y:Kd(n,"y")};switch(e){case"bar":case"tick":{if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;const e=Jd(t,o,r.view);return C(e)?e-1:new Dd(()=>e.signal+" - 1")}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const e=Jd(t,o,r.view);return C(e)?Math.pow(.95*e,2):new Dd(()=>`pow(0.95 * ${e.signal}, 2)`)}}throw new Error(i.incompatibleChannel("size",e))}(o,n,t,r);return Oo(c)?function(e,t,n){const i=()=>{const i=ia(t),r=ia(e),o=`(${i} - ${r}) / (${n} - 1)`;return`sequence(${r}, ${i} + ${o}, ${o})`};return Er(t)?new Dd(i):{signal:i()}}(a,l,function(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return void 0!==n&&g(n)?n.length+1:(dr(i.domainRequiredForThresholdScale(r)),3)}}(c,r,u,e)):[a,l]}case mt:return[0,2*Math.PI];case"angle":return[0,360];case gt:return[0,new Dd(()=>`min(${t.getSignalName("width")},${t.getSignalName("height")})/2`)];case"strokeWidth":return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case"strokeDash":return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case xt:return"symbol";case bt:case yt:case wt:return"ordinal"===c?"nominal"===l?"category":"ordinal":void 0!==h?"diverging":"rect"===o||"geoshape"===o?"heatmap":"ramp";case"opacity":case"fillOpacity":case"strokeOpacity":return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error("Scale range undefined for channel "+e)}(e,t);return(void 0!==s||void 0!==a)&&Fo(o,"rangeMin")&&g(l)&&2===l.length?Wl([null!=s?s:l[0],null!=a?a:l[1]]):Ul(l)}function Xd(e){return function(e){return!A(e)&&!!e.name}(e)?Object.assign({scheme:e.name},H(e,["name"])):{scheme:e}}function Jd(e,t,n){const i=Ja(e.width)?e.width.step:tl(n,"width"),r=Ja(e.height)?e.height.step:tl(n,"height");return t.x||t.y?new Dd(()=>`min(${[t.x?t.x.signal:i,t.y?t.y.signal:r].join(", ")})`):Math.min(i,r)}function Qd(e,t){af(e)?function(e,t){const n=e.component.scales,{config:r,encoding:o,markDef:s,specifiedScales:a}=e;for(const l of ie(n)){const c=a[l],u=n[l],h=e.getScaleComponent(l),d=Us(o[l]),f=c[t],p=h.get("type"),g=h.get("padding"),m=h.get("paddingInner"),v=Fo(p,t),b=No(l,t);if(void 0!==f&&(v?b&&dr(b):dr(i.scalePropertyNotWorkWithScaleType(p,t,l))),v&&void 0===b)if(void 0!==f){const e=d.timeUnit,n=d.type;switch(t){case"domainMax":case"domainMin":fr(c[t])||"temporal"===n||e?u.set(t,{signal:Xs(c[t],{type:n,timeUnit:e})},!0):u.set(t,c[t],!0);break;default:u.copyKeyFromObject(t,c)}}else{const n=t in Zd?Zd[t]({model:e,channel:l,fieldOrDatumDef:d,scaleType:p,scalePadding:g,scalePaddingInner:m,domain:c.domain,markDef:s,config:r}):r.scale[t];void 0!==n&&u.set(t,n,!1)}}}(e,t):tf(e,t)}const Zd={bins:({model:e,fieldOrDatumDef:t})=>ys(t)?function(e,t){const n=t.bin;if(Tn(n)){const i=Kh(e,t.field,n);return new Dd(()=>e.getSignalName(i))}if(Ln(n)&&Fn(n)&&void 0!==n.step)return{step:n.step};return}(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>function(e,t){if(K([bt,yt,wt],e)&&"nominal"!==t)return"hcl";return}(e,t.type),nice:({scaleType:e,channel:t,fieldOrDatumDef:n})=>function(e,t,n){var i;if((null===(i=Ws(n))||void 0===i?void 0:i.bin)||K([ro,oo],e))return;return t in cn||void 0}(e,t,n),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:i,config:r})=>function(e,t,n,i,r,o){if(e in cn){if(So(t)){if(void 0!==n.continuousPadding)return n.continuousPadding;const{type:t,orient:s}=r;if("bar"===t&&(!ys(i)||!i.bin&&!i.timeUnit)&&("vertical"===s&&"x"===e||"horizontal"===s&&"y"===e))return o.continuousBandSize}if(t===co)return n.pointPadding}return}(e,t,r.scale,n,i,r.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,config:i})=>function(e,t,n,i){if(void 0!==e)return;if(t in cn){const{bandPaddingInner:e,barBandPaddingInner:t,rectBandPaddingInner:r}=i;return ve(e,"bar"===n?t:r)}return}(e,t,n.type,i.scale),paddingOuter:({scalePadding:e,channel:t,scaleType:n,markDef:i,scalePaddingInner:r,config:o})=>function(e,t,n,i,r,o){if(void 0!==e)return;if(t in cn&&n===uo){const{bandPaddingOuter:e}=o;return ve(e,Er(r)?{signal:r.signal+"/2"}:r/2)}return}(e,t,n,i.type,r,o.scale),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:i})=>function(e,t,n,i){if("x"===n&&void 0!==i.xReverse)return ko(e)&&"descending"===t?Er(i.xReverse)?{signal:"!"+i.xReverse.signal}:!i.xReverse:i.xReverse;if(ko(e)&&"descending"===t)return!0;return}(t,ys(e)?e.sort:void 0,n,i.scale),zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:i,scaleType:r})=>function(e,t,n,i,r){if(n&&"unaggregated"!==n&&ko(r)){if(g(n)){const e=n[0],t=n[n.length-1];if(e<=0&&t>=0)return!0}return!1}if("size"===e&&"quantitative"===t.type&&!Oo(r))return!0;if((!ys(t)||!t.bin)&&K([...un,...fn],e)){const{orient:t,type:n}=i;return!K(["bar","area","line","trail"],n)||!("horizontal"===t&&"y"===e||"vertical"===t&&"x"===e)}return!1}(e,t,n,i,r)};function ef(e){af(e)?function(e){const t=e.component.scales;for(const n of Cn){const i=t[n];if(!i)continue;const r=Yd(n,e);i.setWithExplicit("range",r)}}(e):tf(e,"range")}function tf(e,t){const n=e.component.scales;for(const n of e.children)"range"===t?ef(n):Qd(n,t);for(const i of ie(n)){let r;for(const n of e.children){const e=n.component.scales[i];if(e){r=Vl(r,e.getWithExplicit(t),t,"scale",Hl((e,n)=>{switch(t){case"range":return e.step&&n.step?e.step-n.step:0}return 0}))}}n[i].setWithExplicit(t,r)}}function nf(e,t,n,r){const o=function(e,t,n){var r;switch(t.type){case"nominal":case"ordinal":if($t(e)||"discrete"===Rn(e))return"shape"===e&&"ordinal"===t.type&&dr(i.discreteChannelCannotEncode(e,"ordinal")),"ordinal";if(e in cn){if(K(["rect","bar","image","rule"],n))return"band"}else if("arc"===n&&e in dn)return"band";return void 0!==t.band||$s(t)&&(null===(r=t.axis)||void 0===r?void 0:r.tickBand)?"band":"point";case"temporal":return $t(e)?"time":"discrete"===Rn(e)?(dr(i.discreteChannelCannotEncode(e,"temporal")),"ordinal"):ys(t)&&t.timeUnit&&$r(t.timeUnit).utc?"utc":"time";case"quantitative":return $t(e)?ys(t)&&Tn(t.bin)?"bin-ordinal":"linear":"discrete"===Rn(e)?(dr(i.discreteChannelCannotEncode(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(i.invalidFieldType(t.type))}(t,n,r),{type:s}=e;return An(t)?void 0!==s?function(e,t){if(!An(e))return!1;switch(e){case ht:case dt:case mt:case gt:return So(t)||K(["band","point"],t);case _t:case"strokeWidth":case"opacity":case"fillOpacity":case"strokeOpacity":case"angle":return So(t)||Oo(t)||K(["band","point","ordinal"],t);case bt:case yt:case wt:return"band"!==t;case"strokeDash":return"ordinal"===t||Oo(t);case xt:return"ordinal"===t}}(t,s)?ys(n)&&(a=s,l=n.type,!(K([Yr,Jr],l)?void 0===a||_o(a):l===Xr?K([ro,oo,void 0],a):l!==Kr||K([eo,to,no,io,so,ao,lo,Zr,void 0],a)))?(dr(i.scaleTypeNotWorkWithFieldDef(s,o)),o):s:(dr(i.scaleTypeNotWorkWithChannel(t,s,o)),o):o:null;var a,l}function rf(e){af(e)?e.component.scales=function(e){const{encoding:t,mark:n}=e;return Cn.reduce((i,r)=>{const o=Us(t[r]);if(o&&n===We&&r===xt&&o.type===Qr)return i;let s=o&&o.scale;if(o&&null!==s&&!1!==s){s=null!=s?s:{};const t=nf(s,r,o,n);i[r]=new qd(e.scaleName(r+"",!0),{value:t,explicit:s.type===t})}return i},{})}(e):e.component.scales=function(e){var t;const n=e.component.scales={},i={},r=e.component.resolve;for(const n of e.children){rf(n);for(const o of ie(n.component.scales))if(r.scale[o]=null!==(t=r.scale[o])&&void 0!==t?t:xh(o,e),"shared"===r.scale[o]){const e=i[o],t=n.component.scales[o].getWithExplicit("type");e?fo(e.value,t.value)?i[o]=Vl(e,t,"type","scale",of):(r.scale[o]="independent",delete i[o]):i[o]=t}}for(const t of ie(i)){const r=e.scaleName(t,!0),o=i[t];n[t]=new qd(r,o);for(const n of e.children){const e=n.component.scales[t];e&&(n.renameScale(e.get("name"),r),e.merged=!0)}}return n}(e)}const of=Hl((e,t)=>go(e)-go(t));class sf{constructor(){this.nameMap={}}rename(e,t){this.nameMap[e]=t}has(e){return void 0!==this.nameMap[e]}get(e){for(;this.nameMap[e]&&e!==this.nameMap[e];)e=this.nameMap[e];return e}}function af(e){return"unit"===(null==e?void 0:e.type)}function lf(e){return"facet"===(null==e?void 0:e.type)}function cf(e){return"concat"===(null==e?void 0:e.type)}function uf(e){return"layer"===(null==e?void 0:e.type)}class hf{constructor(e,t,n,i,r,o,s){var a,l;this.type=t,this.parent=n,this.config=r,this.view=s,this.children=[],this.correctDataNames=e=>(e.from&&e.from.data&&(e.from.data=this.lookupDataSource(e.from.data)),e.from&&e.from.facet&&e.from.facet.data&&(e.from.facet.data=this.lookupDataSource(e.from.facet.data)),e),this.parent=n,this.config=r,this.name=null!==(a=e.name)&&void 0!==a?a:i,this.title=ea(e.title)?{text:e.title}:e.title,this.scaleNameMap=n?n.scaleNameMap:new sf,this.projectionNameMap=n?n.projectionNameMap:new sf,this.signalNameMap=n?n.signalNameMap:new sf,this.data=e.data,this.description=e.description,this.transforms=(null!==(l=e.transform)&&void 0!==l?l:[]).map(e=>nc(e)?{filter:I(e.filter,Vr)}:e),this.layout="layer"===t||"unit"===t?{}:function(e,t,n){var i,r;const o=n[t],s={},{spacing:a,columns:l}=o;void 0!==a&&(s.spacing=a),void 0!==l&&(hs(e)&&!cs(e.facet)||Ka(e))&&(s.columns=l),Ya(e)&&(s.columns=1);for(const t of Za)if(void 0!==e[t])if("spacing"===t){const n=e[t];s[t]=C(n)?n:{row:null!==(i=n.row)&&void 0!==i?i:a,column:null!==(r=n.column)&&void 0!==r?r:a}}else s[t]=e[t];return s}(e,t,r),this.component={data:{sources:n?n.component.data.sources:[],outputNodes:n?n.component.data.outputNodes:{},outputNodeRefCounts:n?n.component.data.outputNodeRefCounts:{},isFaceted:hs(e)||n&&n.component.data.isFaceted&&void 0===e.data},layoutSize:new Bl,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},o?W(o):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){!function(e,{ignoreRange:t}={}){rf(e),Td(e);for(const t of Lo)Qd(e,t);t||ef(e)}(this)}parseProjection(){Vh(this)}renameTopLevelLayoutSizeSignal(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}parseLegends(){Lh(this)}assembleGroupStyle(){var e,t;if("unit"===this.type||"layer"===this.type)return null!==(t=null===(e=this.view)||void 0===e?void 0:e.style)&&void 0!==t?t:"cell"}assembleEncodeFromView(e){const{style:t}=e,n=M(e,["style"]),i={};for(const e of ie(n)){const t=n[e];void 0!==t&&(i[e]=ta(t))}return i}assembleGroupEncodeEntry(e){let t={};return this.view&&(t=this.assembleEncodeFromView(this.view)),e||(this.description&&(t.description=ta(this.description)),"unit"!==this.type&&"layer"!==this.type)?ne(t)?void 0:t:Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},null!=t?t:{})}assembleLayout(){if(!this.layout)return;const e=this.layout,{spacing:t}=e,n=M(e,["spacing"]),{component:i,config:r}=this,o=function(e,t){const n={};for(const i of Mt){const r=e[i];if(null==r?void 0:r.facetFieldDef){const{titleAnchor:e,titleOrient:o}=nh(["titleAnchor","titleOrient"],r.facetFieldDef,t,i),s=eh(i,o),a=fh(e,s);void 0!==a&&(n[s]=a)}}return ne(n)?void 0:n}(i.layoutHeaders,r);return Object.assign(Object.assign(Object.assign({padding:t},this.assembleDefaultLayout()),n),o?{titleBand:o}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:e}=this.component;let t=[];for(const n of Mt)e[n].title&&t.push(oh(this,n));for(const e of ih)t=t.concat(lh(this,e));return t}assembleAxes(){return function(e,t){const{x:n=[],y:i=[]}=e;return[...n.map(e=>Nu(e,"grid",t)),...i.map(e=>Nu(e,"grid",t)),...n.map(e=>Nu(e,"main",t)),...i.map(e=>Nu(e,"main",t))].filter(e=>e)}(this.component.axes,this.config)}assembleLegends(){return Bh(this)}assembleProjections(){return Wh(this)}assembleTitle(){var e,t,n;const i=null!==(e=this.title)&&void 0!==e?e:{},{encoding:r}=i,o=M(i,["encoding"]),s=Object.assign(Object.assign(Object.assign({},Zs(this.config.title).nonMark),o),r?{encode:{update:r}}:{});if(s.text)return K(["unit","layer"],this.type)?K(["middle",void 0],s.anchor)&&(s.frame=null!==(t=s.frame)&&void 0!==t?t:"group"):s.anchor=null!==(n=s.anchor)&&void 0!==n?n:"start",ne(s)?void 0:s}assembleGroup(e=[]){const t={};(e=e.concat(this.assembleSignals())).length>0&&(t.signals=e);const n=this.assembleLayout();n&&(t.layout=n),t.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const i=!this.parent||lf(this.parent)?function e(t){return uf(t)||cf(t)?t.children.reduce((t,n)=>t.concat(e(n)),Hd(t)):Hd(t)}(this):[];i.length>0&&(t.scales=i);const r=this.assembleAxes();r.length>0&&(t.axes=r);const o=this.assembleLegends();return o.length>0&&(t.legends=o),t}getName(e){return ae((this.name?this.name+"_":"")+e)}getDataName(e){return this.getName(tc[e].toLowerCase())}requestDataName(e){const t=this.getDataName(e),n=this.component.data.outputNodeRefCounts;return n[t]=(n[t]||0)+1,t}getSizeSignalRef(e){if(lf(this.parent)){const t=pn(yh(e)),n=this.component.scales[t];if(n&&!n.merged){const e=n.get("type"),r=n.get("range");if(_o(e)&&Mr(r)){const e=n.get("name"),r=Wd(Ud(this,t));if(r){return{signal:bh(e,n,Rs({aggregate:"distinct",field:r},{expr:"datum"}))}}return dr(i.unknownField(t)),null}}}return{signal:this.signalNameMap.get(this.getName(e))}}lookupDataSource(e){const t=this.component.data.outputNodes[e];return t?t.getSource():e}getSignalName(e){return this.signalNameMap.get(e)}renameSignal(e,t){this.signalNameMap.rename(e,t)}renameScale(e,t){this.scaleNameMap.rename(e,t)}renameProjection(e,t){this.projectionNameMap.rename(e,t)}scaleName(e,t){return t?this.getName(e):Bt(e)&&An(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e))?this.scaleNameMap.get(this.getName(e)):void 0}projectionName(e){return e?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}getScaleComponent(e){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const t=this.component.scales[e];return t&&!t.merged?t:this.parent?this.parent.getScaleComponent(e):void 0}getSelectionComponent(e,t){let n=this.component.selection[e];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(e,t)),!n)throw new Error(i.selectionNotFound(t));return n}hasAxisOrientSignalRef(){var e,t;return(null===(e=this.component.axes.x)||void 0===e?void 0:e.some(e=>e.hasOrientSignalRef()))||(null===(t=this.component.axes.y)||void 0===t?void 0:t.some(e=>e.hasOrientSignalRef()))}}class df extends hf{vgField(e,t={}){const n=this.fieldDef(e);if(n)return Rs(n,t)}reduceFieldDef(e,t){return ya(this.getMapping(),(t,n,i)=>{const r=Ws(n);return r?e(t,r,i):t},t)}forEachFieldDef(e,t){ba(this.getMapping(),(t,n)=>{const i=Ws(t);i&&e(i,n)},t)}}class ff extends Yc{constructor(e,t){var n,i,r;super(e),this.transform=t,this.transform=W(t);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(i=o[0])&&void 0!==i?i:"value",null!==(r=o[1])&&void 0!==r?r:"density"]}clone(){return new ff(null,W(this.transform))}dependentFields(){var e;return new Set([this.transform.density,...null!==(e=this.transform.groupby)&&void 0!==e?e:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"DensityTransform "+V(this.transform)}assemble(){const e=this.transform,{density:t}=e,n=M(e,["density"]);return Object.assign({type:"kde",field:t},n)}}class pf extends Yc{constructor(e,t){super(e),this.filter=t}clone(){return new pf(null,Object.assign({},this.filter))}static make(e,t){const{config:n,mark:i,markDef:r}=t;if("filter"!==oa("invalid",r,n))return null;const o=t.reduceFieldDef((e,n,r)=>{const o=An(r)&&t.getScaleComponent(r);if(o){ko(o.get("type"))&&"count"!==n.aggregate&&!Ue(i)&&(e[n.field]=n)}return e},{});return ie(o).length?new pf(e,o):null}dependentFields(){return new Set(ie(this.filter))}producedFields(){return new Set}hash(){return"FilterInvalid "+V(this.filter)}assemble(){const e=ie(this.filter).reduce((e,t)=>{const n=this.filter[t],i=Rs(n,{expr:"datum"});return null!==n&&("temporal"===n.type?e.push(`(isDate(${i}) || (isValid(${i}) && isFinite(+${i})))`):"quantitative"===n.type&&(e.push(`isValid(${i})`),e.push(`isFinite(+${i})`))),e},[]);return e.length>0?{type:"filter",expr:e.join(" && ")}:null}}class gf extends Yc{constructor(e,t){super(e),this.transform=t,this.transform=W(t);const{flatten:n,as:i=[]}=this.transform;this.transform.as=n.map((e,t)=>{var n;return null!==(n=i[t])&&void 0!==n?n:e})}clone(){return new gf(this.parent,W(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return"FlattenTransform "+V(this.transform)}assemble(){const{flatten:e,as:t}=this.transform;return{type:"flatten",fields:e,as:t}}}class mf extends Yc{constructor(e,t){var n,i,r;super(e),this.transform=t,this.transform=W(t);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(i=o[0])&&void 0!==i?i:"key",null!==(r=o[1])&&void 0!==r?r:"value"]}clone(){return new mf(null,W(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return"FoldTransform "+V(this.transform)}assemble(){const{fold:e,as:t}=this.transform;return{type:"fold",fields:e,as:t}}}class vf extends Yc{constructor(e,t,n,i){super(e),this.fields=t,this.geojson=n,this.signal=i}clone(){return new vf(null,W(this.fields),this.geojson,this.signal)}static parseAll(e,t){if(t.component.projection&&!t.component.projection.isFit)return e;let n=0;for(const i of[["longitude","latitude"],["longitude2","latitude2"]]){const r=i.map(e=>{const n=Us(t.encoding[e]);return ys(n)?n.field:xs(n)?{expr:""+n.datum}:Cs(n)?{expr:""+n.value}:void 0});(r[0]||r[1])&&(e=new vf(e,r,null,t.getName("geojson_"+n++)))}if(t.channelHasField(xt)){const i=t.typedFieldDef(xt);i.type===Qr&&(e=new vf(e,null,i.field,t.getName("geojson_"+n++)))}return e}dependentFields(){var e;const t=(null!==(e=this.fields)&&void 0!==e?e:[]).filter(A);return new Set([...this.geojson?[this.geojson]:[],...t])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${V(this.fields)}`}assemble(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}class bf extends Yc{constructor(e,t,n,i){super(e),this.projection=t,this.fields=n,this.as=i}clone(){return new bf(null,this.projection,W(this.fields),W(this.as))}static parseAll(e,t){if(!t.projectionName())return e;for(const n of[["longitude","latitude"],["longitude2","latitude2"]]){const i=n.map(e=>{const n=Us(t.encoding[e]);return ys(n)?n.field:xs(n)?{expr:""+n.datum}:Cs(n)?{expr:""+n.value}:void 0}),r="longitude2"===n[0]?"2":"";(i[0]||i[1])&&(e=new bf(e,t.projectionName(),i,[t.getName("x"+r),t.getName("y"+r)]))}return e}dependentFields(){return new Set(this.fields.filter(A))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${V(this.fields)} ${V(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class yf extends Yc{constructor(e,t){super(e),this.transform=t}clone(){return new yf(null,W(this.transform))}dependentFields(){var e;return new Set([this.transform.impute,this.transform.key,...null!==(e=this.transform.groupby)&&void 0!==e?e:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(e){const{start:t=0,stop:n,step:i}=e;return{signal:`sequence(${[t,n,...i?[i]:[]].join(",")})`}}static makeFromTransform(e,t){return new yf(e,t)}static makeFromEncoding(e,t){const n=t.encoding,i=n.x,r=n.y;if(ys(i)&&ys(r)){const o=i.impute?i:r.impute?r:void 0;if(void 0===o)return;const s=i.impute?r:r.impute?i:void 0,{method:a,value:l,frame:c,keyvals:u}=o.impute,h=wa(t.mark,n);return new yf(e,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:s.field},a?{method:a}:{}),void 0!==l?{value:l}:{}),c?{frame:c}:{}),void 0!==u?{keyvals:u}:{}),h.length?{groupby:h}:{}))}return null}hash(){return"Impute "+V(this.transform)}assemble(){const{impute:e,key:t,keyvals:n,method:i,groupby:r,value:o,frame:s=[null,null]}=this.transform,a=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:e,key:t},n?{keyvals:(l=n,void 0!==(null==l?void 0:l.stop)?this.processSequence(n):n)}:{}),{method:"value"}),r?{groupby:r}:{}),{value:i&&"value"!==i?null:o});var l;if(i&&"value"!==i){return[a,Object.assign({type:"window",as:[`imputed_${e}_value`],ops:[i],fields:[e],frame:s,ignorePeers:!1},r?{groupby:r}:{}),{type:"formula",expr:`datum.${e} === null ? datum.imputed_${e}_value : datum.${e}`,as:e}]}return[a]}}class wf extends Yc{constructor(e,t){var n,i,r;super(e),this.transform=t,this.transform=W(t);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(i=o[0])&&void 0!==i?i:t.on,null!==(r=o[1])&&void 0!==r?r:t.loess]}clone(){return new wf(null,W(this.transform))}dependentFields(){var e;return new Set([this.transform.loess,this.transform.on,...null!==(e=this.transform.groupby)&&void 0!==e?e:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"LoessTransform "+V(this.transform)}assemble(){const e=this.transform,{loess:t,on:n}=e,i=M(e,["loess","on"]);return Object.assign({type:"loess",x:n,y:t},i)}}class xf extends Yc{constructor(e,t,n){super(e),this.transform=t,this.secondary=n}clone(){return new xf(null,W(this.transform),this.secondary)}static make(e,t,n,r){const o=t.component.data.sources,{from:s}=n;let a=null;if(function(e){return"data"in e}(s)){let e=Ff(s.data,o);e||(e=new Jh(s.data),o.push(e));const n=t.getName("lookup_"+r);a=new Xc(e,n,tc.Lookup,t.component.data.outputNodeRefCounts),t.component.data.outputNodes[n]=a}else if(function(e){return"selection"in e}(s)){const e=s.selection;if(n=Object.assign({as:e},n),a=t.getSelectionComponent(ae(e),e).materialized,!a)throw new Error(i.noSameUnitLookup(e))}return new xf(e,n,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?x(this.transform.as):this.transform.from.fields)}hash(){return"Lookup "+V({transform:this.transform,secondary:this.secondary})}assemble(){let e;if(this.transform.from.fields)e=Object.assign({values:this.transform.from.fields},this.transform.as?{as:x(this.transform.as)}:{});else{let t=this.transform.as;A(t)||(dr(i.NO_FIELDS_NEEDS_AS),t="_lookup"),e={as:[t]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},e),this.transform.default?{default:this.transform.default}:{})}}class _f extends Yc{constructor(e,t){var n,i,r;super(e),this.transform=t,this.transform=W(t);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(i=o[0])&&void 0!==i?i:"prob",null!==(r=o[1])&&void 0!==r?r:"value"]}clone(){return new _f(null,W(this.transform))}dependentFields(){var e;return new Set([this.transform.quantile,...null!==(e=this.transform.groupby)&&void 0!==e?e:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"QuantileTransform "+V(this.transform)}assemble(){const e=this.transform,{quantile:t}=e,n=M(e,["quantile"]);return Object.assign({type:"quantile",field:t},n)}}class kf extends Yc{constructor(e,t){var n,i,r;super(e),this.transform=t,this.transform=W(t);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(i=o[0])&&void 0!==i?i:t.on,null!==(r=o[1])&&void 0!==r?r:t.regression]}clone(){return new kf(null,W(this.transform))}dependentFields(){var e;return new Set([this.transform.regression,this.transform.on,...null!==(e=this.transform.groupby)&&void 0!==e?e:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"RegressionTransform "+V(this.transform)}assemble(){const e=this.transform,{regression:t,on:n}=e,i=M(e,["regression","on"]);return Object.assign({type:"regression",x:n,y:t},i)}}class Sf extends Yc{constructor(e,t){super(e),this.transform=t}clone(){return new Sf(null,W(this.transform))}addDimensions(e){var t;this.transform.groupby=Q((null!==(t=this.transform.groupby)&&void 0!==t?t:[]).concat(e),e=>e)}producedFields(){}dependentFields(){var e;return new Set([this.transform.pivot,this.transform.value,...null!==(e=this.transform.groupby)&&void 0!==e?e:[]])}hash(){return"PivotTransform "+V(this.transform)}assemble(){const{pivot:e,value:t,groupby:n,limit:i,op:r}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:e,value:t},void 0!==i?{limit:i}:{}),void 0!==r?{op:r}:{}),void 0!==n?{groupby:n}:{})}}class Of extends Yc{constructor(e,t){super(e),this.transform=t}clone(){return new Of(null,W(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return"SampleTransform "+V(this.transform)}assemble(){return{type:"sample",size:this.transform.sample}}}function Cf(e){let t=0;return function n(i,r){var o;if(i instanceof Jh&&!i.isGenerator&&!Kl(i.data)){e.push(r);r={name:null,source:r.name,transform:[]}}if(i instanceof ud&&(i.parent instanceof Jh&&!r.source?(r.format=Object.assign(Object.assign({},null!==(o=r.format)&&void 0!==o?o:{}),{parse:i.assembleFormatParse()}),r.transform.push(...i.assembleTransforms(!0))):r.transform.push(...i.assembleTransforms())),i instanceof sd){r.name||(r.name="data_"+t++),!r.source||r.transform.length>0?(e.push(r),i.data=r.name):i.data=r.source;for(const t of i.assemble())e.push(t)}else{if((i instanceof Qh||i instanceof Zh||i instanceof pf||i instanceof Ru||i instanceof Qu||i instanceof bf||i instanceof vf||i instanceof od||i instanceof xf||i instanceof pd||i instanceof dd||i instanceof mf||i instanceof gf||i instanceof ff||i instanceof wf||i instanceof _f||i instanceof kf||i instanceof hd||i instanceof Of||i instanceof Sf)&&r.transform.push(i.assemble()),(i instanceof Xh||i instanceof Jc||i instanceof yf||i instanceof fd)&&r.transform.push(...i.assemble()),i instanceof Xc)if(r.source&&0===r.transform.length)i.setSource(r.source);else if(i.parent instanceof Xc)i.setSource(r.name);else if(r.name||(r.name="data_"+t++),i.setSource(r.name),1===i.numChildren()){e.push(r);r={name:null,source:r.name,transform:[]}}switch(i.numChildren()){case 0:i instanceof Xc&&(!r.source||r.transform.length>0)&&e.push(r);break;case 1:n(i.children[0],r);break;default:{r.name||(r.name="data_"+t++);let o=r.name;!r.source||r.transform.length>0?e.push(r):o=r.source;for(const e of i.children){n(e,{name:null,source:o,transform:[]})}break}}}}}function Af(e,t){var n;const{facet:i,config:r,child:o,component:s}=e;if(e.channelHasField(t)){const a=i[t],l=th("title",null,r,t);let c=Ps(a,r,{allowDisabling:!0,includeDefault:void 0===l||!!l});o.component.layoutHeaders[t].title&&(c=g(c)?c.join(", "):c,c+=" / "+o.component.layoutHeaders[t].title,o.component.layoutHeaders[t].title=null);const u=th("labelOrient",a,r,t),h=ve((null!==(n=a.header)&&void 0!==n?n:{}).labels,r.header.labels,!0),d=K(["bottom","right"],u)?"footer":"header";s.layoutHeaders[t]={title:c,facetFieldDef:a,[d]:"facet"===t?[]:[$f(e,t,h)]}}}function $f(e,t,n){const i="row"===t?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(i)?e.child.getSizeSignalRef(i):void 0,axes:[]}}function Ef(e,t){var n;const{child:i}=e;if(i.component.axes[t]){const{layoutHeaders:o,resolve:s}=e.component;if(s.axis[t]=_h(s,t),"shared"===s.axis[t]){const s="x"===t?"column":"row",a=o[s];for(const o of i.component.axes[t]){const t="top"===(r=o.get("orient"))||"left"===r||Er(r)?"header":"footer";a[t]=null!==(n=a[t])&&void 0!==n?n:[$f(e,s,!1)];const i=Nu(o,"main",e.config,{header:!0});i&&a[t][0].axes.push(i),o.mainExtracted=!0}}}var r}function Mf(e){jf(e);const t=1===e.layout.columns?"width":"childWidth",n=void 0===e.layout.columns?"height":"childHeight";Rf(e,t),Rf(e,n)}function jf(e){for(const t of e.children)t.parseLayoutSize()}function Rf(e,t){const n=yh(t),i=pn(n),r=e.component.resolve,o=e.component.layoutSize;let s;for(const t of e.children){const e=t.component.layoutSize.getWithExplicit(n),o=r.scale[i];if("independent"===o&&"step"===e.value){s=void 0;break}if(s){if("independent"===o&&s.value!==e.value){s=void 0;break}s=Vl(s,e,n,"")}else s=e}if(s){for(const i of e.children)e.renameSignal(i.getName(n),e.getName(t)),i.component.layoutSize.set(n,"merged",!1);o.setWithExplicit(t,s)}else o.setWithExplicit(t,{explicit:!1,value:void 0})}function Df(e,t){const n="width"===t?"x":"y",i=e.config,r=e.getScaleComponent(n);if(r){const e=r.get("type"),n=r.get("range");if(_o(e)){const e=nl(i.view,t);return Mr(n)||Ja(e)?"step":e}return el(i.view,t)}if(e.hasProjection||"arc"===e.mark)return el(i.view,t);{const e=nl(i.view,t);return Ja(e)?e.step:e}}function Tf(e,t,n){return Rs(t,Object.assign({suffix:"by_"+Rs(e)},null!=n?n:{}))}class Lf extends df{constructor(e,t,n,i){super(e,"facet",t,n,i,e.resolve),this.child=ip(e.spec,this,this.getName("child"),void 0,i),this.children=[this.child],this.facet=this.initFacet(e.facet,i)}initFacet(e,t){return cs(e)?ya(e,(e,n,r)=>K([ct,ut],r)?void 0===n.field?(dr(i.emptyFieldDef(n,r)),e):(e[r]=Hs(n,r,t),e):(dr(i.incompatibleChannel(r,"facet")),e),{}):{facet:Hs(e,"facet",t)}}channelHasField(e){return!!this.facet[e]}fieldDef(e){return this.facet[e]}parseData(){this.component.data=Pf(this),this.child.parseData()}parseLayoutSize(){jf(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),function(e){for(const t of Mt)Af(e,t);Ef(e,"x"),Ef(e,"y")}(this)}assembleSelectionTopLevelSignals(e){return this.child.assembleSelectionTopLevelSignals(e)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(e){return this.child.assembleSelectionData(e)}getHeaderLayoutMixins(){var e,t,n;const i={};for(const r of Mt)for(const o of rh){const s=this.component.layoutHeaders[r],a=s[o],{facetFieldDef:l}=s;if(l){const t=th("titleOrient",l,this.config,r);if(K(["right","bottom"],t)){const n=eh(r,t);i.titleAnchor=null!==(e=i.titleAnchor)&&void 0!==e?e:{},i.titleAnchor[n]="end"}}if(null==a?void 0:a[0]){const e="row"===r?"height":"width",a="header"===o?"headerBand":"footerBand";"facet"===r||this.child.component.layoutSize.get(e)||(i[a]=null!==(t=i[a])&&void 0!==t?t:{},i[a][r]=.5),s.title&&(i.offset=null!==(n=i.offset)&&void 0!==n?n:{},i.offset["row"===r?"rowTitle":"columnTitle"]=10)}}return i}assembleDefaultLayout(){const{column:e,row:t}=this.facet,n=e?this.columnDistinctSignal():t?1:void 0;let i="all";return(t||"independent"!==this.component.resolve.scale.x)&&(e||"independent"!==this.component.resolve.scale.y)||(i="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),n?{columns:n}:{}),{bounds:"full",align:i})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof Lf)){return{signal:`length(data('${this.getName("column_domain")}'))`}}}assembleGroup(e){return this.parent&&this.parent instanceof Lf?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:Rs(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(e)):super.assembleGroup(e)}getCardinalityAggregateForChild(){const e=[],t=[],n=[];if(this.child instanceof Lf){if(this.child.channelHasField("column")){const i=Rs(this.child.facet.column);e.push(i),t.push("distinct"),n.push("distinct_"+i)}}else for(const r of un){const o=this.child.component.scales[r];if(o&&!o.merged){const s=o.get("type"),a=o.get("range");if(_o(s)&&Mr(a)){const o=Wd(Ud(this.child,r));o?(e.push(o),t.push("distinct"),n.push("distinct_"+o)):dr(i.unknownField(r))}}}return{fields:e,ops:t,as:n}}assembleFacet(){const{name:e,data:t}=this.component.data.facetRoot,{row:n,column:i}=this.facet,{fields:r,ops:o,as:s}=this.getCardinalityAggregateForChild(),a=[];for(const e of Mt){const t=this.facet[e];if(t){a.push(Rs(t));const{bin:l,sort:c}=t;if(Tn(l)&&a.push(Rs(t,{binSuffix:"end"})),as(c)){const{field:e,op:a=is}=c,l=Tf(t,c);n&&i?(r.push(l),o.push("max"),s.push(l)):(r.push(e),o.push(a),s.push(l))}else if(g(c)){const n=Zu(t,e);r.push(n),o.push("max"),s.push(n)}}}const l=!!n&&!!i;return Object.assign({name:e,data:t,groupby:a},l||r.length>0?{aggregate:Object.assign(Object.assign({},l?{cross:l}:{}),r.length?{fields:r,ops:o,as:s}:{})}:{})}facetSortFields(e){const{facet:t}=this,n=t[e];return n?as(n.sort)?[Tf(n,n.sort,{expr:"datum"})]:g(n.sort)?[Zu(n,e,{expr:"datum"})]:[Rs(n,{expr:"datum"})]:[]}facetSortOrder(e){const{facet:t}=this,n=t[e];if(n){const{sort:e}=n;return[(as(e)?e.order:!g(e)&&e)||"ascending"]}return[]}assembleLabelTitle(){const{facet:e,config:t}=this;if(e.facet)return uh(e.facet,"facet",t);const n={row:["top","bottom"],column:["left","right"]};for(const i of ih)if(e[i]){const r=th("labelOrient",e[i],t,i);if(K(n[i],r))return uh(e[i],i,t)}}assembleMarks(){const{child:e}=this,t=function(e){const t=[],n=Cf(t);for(const t of e.children)n(t,{source:e.name,name:null,transform:[]});return t}(this.component.data.facetRoot),n=e.assembleGroupEncodeEntry(!1),i=this.assembleLabelTitle()||e.assembleTitle(),r=e.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},i?{title:i}:{}),r?{style:r}:{}),{from:{facet:this.assembleFacet()},sort:{field:Mt.map(e=>this.facetSortFields(e)).flat(),order:Mt.map(e=>this.facetSortOrder(e)).flat()}}),t.length>0?{data:t}:{}),n?{encode:{update:n}}:{}),e.assembleGroup(function(e,t){if(e.component.selection&&ie(e.component.selection).length){const n=$(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:Object(wc.a)("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return gu(t)}(this,[])))]}getMapping(){return this.facet}}function Ff(e,t){var n,i,r,o,s,a,l,c,u,h;for(const d of t){const t=d.data;if((!e.name||!d.hasName()||e.name===d.dataName)&&!((null===(n=e.format)||void 0===n?void 0:n.mesh)&&(null===(i=t.format)||void 0===i?void 0:i.feature)||((null===(r=e.format)||void 0===r?void 0:r.feature)||(null===(o=t.format)||void 0===o?void 0:o.feature))&&(null===(s=e.format)||void 0===s?void 0:s.feature)!==(null===(a=t.format)||void 0===a?void 0:a.feature)||((null===(l=e.format)||void 0===l?void 0:l.mesh)||(null===(c=t.format)||void 0===c?void 0:c.mesh))&&(null===(u=e.format)||void 0===u?void 0:u.mesh)!==(null===(h=t.format)||void 0===h?void 0:h.mesh)))if(Yl(e)&&Yl(t)){if(B(e.values,t.values))return d}else if(Kl(e)&&Kl(t)){if(e.url===t.url)return d}else if(Xl(e)&&e.name===d.dataName)return d}return null}function Nf(e,t){if(e.data||!e.parent){if(null===e.data){const e=new Jh({values:[]});return t.push(e),e}const n=Ff(e.data,t);if(n)return Jl(e.data)||(n.data.format=function(e,...t){for(const n of t)J(e,null!=n?n:{});return e}({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const n=new Jh(e.data);return t.push(n),n}}return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function Pf(e){var t,n,r,o,s,a,l,c,u,h;let d=Nf(e,e.component.data.sources);const{outputNodes:f,outputNodeRefCounts:p}=e.component.data,g=e.parent?e.parent.component.data.ancestorParse.clone():new Gl,m=e.data;Jl(m)?(Ql(m)?d=new Zh(d,m.sequence):ec(m)&&(d=new Qh(d,m.graticule)),g.parseNothing=!0):null===(null===(t=null==m?void 0:m.format)||void 0===t?void 0:t.parse)&&(g.parseNothing=!0),d=null!==(n=ud.makeExplicit(d,e,g))&&void 0!==n?n:d,d=new hd(d);const v=e.parent&&uf(e.parent);(af(e)||lf(e))&&v&&(d=null!==(r=Xh.makeFromEncoding(d,e))&&void 0!==r?r:d),e.transforms.length>0&&(d=function(e,t,n){var r,o;let s=0;for(const a of t.transforms){let l,c=void 0;if(fc(a))l=e=new Qu(e,a),c="derived";else if(nc(a)){const i=ld(a);l=e=null!==(r=ud.makeWithAncestors(e,{},i,n))&&void 0!==r?r:e,e=new Ru(e,t,a.filter)}else if(pc(a))l=e=Xh.makeFromTransform(e,a,t),c="number";else if(mc(a)){c="date";void 0===n.getWithExplicit(a.field).value&&(e=new ud(e,{[a.field]:c}),n.set(a.field,c,!1)),l=e=Jc.makeFromTransform(e,a)}else if(vc(a))l=e=od.makeFromTransform(e,a),c="number",Eu(t)&&(e=new hd(e));else if(ic(a))l=e=xf.make(e,t,a,s++),c="derived";else if(uc(a))l=e=new pd(e,a),c="number";else if(hc(a))l=e=new dd(e,a),c="number";else if(bc(a))l=e=fd.makeFromTransform(e,a),c="derived";else if(yc(a))l=e=new mf(e,a),c="derived";else if(dc(a))l=e=new gf(e,a),c="derived";else if(rc(a))l=e=new Sf(e,a),c="derived";else if(cc(a))e=new Of(e,a);else if(gc(a))l=e=yf.makeFromTransform(e,a),c="derived";else if(oc(a))l=e=new ff(e,a),c="derived";else if(sc(a))l=e=new _f(e,a),c="derived";else if(ac(a))l=e=new kf(e,a),c="derived";else{if(!lc(a)){dr(i.invalidTransformIgnored(a));continue}l=e=new wf(e,a),c="derived"}if(l&&void 0!==c)for(const e of null!==(o=l.producedFields())&&void 0!==o?o:[])n.set(e,c,!1)}return e}(d,e,g));const b=function(e){const t={};if(af(e)&&e.component.selection)for(const n of ie(e.component.selection)){const i=e.component.selection[n];for(const e of i.project.items)!e.channel&&me(e.field)>1&&(t[e.field]="flatten")}return t}(e),y=cd(e);d=null!==(o=ud.makeWithAncestors(d,{},Object.assign(Object.assign({},b),y),g))&&void 0!==o?o:d,af(e)&&(d=vf.parseAll(d,e),d=bf.parseAll(d,e)),(af(e)||lf(e))&&(v||(d=null!==(s=Xh.makeFromEncoding(d,e))&&void 0!==s?s:d),d=null!==(a=Jc.makeFromEncoding(d,e))&&void 0!==a?a:d,d=Qu.parseAllForSortIndex(d,e));const w=e.getDataName(tc.Raw),x=new Xc(d,w,tc.Raw,p);if(f[w]=x,d=x,af(e)){const t=od.makeFromEncoding(d,e);t&&(d=t,Eu(e)&&(d=new hd(d))),d=null!==(l=yf.makeFromEncoding(d,e))&&void 0!==l?l:d,d=null!==(c=fd.makeFromEncoding(d,e))&&void 0!==c?c:d}af(e)&&(d=null!==(u=pf.make(d,e))&&void 0!==u?u:d);const _=e.getDataName(tc.Main),k=new Xc(d,_,tc.Main,p);f[_]=k,d=k,af(e)&&function(e,t){Au(e,n=>{const i=n.name,r=e.getName("lookup_"+i);e.component.data.outputNodes[r]=n.materialized=new Xc(new Ru(t,e,{selection:i}),r,tc.Lookup,e.component.data.outputNodeRefCounts)})}(e,k);let S=null;if(lf(e)){const t=e.getName("facet");d=null!==(h=function(e,t){const{row:n,column:i}=t;if(n&&i){let t=null;for(const r of[n,i])if(as(r.sort)){const{field:n,op:i=is}=r.sort;e=t=new dd(e,{joinaggregate:[{op:i,field:n,as:Tf(r,r.sort,{forAs:!0})}],groupby:[Rs(r)]})}return t}return null}(d,e.facet))&&void 0!==h?h:d,S=new sd(d,e,t,k.getSource()),f[t]=S}return Object.assign(Object.assign({},e.component.data),{outputNodes:f,outputNodeRefCounts:p,raw:x,main:k,facetRoot:S,ancestorParse:g})}class zf extends hf{constructor(e,t,n,r){var o,s,a,l;super(e,"concat",t,n,r,e.resolve),"shared"!==(null===(s=null===(o=e.resolve)||void 0===o?void 0:o.axis)||void 0===s?void 0:s.x)&&"shared"!==(null===(l=null===(a=e.resolve)||void 0===a?void 0:a.axis)||void 0===l?void 0:l.y)||dr(i.CONCAT_CANNOT_SHARE_AXIS),this.children=this.getChildren(e).map((e,t)=>ip(e,this,this.getName("concat_"+t),void 0,r))}parseData(){this.component.data=Pf(this);for(const e of this.children)e.parseData()}parseSelections(){this.component.selection={};for(const e of this.children){e.parseSelections();for(const t of ie(e.component.selection))this.component.selection[t]=e.component.selection[t]}}parseMarkGroup(){for(const e of this.children)e.parseMarkGroup()}parseAxesAndHeaders(){for(const e of this.children)e.parseAxesAndHeaders()}getChildren(e){return Ya(e)?e.vconcat:Xa(e)?e.hconcat:e.concat}parseLayoutSize(){Mf(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(e){return this.children.reduce((e,t)=>t.assembleSelectionTopLevelSignals(e),e)}assembleSignals(){return this.children.forEach(e=>e.assembleSignals()),[]}assembleLayoutSignals(){const e=gh(this);for(const t of this.children)e.push(...t.assembleLayoutSignals());return e}assembleSelectionData(e){return this.children.reduce((e,t)=>t.assembleSelectionData(e),e)}assembleMarks(){return this.children.map(e=>{const t=e.assembleTitle(),n=e.assembleGroupStyle(),i=e.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:e.getName("group")},t?{title:t}:{}),n?{style:n}:{}),i?{encode:{update:i}}:{}),e.assembleGroup())})}assembleDefaultLayout(){const e=this.layout.columns;return Object.assign(Object.assign({},null!=e?{columns:e}:{}),{bounds:"full",align:"each"})}}const If=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},Oe),{labelExpr:1,encode:1}),Bf=ie(If);class Wf extends Bl{constructor(e={},t={},n=!1){super(),this.explicit=e,this.implicit=t,this.mainExtracted=n}clone(){return new Wf(W(this.explicit),W(this.implicit),this.mainExtracted)}hasAxisPart(e){return"axis"===e||("grid"===e||"title"===e?!!this.get(e):!(!1===(t=this.get(e))||null===t));var t}hasOrientSignalRef(){return Er(this.explicit.orient)}}const Uf={bottom:"top",top:"bottom",left:"right",right:"left"};function Hf(e,t){if(!e)return t.map(e=>e.clone());{if(e.length!==t.length)return;const n=e.length;for(let i=0;i<n;i++){const n=e[i],r=t[i];if(!!n!=!!r)return;if(n&&r){const t=n.getWithExplicit("orient"),o=r.getWithExplicit("orient");if(t.explicit&&o.explicit&&t.value!==o.value)return;e[i]=qf(n,r)}}}return e}function qf(e,t){for(const n of Bf){const i=Vl(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(e,t)=>{switch(n){case"title":return da(e,t);case"gridScale":return{explicit:e.explicit,value:ve(e.value,t.value)}}return ql(e,t,n,"axis")});e.setWithExplicit(n,i)}return e}function Vf(e,t,n,i,r){if("disable"===t)return void 0!==n;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(Er(n.labelAngle)?n.labelAngle:ye(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===Ju(i,r))return!0}return e===n[t]}const Gf=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function Kf(e,t){var n,i,r;let o=t.axis(e);const s=new Wf,a=Us(t.encoding[e]),{mark:l,config:c}=t,u=(null==o?void 0:o.orient)||(null===(n=c["x"===e?"axisX":"axisY"])||void 0===n?void 0:n.orient)||(null===(i=c.axis)||void 0===i?void 0:i.orient)||function(e){return"x"===e?"bottom":"left"}(e),h=t.getScaleComponent(e).get("type"),d=Hu(e,h,u,t.config),f=void 0!==o?!o:Vu("disable",c.style,null==o?void 0:o.style,d).configValue;if(s.set("disable",f,void 0!==o),f)return s;o=o||{};const p=function(e,t,n,i,r){const o=null==t?void 0:t.labelAngle;if(void 0!==o)return Er(o)?o:ye(o);{const{configValue:o}=Vu("labelAngle",i,null==t?void 0:t.style,r);return void 0!==o?ye(o):n!==ht||!K([Jr,Yr],e.type)||ys(e)&&e.timeUnit?void 0:270}}(a,o,e,c.style,d),g={fieldOrDatumDef:a,axis:o,channel:e,model:t,scaleType:h,orient:u,labelAngle:p,mark:l,config:c};for(const n of Bf){const i=n in Gu?Gu[n](g):Ae(n)?o[n]:void 0,r=void 0!==i,a=Vf(i,n,o,t,e);if(r&&a)s.set(n,i,a);else{const{configValue:e,configFrom:t}=Ae(n)&&"values"!==n?Vu(n,c.style,o.style,d):{},l=void 0!==e;r&&!l?s.set(n,i,a):("vgAxisConfig"!==t||Gf.has(n)&&l||_e(e)||Er(e))&&s.set(n,e,!1)}}const m=null!==(r=o.encoding)&&void 0!==r?r:{},v=ke.reduce((n,i)=>{var r;if(!s.hasAxisPart(i))return n;const o=wh(null!==(r=m[i])&&void 0!==r?r:{},t),a="labels"===i?function(e,t,n){var i;const{encoding:r,config:o}=e,s=null!==(i=Us(r[t]))&&void 0!==i?i:Us(r[Vt(t)]),a=e.axis(t)||{},{format:l,formatType:c}=a;return Vo(c)?Object.assign({text:Xo({fieldOrDatumDef:s,field:"datum.value",format:l,formatType:c,config:o})},n):n}(t,e,o):o;return void 0===a||ne(a)||(n[i]={update:a}),n},{});return ne(v)||s.set("encode",v,!!o.encoding||void 0!==o.labelAngle),s}function Yf(e,t,n){const r=oa("orient",e,n);if(e.orient=function(e,t,n){switch(e){case Te:case Ie:case Be:case Ne:case Le:case Re:return}const{x:i,y:r,x2:o,y2:s}=t;switch(e){case je:if(ys(i)&&(Ln(i.bin)||ys(r)&&r.aggregate&&!i.aggregate))return"vertical";if(ys(r)&&(Ln(r.bin)||ys(i)&&i.aggregate&&!r.aggregate))return"horizontal";if(s||o){if(n)return n;if(!o&&(ys(i)&&i.type===Kr&&!Tn(i.bin)||ks(i)))return"horizontal";if(!s&&(ys(r)&&r.type===Kr&&!Tn(r.bin)||ks(r)))return"vertical"}case Fe:if(o&&(!ys(i)||!Ln(i.bin))&&s&&(!ys(r)||!Ln(r.bin)))return;case Me:if(s)return ys(r)&&Ln(r.bin)?"horizontal":"vertical";if(o)return ys(i)&&Ln(i.bin)?"vertical":"horizontal";if(e===Fe){if(i&&!r)return"vertical";if(r&&!i)return"horizontal"}case De:case Pe:{const t=_s(i),o=_s(r);if(t&&!o)return"tick"!==e?"horizontal":"vertical";if(!t&&o)return"tick"!==e?"vertical":"horizontal";if(t&&o){const t=i,o=r,s=t.type===Xr,a=o.type===Xr;return s&&!a?"tick"!==e?"vertical":"horizontal":!s&&a?"tick"!==e?"horizontal":"vertical":!t.aggregate&&o.aggregate?"tick"!==e?"vertical":"horizontal":t.aggregate&&!o.aggregate?"tick"!==e?"horizontal":"vertical":n||"vertical"}return n||void 0}}return"vertical"}(e.type,t,r),void 0!==r&&r!==e.orient&&dr(i.orientOverridden(e.orient,r)),"bar"===e.type&&e.orient){const i=oa("cornerRadiusEnd",e,n);if(void 0!==i){const n="horizontal"===e.orient&&t.x2||"vertical"===e.orient&&t.y2?["cornerRadius"]:Ye[e.orient];for(const t of n)e[t]=i;void 0!==e.cornerRadiusEnd&&delete e.cornerRadiusEnd}}void 0===oa("opacity",e,n)&&(e.opacity=function(e,t){if(K([Te,Pe,Ie,Be],e)&&!pa(t))return.7;return}(e.type,t));return void 0===oa("cursor",e,n)&&(e.cursor=function(e,t,n){if(t.href||e.href||oa("href",e,n))return"pointer";return e.cursor}(e,t,n)),e}function Xf(e,t){const{config:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Hc(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),jc("x",e,{defaultPos:"mid"})),jc("y",e,{defaultPos:"mid"})),$c("size",e)),$c("angle",e)),function(e,t,n){if(n)return{shape:{value:n}};return $c("shape",e)}(e,0,t))}function Jf(e){var t;const{config:n,markDef:i}=e,{orient:r}=i,o="horizontal"===r?"width":"height",s=e.getScaleComponent("horizontal"===r?"x":"y"),a=null!==(t=oa("size",i,n,{vgChannel:o}))&&void 0!==t?t:n.tick.bandSize;if(void 0!==a)return a;{const e=s?s.get("range"):void 0;if(e&&Mr(e)&&C(e.step))return 3*e.step/4;return 3*tl(n.view,o)/4}}const Qf={arc:{vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Hc(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),jc("x",e,{defaultPos:"mid"})),jc("y",e,{defaultPos:"mid"})),zc(e,"radius","arc")),zc(e,"theta","arc"))},area:{vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Hc(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),Fc("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===e.markDef.orient})),Fc("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===e.markDef.orient})),Vc(e))},bar:{vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Hc(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),zc(e,"x","bar")),zc(e,"y","bar"))},circle:{vgMark:"symbol",encodeEntry:e=>Xf(e,"circle")},geoshape:{vgMark:"shape",encodeEntry:e=>Object.assign({},Hc(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&ys(n)&&n.type===Qr?{field:Rs(n,{expr:"datum"})}:{})]}},image:{vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Hc(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),zc(e,"x","image")),zc(e,"y","image")),_c(e,"url"))},line:{vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Hc(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),jc("x",e,{defaultPos:"mid"})),jc("y",e,{defaultPos:"mid"})),$c("size",e,{vgChannel:"strokeWidth"})),Vc(e))},point:{vgMark:"symbol",encodeEntry:e=>Xf(e)},rect:{vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Hc(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),zc(e,"x","rect")),zc(e,"y","rect"))},rule:{vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return e.encoding.x||e.encoding.y||e.encoding.latitude||e.encoding.longitude?Object.assign(Object.assign(Object.assign(Object.assign({},Hc(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Fc("x",e,{defaultPos:"horizontal"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==n})),Fc("y",e,{defaultPos:"vertical"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==n})),$c("size",e,{vgChannel:"strokeWidth"})):{}}},square:{vgMark:"symbol",encodeEntry:e=>Xf(e,"square")},text:{vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Hc(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),jc("x",e,{defaultPos:"mid"})),jc("y",e,{defaultPos:"mid"})),_c(e)),$c("size",e,{vgChannel:"fontSize"})),$c("angle",e)),Gc("align",function(e,t,n){if(void 0===oa("align",e,n))return"center";return}(e.markDef,0,t))),Gc("baseline",function(e,t,n){if(void 0===oa("baseline",e,n))return"middle";return}(e.markDef,0,t))),jc("radius",e,{defaultPos:null,isMidPoint:!0})),jc("theta",e,{defaultPos:null,isMidPoint:!0}))}},tick:{vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,i=n.orient,r="horizontal"===i?"width":"height",o="horizontal"===i?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Hc(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),jc("x",e,{defaultPos:"mid",vgChannel:"xc"})),jc("y",e,{defaultPos:"mid",vgChannel:"yc"})),$c("size",e,{defaultValue:Jf(e),vgChannel:r})),{[o]:ta(oa("thickness",n,t))})}},trail:{vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Hc(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),jc("x",e,{defaultPos:"mid"})),jc("y",e,{defaultPos:"mid"})),$c("size",e)),Vc(e))}};function Zf(e){if(K([De,Me,ze],e.mark)){const t=wa(e.mark,e.encoding);if(t.length>0)return function(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:"faceted_path_"+e.requestDataName(tc.Main),data:e.requestDataName(tc.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:ep(e,{fromPrefix:"faceted_path_"})}]}(e,t)}else if(K([je],e.mark)){const t=Tr.some(t=>oa(t,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return function(e){const[t]=ep(e,{fromPrefix:"stack_group_"}),n=e.scaleName(e.stack.fieldChannel),i=(t={})=>e.vgField(e.stack.fieldChannel,t),r=(e,t)=>`${e}(${[i({prefix:"min",suffix:"start",expr:t}),i({prefix:"max",suffix:"start",expr:t}),i({prefix:"min",suffix:"end",expr:t}),i({prefix:"max",suffix:"end",expr:t})].map(e=>`scale('${n}',${e})`).join(",")})`;let o,s;"x"===e.stack.fieldChannel?(o=Object.assign(Object.assign({},U(t.encode.update,["y","yc","y2","height",...Tr])),{x:{signal:r("min","datum")},x2:{signal:r("max","datum")},clip:{value:!0}}),s={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update=Object.assign(Object.assign({},H(t.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(o=Object.assign(Object.assign({},U(t.encode.update,["x","xc","x2","width"])),{y:{signal:r("min","datum")},y2:{signal:r("max","datum")},clip:{value:!0}}),s={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update=Object.assign(Object.assign({},H(t.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const n of Tr){const i=sa(n,e.markDef,e.config);t.encode.update[n]?(o[n]=t.encode.update[n],delete t.encode.update[n]):i&&(o[n]=ta(i)),i&&(t.encode.update[n]={value:0})}const a=e.fieldDef(e.stack.groupbyChannel),l=Rs(a)?[Rs(a)]:[];((null==a?void 0:a.bin)||(null==a?void 0:a.timeUnit))&&l.push(Rs(a,{binSuffix:"end"}));o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((n,i)=>{if(t.encode.update[i])return Object.assign(Object.assign({},n),{[i]:t.encode.update[i]});{const t=sa(i,e.markDef,e.config);return void 0!==t?Object.assign(Object.assign({},n),{[i]:ta(t)}):n}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0});return[{type:"group",from:{facet:{data:e.requestDataName(tc.Main),name:"stack_group_"+e.requestDataName(tc.Main),groupby:l,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:s},marks:[t]}]}]}(e)}return ep(e)}function ep(e,t={fromPrefix:""}){const{mark:n,markDef:i,encoding:r,config:o}=e,s=ve(i.clip,function(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return!!(t&&t.get("selectionExtent")||n&&n.get("selectionExtent"))||void 0}(e),function(e){const t=e.component.projection;return!(!t||t.isFit)||void 0}(e)),a=ra(i),l=r.key,c=function(e){const{encoding:t,stack:n,mark:i,markDef:r,config:o}=e,s=t.order;if(!(!g(s)&&Cs(s)&&G(s.value)||!s&&G(oa("order",r,o)))){if((g(s)||ys(s))&&!n)return ca(s,{expr:"datum"});if(Ue(i)){const n="horizontal"===r.orient?"y":"x",i=t[n];if(ys(i)){const t=i.sort;if(g(t))return{field:Rs(i,{prefix:n,suffix:"sort_index",expr:"datum"})};if(as(t))return{field:Rs({aggregate:pa(e.encoding)?t.op:void 0,field:t.field},{expr:"datum"})};if(ss(t)){return{field:Rs(e.fieldDef(t.encoding),{expr:"datum"}),order:t.order}}return null===t?void 0:{field:Rs(i,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"})}}}else;}}(e),u=function(e){if(!e.component.selection)return null;const t=ie(e.component.selection).length;let n=t,i=e.parent;for(;i&&0===n;)n=ie(i.component.selection).length,i=i.parent;return n?{interactive:t>0}:null}(e),h=oa("aria",i,o),d=Qf[n].postEncodingTransform?Qf[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:Qf[n].vgMark},s?{clip:!0}:{}),a?{style:a}:{}),l?{key:l.field}:{}),c?{sort:c}:{}),u||{}),!1===h?{aria:h}:{}),{from:{data:t.fromPrefix+e.requestDataName(tc.Main)},encode:{update:Qf[n].encodeEntry(e)}}),d?{transform:d}:{})]}class tp extends df{constructor(e,t,n,r={},o){super(e,"unit",t,n,o,void 0,Qa(e)?e.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection={},this.children=[];const s=Ve(e.mark)?Object.assign({},e.mark):{type:e.mark},a=s.type;void 0===s.filled&&(s.filled=function(e,t,{graticule:n}){if(n)return!1;const i=sa("filled",e,t),r=e.type;return ve(i,r!==Te&&r!==De&&r!==Fe)}(s,o,{graticule:e.data&&ec(e.data)}));const l=this.encoding=ma(e.encoding||{},a,s.filled,o);this.markDef=Yf(s,l,o),this.size=function({encoding:e,size:t}){for(const n of un){const r=Gt(n);Ja(t[r])&&_s(e[n])&&(delete t[r],dr(i.stepDropped(r)))}return t}({encoding:l,size:Qa(e)?Object.assign(Object.assign(Object.assign({},r),e.width?{width:e.width}:{}),e.height?{height:e.height}:{}):r}),this.stack=yl(a,l),this.specifiedScales=this.initScales(a,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegend(l),this.specifiedProjection=e.projection,this.selection=e.selection}get hasProjection(){const{encoding:e}=this,t=this.mark===We,n=e&&Ct.some(t=>Ss(e[t]));return t||n}scaleDomain(e){const t=this.specifiedScales[e];return t?t.domain:void 0}axis(e){return this.specifiedAxes[e]}legend(e){return this.specifiedLegends[e]}initScales(e,t){return Cn.reduce((e,n)=>{var i;const r=Us(t[n]);return r&&(e[n]=null!==(i=r.scale)&&void 0!==i?i:{}),e},{})}initAxes(e){return un.reduce((t,n)=>{const i=e[n];if(Ss(i)||n===ht&&Ss(e.x2)||n===dt&&Ss(e.y2)){const e=Ss(i)?i.axis:void 0;t[n]=e?Object.assign({},e):e}return t},{})}initLegend(e){return Sn.reduce((t,n)=>{const i=Us(e[n]);if(i&&function(e){switch(e){case bt:case yt:case wt:case _t:case xt:case"opacity":case"strokeWidth":case"strokeDash":return!0;case"fillOpacity":case"strokeOpacity":case"angle":return!1}}(n)){const e=i.legend;t[n]=e?Object.assign({},e):e}return t},{})}parseData(){this.component.data=Pf(this)}parseLayoutSize(){!function(e){const{size:t,component:n}=e;for(const i of un){const r=Gt(i);if(t[r]){const e=t[r];n.layoutSize.set(r,Ja(e)?"step":e,!0)}else{const t=Df(e,r);n.layoutSize.set(r,t,!1)}}}(this)}parseSelections(){this.component.selection=function(e,t){var n;const i={},r=e.config.selection;for(const o of ie(null!=t?t:{})){const s=W(t[o]),a=r[s.type],{fields:l,encodings:c}=a,u=M(a,["fields","encodings"]);for(const e in u)"encodings"===e&&s.fields||"fields"===e&&s.encodings||("mark"===e&&(s[e]=Object.assign(Object.assign({},u[e]),s[e])),void 0!==s[e]&&!0!==s[e]||(s[e]=null!==(n=u[e])&&void 0!==n?n:s[e]));const h=ae(o),d=i[h]=Object.assign(Object.assign({},s),{name:h,events:A(s.on)?Object(wc.a)(s.on,"scope"):W(s.on)});du(d,n=>{n.has(d)&&n.parse&&n.parse(e,d,s,t[o])})}return i}(this,this.selection)}parseMarkGroup(){this.component.mark=Zf(this)}parseAxesAndHeaders(){var e;this.component.axes=(e=this,un.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[Kf(n,e)]),t),{}))}assembleSelectionTopLevelSignals(e){return function(e,t){let n=!1;if(Au(e,(i,r)=>{const o=i.name,s=$(o+_u);if(0===t.filter(e=>e.name===o).length){const e="global"===i.resolve?"union":i.resolve,n="multi"===i.type?", true)":")";t.push({name:i.name,update:`${Ou}(${s}, ${$(e)}${n}`})}n=!0,r.topLevelSignals&&(t=r.topLevelSignals(e,i,t)),du(i,n=>{n.topLevelSignals&&(t=n.topLevelSignals(e,i,t))})}),n){0===t.filter(e=>"unit"===e.name).length&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]})}return gu(t)}(this,e)}assembleSignals(){return[...Pu(this),...(e=this,t=[],Au(e,(n,i)=>{const r=n.name;let o=i.modifyExpr(e,n);t.push(...i.signals(e,n)),du(n,i=>{i.signals&&(t=i.signals(e,n,t)),i.modifyExpr&&(o=i.modifyExpr(e,n,o))}),t.push({name:r+Su,on:[{events:{signal:n.name+ku},update:`modify(${$(n.name+_u)}, ${o})`}]})}),gu(t))];var e,t}assembleSelectionData(e){return function(e,t){const n=[...t];return Au(e,t=>{const i={name:t.name+_u};if(t.init){const n=t.project.items.map(e=>{const{signals:t}=e;return M(e,["signals"])}),r=t.init.map(e=>fu(e,!1));i.values="interval"===t.type?[{unit:$u(e,{escape:!1}),fields:n,values:r}]:r.map(t=>({unit:$u(e,{escape:!1}),fields:n,values:t}))}n.filter(e=>e.name===t.name+_u).length||n.push(i)}),n}(this,e)}assembleLayout(){return null}assembleLayoutSignals(){return gh(this)}assembleMarks(){var e;let t=null!==(e=this.component.mark)&&void 0!==e?e:[];return this.parent&&uf(this.parent)||(t=pu(this,t)),t.map(this.correctDataNames)}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(e){return fa(this.encoding,e)}fieldDef(e){return Ws(this.encoding[e])}typedFieldDef(e){const t=this.fieldDef(e);return Os(t)?t:null}}class np extends hf{constructor(e,t,n,r,o){super(e,"layer",t,n,o,e.resolve,e.view);const s=Object.assign(Object.assign(Object.assign({},r),e.width?{width:e.width}:{}),e.height?{height:e.height}:{});this.children=e.layer.map((e,t)=>{if(pl(e))return new np(e,this,this.getName("layer_"+t),s,o);if(Qe(e))return new tp(e,this,this.getName("layer_"+t),s,o);throw new Error(i.invalidSpec(e))})}parseData(){this.component.data=Pf(this);for(const e of this.children)e.parseData()}parseLayoutSize(){var e;jf(e=this),Rf(e,"width"),Rf(e,"height")}parseSelections(){this.component.selection={};for(const e of this.children){e.parseSelections();for(const t of ie(e.component.selection))this.component.selection[t]=e.component.selection[t]}}parseMarkGroup(){for(const e of this.children)e.parseMarkGroup()}parseAxesAndHeaders(){!function(e){var t;const{axes:n,resolve:i}=e.component,r={top:0,bottom:0,right:0,left:0};for(const t of e.children){t.parseAxesAndHeaders();for(const r of ie(t.component.axes))i.axis[r]=_h(e.component.resolve,r),"shared"===i.axis[r]&&(n[r]=Hf(n[r],t.component.axes[r]),n[r]||(i.axis[r]="independent",delete n[r]))}for(const o of un){for(const s of e.children)if(s.component.axes[o]){if("independent"===i.axis[o]){n[o]=(null!==(t=n[o])&&void 0!==t?t:[]).concat(s.component.axes[o]);for(const e of s.component.axes[o]){const{value:t,explicit:n}=e.getWithExplicit("orient");if(!Er(t)){if(r[t]>0&&!n){const n=Uf[t];r[t]>r[n]&&e.set("orient",n,!1)}r[t]++}}}delete s.component.axes[o]}if("independent"===i.axis[o]&&n[o]&&n[o].length>1)for(const e of n[o])e.get("grid")&&!e.explicit.grid&&(e.implicit.grid=!1)}}(this)}assembleSelectionTopLevelSignals(e){return this.children.reduce((e,t)=>t.assembleSelectionTopLevelSignals(e),e)}assembleSignals(){return this.children.reduce((e,t)=>e.concat(t.assembleSignals()),Pu(this))}assembleLayoutSignals(){return this.children.reduce((e,t)=>e.concat(t.assembleLayoutSignals()),gh(this))}assembleSelectionData(e){return this.children.reduce((e,t)=>t.assembleSelectionData(e),e)}assembleTitle(){let e=super.assembleTitle();if(e)return e;for(const t of this.children)if(e=t.assembleTitle(),e)return e}assembleLayout(){return null}assembleMarks(){return function(e,t){for(const n of e.children)af(n)&&(t=pu(n,t));return t}(this,this.children.flatMap(e=>e.assembleMarks()))}assembleLegends(){return this.children.reduce((e,t)=>e.concat(t.assembleLegends()),Bh(this))}}function ip(e,t,n,r,o){if(hs(e))return new Lf(e,t,n,o);if(pl(e))return new np(e,t,n,r,o);if(Qe(e))return new tp(e,t,n,r,o);if(function(e){return Ya(e)||Xa(e)||Ka(e)}(e))return new zf(e,t,n,o);throw new Error(i.invalidSpec(e))}function rp(e,t={}){var n;t.logger&&(n=t.logger,ur=n),t.fieldTitle&&Ns(t.fieldTitle);try{const n=ll(b(t.config,e.config)),r=Fl(e,n),o=ip(r,null,"",void 0,n);o.parse(),function(e,t){$d(e.sources);let n=0,i=0;for(let i=0;i<5&&Rd(e,t,!0);i++)n++;e.sources.map(wd);for(let n=0;n<5&&Rd(e,t,!1);n++)i++;$d(e.sources),5===Math.max(n,i)&&dr("Maximum optimization runs(5) reached.")}(o.component.data,o);return{spec:function(e,t,n={},i){const r=e.config?dl(e.config):void 0,o=[].concat(e.assembleSelectionData([]),function(e,t){var n,i;const r=[],o=Cf(r);let s=0;for(const t of e.sources){t.hasName()||(t.dataName="source_"+s++);const e=t.assemble();o(t,e)}for(const e of r)0===e.transform.length&&delete e.transform;let a=0;for(const[e,t]of r.entries())0!==(null!==(n=t.transform)&&void 0!==n?n:[]).length||t.source||r.splice(a++,0,r.splice(e,1)[0]);for(const t of r)for(const n of null!==(i=t.transform)&&void 0!==i?i:[])"lookup"===n.type&&(n.from=e.outputNodes[n.from].getSource());for(const e of r)e.name in t&&(e.values=t[e.name]);return r}(e.component.data,n)),s=e.assembleProjections(),a=e.assembleTitle(),l=e.assembleGroupStyle(),c=e.assembleGroupEncodeEntry(!0);let u=e.assembleLayoutSignals();return u=u.filter(e=>"width"!==e.name&&"height"!==e.name||void 0===e.value||(t[e.name]=+e.value,!1)),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),t),a?{title:a}:{}),l?{style:l}:{}),c?{encode:{update:c}}:{}),{data:o}),s.length>0?{projections:s}:{}),e.assembleGroup([...u,...e.assembleSelectionTopLevelSignals([])])),r?{config:r}:{}),i?{usermeta:i}:{})}(o,function(e,t,n,r){const o=r.component.layoutSize.get("width"),s=r.component.layoutSize.get("height");void 0===t?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):A(t)&&(t={type:t});if(o&&s&&(a=t.type,"fit"===a||"fit-x"===a||"fit-y"===a))if("step"===o&&"step"===s)dr(i.droppingFit()),t.type="pad";else if("step"===o||"step"===s){const e="step"===o?"width":"height";dr(i.droppingFit(pn(e)));const n="width"===e?"height":"width";t.type=function(e){return e?"fit-"+pn(e):"fit"}(n)}var a;return Object.assign(Object.assign(Object.assign({},1===ie(t).length&&t.type?"pad"===t.type?{}:{autosize:t.type}:{autosize:t}),Il(n)),Il(e))}(e,r.autosize,n,o),e.datasets,e.usermeta),normalized:r}}finally{t.logger&&hr(),t.fieldTitle&&Ns(Ls)}}n.d(t,"compile",(function(){return rp})),n.d(t,"normalize",(function(){return Fl})),n.d(t,"version",(function(){return r.a}))},function(e,t,n){"use strict";n.r(t);var i=n(63);var r={background:"#333",title:{color:"#fff"},style:{"guide-label":{fill:"#fff"},"guide-title":{fill:"#fff"}},axis:{domainColor:"#fff",gridColor:"#888",tickColor:"#fff"}};var o={background:"#fff",arc:{fill:"#4572a7"},area:{fill:"#4572a7"},line:{stroke:"#4572a7",strokeWidth:2},path:{stroke:"#4572a7"},rect:{fill:"#4572a7"},shape:{stroke:"#4572a7"},symbol:{fill:"#4572a7",strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}};var s={arc:{fill:"#30a2da"},area:{fill:"#30a2da"},axis:{domainColor:"#cbcbcb",grid:!0,gridColor:"#cbcbcb",gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:"#cbcbcb",tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:"#f0f0f0",group:{fill:"#f0f0f0"},legend:{labelColor:"#333",labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:"#333",titleFontSize:14,titlePadding:10},line:{stroke:"#30a2da",strokeWidth:2},path:{stroke:"#30a2da",strokeWidth:.5},rect:{fill:"#30a2da"},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:"#30a2da"},bar:{binSpacing:2,fill:"#30a2da",stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}};var a={group:{fill:"#e5e5e5"},arc:{fill:"#000"},area:{fill:"#000"},line:{stroke:"#000"},path:{stroke:"#000"},rect:{fill:"#000"},shape:{stroke:"#000"},symbol:{fill:"#000",size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}};const l="Benton Gothic Bold, sans-serif",c={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]};var u={background:"#ffffff",title:{anchor:"start",color:"#000000",font:l,fontSize:22,fontWeight:"normal"},arc:{fill:"#82c6df"},area:{fill:"#82c6df"},line:{stroke:"#82c6df",strokeWidth:2},path:{stroke:"#82c6df"},rect:{fill:"#82c6df"},shape:{stroke:"#82c6df"},symbol:{fill:"#82c6df",size:30},axis:{labelFont:"Benton Gothic, sans-serif",labelFontSize:11.5,labelFontWeight:"normal",titleFont:l,titleFontSize:13,titleFontWeight:"normal"},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:"Benton Gothic, sans-serif",labelFontSize:11.5,symbolType:"square",titleFont:l,titleFontSize:13,titleFontWeight:"normal"},range:{category:c["category-6"],diverging:c["fireandice-6"],heatmap:c["fire-7"],ordinal:c["fire-7"],ramp:c["fire-7"]}};var h={background:"#f9f9f9",arc:{fill:"#ab5787"},area:{fill:"#ab5787"},line:{stroke:"#ab5787"},path:{stroke:"#ab5787"},rect:{fill:"#ab5787"},shape:{stroke:"#ab5787"},symbol:{fill:"#ab5787",size:30},axis:{domainColor:"#979797",domainWidth:.5,gridWidth:.2,labelColor:"#979797",tickColor:"#979797",tickWidth:.2,titleColor:"#979797"},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}};var d={background:"#fff",arc:{fill:"#3e5c69"},area:{fill:"#3e5c69"},line:{stroke:"#3e5c69"},path:{stroke:"#3e5c69"},rect:{fill:"#3e5c69"},shape:{stroke:"#3e5c69"},symbol:{fill:"#3e5c69"},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}};const f={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]};var p={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:"Lato"},axisX:{domain:!0,domainColor:"#000000",domainWidth:1,grid:!1,labelFontSize:12,labelFont:"Lato",labelAngle:0,tickColor:"#000000",tickSize:5,titleFontSize:12,titlePadding:10,titleFont:"Lato"},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:"Lato",labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:"Lato",titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:"Lato",symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:"Lato",orient:"right",offset:10},view:{stroke:"transparent"},range:{category:f["six-groups-cat-1"],diverging:f["diverging-colors"],heatmap:f["diverging-colors"],ordinal:f["six-groups-seq"],ramp:f["shades-blue"]},area:{fill:"#1696d2"},rect:{fill:"#1696d2"},line:{color:"#1696d2",stroke:"#1696d2",strokeWidth:5},trail:{color:"#1696d2",stroke:"#1696d2",strokeWidth:0,size:1},path:{stroke:"#1696d2",strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:"#1696d2",fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:"#1696d2",stroke:null}},arc:{fill:"#1696d2"},shape:{stroke:"#1696d2"},symbol:{fill:"#1696d2",size:30}};var g={arc:{fill:"#3366CC"},area:{fill:"#3366CC"},path:{stroke:"#3366CC"},rect:{fill:"#3366CC"},shape:{stroke:"#3366CC"},symbol:{stroke:"#3366CC"},circle:{fill:"#3366CC"},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:"Arial, sans-serif",fontSize:12},"guide-title":{font:"Arial, sans-serif",fontSize:12},"group-title":{font:"Arial, sans-serif",fontSize:12}},title:{font:"Arial, sans-serif",fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:"#ccc",tickColor:"#ccc",domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}};n.d(t,"version",(function(){return m})),n.d(t,"dark",(function(){return r})),n.d(t,"excel",(function(){return o})),n.d(t,"fivethirtyeight",(function(){return s})),n.d(t,"ggplot2",(function(){return a})),n.d(t,"latimes",(function(){return u})),n.d(t,"quartz",(function(){return h})),n.d(t,"vox",(function(){return d})),n.d(t,"urbaninstitute",(function(){return p})),n.d(t,"googlecharts",(function(){return g}));const m=i.version},function(e,t,n){"use strict";var i=n(64),r="#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black; }\n  #vg-tooltip-element.visible {\n    visibility: visible; }\n  #vg-tooltip-element h2 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 13px; }\n  #vg-tooltip-element img {\n    max-width: 200px;\n    max-height: 200px; }\n  #vg-tooltip-element table {\n    border-spacing: 0; }\n    #vg-tooltip-element table tr {\n      border: none; }\n      #vg-tooltip-element table tr td {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        padding-top: 2px;\n        padding-bottom: 2px; }\n        #vg-tooltip-element table tr td.key {\n          color: #808080;\n          max-width: 150px;\n          text-align: right;\n          padding-right: 4px; }\n        #vg-tooltip-element table tr td.value {\n          display: block;\n          max-width: 300px;\n          max-height: 7em;\n          text-align: left; }\n  #vg-tooltip-element.dark-theme {\n    background-color: rgba(32, 32, 32, 0.9);\n    border: 1px solid #f5f5f5;\n    color: white; }\n    #vg-tooltip-element.dark-theme td.key {\n      color: #bfbfbf; }\n";const o="vg-tooltip-element",s={offsetX:10,offsetY:10,id:o,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2};var a=n(0),l=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function c(e,t){return JSON.stringify(e,function(e){const t=[];return function(n,i){if("object"!=typeof i||null===i)return i;const r=t.indexOf(this)+1;return t.length=r,t.length>e?"[Object]":t.indexOf(i)>=0?"[Circular]":(t.push(i),i)}}(t))}class u{constructor(e){this.options=Object.assign(Object.assign({},s),e);const t=this.options.id;if(this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const e=document.createElement("style");e.setAttribute("id",this.options.styleId),e.innerHTML=function(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return r.toString().replace(o,e)}(t);const n=document.head;n.childNodes.length>0?n.insertBefore(e,n.childNodes[0]):n.appendChild(e)}this.el=document.getElementById(t),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",t),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el))}tooltipHandler(e,t,n,i){if(null==i||""===i)return void this.el.classList.remove("visible",this.options.theme+"-theme");this.el.innerHTML=function(e,t,n){if(Object(a.B)(e))return`[${e.map(e=>t(Object(a.I)(e)?e:c(e,n))).join(", ")}]`;if(Object(a.G)(e)){let i="";const r=e,{title:o,image:s}=r,u=l(r,["title","image"]);o&&(i+=`<h2>${t(o)}</h2>`),s&&(i+=`<img src="${t(s)}">`);const h=Object.keys(u);if(h.length>0){i+="<table>";for(const e of h){let r=u[e];void 0!==r&&(Object(a.G)(r)&&(r=c(r,n)),i+=`<tr><td class="key">${t(e)}:</td><td class="value">${t(r)}</td></tr>`)}i+="</table>"}return i||"{}"}return t(e)}(i,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",this.options.theme+"-theme");const{x:r,y:o}=function(e,t,n,i){let r=e.clientX+n;r+t.width>window.innerWidth&&(r=+e.clientX-n-t.width);let o=e.clientY+i;return o+t.height>window.innerHeight&&(o=+e.clientY-i-t.height),{x:r,y:o}}(t,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${o}px; left: ${r}px`)}}n.d(t,"a",(function(){return u}));i.version},function(e,t,n){"use strict";var i={};n.r(i),n.d(i,"JsonPatchError",(function(){return m})),n.d(i,"deepClone",(function(){return v})),n.d(i,"getValueByPointer",(function(){return w})),n.d(i,"applyOperation",(function(){return x})),n.d(i,"applyPatch",(function(){return _})),n.d(i,"applyReducer",(function(){return k})),n.d(i,"validator",(function(){return S})),n.d(i,"validate",(function(){return O})),n.d(i,"_areEquals",(function(){return C}));var r={};n.r(r),n.d(r,"unobserve",(function(){return M})),n.d(r,"observe",(function(){return j})),n.d(r,"generate",(function(){return R})),n.d(r,"compare",(function(){return T}));var o,s=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=Object.prototype.hasOwnProperty;function l(e,t){return a.call(e,t)}function c(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);t=[];for(var i in e)l(e,i)&&t.push(i);return t}function u(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function h(e){for(var t,n=0,i=e.length;n<i;){if(!((t=e.charCodeAt(n))>=48&&t<=57))return!1;n++}return!0}function d(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function f(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function p(e,t){var n=[e];for(var i in t){var r="object"==typeof t[i]?JSON.stringify(t[i],null,2):t[i];void 0!==r&&n.push(i+": "+r)}return n.join("\n")}var g=function(e){function t(t,n,i,r,o){var s=this.constructor,a=e.call(this,p(t,{name:n,index:i,operation:r,tree:o}))||this;return a.name=n,a.index=i,a.operation=r,a.tree=o,Object.setPrototypeOf(a,s.prototype),a.message=p(t,{name:n,index:i,operation:r,tree:o}),a}return s(t,e),t}(Error),m=g,v=u,b={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var i=e[t];return delete e[t],{newDocument:n,removed:i}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:function(e,t,n){var i=w(n,this.path);i&&(i=u(i));var r=x(n,{op:"remove",path:this.from}).removed;return x(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(e,t,n){var i=w(n,this.from);return x(n,{op:"add",path:this.path,value:u(i)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:C(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},y={add:function(e,t,n){return h(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:b.move,copy:b.copy,test:b.test,_get:b._get};function w(e,t){if(""==t)return e;var n={op:"_get",path:t};return x(e,n),n.value}function x(e,t,n,i,r,o){if(void 0===n&&(n=!1),void 0===i&&(i=!0),void 0===r&&(r=!0),void 0===o&&(o=0),n&&("function"==typeof n?n(t,0,e,t.path):S(t,0)),""===t.path){var s={newDocument:e};if("add"===t.op)return s.newDocument=t.value,s;if("replace"===t.op)return s.newDocument=t.value,s.removed=e,s;if("move"===t.op||"copy"===t.op)return s.newDocument=w(e,t.from),"move"===t.op&&(s.removed=e),s;if("test"===t.op){if(s.test=C(e,t.value),!1===s.test)throw new m("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s.newDocument=e,s}if("remove"===t.op)return s.removed=e,s.newDocument=null,s;if("_get"===t.op)return t.value=e,s;if(n)throw new m("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e);return s}i||(e=u(e));var a=(t.path||"").split("/"),l=e,c=1,d=a.length,p=void 0,g=void 0,v=void 0;for(v="function"==typeof n?n:S;;){if(g=a[c],r&&"__proto__"==g)throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===p&&(void 0===l[g]?p=a.slice(0,c).join("/"):c==d-1&&(p=t.path),void 0!==p&&v(t,0,e,p)),c++,Array.isArray(l)){if("-"===g)g=l.length;else{if(n&&!h(g))throw new m("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);h(g)&&(g=~~g)}if(c>=d){if(n&&"add"===t.op&&g>l.length)throw new m("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);if(!1===(s=y[t.op].call(t,l,g,e)).test)throw new m("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s}}else if(g&&-1!=g.indexOf("~")&&(g=f(g)),c>=d){if(!1===(s=b[t.op].call(t,l,g,e)).test)throw new m("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s}l=l[g]}}function _(e,t,n,i,r){if(void 0===i&&(i=!0),void 0===r&&(r=!0),n&&!Array.isArray(t))throw new m("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(e=u(e));for(var o=new Array(t.length),s=0,a=t.length;s<a;s++)o[s]=x(e,t[s],n,!0,r,s),e=o[s].newDocument;return o.newDocument=e,o}function k(e,t,n){var i=x(e,t);if(!1===i.test)throw new m("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function S(e,t,n,i){if("object"!=typeof e||null===e||Array.isArray(e))throw new m("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!b[e.op])throw new m("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!=typeof e.path)throw new m("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new m('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new m("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new m("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&function e(t){if(void 0===t)return!0;if(t)if(Array.isArray(t)){for(var n=0,i=t.length;n<i;n++)if(e(t[n]))return!0}else if("object"==typeof t){var r=c(t),o=r.length;for(n=0;n<o;n++)if(e(t[r[n]]))return!0}return!1}(e.value))throw new m("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var r=e.path.split("/").length,o=i.split("/").length;if(r!==o+1&&r!==o)throw new m("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==i)throw new m("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var s=O([{op:"_get",path:e.from,value:void 0}],n);if(s&&"OPERATION_PATH_UNRESOLVABLE"===s.name)throw new m("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function O(e,t,n){try{if(!Array.isArray(e))throw new m("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)_(u(t),u(e),n||!0);else{n=n||S;for(var i=0;i<e.length;i++)n(e[i],i,t,void 0)}}catch(e){if(e instanceof m)return e;throw e}}function C(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n,i,r,o=Array.isArray(e),s=Array.isArray(t);if(o&&s){if((i=e.length)!=t.length)return!1;for(n=i;0!=n--;)if(!C(e[n],t[n]))return!1;return!0}if(o!=s)return!1;var a=Object.keys(e);if((i=a.length)!==Object.keys(t).length)return!1;for(n=i;0!=n--;)if(!t.hasOwnProperty(a[n]))return!1;for(n=i;0!=n--;)if(!C(e[r=a[n]],t[r]))return!1;return!0}return e!=e&&t!=t}var A=new WeakMap,$=function(e){this.observers=new Map,this.obj=e},E=function(e,t){this.callback=e,this.observer=t};function M(e,t){t.unobserve()}function j(e,t){var n,i=function(e){return A.get(e)}(e);if(i){var r=function(e,t){return e.observers.get(t)}(i,t);n=r&&r.observer}else i=new $(e),A.set(e,i);if(n)return n;if(n={},i.value=u(e),t){n.callback=t,n.next=null;var o=function(){R(n)},s=function(){clearTimeout(n.next),n.next=setTimeout(o)};"undefined"!=typeof window&&(window.addEventListener("mouseup",s),window.addEventListener("keyup",s),window.addEventListener("mousedown",s),window.addEventListener("keydown",s),window.addEventListener("change",s))}return n.patches=[],n.object=e,n.unobserve=function(){R(n),clearTimeout(n.next),function(e,t){e.observers.delete(t.callback)}(i,n),"undefined"!=typeof window&&(window.removeEventListener("mouseup",s),window.removeEventListener("keyup",s),window.removeEventListener("mousedown",s),window.removeEventListener("keydown",s),window.removeEventListener("change",s))},i.observers.set(t,new E(t,n)),n}function R(e,t){void 0===t&&(t=!1);var n=A.get(e.object);D(n.value,e.object,e.patches,"",t),e.patches.length&&_(n.value,e.patches);var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function D(e,t,n,i,r){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var o=c(t),s=c(e),a=!1,h=s.length-1;h>=0;h--){var f=e[g=s[h]];if(!l(t,g)||void 0===t[g]&&void 0!==f&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(r&&n.push({op:"test",path:i+"/"+d(g),value:u(f)}),n.push({op:"remove",path:i+"/"+d(g)}),a=!0):(r&&n.push({op:"test",path:i,value:e}),n.push({op:"replace",path:i,value:t}),!0);else{var p=t[g];"object"==typeof f&&null!=f&&"object"==typeof p&&null!=p?D(f,p,n,i+"/"+d(g),r):f!==p&&(!0,r&&n.push({op:"test",path:i+"/"+d(g),value:u(f)}),n.push({op:"replace",path:i+"/"+d(g),value:u(p)}))}}if(a||o.length!=s.length)for(h=0;h<o.length;h++){var g;l(e,g=o[h])||void 0===t[g]||n.push({op:"add",path:i+"/"+d(g),value:u(t[g])})}}}function T(e,t,n){void 0===n&&(n=!1);var i=[];return D(e,t,i,"",n),i}n.d(t,"a",(function(){return _}));Object.assign({},i,r,{JsonPatchError:g,deepClone:u,escapePathComponent:d,unescapePathComponent:f})},,,function(e,t,n){"use strict";var i=n(75);function r(){}function o(){}o.resetWarningCache=r,e.exports=function(){function e(e,t,n,r,o,s){if(s!==i){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:r};return n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t){var n,i,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var l,c=[],u=!1,h=-1;function d(){u&&l&&(u=!1,l.length?c=l.concat(c):h=-1,c.length&&f())}function f(){if(!u){var e=a(d);u=!0;for(var t=c.length;t;){for(l=c,c=[];++h<t;)l&&l[h].run();h=-1,t=c.length}l=null,u=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||u||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,n){const i=n(14);e.exports=(e,t)=>{const n=i(e,t);return n?n.version:null}},function(e,t,n){const i=n(14);e.exports=(e,t)=>{const n=i(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null}},function(e,t,n){const i=n(5);e.exports=(e,t,n,r)=>{"string"==typeof n&&(r=n,n=void 0);try{return new i(e,n).inc(t,r).version}catch(e){return null}}},function(e,t,n){const i=n(14),r=n(36);e.exports=(e,t)=>{if(r(e,t))return null;{const n=i(e),r=i(t),o=n.prerelease.length||r.prerelease.length,s=o?"pre":"",a=o?"prerelease":"";for(const e in n)if(("major"===e||"minor"===e||"patch"===e)&&n[e]!==r[e])return s+e;return a}}},function(e,t,n){const i=n(5);e.exports=(e,t)=>new i(e,t).major},function(e,t,n){const i=n(5);e.exports=(e,t)=>new i(e,t).minor},function(e,t,n){const i=n(5);e.exports=(e,t)=>new i(e,t).patch},function(e,t,n){const i=n(14);e.exports=(e,t)=>{const n=i(e,t);return n&&n.prerelease.length?n.prerelease:null}},function(e,t,n){const i=n(7);e.exports=(e,t,n)=>i(t,e,n)},function(e,t,n){const i=n(7);e.exports=(e,t)=>i(e,t,!0)},function(e,t,n){const i=n(37);e.exports=(e,t)=>e.sort((e,n)=>i(e,n,t))},function(e,t,n){const i=n(37);e.exports=(e,t)=>e.sort((e,n)=>i(n,e,t))},function(e,t,n){const i=n(5),r=n(14),{re:o,t:s}=n(13);e.exports=(e,t)=>{if(e instanceof i)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let n=null;if((t=t||{}).rtl){let t;for(;(t=o[s.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&t.index+t[0].length===n.index+n[0].length||(n=t),o[s.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;o[s.COERCERTL].lastIndex=-1}else n=e.match(o[s.COERCE]);return null===n?null:r(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,t)}},function(e,t,n){const i=n(8);e.exports=(e,t)=>new i(e,t).set.map(e=>e.map(e=>e.value).join(" ").trim().split(" "))},function(e,t,n){const i=n(5),r=n(8);e.exports=(e,t,n)=>{let o=null,s=null,a=null;try{a=new r(t,n)}catch(e){return null}return e.forEach(e=>{a.test(e)&&(o&&-1!==s.compare(e)||(o=e,s=new i(o,n)))}),o}},function(e,t,n){const i=n(5),r=n(8);e.exports=(e,t,n)=>{let o=null,s=null,a=null;try{a=new r(t,n)}catch(e){return null}return e.forEach(e=>{a.test(e)&&(o&&1!==s.compare(e)||(o=e,s=new i(o,n)))}),o}},function(e,t,n){const i=n(5),r=n(8),o=n(20);e.exports=(e,t)=>{e=new r(e,t);let n=new i("0.0.0");if(e.test(n))return n;if(n=new i("0.0.0-0"),e.test(n))return n;n=null;for(let t=0;t<e.set.length;++t){e.set[t].forEach(e=>{const t=new i(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":n&&!o(n,t)||(n=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}})}return n&&e.test(n)?n:null}},function(e,t,n){const i=n(8);e.exports=(e,t)=>{try{return new i(e,t).range||"*"}catch(e){return null}}},function(e,t,n){const i=n(41);e.exports=(e,t,n)=>i(e,t,">",n)},function(e,t,n){const i=n(41);e.exports=(e,t,n)=>i(e,t,"<",n)},function(e,t,n){const i=n(8);e.exports=(e,t,n)=>(e=new i(e,n),t=new i(t,n),e.intersects(t))},function(e,t,n){const i=n(22),r=n(7);e.exports=(e,t,n)=>{const o=[];let s=null,a=null;const l=e.sort((e,t)=>r(e,t,n));for(const e of l){i(e,t,n)?(a=e,s||(s=e)):(a&&o.push([s,a]),a=null,s=null)}s&&o.push([s,null]);const c=[];for(const[e,t]of o)e===t?c.push(e):t||e!==l[0]?t?e===l[0]?c.push("<="+t):c.push(`${e} - ${t}`):c.push(">="+e):c.push("*");const u=c.join(" || "),h="string"==typeof t.raw?t.raw:String(t);return u.length<h.length?u:t}},function(e,t,n){const i=n(8),{ANY:r}=n(21),o=n(22),s=n(7),a=(e,t,n)=>{if(1===e.length&&e[0].semver===r)return 1===t.length&&t[0].semver===r;const i=new Set;let a,u,h,d,f,p,g;for(const t of e)">"===t.operator||">="===t.operator?a=l(a,t,n):"<"===t.operator||"<="===t.operator?u=c(u,t,n):i.add(t.semver);if(i.size>1)return null;if(a&&u){if(h=s(a.semver,u.semver,n),h>0)return null;if(0===h&&(">="!==a.operator||"<="!==u.operator))return null}for(const e of i){if(a&&!o(e,String(a),n))return null;if(u&&!o(e,String(u),n))return null;for(const i of t)if(!o(e,String(i),n))return!1;return!0}for(const e of t){if(g=g||">"===e.operator||">="===e.operator,p=p||"<"===e.operator||"<="===e.operator,a)if(">"===e.operator||">="===e.operator){if(d=l(a,e,n),d===e)return!1}else if(">="===a.operator&&!o(a.semver,String(e),n))return!1;if(u)if("<"===e.operator||"<="===e.operator){if(f=c(u,e,n),f===e)return!1}else if("<="===u.operator&&!o(u.semver,String(e),n))return!1;if(!e.operator&&(u||a)&&0!==h)return!1}return!(a&&p&&!u&&0!==h)&&!(u&&g&&!a&&0!==h)},l=(e,t,n)=>{if(!e)return t;const i=s(e.semver,t.semver,n);return i>0?e:i<0||">"===t.operator&&">="===e.operator?t:e},c=(e,t,n)=>{if(!e)return t;const i=s(e.semver,t.semver,n);return i<0?e:i>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,n)=>{e=new i(e,n),t=new i(t,n);let r=!1;e:for(const i of e.set){for(const e of t.set){const t=a(i,e,n);if(r=r||null!==t,t)continue e}if(r)return!1}return!0}},function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],i=t[1];return 3*(n+i)/4-i},t.toByteArray=function(e){var t,n,i=c(e),s=i[0],a=i[1],l=new o(function(e,t,n){return 3*(t+n)/4-n}(0,s,a)),u=0,h=a>0?s-4:s;for(n=0;n<h;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;2===a&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,l[u++]=255&t);1===a&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t);return l},t.fromByteArray=function(e){for(var t,n=e.length,r=n%3,o=[],s=0,a=n-r;s<a;s+=16383)o.push(u(e,s,s+16383>a?a:s+16383));1===r?(t=e[n-1],o.push(i[t>>2]+i[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],o.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"="));return o.join("")};for(var i=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,l=s.length;a<l;++a)i[a]=s[a],r[s.charCodeAt(a)]=a;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function u(e,t,n){for(var r,o,s=[],a=t;a<n;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(i[(o=r)>>18&63]+i[o>>12&63]+i[o>>6&63]+i[63&o]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,i,r){var o,s,a=8*r-i-1,l=(1<<a)-1,c=l>>1,u=-7,h=n?r-1:0,d=n?-1:1,f=e[t+h];for(h+=d,o=f&(1<<-u)-1,f>>=-u,u+=a;u>0;o=256*o+e[t+h],h+=d,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=i;u>0;s=256*s+e[t+h],h+=d,u-=8);if(0===o)o=1-c;else{if(o===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,i),o-=c}return(f?-1:1)*s*Math.pow(2,o-i)},t.write=function(e,t,n,i,r,o){var s,a,l,c=8*o-r-1,u=(1<<c)-1,h=u>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:o-1,p=i?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=u?(a=0,s=u):s+h>=1?(a=(t*l-1)*Math.pow(2,r),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,r),s=0));r>=8;e[n+f]=255&a,f+=p,a/=256,r-=8);for(s=s<<r|a,c+=r;c>0;e[n+f]=255&s,f+=p,s/=256,c-=8);e[n+f-p]|=128*g}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(11),a=n(2),l=n(55),c=n(56),u=c.getAceInstance(),h=u.require("ace/range").Range,d=function(e){function t(t){var n=e.call(this,t)||this;return c.editorEvents.forEach((function(e){n[e]=n[e].bind(n)})),n.debounce=c.debounce,n}return r(t,e),t.prototype.isInShadow=function(e){for(var t=e&&e.parentNode;t;){if("[object ShadowRoot]"===t.toString())return!0;t=t.parentNode}return!1},t.prototype.componentDidMount=function(){var e=this,t=this.props,n=t.className,i=t.onBeforeLoad,r=t.onValidate,o=t.mode,s=t.focus,a=t.theme,l=t.fontSize,h=t.value,d=t.defaultValue,f=t.showGutter,p=t.wrapEnabled,g=t.showPrintMargin,m=t.scrollMargin,v=void 0===m?[0,0,0,0]:m,b=t.keyboardHandler,y=t.onLoad,w=t.commands,x=t.annotations,_=t.markers,k=t.placeholder;this.editor=u.edit(this.refEditor),i&&i(u);for(var S=Object.keys(this.props.editorProps),O=0;O<S.length;O++)this.editor[S[O]]=this.props.editorProps[S[O]];this.props.debounceChangePeriod&&(this.onChange=this.debounce(this.onChange,this.props.debounceChangePeriod)),this.editor.renderer.setScrollMargin(v[0],v[1],v[2],v[3]),this.isInShadow(this.refEditor)&&this.editor.renderer.attachToShadowRoot(),this.editor.getSession().setMode("ace/mode/"+o),this.editor.setTheme("ace/theme/"+a),this.editor.setFontSize("number"==typeof l?l+"px":l),this.editor.getSession().setValue(d||(h||"")),this.props.navigateToFileEnd&&this.editor.navigateFileEnd(),this.editor.renderer.setShowGutter(f),this.editor.getSession().setUseWrapMode(p),this.editor.setShowPrintMargin(g),this.editor.on("focus",this.onFocus),this.editor.on("blur",this.onBlur),this.editor.on("copy",this.onCopy),this.editor.on("paste",this.onPaste),this.editor.on("change",this.onChange),this.editor.on("input",this.onInput),k&&this.updatePlaceholder(),this.editor.getSession().selection.on("changeSelection",this.onSelectionChange),this.editor.getSession().selection.on("changeCursor",this.onCursorChange),r&&this.editor.getSession().on("changeAnnotation",(function(){var t=e.editor.getSession().getAnnotations();e.props.onValidate(t)})),this.editor.session.on("changeScrollTop",this.onScroll),this.editor.getSession().setAnnotations(x||[]),_&&_.length>0&&this.handleMarkers(_);var C=this.editor.$options;c.editorOptions.forEach((function(t){C.hasOwnProperty(t)?e.editor.setOption(t,e.props[t]):e.props[t]&&console.warn("ReactAce: editor option "+t+" was activated but not found. Did you need to import a related tool or did you possibly mispell the option?")})),this.handleOptions(this.props),Array.isArray(w)&&w.forEach((function(t){"string"==typeof t.exec?e.editor.commands.bindKey(t.bindKey,t.exec):e.editor.commands.addCommand(t)})),b&&this.editor.setKeyboardHandler("ace/keyboard/"+b),n&&(this.refEditor.className+=" "+n),y&&y(this.editor),this.editor.resize(),s&&this.editor.focus()},t.prototype.componentDidUpdate=function(e){for(var t=e,n=this.props,i=0;i<c.editorOptions.length;i++){var r=c.editorOptions[i];n[r]!==t[r]&&this.editor.setOption(r,n[r])}if(n.className!==t.className){var o=this.refEditor.className.trim().split(" ");t.className.trim().split(" ").forEach((function(e){var t=o.indexOf(e);o.splice(t,1)})),this.refEditor.className=" "+n.className+" "+o.join(" ")}if(this.editor&&null!=n.value&&this.editor.getValue()!==n.value){this.silent=!0;var s=this.editor.session.selection.toJSON();this.editor.setValue(n.value,n.cursorStart),this.editor.session.selection.fromJSON(s),this.silent=!1}n.placeholder!==t.placeholder&&this.updatePlaceholder(),n.mode!==t.mode&&this.editor.getSession().setMode("ace/mode/"+n.mode),n.theme!==t.theme&&this.editor.setTheme("ace/theme/"+n.theme),n.keyboardHandler!==t.keyboardHandler&&(n.keyboardHandler?this.editor.setKeyboardHandler("ace/keyboard/"+n.keyboardHandler):this.editor.setKeyboardHandler(null)),n.fontSize!==t.fontSize&&this.editor.setFontSize("number"==typeof n.fontSize?n.fontSize+"px":n.fontSize),n.wrapEnabled!==t.wrapEnabled&&this.editor.getSession().setUseWrapMode(n.wrapEnabled),n.showPrintMargin!==t.showPrintMargin&&this.editor.setShowPrintMargin(n.showPrintMargin),n.showGutter!==t.showGutter&&this.editor.renderer.setShowGutter(n.showGutter),l(n.setOptions,t.setOptions)||this.handleOptions(n),l(n.annotations,t.annotations)||this.editor.getSession().setAnnotations(n.annotations||[]),!l(n.markers,t.markers)&&Array.isArray(n.markers)&&this.handleMarkers(n.markers),l(n.scrollMargin,t.scrollMargin)||this.handleScrollMargins(n.scrollMargin),e.height===this.props.height&&e.width===this.props.width||this.editor.resize(),this.props.focus&&!e.focus&&this.editor.focus()},t.prototype.handleScrollMargins=function(e){void 0===e&&(e=[0,0,0,0]),this.editor.renderer.setScrollMargin(e[0],e[1],e[2],e[3])},t.prototype.componentWillUnmount=function(){this.editor.destroy(),this.editor=null},t.prototype.onChange=function(e){if(this.props.onChange&&!this.silent){var t=this.editor.getValue();this.props.onChange(t,e)}},t.prototype.onSelectionChange=function(e){if(this.props.onSelectionChange){var t=this.editor.getSelection();this.props.onSelectionChange(t,e)}},t.prototype.onCursorChange=function(e){if(this.props.onCursorChange){var t=this.editor.getSelection();this.props.onCursorChange(t,e)}},t.prototype.onInput=function(e){this.props.onInput&&this.props.onInput(e),this.props.placeholder&&this.updatePlaceholder()},t.prototype.onFocus=function(e){this.props.onFocus&&this.props.onFocus(e,this.editor)},t.prototype.onBlur=function(e){this.props.onBlur&&this.props.onBlur(e,this.editor)},t.prototype.onCopy=function(e){var t=e.text;this.props.onCopy&&this.props.onCopy(t)},t.prototype.onPaste=function(e){var t=e.text;this.props.onPaste&&this.props.onPaste(t)},t.prototype.onScroll=function(){this.props.onScroll&&this.props.onScroll(this.editor)},t.prototype.handleOptions=function(e){for(var t=Object.keys(e.setOptions),n=0;n<t.length;n++)this.editor.setOption(t[n],e.setOptions[t[n]])},t.prototype.handleMarkers=function(e){var t=this,n=this.editor.getSession().getMarkers(!0);for(var i in n)n.hasOwnProperty(i)&&this.editor.getSession().removeMarker(n[i].id);for(var i in n=this.editor.getSession().getMarkers(!1))n.hasOwnProperty(i)&&"ace_active-line"!==n[i].clazz&&"ace_selected-word"!==n[i].clazz&&this.editor.getSession().removeMarker(n[i].id);e.forEach((function(e){var n=e.startRow,i=e.startCol,r=e.endRow,o=e.endCol,s=e.className,a=e.type,l=e.inFront,c=void 0!==l&&l,u=new h(n,i,r,o);t.editor.getSession().addMarker(u,s,a,c)}))},t.prototype.updatePlaceholder=function(){var e=this.editor,t=this.props.placeholder,n=!e.session.getValue().length,i=e.renderer.placeholderNode;!n&&i?(e.renderer.scroller.removeChild(e.renderer.placeholderNode),e.renderer.placeholderNode=null):n&&!i?((i=e.renderer.placeholderNode=document.createElement("div")).textContent=t||"",i.className="ace_comment ace_placeholder",i.style.padding="0 9px",i.style.position="absolute",i.style.zIndex="3",e.renderer.scroller.appendChild(i)):n&&i&&(i.textContent=t)},t.prototype.updateRef=function(e){this.refEditor=e},t.prototype.render=function(){var e=this.props,t=e.name,n=e.width,i=e.height,r=e.style,s=o({width:n,height:i},r);return a.createElement("div",{ref:this.updateRef,id:t,style:s})},t.propTypes={mode:s.string,focus:s.bool,theme:s.string,name:s.string,className:s.string,height:s.string,width:s.string,fontSize:s.oneOfType([s.number,s.string]),showGutter:s.bool,onChange:s.func,onCopy:s.func,onPaste:s.func,onFocus:s.func,onInput:s.func,onBlur:s.func,onScroll:s.func,value:s.string,defaultValue:s.string,onLoad:s.func,onSelectionChange:s.func,onCursorChange:s.func,onBeforeLoad:s.func,onValidate:s.func,minLines:s.number,maxLines:s.number,readOnly:s.bool,highlightActiveLine:s.bool,tabSize:s.number,showPrintMargin:s.bool,cursorStart:s.number,debounceChangePeriod:s.number,editorProps:s.object,setOptions:s.object,style:s.object,scrollMargin:s.array,annotations:s.array,markers:s.array,keyboardHandler:s.string,wrapEnabled:s.bool,enableSnippets:s.bool,enableBasicAutocompletion:s.oneOfType([s.bool,s.array]),enableLiveAutocompletion:s.oneOfType([s.bool,s.array]),navigateToFileEnd:s.bool,commands:s.array,placeholder:s.string},t.defaultProps={name:"ace-editor",focus:!1,mode:"",theme:"",height:"500px",width:"500px",fontSize:12,enableSnippets:!1,showGutter:!0,onChange:null,onPaste:null,onLoad:null,onScroll:null,minLines:null,maxLines:null,readOnly:!1,highlightActiveLine:!0,showPrintMargin:!0,tabSize:4,cursorStart:1,editorProps:{},style:{},scrollMargin:[0,0,0,0],setOptions:{},wrapEnabled:!1,enableBasicAutocompletion:!1,enableLiveAutocompletion:!1,placeholder:null,navigateToFileEnd:!0},t}(a.Component);t.default=d},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(11),s=n(2),a=n(58),l=n(107),c=function(e){function t(t){var n=e.call(this,t)||this;return n.state={value:n.props.value},n.onChange=n.onChange.bind(n),n.diff=n.diff.bind(n),n}return r(t,e),t.prototype.componentDidUpdate=function(){var e=this.props.value;e!==this.state.value&&this.setState({value:e})},t.prototype.onChange=function(e){this.setState({value:e}),this.props.onChange&&this.props.onChange(e)},t.prototype.diff=function(){var e=new l,t=this.state.value[0],n=this.state.value[1];if(0===t.length&&0===n.length)return[];var i=e.diff_main(t,n);e.diff_cleanupSemantic(i);var r=this.generateDiffedLines(i);return this.setCodeMarkers(r)},t.prototype.generateDiffedLines=function(e){var t=0,n=-1,i=1,r={left:[],right:[]},o={left:1,right:1};return e.forEach((function(e){var s=e[0],a=e[1],l=a.split("\n").length-1;if(0!==a.length){var c=a[0],u=a[a.length-1],h=0;switch(s){case t:o.left+=l,o.right+=l;break;case n:"\n"===c&&(o.left++,l--),0===(h=l)&&r.right.push({startLine:o.right,endLine:o.right}),"\n"===u&&(h-=1),r.left.push({startLine:o.left,endLine:o.left+h}),o.left+=l;break;case i:"\n"===c&&(o.right++,l--),0===(h=l)&&r.left.push({startLine:o.left,endLine:o.left}),"\n"===u&&(h-=1),r.right.push({startLine:o.right,endLine:o.right+h}),o.right+=l;break;default:throw new Error("Diff type was not defined.")}}})),r},t.prototype.setCodeMarkers=function(e){void 0===e&&(e={left:[],right:[]});for(var t=[],n={left:[],right:[]},i=0;i<e.left.length;i++){var r={startRow:e.left[i].startLine-1,endRow:e.left[i].endLine,type:"text",className:"codeMarker"};n.left.push(r)}for(i=0;i<e.right.length;i++){r={startRow:e.right[i].startLine-1,endRow:e.right[i].endLine,type:"text",className:"codeMarker"};n.right.push(r)}return t[0]=n.left,t[1]=n.right,t},t.prototype.render=function(){var e=this.diff();return s.createElement(a.default,{name:this.props.name,className:this.props.className,focus:this.props.focus,orientation:this.props.orientation,splits:this.props.splits,mode:this.props.mode,theme:this.props.theme,height:this.props.height,width:this.props.width,fontSize:this.props.fontSize,showGutter:this.props.showGutter,onChange:this.onChange,onPaste:this.props.onPaste,onLoad:this.props.onLoad,onScroll:this.props.onScroll,minLines:this.props.minLines,maxLines:this.props.maxLines,readOnly:this.props.readOnly,highlightActiveLine:this.props.highlightActiveLine,showPrintMargin:this.props.showPrintMargin,tabSize:this.props.tabSize,cursorStart:this.props.cursorStart,editorProps:this.props.editorProps,style:this.props.style,scrollMargin:this.props.scrollMargin,setOptions:this.props.setOptions,wrapEnabled:this.props.wrapEnabled,enableBasicAutocompletion:this.props.enableBasicAutocompletion,enableLiveAutocompletion:this.props.enableLiveAutocompletion,value:this.state.value,markers:e})},t.propTypes={cursorStart:o.number,editorProps:o.object,enableBasicAutocompletion:o.bool,enableLiveAutocompletion:o.bool,focus:o.bool,fontSize:o.number,height:o.string,highlightActiveLine:o.bool,maxLines:o.number,minLines:o.number,mode:o.string,name:o.string,className:o.string,onLoad:o.func,onPaste:o.func,onScroll:o.func,onChange:o.func,orientation:o.string,readOnly:o.bool,scrollMargin:o.array,setOptions:o.object,showGutter:o.bool,showPrintMargin:o.bool,splits:o.number,style:o.object,tabSize:o.number,theme:o.string,value:o.array,width:o.string,wrapEnabled:o.bool},t.defaultProps={cursorStart:1,editorProps:{},enableBasicAutocompletion:!1,enableLiveAutocompletion:!1,focus:!1,fontSize:12,height:"500px",highlightActiveLine:!0,maxLines:null,minLines:null,mode:"",name:"ace-editor",onLoad:null,onScroll:null,onPaste:null,onChange:null,orientation:"beside",readOnly:!1,scrollMargin:[0,0,0,0],setOptions:{},showGutter:!0,showPrintMargin:!0,splits:2,style:{},tabSize:4,theme:"github",value:["",""],width:"500px",wrapEnabled:!0},t}(s.Component);t.default=c},function(e,t,n){(function(e){ace.define("ace/split",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/lib/event_emitter","ace/editor","ace/virtual_renderer","ace/edit_session"],(function(e,t,n){"use strict";var i=e("./lib/oop"),r=(e("./lib/lang"),e("./lib/event_emitter").EventEmitter),o=e("./editor").Editor,s=e("./virtual_renderer").VirtualRenderer,a=e("./edit_session").EditSession,l=function(e,t,n){this.BELOW=1,this.BESIDE=0,this.$container=e,this.$theme=t,this.$splits=0,this.$editorCSS="",this.$editors=[],this.$orientation=this.BESIDE,this.setSplits(n||1),this.$cEditor=this.$editors[0],this.on("focus",function(e){this.$cEditor=e}.bind(this))};(function(){i.implement(this,r),this.$createEditor=function(){var e=document.createElement("div");e.className=this.$editorCSS,e.style.cssText="position: absolute; top:0px; bottom:0px",this.$container.appendChild(e);var t=new o(new s(e,this.$theme));return t.on("focus",function(){this._emit("focus",t)}.bind(this)),this.$editors.push(t),t.setFontSize(this.$fontSize),t},this.setSplits=function(e){var t;if(e<1)throw"The number of splits have to be > 0!";if(e!=this.$splits){if(e>this.$splits){for(;this.$splits<this.$editors.length&&this.$splits<e;)t=this.$editors[this.$splits],this.$container.appendChild(t.container),t.setFontSize(this.$fontSize),this.$splits++;for(;this.$splits<e;)this.$createEditor(),this.$splits++}else for(;this.$splits>e;)t=this.$editors[this.$splits-1],this.$container.removeChild(t.container),this.$splits--;this.resize()}},this.getSplits=function(){return this.$splits},this.getEditor=function(e){return this.$editors[e]},this.getCurrentEditor=function(){return this.$cEditor},this.focus=function(){this.$cEditor.focus()},this.blur=function(){this.$cEditor.blur()},this.setTheme=function(e){this.$editors.forEach((function(t){t.setTheme(e)}))},this.setKeyboardHandler=function(e){this.$editors.forEach((function(t){t.setKeyboardHandler(e)}))},this.forEach=function(e,t){this.$editors.forEach(e,t)},this.$fontSize="",this.setFontSize=function(e){this.$fontSize=e,this.forEach((function(t){t.setFontSize(e)}))},this.$cloneSession=function(e){var t=new a(e.getDocument(),e.getMode()),n=e.getUndoManager();return t.setUndoManager(n),t.setTabSize(e.getTabSize()),t.setUseSoftTabs(e.getUseSoftTabs()),t.setOverwrite(e.getOverwrite()),t.setBreakpoints(e.getBreakpoints()),t.setUseWrapMode(e.getUseWrapMode()),t.setUseWorker(e.getUseWorker()),t.setWrapLimitRange(e.$wrapLimitRange.min,e.$wrapLimitRange.max),t.$foldData=e.$cloneFoldData(),t},this.setSession=function(e,t){var n;return n=null==t?this.$cEditor:this.$editors[t],this.$editors.some((function(t){return t.session===e}))&&(e=this.$cloneSession(e)),n.setSession(e),e},this.getOrientation=function(){return this.$orientation},this.setOrientation=function(e){this.$orientation!=e&&(this.$orientation=e,this.resize())},this.resize=function(){var e,t=this.$container.clientWidth,n=this.$container.clientHeight;if(this.$orientation==this.BESIDE)for(var i=t/this.$splits,r=0;r<this.$splits;r++)(e=this.$editors[r]).container.style.width=i+"px",e.container.style.top="0px",e.container.style.left=r*i+"px",e.container.style.height=n+"px",e.resize();else{var o=n/this.$splits;for(r=0;r<this.$splits;r++)(e=this.$editors[r]).container.style.width=t+"px",e.container.style.top=r*o+"px",e.container.style.left="0px",e.container.style.height=o+"px",e.resize()}}}).call(l.prototype),t.Split=l})),ace.define("ace/ext/split",["require","exports","module","ace/split"],(function(e,t,n){"use strict";n.exports=e("../split")})),ace.require(["ace/ext/split"],(function(t){e&&(e.exports=t)}))}).call(this,n(42)(e))},function(e,t,n){(function(t){var n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/,r=/^\./,o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,s=/\\(\\)?/g,a=/^\[object .+?Constructor\]$/,l="object"==typeof t&&t&&t.Object===Object&&t,c="object"==typeof self&&self&&self.Object===Object&&self,u=l||c||Function("return this")();var h,d=Array.prototype,f=Function.prototype,p=Object.prototype,g=u["__core-js_shared__"],m=(h=/[^.]+$/.exec(g&&g.keys&&g.keys.IE_PROTO||""))?"Symbol(src)_1."+h:"",v=f.toString,b=p.hasOwnProperty,y=p.toString,w=RegExp("^"+v.call(b).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),x=u.Symbol,_=d.splice,k=T(u,"Map"),S=T(Object,"create"),O=x?x.prototype:void 0,C=O?O.toString:void 0;function A(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function $(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function E(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function M(e,t){for(var n,i,r=e.length;r--;)if((n=e[r][0])===(i=t)||n!=n&&i!=i)return r;return-1}function j(e,t){for(var r,o=0,s=(t=function(e,t){if(P(e))return!1;var r=typeof e;if("number"==r||"symbol"==r||"boolean"==r||null==e||I(e))return!0;return i.test(e)||!n.test(e)||null!=t&&e in Object(t)}(t,e)?[t]:P(r=t)?r:L(r)).length;null!=e&&o<s;)e=e[F(t[o++])];return o&&o==s?e:void 0}function R(e){return!(!z(e)||(t=e,m&&m in t))&&(function(e){var t=z(e)?y.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?w:a).test(function(e){if(null!=e){try{return v.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function D(e,t){var n,i,r=e.__data__;return("string"==(i=typeof(n=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof t?"string":"hash"]:r.map}function T(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return R(n)?n:void 0}A.prototype.clear=function(){this.__data__=S?S(null):{}},A.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},A.prototype.get=function(e){var t=this.__data__;if(S){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return b.call(t,e)?t[e]:void 0},A.prototype.has=function(e){var t=this.__data__;return S?void 0!==t[e]:b.call(t,e)},A.prototype.set=function(e,t){return this.__data__[e]=S&&void 0===t?"__lodash_hash_undefined__":t,this},$.prototype.clear=function(){this.__data__=[]},$.prototype.delete=function(e){var t=this.__data__,n=M(t,e);return!(n<0)&&(n==t.length-1?t.pop():_.call(t,n,1),!0)},$.prototype.get=function(e){var t=this.__data__,n=M(t,e);return n<0?void 0:t[n][1]},$.prototype.has=function(e){return M(this.__data__,e)>-1},$.prototype.set=function(e,t){var n=this.__data__,i=M(n,e);return i<0?n.push([e,t]):n[i][1]=t,this},E.prototype.clear=function(){this.__data__={hash:new A,map:new(k||$),string:new A}},E.prototype.delete=function(e){return D(this,e).delete(e)},E.prototype.get=function(e){return D(this,e).get(e)},E.prototype.has=function(e){return D(this,e).has(e)},E.prototype.set=function(e,t){return D(this,e).set(e,t),this};var L=N((function(e){var t;e=null==(t=e)?"":function(e){if("string"==typeof e)return e;if(I(e))return C?C.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(t);var n=[];return r.test(e)&&n.push(""),e.replace(o,(function(e,t,i,r){n.push(i?r.replace(s,"$1"):t||e)})),n}));function F(e){if("string"==typeof e||I(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function N(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var i=arguments,r=t?t.apply(this,i):i[0],o=n.cache;if(o.has(r))return o.get(r);var s=e.apply(this,i);return n.cache=o.set(r,s),s};return n.cache=new(N.Cache||E),n}N.Cache=E;var P=Array.isArray;function z(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function I(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==y.call(e)}e.exports=function(e,t,n){var i=null==e?void 0:j(e,t);return void 0===i?n:i}}).call(this,n(24))},function(e,t){var n=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32};n.Diff=function(e,t){return[e,t]},n.prototype.diff_main=function(e,t,i,r){void 0===r&&(r=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var o=r;if(null==e||null==t)throw new Error("Null input. (diff_main)");if(e==t)return e?[new n.Diff(0,e)]:[];void 0===i&&(i=!0);var s=i,a=this.diff_commonPrefix(e,t),l=e.substring(0,a);e=e.substring(a),t=t.substring(a),a=this.diff_commonSuffix(e,t);var c=e.substring(e.length-a);e=e.substring(0,e.length-a),t=t.substring(0,t.length-a);var u=this.diff_compute_(e,t,s,o);return l&&u.unshift(new n.Diff(0,l)),c&&u.push(new n.Diff(0,c)),this.diff_cleanupMerge(u),u},n.prototype.diff_compute_=function(e,t,i,r){var o;if(!e)return[new n.Diff(1,t)];if(!t)return[new n.Diff(-1,e)];var s=e.length>t.length?e:t,a=e.length>t.length?t:e,l=s.indexOf(a);if(-1!=l)return o=[new n.Diff(1,s.substring(0,l)),new n.Diff(0,a),new n.Diff(1,s.substring(l+a.length))],e.length>t.length&&(o[0][0]=o[2][0]=-1),o;if(1==a.length)return[new n.Diff(-1,e),new n.Diff(1,t)];var c=this.diff_halfMatch_(e,t);if(c){var u=c[0],h=c[1],d=c[2],f=c[3],p=c[4],g=this.diff_main(u,d,i,r),m=this.diff_main(h,f,i,r);return g.concat([new n.Diff(0,p)],m)}return i&&e.length>100&&t.length>100?this.diff_lineMode_(e,t,r):this.diff_bisect_(e,t,r)},n.prototype.diff_lineMode_=function(e,t,i){var r=this.diff_linesToChars_(e,t);e=r.chars1,t=r.chars2;var o=r.lineArray,s=this.diff_main(e,t,!1,i);this.diff_charsToLines_(s,o),this.diff_cleanupSemantic(s),s.push(new n.Diff(0,""));for(var a=0,l=0,c=0,u="",h="";a<s.length;){switch(s[a][0]){case 1:c++,h+=s[a][1];break;case-1:l++,u+=s[a][1];break;case 0:if(l>=1&&c>=1){s.splice(a-l-c,l+c),a=a-l-c;for(var d=this.diff_main(u,h,!1,i),f=d.length-1;f>=0;f--)s.splice(a,0,d[f]);a+=d.length}c=0,l=0,u="",h=""}a++}return s.pop(),s},n.prototype.diff_bisect_=function(e,t,i){for(var r=e.length,o=t.length,s=Math.ceil((r+o)/2),a=s,l=2*s,c=new Array(l),u=new Array(l),h=0;h<l;h++)c[h]=-1,u[h]=-1;c[a+1]=0,u[a+1]=0;for(var d=r-o,f=d%2!=0,p=0,g=0,m=0,v=0,b=0;b<s&&!((new Date).getTime()>i);b++){for(var y=-b+p;y<=b-g;y+=2){for(var w=a+y,x=(C=y==-b||y!=b&&c[w-1]<c[w+1]?c[w+1]:c[w-1]+1)-y;C<r&&x<o&&e.charAt(C)==t.charAt(x);)C++,x++;if(c[w]=C,C>r)g+=2;else if(x>o)p+=2;else if(f){if((S=a+d-y)>=0&&S<l&&-1!=u[S])if(C>=(k=r-u[S]))return this.diff_bisectSplit_(e,t,C,x,i)}}for(var _=-b+m;_<=b-v;_+=2){for(var k,S=a+_,O=(k=_==-b||_!=b&&u[S-1]<u[S+1]?u[S+1]:u[S-1]+1)-_;k<r&&O<o&&e.charAt(r-k-1)==t.charAt(o-O-1);)k++,O++;if(u[S]=k,k>r)v+=2;else if(O>o)m+=2;else if(!f){if((w=a+d-_)>=0&&w<l&&-1!=c[w]){var C;x=a+(C=c[w])-w;if(C>=(k=r-k))return this.diff_bisectSplit_(e,t,C,x,i)}}}}return[new n.Diff(-1,e),new n.Diff(1,t)]},n.prototype.diff_bisectSplit_=function(e,t,n,i,r){var o=e.substring(0,n),s=t.substring(0,i),a=e.substring(n),l=t.substring(i),c=this.diff_main(o,s,!1,r),u=this.diff_main(a,l,!1,r);return c.concat(u)},n.prototype.diff_linesToChars_=function(e,t){var n=[],i={};function r(e){for(var t="",r=0,s=-1,a=n.length;s<e.length-1;){-1==(s=e.indexOf("\n",r))&&(s=e.length-1);var l=e.substring(r,s+1);(i.hasOwnProperty?i.hasOwnProperty(l):void 0!==i[l])?t+=String.fromCharCode(i[l]):(a==o&&(l=e.substring(r),s=e.length),t+=String.fromCharCode(a),i[l]=a,n[a++]=l),r=s+1}return t}n[0]="";var o=4e4,s=r(e);return o=65535,{chars1:s,chars2:r(t),lineArray:n}},n.prototype.diff_charsToLines_=function(e,t){for(var n=0;n<e.length;n++){for(var i=e[n][1],r=[],o=0;o<i.length;o++)r[o]=t[i.charCodeAt(o)];e[n][1]=r.join("")}},n.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var n=0,i=Math.min(e.length,t.length),r=i,o=0;n<r;)e.substring(o,r)==t.substring(o,r)?o=n=r:i=r,r=Math.floor((i-n)/2+n);return r},n.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var n=0,i=Math.min(e.length,t.length),r=i,o=0;n<r;)e.substring(e.length-r,e.length-o)==t.substring(t.length-r,t.length-o)?o=n=r:i=r,r=Math.floor((i-n)/2+n);return r},n.prototype.diff_commonOverlap_=function(e,t){var n=e.length,i=t.length;if(0==n||0==i)return 0;n>i?e=e.substring(n-i):n<i&&(t=t.substring(0,n));var r=Math.min(n,i);if(e==t)return r;for(var o=0,s=1;;){var a=e.substring(r-s),l=t.indexOf(a);if(-1==l)return o;s+=l,0!=l&&e.substring(r-s)!=t.substring(0,s)||(o=s,s++)}},n.prototype.diff_halfMatch_=function(e,t){if(this.Diff_Timeout<=0)return null;var n=e.length>t.length?e:t,i=e.length>t.length?t:e;if(n.length<4||2*i.length<n.length)return null;var r=this;function o(e,t,n){for(var i,o,s,a,l=e.substring(n,n+Math.floor(e.length/4)),c=-1,u="";-1!=(c=t.indexOf(l,c+1));){var h=r.diff_commonPrefix(e.substring(n),t.substring(c)),d=r.diff_commonSuffix(e.substring(0,n),t.substring(0,c));u.length<d+h&&(u=t.substring(c-d,c)+t.substring(c,c+h),i=e.substring(0,n-d),o=e.substring(n+h),s=t.substring(0,c-d),a=t.substring(c+h))}return 2*u.length>=e.length?[i,o,s,a,u]:null}var s,a,l,c,u,h=o(n,i,Math.ceil(n.length/4)),d=o(n,i,Math.ceil(n.length/2));return h||d?(s=d?h&&h[4].length>d[4].length?h:d:h,e.length>t.length?(a=s[0],l=s[1],c=s[2],u=s[3]):(c=s[0],u=s[1],a=s[2],l=s[3]),[a,l,c,u,s[4]]):null},n.prototype.diff_cleanupSemantic=function(e){for(var t=!1,i=[],r=0,o=null,s=0,a=0,l=0,c=0,u=0;s<e.length;)0==e[s][0]?(i[r++]=s,a=c,l=u,c=0,u=0,o=e[s][1]):(1==e[s][0]?c+=e[s][1].length:u+=e[s][1].length,o&&o.length<=Math.max(a,l)&&o.length<=Math.max(c,u)&&(e.splice(i[r-1],0,new n.Diff(-1,o)),e[i[r-1]+1][0]=1,r--,s=--r>0?i[r-1]:-1,a=0,l=0,c=0,u=0,o=null,t=!0)),s++;for(t&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),s=1;s<e.length;){if(-1==e[s-1][0]&&1==e[s][0]){var h=e[s-1][1],d=e[s][1],f=this.diff_commonOverlap_(h,d),p=this.diff_commonOverlap_(d,h);f>=p?(f>=h.length/2||f>=d.length/2)&&(e.splice(s,0,new n.Diff(0,d.substring(0,f))),e[s-1][1]=h.substring(0,h.length-f),e[s+1][1]=d.substring(f),s++):(p>=h.length/2||p>=d.length/2)&&(e.splice(s,0,new n.Diff(0,h.substring(0,p))),e[s-1][0]=1,e[s-1][1]=d.substring(0,d.length-p),e[s+1][0]=-1,e[s+1][1]=h.substring(p),s++),s++}s++}},n.prototype.diff_cleanupSemanticLossless=function(e){function t(e,t){if(!e||!t)return 6;var i=e.charAt(e.length-1),r=t.charAt(0),o=i.match(n.nonAlphaNumericRegex_),s=r.match(n.nonAlphaNumericRegex_),a=o&&i.match(n.whitespaceRegex_),l=s&&r.match(n.whitespaceRegex_),c=a&&i.match(n.linebreakRegex_),u=l&&r.match(n.linebreakRegex_),h=c&&e.match(n.blanklineEndRegex_),d=u&&t.match(n.blanklineStartRegex_);return h||d?5:c||u?4:o&&!a&&l?3:a||l?2:o||s?1:0}for(var i=1;i<e.length-1;){if(0==e[i-1][0]&&0==e[i+1][0]){var r=e[i-1][1],o=e[i][1],s=e[i+1][1],a=this.diff_commonSuffix(r,o);if(a){var l=o.substring(o.length-a);r=r.substring(0,r.length-a),o=l+o.substring(0,o.length-a),s=l+s}for(var c=r,u=o,h=s,d=t(r,o)+t(o,s);o.charAt(0)===s.charAt(0);){r+=o.charAt(0),o=o.substring(1)+s.charAt(0),s=s.substring(1);var f=t(r,o)+t(o,s);f>=d&&(d=f,c=r,u=o,h=s)}e[i-1][1]!=c&&(c?e[i-1][1]=c:(e.splice(i-1,1),i--),e[i][1]=u,h?e[i+1][1]=h:(e.splice(i+1,1),i--))}i++}},n.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,n.whitespaceRegex_=/\s/,n.linebreakRegex_=/[\r\n]/,n.blanklineEndRegex_=/\n\r?\n$/,n.blanklineStartRegex_=/^\r?\n\r?\n/,n.prototype.diff_cleanupEfficiency=function(e){for(var t=!1,i=[],r=0,o=null,s=0,a=!1,l=!1,c=!1,u=!1;s<e.length;)0==e[s][0]?(e[s][1].length<this.Diff_EditCost&&(c||u)?(i[r++]=s,a=c,l=u,o=e[s][1]):(r=0,o=null),c=u=!1):(-1==e[s][0]?u=!0:c=!0,o&&(a&&l&&c&&u||o.length<this.Diff_EditCost/2&&a+l+c+u==3)&&(e.splice(i[r-1],0,new n.Diff(-1,o)),e[i[r-1]+1][0]=1,r--,o=null,a&&l?(c=u=!0,r=0):(s=--r>0?i[r-1]:-1,c=u=!1),t=!0)),s++;t&&this.diff_cleanupMerge(e)},n.prototype.diff_cleanupMerge=function(e){e.push(new n.Diff(0,""));for(var t,i=0,r=0,o=0,s="",a="";i<e.length;)switch(e[i][0]){case 1:o++,a+=e[i][1],i++;break;case-1:r++,s+=e[i][1],i++;break;case 0:r+o>1?(0!==r&&0!==o&&(0!==(t=this.diff_commonPrefix(a,s))&&(i-r-o>0&&0==e[i-r-o-1][0]?e[i-r-o-1][1]+=a.substring(0,t):(e.splice(0,0,new n.Diff(0,a.substring(0,t))),i++),a=a.substring(t),s=s.substring(t)),0!==(t=this.diff_commonSuffix(a,s))&&(e[i][1]=a.substring(a.length-t)+e[i][1],a=a.substring(0,a.length-t),s=s.substring(0,s.length-t))),i-=r+o,e.splice(i,r+o),s.length&&(e.splice(i,0,new n.Diff(-1,s)),i++),a.length&&(e.splice(i,0,new n.Diff(1,a)),i++),i++):0!==i&&0==e[i-1][0]?(e[i-1][1]+=e[i][1],e.splice(i,1)):i++,o=0,r=0,s="",a=""}""===e[e.length-1][1]&&e.pop();var l=!1;for(i=1;i<e.length-1;)0==e[i-1][0]&&0==e[i+1][0]&&(e[i][1].substring(e[i][1].length-e[i-1][1].length)==e[i-1][1]?(e[i][1]=e[i-1][1]+e[i][1].substring(0,e[i][1].length-e[i-1][1].length),e[i+1][1]=e[i-1][1]+e[i+1][1],e.splice(i-1,1),l=!0):e[i][1].substring(0,e[i+1][1].length)==e[i+1][1]&&(e[i-1][1]+=e[i+1][1],e[i][1]=e[i][1].substring(e[i+1][1].length)+e[i+1][1],e.splice(i+1,1),l=!0)),i++;l&&this.diff_cleanupMerge(e)},n.prototype.diff_xIndex=function(e,t){var n,i=0,r=0,o=0,s=0;for(n=0;n<e.length&&(1!==e[n][0]&&(i+=e[n][1].length),-1!==e[n][0]&&(r+=e[n][1].length),!(i>t));n++)o=i,s=r;return e.length!=n&&-1===e[n][0]?s:s+(t-o)},n.prototype.diff_prettyHtml=function(e){for(var t=[],n=/&/g,i=/</g,r=/>/g,o=/\n/g,s=0;s<e.length;s++){var a=e[s][0],l=e[s][1].replace(n,"&amp;").replace(i,"&lt;").replace(r,"&gt;").replace(o,"&para;<br>");switch(a){case 1:t[s]='<ins style="background:#e6ffe6;">'+l+"</ins>";break;case-1:t[s]='<del style="background:#ffe6e6;">'+l+"</del>";break;case 0:t[s]="<span>"+l+"</span>"}}return t.join("")},n.prototype.diff_text1=function(e){for(var t=[],n=0;n<e.length;n++)1!==e[n][0]&&(t[n]=e[n][1]);return t.join("")},n.prototype.diff_text2=function(e){for(var t=[],n=0;n<e.length;n++)-1!==e[n][0]&&(t[n]=e[n][1]);return t.join("")},n.prototype.diff_levenshtein=function(e){for(var t=0,n=0,i=0,r=0;r<e.length;r++){var o=e[r][0],s=e[r][1];switch(o){case 1:n+=s.length;break;case-1:i+=s.length;break;case 0:t+=Math.max(n,i),n=0,i=0}}return t+=Math.max(n,i)},n.prototype.diff_toDelta=function(e){for(var t=[],n=0;n<e.length;n++)switch(e[n][0]){case 1:t[n]="+"+encodeURI(e[n][1]);break;case-1:t[n]="-"+e[n][1].length;break;case 0:t[n]="="+e[n][1].length}return t.join("\t").replace(/%20/g," ")},n.prototype.diff_fromDelta=function(e,t){for(var i=[],r=0,o=0,s=t.split(/\t/g),a=0;a<s.length;a++){var l=s[a].substring(1);switch(s[a].charAt(0)){case"+":try{i[r++]=new n.Diff(1,decodeURI(l))}catch(e){throw new Error("Illegal escape in diff_fromDelta: "+l)}break;case"-":case"=":var c=parseInt(l,10);if(isNaN(c)||c<0)throw new Error("Invalid number in diff_fromDelta: "+l);var u=e.substring(o,o+=c);"="==s[a].charAt(0)?i[r++]=new n.Diff(0,u):i[r++]=new n.Diff(-1,u);break;default:if(s[a])throw new Error("Invalid diff operation in diff_fromDelta: "+s[a])}}if(o!=e.length)throw new Error("Delta length ("+o+") does not equal source text length ("+e.length+").");return i},n.prototype.match_main=function(e,t,n){if(null==e||null==t||null==n)throw new Error("Null input. (match_main)");return n=Math.max(0,Math.min(n,e.length)),e==t?0:e.length?e.substring(n,n+t.length)==t?n:this.match_bitap_(e,t,n):-1},n.prototype.match_bitap_=function(e,t,n){if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var i=this.match_alphabet_(t),r=this;function o(e,i){var o=e/t.length,s=Math.abs(n-i);return r.Match_Distance?o+s/r.Match_Distance:s?1:o}var s=this.Match_Threshold,a=e.indexOf(t,n);-1!=a&&(s=Math.min(o(0,a),s),-1!=(a=e.lastIndexOf(t,n+t.length))&&(s=Math.min(o(0,a),s)));var l,c,u=1<<t.length-1;a=-1;for(var h,d=t.length+e.length,f=0;f<t.length;f++){for(l=0,c=d;l<c;)o(f,n+c)<=s?l=c:d=c,c=Math.floor((d-l)/2+l);d=c;var p=Math.max(1,n-c+1),g=Math.min(n+c,e.length)+t.length,m=Array(g+2);m[g+1]=(1<<f)-1;for(var v=g;v>=p;v--){var b=i[e.charAt(v-1)];if(m[v]=0===f?(m[v+1]<<1|1)&b:(m[v+1]<<1|1)&b|(h[v+1]|h[v])<<1|1|h[v+1],m[v]&u){var y=o(f,v-1);if(y<=s){if(s=y,!((a=v-1)>n))break;p=Math.max(1,2*n-a)}}}if(o(f+1,n)>s)break;h=m}return a},n.prototype.match_alphabet_=function(e){for(var t={},n=0;n<e.length;n++)t[e.charAt(n)]=0;for(n=0;n<e.length;n++)t[e.charAt(n)]|=1<<e.length-n-1;return t},n.prototype.patch_addContext_=function(e,t){if(0!=t.length){if(null===e.start2)throw Error("patch not initialized");for(var i=t.substring(e.start2,e.start2+e.length1),r=0;t.indexOf(i)!=t.lastIndexOf(i)&&i.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)r+=this.Patch_Margin,i=t.substring(e.start2-r,e.start2+e.length1+r);r+=this.Patch_Margin;var o=t.substring(e.start2-r,e.start2);o&&e.diffs.unshift(new n.Diff(0,o));var s=t.substring(e.start2+e.length1,e.start2+e.length1+r);s&&e.diffs.push(new n.Diff(0,s)),e.start1-=o.length,e.start2-=o.length,e.length1+=o.length+s.length,e.length2+=o.length+s.length}},n.prototype.patch_make=function(e,t,i){var r,o;if("string"==typeof e&&"string"==typeof t&&void 0===i)r=e,(o=this.diff_main(r,t,!0)).length>2&&(this.diff_cleanupSemantic(o),this.diff_cleanupEfficiency(o));else if(e&&"object"==typeof e&&void 0===t&&void 0===i)o=e,r=this.diff_text1(o);else if("string"==typeof e&&t&&"object"==typeof t&&void 0===i)r=e,o=t;else{if("string"!=typeof e||"string"!=typeof t||!i||"object"!=typeof i)throw new Error("Unknown call format to patch_make.");r=e,o=i}if(0===o.length)return[];for(var s=[],a=new n.patch_obj,l=0,c=0,u=0,h=r,d=r,f=0;f<o.length;f++){var p=o[f][0],g=o[f][1];switch(l||0===p||(a.start1=c,a.start2=u),p){case 1:a.diffs[l++]=o[f],a.length2+=g.length,d=d.substring(0,u)+g+d.substring(u);break;case-1:a.length1+=g.length,a.diffs[l++]=o[f],d=d.substring(0,u)+d.substring(u+g.length);break;case 0:g.length<=2*this.Patch_Margin&&l&&o.length!=f+1?(a.diffs[l++]=o[f],a.length1+=g.length,a.length2+=g.length):g.length>=2*this.Patch_Margin&&l&&(this.patch_addContext_(a,h),s.push(a),a=new n.patch_obj,l=0,h=d,c=u)}1!==p&&(c+=g.length),-1!==p&&(u+=g.length)}return l&&(this.patch_addContext_(a,h),s.push(a)),s},n.prototype.patch_deepCopy=function(e){for(var t=[],i=0;i<e.length;i++){var r=e[i],o=new n.patch_obj;o.diffs=[];for(var s=0;s<r.diffs.length;s++)o.diffs[s]=new n.Diff(r.diffs[s][0],r.diffs[s][1]);o.start1=r.start1,o.start2=r.start2,o.length1=r.length1,o.length2=r.length2,t[i]=o}return t},n.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var n=this.patch_addPadding(e);t=n+t+n,this.patch_splitMax(e);for(var i=0,r=[],o=0;o<e.length;o++){var s,a,l=e[o].start2+i,c=this.diff_text1(e[o].diffs),u=-1;if(c.length>this.Match_MaxBits?-1!=(s=this.match_main(t,c.substring(0,this.Match_MaxBits),l))&&(-1==(u=this.match_main(t,c.substring(c.length-this.Match_MaxBits),l+c.length-this.Match_MaxBits))||s>=u)&&(s=-1):s=this.match_main(t,c,l),-1==s)r[o]=!1,i-=e[o].length2-e[o].length1;else if(r[o]=!0,i=s-l,c==(a=-1==u?t.substring(s,s+c.length):t.substring(s,u+this.Match_MaxBits)))t=t.substring(0,s)+this.diff_text2(e[o].diffs)+t.substring(s+c.length);else{var h=this.diff_main(c,a,!1);if(c.length>this.Match_MaxBits&&this.diff_levenshtein(h)/c.length>this.Patch_DeleteThreshold)r[o]=!1;else{this.diff_cleanupSemanticLossless(h);for(var d,f=0,p=0;p<e[o].diffs.length;p++){var g=e[o].diffs[p];0!==g[0]&&(d=this.diff_xIndex(h,f)),1===g[0]?t=t.substring(0,s+d)+g[1]+t.substring(s+d):-1===g[0]&&(t=t.substring(0,s+d)+t.substring(s+this.diff_xIndex(h,f+g[1].length))),-1!==g[0]&&(f+=g[1].length)}}}}return[t=t.substring(n.length,t.length-n.length),r]},n.prototype.patch_addPadding=function(e){for(var t=this.Patch_Margin,i="",r=1;r<=t;r++)i+=String.fromCharCode(r);for(r=0;r<e.length;r++)e[r].start1+=t,e[r].start2+=t;var o=e[0],s=o.diffs;if(0==s.length||0!=s[0][0])s.unshift(new n.Diff(0,i)),o.start1-=t,o.start2-=t,o.length1+=t,o.length2+=t;else if(t>s[0][1].length){var a=t-s[0][1].length;s[0][1]=i.substring(s[0][1].length)+s[0][1],o.start1-=a,o.start2-=a,o.length1+=a,o.length2+=a}if(0==(s=(o=e[e.length-1]).diffs).length||0!=s[s.length-1][0])s.push(new n.Diff(0,i)),o.length1+=t,o.length2+=t;else if(t>s[s.length-1][1].length){a=t-s[s.length-1][1].length;s[s.length-1][1]+=i.substring(0,a),o.length1+=a,o.length2+=a}return i},n.prototype.patch_splitMax=function(e){for(var t=this.Match_MaxBits,i=0;i<e.length;i++)if(!(e[i].length1<=t)){var r=e[i];e.splice(i--,1);for(var o=r.start1,s=r.start2,a="";0!==r.diffs.length;){var l=new n.patch_obj,c=!0;for(l.start1=o-a.length,l.start2=s-a.length,""!==a&&(l.length1=l.length2=a.length,l.diffs.push(new n.Diff(0,a)));0!==r.diffs.length&&l.length1<t-this.Patch_Margin;){var u=r.diffs[0][0],h=r.diffs[0][1];1===u?(l.length2+=h.length,s+=h.length,l.diffs.push(r.diffs.shift()),c=!1):-1===u&&1==l.diffs.length&&0==l.diffs[0][0]&&h.length>2*t?(l.length1+=h.length,o+=h.length,c=!1,l.diffs.push(new n.Diff(u,h)),r.diffs.shift()):(h=h.substring(0,t-l.length1-this.Patch_Margin),l.length1+=h.length,o+=h.length,0===u?(l.length2+=h.length,s+=h.length):c=!1,l.diffs.push(new n.Diff(u,h)),h==r.diffs[0][1]?r.diffs.shift():r.diffs[0][1]=r.diffs[0][1].substring(h.length))}a=(a=this.diff_text2(l.diffs)).substring(a.length-this.Patch_Margin);var d=this.diff_text1(r.diffs).substring(0,this.Patch_Margin);""!==d&&(l.length1+=d.length,l.length2+=d.length,0!==l.diffs.length&&0===l.diffs[l.diffs.length-1][0]?l.diffs[l.diffs.length-1][1]+=d:l.diffs.push(new n.Diff(0,d))),c||e.splice(++i,0,l)}}},n.prototype.patch_toText=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e[n];return t.join("")},n.prototype.patch_fromText=function(e){var t=[];if(!e)return t;for(var i=e.split("\n"),r=0,o=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;r<i.length;){var s=i[r].match(o);if(!s)throw new Error("Invalid patch string: "+i[r]);var a=new n.patch_obj;for(t.push(a),a.start1=parseInt(s[1],10),""===s[2]?(a.start1--,a.length1=1):"0"==s[2]?a.length1=0:(a.start1--,a.length1=parseInt(s[2],10)),a.start2=parseInt(s[3],10),""===s[4]?(a.start2--,a.length2=1):"0"==s[4]?a.length2=0:(a.start2--,a.length2=parseInt(s[4],10)),r++;r<i.length;){var l=i[r].charAt(0);try{var c=decodeURI(i[r].substring(1))}catch(e){throw new Error("Illegal escape in patch_fromText: "+c)}if("-"==l)a.diffs.push(new n.Diff(-1,c));else if("+"==l)a.diffs.push(new n.Diff(1,c));else if(" "==l)a.diffs.push(new n.Diff(0,c));else{if("@"==l)break;if(""!==l)throw new Error('Invalid patch mode "'+l+'" in: '+c)}r++}}return t},(n.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0}).prototype.toString=function(){for(var e,t=["@@ -"+(0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1)+" +"+(0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2)+" @@\n"],n=0;n<this.diffs.length;n++){switch(this.diffs[n][0]){case 1:e="+";break;case-1:e="-";break;case 0:e=" "}t[n+1]=e+encodeURI(this.diffs[n][1])+"\n"}return t.join("").replace(/%20/g," ")},e.exports=n,e.exports.diff_match_patch=n,e.exports.DIFF_DELETE=-1,e.exports.DIFF_INSERT=1,e.exports.DIFF_EQUAL=0},function(e,t,n){"use strict";n.r(t);var i=n(59),r=n(4),o=n(2),s=n.n(o),a=n(15),l=n(60),c=n(11),u=n.n(c);const h={};function d(e=h,t=h){const n=Object.keys(e),i=Object.keys(t);return e===t||n.length===i.length&&n.every(n=>e[n]===t[n])}var f=n(25);function p(e,t){Object.keys(t).forEach(n=>{!function(e,t,n){var i;n&&((i=n)&&"[object Function]"==={}.toString.call(i)?n(e.data(t)):e.change(t,f.vega.changeset().remove(()=>!0).insert(n)))}(e,n,t[n])})}function g(e){const t=new Set;return e.forEach(e=>{Object.keys(e).forEach(e=>{t.add(e)})}),t}const m=()=>{};function v(e,t){const n=Object.keys(t);return n.forEach(n=>{try{e.addSignalListener(n,t[n])}catch(e){console.warn("Cannot add invalid signal listener.",e)}}),n.length>0}var b=n(66),y=n.n(b);function w(e,t){const n=Object.keys(t);return n.forEach(n=>{try{e.removeSignalListener(n,t[n])}catch(e){console.warn("Cannot remove invalid signal listener.",e)}}),n.length>0}function x(e){const{spec:t,width:n,height:i}=e;return void 0!==n&&void 0!==i?{...t,width:n,height:i}:void 0!==n?{...t,width:n}:void 0!==i?{...t,height:i}:t}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class k extends s.a.PureComponent{constructor(...e){super(...e),_(this,"containerRef",s.a.createRef()),_(this,"viewPromise",void 0),_(this,"handleError",e=>{const{onError:t=m}=this.props;t(e),console.warn(e)}),_(this,"modifyView",e=>{this.viewPromise&&this.viewPromise.then(t=>(t&&e(t),!0)).catch(this.handleError)})}componentDidMount(){this.createView()}componentDidUpdate(e){const t=g([this.props,e]);if(t.delete("className"),t.delete("signalListeners"),t.delete("spec"),t.delete("style"),t.delete("width"),t.delete("height"),Array.from(t).some(t=>this.props[t]!==e[t]))this.clearView(),this.createView();else{const t=function(e,t){if(e===t)return!1;const n={width:!1,height:!1,isExpensive:!1},i=g([e,t]);return!i.has("width")||"width"in e&&"width"in t&&e.width===t.width||("width"in e&&"number"==typeof e.width?n.width=e.width:n.isExpensive=!0),!i.has("height")||"height"in e&&"height"in t&&e.height===t.height||("height"in e&&"number"==typeof e.height?n.height=e.height:n.isExpensive=!0),i.delete("width"),i.delete("height"),[...i].some(n=>!(n in e)||!(n in t)||!y()(e[n],t[n]))&&(n.isExpensive=!0),!(!1===n.width&&!1===n.height&&!n.isExpensive)&&n}(x(this.props),x(e)),{signalListeners:n}=this.props,{signalListeners:i}=e;if(t)if(t.isExpensive)this.clearView(),this.createView();else{const e=!d(n,i);this.modifyView(r=>{!1!==t.width&&r.width(t.width),!1!==t.height&&r.height(t.height),e&&(i&&w(r,i),n&&v(r,n)),r.run()})}else d(n,i)||this.modifyView(e=>{i&&w(e,i),n&&v(e,n),e.run()})}}componentWillUnmount(){this.clearView()}createView(){const{spec:e,onNewView:t,signalListeners:n={},width:i,height:r,...o}=this.props;if(this.containerRef.current){const e=x(this.props);this.viewPromise=Object(f.default)(this.containerRef.current,e,o).then(({view:e})=>(v(e,n)&&e.run(),e)).catch(this.handleError),t&&this.modifyView(t)}}clearView(){return this.modifyView(e=>{e.finalize()}),this.viewPromise=void 0,this}render(){const{className:e,style:t}=this.props;return s.a.createElement("div",{ref:this.containerRef,className:e,style:t})}}function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}_(k,"propTypes",{className:u.a.string,onError:u.a.func});class C extends s.a.PureComponent{constructor(...e){super(...e),O(this,"vegaEmbed",s.a.createRef()),O(this,"handleNewView",e=>{this.update();const{onNewView:t=m}=this.props;t(e)})}componentDidMount(){this.update()}componentDidUpdate(e){d(this.props.data,e.data)||this.update()}update(){const{data:e}=this.props;this.vegaEmbed.current&&e&&Object.keys(e).length>0&&this.vegaEmbed.current.modifyView(t=>{p(t,e),t.resize().run()})}render(){const{data:e,...t}=this.props;return s.a.createElement(k,S({ref:this.vegaEmbed},t,{onNewView:this.handleNewView}))}}O(C,"defaultProps",{data:{}});var A,$,E,M,j=function(e){return e.reduce((function(e,t,n){var i,o,s,a,l;return Object(r.a)(Object(r.a)({},e),((i={})[(o=t.name,null!=o?o:""+n)]=(a=(s=t).fields.map((function(e){return e.name})),l=s.fields.reduce((function(e,t){var n;return Object(r.a)(Object(r.a)({},e),((n={})[t.name]=t.values,n))}),{}),s.fields[0].values.toArray().map((function(e,t){return a.reduce((function(e,n){var i;return Object(r.a)(Object(r.a)({},e),((i={})[n]=l[n].get(t),i))}),{})}))),i))}),{})},R=Object(l.stylesFactory)((function(){return{wrapper:Object(a.css)($||($=Object(r.c)(["\n      position: relative;\n    "],["\n      position: relative;\n    "]))),svg:Object(a.css)(E||(E=Object(r.c)(["\n      position: absolute;\n      top: 0;\n      left: 0;\n    "],["\n      position: absolute;\n      top: 0;\n      left: 0;\n    "]))),textBox:Object(a.css)(M||(M=Object(r.c)(["\n      position: absolute;\n      bottom: 0;\n      left: 0;\n      padding: 10px;\n    "],["\n      position: absolute;\n      bottom: 0;\n      left: 0;\n      padding: 10px;\n    "])))}})),D=n(67),T=n.n(D),L=function(e){var t=e.value,n=e.onChange;return o.createElement(T.a,{mode:"json",onChange:n,value:t,tabSize:2,showGutter:!1})};n.d(t,"plugin",(function(){return F}));var F=new i.PanelPlugin((function(e){var t,n=e.options.spec,i=e.data,o=e.width,l=e.height,c=R(),u=Object(r.d)(s.a.useState({}),2),h=u[0],d=u[1];s.a.useEffect((function(){var e;try{d(Object(r.a)({width:4*o/5,height:3*l/4,data:{name:(e=i.series[0].name,null!=e?e:"0")}},JSON.parse(n)))}catch(e){}}),[n,o,l,null===(t=i.series[0])||void 0===t?void 0:t.name]);var f=s.a.useMemo((function(){return j(i.series)}),i.series);return s.a.createElement("div",{className:Object(a.cx)(c.wrapper,Object(a.css)(A||(A=Object(r.c)(["\n          width: ","px;\n          height: ","px;\n        "],["\n          width: ","px;\n          height: ","px;\n        "])),o,l))},s.a.createElement(C,{spec:h,data:f}))})).setPanelOptions((function(e){return e.addCustomEditor({path:"spec",name:"Vega Spec",id:"specEdit",editor:L})}))}])}));
//# sourceMappingURL=module.js.map